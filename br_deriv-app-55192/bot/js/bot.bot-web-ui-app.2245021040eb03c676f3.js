(self.webpackChunk_deriv_bot_web_ui=self.webpackChunk_deriv_bot_web_ui||[]).push([[558],{7328:(e,t,o)=>{var n={"./dalembert.xml":[9022,406],"./martingale.xml":[1732,101],"./oscars_grind.xml":[6373,113]};function r(e){if(!o.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return o.e(t[1]).then((()=>o(r)))}r.keys=()=>Object.keys(n),r.id=7328,e.exports=r},2330:(e,t,o)=>{"use strict";o.r(t),o.d(t,{ActiveSymbols:()=>qo.Z,ApiHelpers:()=>d.Z,ContractsFor:()=>Ko.Z,DBot:()=>Yo,NetworkMonitor:()=>$o,ServerTime:()=>tn,TradingTimes:()=>on.Z,config:()=>l.v,createError:()=>H,error_types:()=>c.Di,getContractTypeName:()=>nn,getSavedWorkspaces:()=>u.WN,importExternal:()=>rn,load:()=>r.zD,log_types:()=>c.F$,message_types:()=>c.LF,observer:()=>p.P,onWorkspaceResize:()=>an.N0,removeExistingWorkspace:()=>u.lY,runGroupedEvents:()=>r.UR,runIrreversibleEvents:()=>r.$9,save:()=>r.a1,saveWorkspaceToRecent:()=>u.l5,save_types:()=>s.R,scrollWorkspace:()=>r.yW,timeSince:()=>ln,trackAndEmitError:()=>J,unrecoverable_errors:()=>c.Jr,updateWorkspaceName:()=>r.Hh});var n=o(2273),r=(o(5730),o(6132));const i='<xml xmlns="http://www.w3.org/1999/xhtml" collection="false">\n  <variables></variables>\n  <block type="trade_definition" x="0" y="0">\n    <statement name="TRADE_OPTIONS">\n      <block type="trade_definition_market" deletable="false" movable="false">\n        <field name="MARKET_LIST"></field>\n        <field name="SUBMARKET_LIST"></field>\n        <field name="SYMBOL_LIST"></field>\n        <next>\n          <block type="trade_definition_tradetype" deletable="false" movable="false">\n            <field name="TRADETYPECAT_LIST"></field>\n            <field name="TRADETYPE_LIST"></field>\n            <next>\n              <block type="trade_definition_contracttype" deletable="false" movable="false">\n                <field name="TYPE_LIST"></field>\n                <next>\n                  <block type="trade_definition_candleinterval" deletable="false" movable="false">\n                    <field name="CANDLEINTERVAL_LIST">60</field>\n                    <next>\n                      <block type="trade_definition_restartbuysell" deletable="false" movable="false">\n                        <field name="TIME_MACHINE_ENABLED">FALSE</field>\n                        <next>\n                          <block type="trade_definition_restartonerror" deletable="false" movable="false">\n                            <field name="RESTARTONERROR">TRUE</field>\n                          </block>\n                        </next>\n                      </block>\n                    </next>\n                  </block>\n                </next>\n              </block>\n            </next>\n          </block>\n        </next>\n      </block>\n    </statement>\n    <statement name="SUBMARKET">\n      <block type="trade_definition_tradeoptions">\n        <mutation has_first_barrier="false" has_second_barrier="false" has_prediction="false"></mutation>\n        <field name="DURATIONTYPE_LIST"></field>\n        <field name="CURRENCY_LIST">USD</field>\n        <value name="DURATION">\n          <shadow type="math_number_positive">\n            <field name="NUM">5</field>\n          </shadow>\n        </value>\n        <value name="AMOUNT">\n          <shadow type="math_number_positive">\n            <field name="NUM">1</field>\n          </shadow>\n        </value>\n        <field name="AMOUNT_LIMITS"></field>\n      </block>\n    </statement>\n  </block>\n  <block type="during_purchase" x="770" y="0">\n    <statement name="DURING_PURCHASE_STACK">\n      <block type="controls_if">\n        <value name="IF0">\n          <block type="check_sell"></block>\n        </value>\n      </block>\n    </statement>\n  </block>\n  <block type="after_purchase" x="770" y="248">\n    <statement name="AFTERPURCHASE_STACK">\n      <block type="trade_again"></block>\n    </statement>\n  </block>\n  <block type="before_purchase" x="0" y="576">\n    <statement name="BEFOREPURCHASE_STACK">\n      <block type="purchase">\n        <field name="PURCHASE_LIST"></field>\n      </block>\n    </statement>\n  </block>\n</xml>';var a=o(282),l=o(9789),c=o(7103),s=o(7929),u=o(2626),p=o(8421),d=o(9633),y=o(5770),m=o(6650),f=o.n(m),_=o(6670),h=o(2052),g=function(e){return p.P.emit("contract.status",e)},b=function(e){return p.P.emit("bot.info",e)},v=function(e,t){return p.P.emit("ui.log.success",{log_type:e,extra:t})},k=function(e){return p.P.emit("ui.log.error",e)};function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var T=function(e){var t=e;return"number"==typeof t&&(t=String(t)),t[t.length-1]},B=function(e){var t,o,r;"InputValidationFailed"===(null===(t=e.error)||void 0===t?void 0:t.code)&&(null!==(o=e.error.details)&&void 0!==o&&o.duration&&(e.error.message=(0,n.localize)("Duration must be a positive integer")),null!==(r=e.error.details)&&void 0!==r&&r.amount&&(e.error.message=(0,n.localize)("Amount must be a positive number.")))},S=function(e,t,o,r){return new Promise((function(i,a){var l=e();l?l.then(i).catch((function(e){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e.error)return!1;var o=["CallError","WrongResponse","GetProposalFailure","RateLimit","DisconnectError","MarketIsClosed"];return B(e),!t.concat(o).includes(e.error.code)}(e,o)?t(e.error.code,(function(){return new Promise((function(t){var o=function(){var e;return null!==(e=p.P.getState("global_timeouts"))&&void 0!==e?e:[]},i=setTimeout((function(){var e=o();delete e[i],p.P.setState(e),t()}),function(e,t){var o=Math.min(2.5*t,15);return"RateLimit"===e.error.code?k((0,n.localize)("You are rate limited for: {{ message_type }}, retrying in {{ delay }}s (ID: {{ request }})",{message_type:e.msg_type,delay:o,request:e.echo_req.req_id})):"DisconnectError"===e.error.code?k((0,n.localize)("You are disconnected, retrying in {{ delay }}s",{delay:o})):"MarketIsClosed"===e.error.code?k((0,n.localize)("This market is presently closed.")):k((0,n.localize)("Request failed for: {{ message_type }}, retrying in {{ delay }}s",{message_type:e.msg_type||(0,n.localize)("unknown"),delay:o})),1e3*o}(e,r)),a=o(),l=(0,y.findValueByKeyRecursively)(e,"msg_type");a[i]={is_cancellable:["buy"].includes(l),msg_type:l},p.P.setState({global_timeouts:a})}))})):a(e)})):i()}))},O=function(e,t){var o=1;return new Promise((function(n,r){var i=function(e,t){o++,t().then(a)},a=function(){S(e,i,t,o).then(n).catch(r)};a()}))},w=function(){return"".concat((new Date).getTime()*Math.random())};function C(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function A(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?C(Object(o),!0).forEach((function(t){I(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):C(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function I(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function R(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return D(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?D(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var x=function(e){return{open:+e.open,high:+e.high,low:+e.low,close:+e.close,epoch:+(e.open_time||e.epoch)}},P=function(e){return e?"candles":"ticks"},N=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=t,this.ticks=new _.Map,this.candles=new _.Map,this.tickListeners=new _.Map,this.ohlcListeners=new _.Map,this.subscriptions=new _.Map,this.ticks_history_promise=null,this.active_symbols_promise=null,this.candles_promise=null,this.observe()}var t,o;return t=e,o=[{key:"requestPipSizes",value:function(){var e=this;return this.pipSizes?Promise.resolve(this.pipSizes):(this.active_symbols_promise||(this.active_symbols_promise=new Promise((function(t){e.api.send({active_symbols:"brief"}).then((function(o){var n=o.active_symbols;e.pipSizes=n.reduce((function(e,t){return e.set(t.symbol,+(+t.pip).toExponential().substring(3))}),new _.Map).toObject(),t(e.pipSizes)}))}))),this.active_symbols_promise)}},{key:"request",value:function(e){var t=e.symbol,o=e.granularity,n=P(o);return"ticks"===n&&this.ticks.has(t)?Promise.resolve(this.ticks.get(t)):"candles"===n&&this.candles.hasIn([t,Number(o)])?Promise.resolve(this.candles.getIn([t,Number(o)])):this.requestStream(A(A({},e),{},{style:n}))}},{key:"monitor",value:function(e){var t=e.symbol,o=e.granularity,n=e.callback,r=P(o),i=w();return this.request(e).catch((function(e){p.P.emit("Error",e)})),"ticks"===r?this.tickListeners=this.tickListeners.setIn([t,i],n):this.ohlcListeners=this.ohlcListeners.setIn([t,Number(o),i],n),i}},{key:"stopMonitor",value:function(e){var t=e.symbol,o=e.granularity,n=e.key,r=P(o);"ticks"===r&&this.tickListeners.hasIn([t,n])&&(this.tickListeners=this.tickListeners.deleteIn([t,n])),"candles"===r&&this.ohlcListeners.hasIn([t,Number(o),n])&&(this.ohlcListeners=this.ohlcListeners.deleteIn([t,Number(o),n])),this.unsubscribeIfEmptyListeners(e)}},{key:"unsubscribeIfEmptyListeners",value:function(e){var t=e.symbol,o=e.granularity,n=!1,r=this.tickListeners.get(t);r&&!r.size&&(this.tickListeners=this.tickListeners.delete(t),this.ticks=this.ticks.delete(t),n=!0);var i=this.ohlcListeners.getIn([t,Number(o)]);i&&!i.size&&(this.ohlcListeners=this.ohlcListeners.deleteIn([t,Number(o)]),this.candles=this.candles.deleteIn([t,Number(o)]),n=!0),n&&this.unsubscribeAllAndSubscribeListeners(t)}},{key:"unsubscribeAllAndSubscribeListeners",value:function(e){var t=this,o=this.subscriptions.getIn(["ohlc",e]),n=this.subscriptions.getIn(["tick",e]),r=[].concat(R(o?Array.from(o.values()):[]),R(n||[]));Promise.all(r.map((function(e){return O((function(){return t.api.forget(e)}))}))),this.subscriptions=new _.Map}},{key:"updateTicksAndCallListeners",value:function(e,t){var o=this;if(this.ticks.get(e)!==t){this.ticks=this.ticks.set(e,t);var n=this.tickListeners.get(e);n&&n.forEach((function(t){return t(o.ticks.get(e))}))}}},{key:"updateCandlesAndCallListeners",value:function(e,t){var o=this;if(this.ticks.getIn(e)!==t){this.candles=this.candles.setIn(e,t);var n=this.ohlcListeners.getIn(e);n&&n.forEach((function(t){return t(o.candles.getIn(e))}))}}},{key:"observe",value:function(){var e=this;this.api.onMessage().subscribe((function(t){var o,n,r=t.data;if("tick"===r.msg_type){var i=r.tick,a=i.symbol,l=i.id;e.ticks.has(a)&&(e.subscriptions=e.subscriptions.setIn(["tick",a],l),e.updateTicksAndCallListeners(a,(o=e.ticks.get(a),n=function(e){return{epoch:+e.epoch,quote:+e.quote}}(i),(0,h.CT)(o).epoch>=n.epoch?o:[].concat(R(o.slice(1)),[n]))))}if("ohlc"===r.msg_type){var c=r.ohlc,s=c.symbol,u=c.granularity,p=c.id;if(e.candles.hasIn([s,Number(u)])){e.subscriptions=e.subscriptions.setIn(["ohlc",s,Number(u)],p);var d=[s,Number(u)];e.updateCandlesAndCallListeners(d,function(e,t){var o=(0,h.CT)(e);if(o.open===t.open&&o.high===t.high&&o.low===t.low&&o.close===t.close&&o.epoch===t.epoch||o.epoch>t.epoch)return e;var n=o.epoch===t.epoch?e.slice(0,-1):e.slice(1);return[].concat(R(n),[t])}(e.candles.getIn(d),x(c)))}}}))}},{key:"requestStream",value:function(e){var t=this,o=e.style,n=JSON.stringify(e);return"ticks"===o?(this.ticks_history_promise&&this.ticks_history_promise.stringified_options===n||(this.ticks_history_promise={promise:this.requestPipSizes().then((function(){return t.requestTicks(e)})),stringified_options:n}),this.ticks_history_promise.promise):"candles"===o?(this.candles_promise&&this.candles_promise.stringified_options===n||(this.candles_promise={promise:this.requestPipSizes().then((function(){return t.requestTicks(e)})),stringified_options:n}),this.candles_promise.promise):[]}},{key:"requestTicks",value:function(e){var t=this,o=e.symbol,n=e.granularity,r=e.style,i={ticks_history:o,subscribe:1,end:"latest",count:1e3,granularity:n?Number(n):void 0,style:r};return new Promise((function(e,a){O((function(){return t.api.send(i)})).then((function(i){if("ticks"===r){var a=(0,h.Yp)(i.history);t.updateTicksAndCallListeners(o,a),e(a)}else{var l=function(e){return e.map((function(e){return x(e)}))}(i.candles);t.updateCandlesAndCallListeners([o,Number(n)],l),e(l)}})).catch(a)}))}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),z=o(5974),L=o.n(z);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t){return U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},U(e,t)}function j(e,t){if(t&&("object"===M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function V(e){return V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},V(e)}var H=function(e,t){var o=new Error(t);return o.name=e,o.code=e,o},J=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p.P.emit("ui.log.error",e),window.trackJs&&trackJs.track("".concat(e," - Error: ").concat(JSON.stringify(t)))};function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var W=function(e){return Number.isFinite(e)&&e>0},Y=function(e){return W(e)&&Number.isInteger(e)},q=function(e){var t,o=(2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(t)||function(e,t){if(e){if("string"==typeof e)return G(e,2);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?G(e,2):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0],i=o[1];if(!r)throw H("LoginError",(0,n.localize)("Please login"));return function(e){var t=e.symbol,o=e.contractTypes;if(!t)throw H("OptionError",(0,n.localize)("Underlying market is not selected"));if(!o[0])throw H("OptionError",(0,n.localize)("Contract type is not selected"))}(i),e},K=function(e){return e instanceof Object&&["open","high","low","close"].every((function(t){return W(e[t])}))&&Y(e.epoch)},X=function(e){if(!K(e))throw H("CandleExpected",(0,n.localize)("Given candle is not valid"));return e};function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $(e,t){return $=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$(e,t)}function ee(e,t){if(t&&("object"===Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function te(e){return te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},te(e)}const oe=function(e){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(l,e);var t,o,r,i,a=(r=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=te(r);if(i){var o=te(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return ee(this,e)});function l(){return Q(this,l),a.apply(this,arguments)}return t=l,(o=[{key:"getCandleInterface",value:function(){return{isCandleBlack:function(e){return X(e)&&e.close<e.open},candleValues:function(e,t){return function(e){if(!(e instanceof Array&&e.every((function(e){return K(e)}))))throw H("CandleListExpected",(0,n.localize)("Given candle list is not valid"));return e}(e).map((function(e){return e[t]}))},candleField:function(e,t){return X(e)[t]}}}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),l}(e)};var ne=function(e,t){return e.map((function(e){return t?e[t]:e}))},re=function(e,t,o){return ne(e.slice(t>e.length?0:e.length-t,e.length),o)},ie=function(e){return e.reduce((function(e,t){return e+t}))/e.length},ae=function(e,t){var o=t.periods,n=t.field;if(e.length<o)throw new Error("Periods longer than data length");return function(e){return e.reduce((function(e,t){return e+t}))}(re(e,o,n))/o},le=function(e,t){var o=t.periods,n=t.pipSize,r=void 0===n?2:n;return(0,y.sequence)(e.length-o+1).map((function(n,i){return+ae(e.slice(i,i+o),t).toFixed(r)}))},ce=function(e,t){var o=t.periods,n=void 0===o?20:o,r=t.field,i=t.stdDevUp,a=void 0===i?2:i,l=t.stdDevDown,c=void 0===l?2:l,s=t.pipSize,u=void 0===s?2:s,p=re(e,n,r),d=ae(p,{periods:n}),y=function(e){var t=ie(e),o=e.map((function(e){return Math.pow(e-t,2)})),n=ie(o);return Math.sqrt(n)}(p),m=d+y*a,f=d-y*c;return[+d.toFixed(u),+m.toFixed(u),+f.toFixed(u)]},se=function(e,t){var o=t.periods;return(0,y.sequence)(e.length-o+1).map((function(n,r){return ce(e.slice(r,r+o),t)}))},ue=function(e,t,o){var n=t.periods,r=t.field,i=t.pipSize,a=void 0===i?2:i,l=2/(n+1),c=ne(e,r);if(o)return(c[0]-o)*l+o;if(e.length<n)throw new Error("Periods longer than data length");var s=ie(ne(e.slice(0,n),r));return+c.slice(n).reduce((function(e,t){return(t-e)*l+e}),s).toFixed(a)},pe=function(e,t){var o=t.periods,n=ue(e.slice(0,o),t);return e.slice(o-1).map((function(e,o){return o?n=ue([e],t,n):n}))};function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var ye=function(e,t){var o=[];return o.length=t-e.length,o.fill(0),[].concat(o,function(e){return function(e){if(Array.isArray(e))return de(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return de(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?de(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e))},me=function(e,t){var o=t.field,n=t.fastEmaPeriod,r=void 0===n?12:n,i=t.slowEmaPeriod,a=void 0===i?26:i,l=t.signalEmaPeriod,c=void 0===l?9:l,s=t.pipSize,u=void 0===s?2:s,p=ne(e,o),d=p.length,y=ye(pe(p,{periods:r,pipSize:20,field:o}),d),m=ye(pe(p,{periods:a,pipSize:20,field:o}),d),f=ye(m.map((function(e,t){return+(y[t]-e).toFixed(u)})),d),_=ye(pe(f.slice(a-1),{periods:c,pipSize:20,field:o}),d);return f.map((function(e,t){return[+(e-_[t]).toFixed(u),e,+_[t].toFixed(u)]})).slice(a+c-2)},fe=function(e,t){return t>e?t-e:0},_e=function(e,t){return t<e?e-t:0},he=function(e,t,o){var n;return e.reduce((function(e,o,r){1===r&&(n=e);var i=t(n,o);return n=o,i+(1===r?0:e)}))/o},ge=function(e,t,o,n){var r;return 1===e.length?n:e.reduce((function(e,i,a){1===a&&(r=e);var l=t(r,i);return r=i,((1===a?n:e)*(o-1)+l)/o}))},be=function(e,t,o){var n=t.periods,r=t.field;if(e.length<n)throw new Error("Periods longer than data length");if(e.length===n)return 0;var i,a,l,c=ne(e.slice(0,n+1),r);o&&"gain"in o?(i=ne(e.slice(-2),r),a=o.gain,l=o.loss):(i=ne(e.slice(n,e.length),r),a=he(c,fe,n),l=he(c,_e,n));var s=ge(i,fe,n,a),u=ge(i,_e,n,l);return o&&(o.gain=s,o.loss=u),0===s?0:0===u?100:100-100/(1+s/u)},ve=function(e,t){var o=t.periods,n=t.pipSize,r=void 0===n?2:n,i={};return(0,y.sequence)(e.length-o).map((function(n,a){return+be(e.slice(0,a+o+1),t,i).toFixed(r)}))};function ke(e){return ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ke(e)}function Ee(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Te(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(o),!0).forEach((function(t){Be(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ee(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Be(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oe(e,t){return Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Oe(e,t)}function we(e,t){if(t&&("object"===ke(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ce(e){return Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ce(e)}const Ae=function(e){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oe(e,t)}(a,e);var t,o,n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ce(n);if(r){var o=Ce(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return we(this,e)});function a(){return Se(this,a),i.apply(this,arguments)}return t=a,o=[{key:"getIndicatorsInterface",value:function(){var e=this;return{sma:function(t,o){return e.decorate(ae,t,{periods:o})},smaa:function(t,o){return e.decorate(le,t,{periods:o})},ema:function(t,o){return e.decorate(ue,t,{periods:o})},emaa:function(t,o){return e.decorate(pe,t,{periods:o})},rsi:function(t,o){return e.decorate(be,t,{periods:o})},rsia:function(t,o){return e.decorate(ve,t,{periods:o})},bb:function(t,o,n){return e.decorate(ce,t,o)[n]},bba:function(t,o,n){return e.decorate(se,t,o).map((function(e){return e[n]}))},macda:function(t,o,n){return e.decorate(me,t,o).map((function(e){return e[n]}))}}}},{key:"decorate",value:function(e,t,o){for(var n=this.tradeEngine.getPipSize(),r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];return e.apply(void 0,[t,Te({pipSize:n},o)].concat(i))}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(e)};function Ie(e){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ie(e)}function Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function De(e,t){return De=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},De(e,t)}function xe(e,t){if(t&&("object"===Ie(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Pe(e){return Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Pe(e)}const Ne=function(e){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&De(e,t)}(c,e);var t,o,r,i,a=(r=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Pe(r);if(i){var o=Pe(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return xe(this,e)});function c(){return Re(this,c),a.apply(this,arguments)}return t=c,o=[{key:"getMiscInterface",value:function(){var e=this;return{notify:function(e){return p.P.emit("ui.log.notify",e)},console:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e.type,o=e.message;return console[t](o)})),notifyTelegram:function(e,t,o){var r="https://api.telegram.org/bot".concat(e,"/sendMessage"),i=function(){return e=(0,n.localize)("The Telegram notification could not be sent"),p.P.emit("ui.log.notify",{className:"warn",message:e,sound:l.v.lists.NOTIFICATION_SOUND[0][1]});var e};fetch(r,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:t,text:o})}).then((function(e){e.ok||i()})).catch(i)},getTotalRuns:function(){return e.tradeEngine.getTotalRuns()},getBalance:function(t){return e.tradeEngine.getBalance(t)},getTotalProfit:function(t){return e.tradeEngine.getTotalProfit(t,e.tradeEngine.tradeOptions.currency)}}}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),c}(e)};function ze(e){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ze(e)}function Le(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Me(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(o),!0).forEach((function(t){Fe(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Le(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Fe(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function Ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function je(e,t){return je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},je(e,t)}function Ve(e,t){if(t&&("object"===ze(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function He(e){return He=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},He(e)}var Je=o(365),Ge=o(3292);function We(e){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(e)}function Ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qe(e,t){return qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qe(e,t)}function Ke(e,t){if(t&&("object"===We(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Xe(e){return Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xe(e)}var Ze="",Qe="BEFORE_PURCHASE",$e="DURING_PURCHASE",et="PROPOSALS_READY",tt="CLEAR_PROPOSALS",ot="PURCHASE_SUCCESSFUL",nt="OPEN_CONTRACT",rt="SELL",it="START",at="STOP",lt="NEW_TICK";function ct(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function st(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(o),!0).forEach((function(t){ut(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ct(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function ut(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var pt=function(e){var t=e.dispatch,o=e.getState,n=e.data,r=e.scope;o().scope===r&&t(n)},dt=function(e){(0,e.getState)().proposalsReady&&function(e){pt(st(st({},e),{},{scope:Qe}))}(e)};function yt(e){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yt(e)}function mt(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ft(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ht(e,t){return ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ht(e,t)}function gt(e,t){if(t&&("object"===yt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function bt(e){return bt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},bt(e)}function vt(e){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vt(e)}function kt(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Et(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?kt(Object(o),!0).forEach((function(t){Tt(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):kt(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Tt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function Bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function St(e,t){return St=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},St(e,t)}function Ot(e,t){if(t&&("object"===vt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function wt(e){return wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},wt(e)}function Ct(e){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ct(e)}function At(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function It(e,t){return It=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},It(e,t)}function Rt(e,t){if(t&&("object"===Ct(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Dt(e){return Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Dt(e)}var xt,Pt=0;function Nt(e){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nt(e)}function zt(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Lt(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(o),!0).forEach((function(t){Mt(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):zt(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Mt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function Ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ut(e,t){return Ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ut(e,t)}function jt(e,t){if(t&&("object"===Nt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Vt(e){return Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Vt(e)}function Ht(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Jt(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(o),!0).forEach((function(t){Gt(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ht(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Gt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var Wt={scope:at,proposalsReady:!1};const Yt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case it:return{scope:Qe,proposalsReady:e.proposalsReady};case et:return Jt(Jt({},e),{},{proposalsReady:!0});case tt:return Jt(Jt({},e),{},{proposalsReady:!1});case ot:return{scope:$e,openContract:!1,proposalsReady:e.proposalsReady};case nt:return{scope:$e,openContract:!0,proposalsReady:e.proposalsReady};case rt:return{scope:at,proposalsReady:e.proposalsReady};case lt:return Jt(Jt({},e),{},{newTick:t.payload});default:return e}};function qt(e){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qt(e)}function Kt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xt(e,t){return Xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Xt(e,t)}function Zt(e,t){if(t&&("object"===qt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Qt(e){return Qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Qt(e)}var $t;function eo(e){return eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eo(e)}function to(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function oo(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?to(Object(o),!0).forEach((function(t){no(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):to(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function no(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function ro(e,t){return ro=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ro(e,t)}function io(e,t){if(t&&("object"===eo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ao(e)}function ao(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lo(e){return lo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},lo(e)}var co={totalProfit:0,totalWins:0,totalLosses:0,totalStake:0,totalPayout:0,totalRuns:0},so={};function uo(e){return uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uo(e)}function po(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function yo(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?po(Object(o),!0).forEach((function(t){mo(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):po(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function mo(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function fo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _o(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _o(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function ho(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function go(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bo(e,t,o){return t&&go(e.prototype,t),o&&go(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function vo(e,t){return vo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},vo(e,t)}function ko(e,t){if(t&&("object"===uo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Eo(e){return Eo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Eo(e)}var To,Bo,So=function(e){var t=e.store,o=e.stopScope,n=e.passScope,r=e.passFlag;return t.getState().scope===o?Promise.resolve(!1):new Promise((function(e){var i=t.subscribe((function(){var a=t.getState();a.newTick!==To&&(To=a.newTick,a.scope===n&&a[r]&&(i(),e(!0)),a.scope===o&&(i(),e(!1)))}))}))},Oo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vo(e,t)}(i,e);var t,o,r=(t=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=Eo(t);if(o){var r=Eo(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return ko(this,e)});function i(e){var t;return ho(this,i),(t=r.call(this)).api=e.api,t.observer=e.observer,t.$scope=e,t.observe(),t.data={contract:{},proposals:[],forget_proposal_ids:[]},t.store=(0,Je.MT)(Yt,(0,Je.md)(Ge.Z)),t}return bo(i,[{key:"init",value:function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];var n=q(t),r=fo(n,2),i=r[0],a=r[1],l=a.symbol;this.initArgs=t,this.options=a,this.startPromise=this.loginAndGetBalance(i),this.watchTicks(l)}},{key:"start",value:function(e){if(!this.options)throw H("NotInitialized",(0,n.localize)("Bot.init is not called"));p.P.emit("bot.running"),this.tradeOptions=e,this.store.dispatch((function(e,t){return pt({dispatch:e,getState:t,data:{type:it},scope:at})})),this.checkLimits(e),this.makeProposals(yo(yo({},this.options),e)),this.checkProposalReady()}},{key:"loginAndGetBalance",value:function(e){var t=this;return this.token===e?Promise.resolve():(O((function(){return t.api.authorize(e)})).catch((function(e){t.$scope.observer.emit("Error",e)})),new Promise((function(o){t.api.onMessage().subscribe((function(n){var r=n.data;"transaction"===r.msg_type&&"sell"===r.transaction.action&&(t.transaction_recovery_timeout=setTimeout((function(){var e=t.data.contract,o=e.contract_id===r.transaction.contract_id,n="open"===e.status;o&&n&&O((function(){t.api.send({proposal_open_contract:1,contract_id:e.contract_id})}),["PriceMoved"])}),1500)),"authorize"===r.msg_type&&(t.accountInfo=r,t.token=e,document?O((function(){return t.api.send({balance:1,subscribe:1})})).then((function(e){t.balance=Number(e.balance.balance),o()})):o(),O((function(){return t.api.send({transaction:1,subscribe:1})})))}))})))}},{key:"observe",value:function(){this.observeOpenContract(),this.observeBalance(),this.observeProposals()}},{key:"watch",value:function(e){return"before"===e?(t=this.store,So({store:t,stopScope:$e,passScope:Qe,passFlag:"proposalsReady"})):function(e){return So({store:e,stopScope:at,passScope:$e,passFlag:"openContract"})}(this.store);var t}}]),i}(function(e){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qe(e,t)}(l,e);var t,o,n,r,i=(n=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Xe(n);if(r){var o=Xe(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return Ke(this,e)});function l(){return Ye(this,l),i.apply(this,arguments)}return t=l,(o=[{key:"observeBalance",value:function(){var e=this;this.api.onMessage().subscribe((function(t){var o=t.data;if("balance"===o.msg_type){var n=o.balance,r=n.balance,i=n.currency;Ze=(0,y.getFormattedText)(r,i),b({accountID:e.accountInfo.loginid,balance:Ze})}}))}},{key:"getBalance",value:function(e){var t=this.store.getState().scope,o=a.Z.instance.client,n=o&&o.balance||0,r=n;return"BEFORE_PURCHASE"===t&&(r=Number(n)-this.tradeOptions.amount),Ze=(0,y.getFormattedText)(r,o.currency,!1),"STR"===e?Ze:n}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),l}(e)}(function(e){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&It(e,t)}(a,e);var t,o,n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Dt(n);if(r){var o=Dt(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return Rt(this,e)});function a(){var e;At(this,a);for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return(e=i.call.apply(i,[this].concat(o))).getPurchaseReference=function(){return xt},e.regeneratePurchaseReference=function(){xt=w()},e}return t=a,(o=[{key:"purchase",value:function(e){var t=this;if(this.store.getState().scope!==Qe)return Promise.resolve();var o=this.selectProposal(e),n=o.id,r=o.askPrice,i=function(o){t.data.proposals=t.data.proposals.filter((function(e){return e.id!==o.echo_req.buy}));var n=o.buy;g({id:"contract.purchase_received",data:n.transaction_id,buy:n}),t.subscribeToOpenContract(n.contract_id),t.store.dispatch((function(e,t){return dt({dispatch:e,getState:t,data:{type:ot}})})),t.renewProposalsOnPurchase(),Pt=0,v(c.F$.PURCHASE,{longcode:n.longcode,transaction_id:n.transaction_id}),b({accountID:t.accountInfo.loginid,totalRuns:t.updateAndReturnTotalRuns(),transaction_ids:{buy:n.transaction_id},contract_type:e,buy_price:n.buy_price})},a=function(){return t.api.send({buy:n,price:r})};return this.isSold=!1,g({id:"contract.purchase_sent",data:r}),this.options.timeMachineEnabled?S(a,(function(e,o){"DisconnectError"!==e?t.renewProposalsOnPurchase():t.clearProposals();var n=t.store.subscribe((function(){var e=t.store.getState(),r=e.scope,i=e.proposalsReady;r===Qe&&i&&(o().then((function(){return t.observer.emit("REVERT","before")})),n())}))}),["PriceMoved","InvalidContractProposal"],Pt++).then(i):O(a).then(i)}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(e)}(function(e){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ut(e,t)}(a,e);var t,o,n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Vt(n);if(r){var o=Vt(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return jt(this,e)});function a(){return Ft(this,a),i.apply(this,arguments)}return t=a,(o=[{key:"isSellAtMarketAvailable",value:function(){return this.contractId&&!this.isSold&&this.isSellAvailable&&!this.isExpired}},{key:"sellAtMarket",value:function(){var e=this;if(p.P.emit("bot.sell"),this.store.getState().scope!==$e)return Promise.resolve();if(!this.isSellAtMarketAvailable())return v(c.F$.NOT_OFFERED),Promise.resolve();var t=1;return new Promise((function(o){var n=function(n){if(t=1,n){var r=n.sell.sold_for;v(c.F$.SELL,{sold_for:r})}g("purchase.sold"),e.waitForAfter(),o()},r=e.contractId,i=function(){return O((function(){return e.api.send({sell:r,price:0})})).then((function(t){O((function(){return e.api.send({proposal_open_contract:1,contract_id:r})})).then((function(){return t}))})).catch((function(t){var o=t.error;if("InvalidOfferings"===o.code)return Promise.resolve();var n={name:o.code,message:o.message,msg_type:t.msg_type,error:Lt({},o.error)};return"RateLimit"===o.code?Promise.reject(n):O((function(){return e.api.send({proposal_open_contract:1,contract_id:r})})).then((function(e){var t=e.proposal_open_contract;return"sold"!==t.status?Promise.reject(n):Promise.resolve({sell:{sold_for:t.sell_price}})}))}))},a=["NoOpenPosition","InvalidSellContractProposal","UnrecognisedRequest"];return e.options.timeMachineEnabled?S(i,(function(t,o){return o().then((function(){return e.observer.emit("REVERT","during")}))}),a,t++).then((function(e){return n(e)})):O(i,a).then((function(e){return n(e)}))}))}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(e)}(function(e){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ht(e,t)}(l,e);var t,o,n,r,i=(n=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=bt(n);if(r){var o=bt(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return gt(this,e)});function l(){return _t(this,l),i.apply(this,arguments)}return t=l,o=[{key:"observeOpenContract",value:function(){var e=this;this.api.onMessage().subscribe((function(t){var o,n=t.data;if("proposal_open_contract"===n.msg_type){var r=n.proposal_open_contract;if(!r&&!e.expectedContractId(null==r?void 0:r.contract_id))return;e.setContractFlags(r),e.data.contract=r,o=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(o),!0).forEach((function(t){ft(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):mt(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({accountID:e.accountInfo.loginid},r),p.P.emit("bot.contract",o),e.isSold?(e.contractId="",clearTimeout(e.transaction_recovery_timeout),e.updateTotals(r),g({id:"contract.sold",data:r.transaction_ids.sell,contract:r}),e.afterPromise&&e.afterPromise(),e.store.dispatch((function(e,t){return pt({dispatch:e,getState:t,data:{type:rt},scope:$e})}))):e.store.dispatch((function(e,t){t().scope===$e&&e({type:nt}),dt({dispatch:e,getState:t,data:{type:nt}})}))}}))}},{key:"waitForAfter",value:function(){var e=this;return new Promise((function(t){e.afterPromise=t}))}},{key:"subscribeToOpenContract",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.contractId;this.contractId=t,O((function(){return e.api.send({proposal_open_contract:1,contract_id:t,subscribe:1})})).then((function(t){(0,a.Z.instance.populateConfig)(t.proposal_open_contract),e.openContractId=t.proposal_open_contract.id})).catch((function(o){"AlreadySubscribed"!==o.error.code&&O((function(){return e.api.send({proposal_open_contract:1,contract_id:t,subscribe:1})})).then((function(t){return e.openContractId=t.proposal_open_contract.id}))}))}},{key:"setContractFlags",value:function(e){var t=e.is_expired,o=e.is_valid_to_sell,n=e.is_sold,r=e.entry_tick;this.isSold=Boolean(n),this.isSellAvailable=!this.isSold&&Boolean(o),this.isExpired=Boolean(t),this.hasEntryTick=Boolean(r)}},{key:"expectedContractId",value:function(e){return this.contractId&&e===this.contractId}},{key:"getSellPrice",value:function(){var e=this.data.contract,t=e.bid_price,o=e.buy_price,n=e.currency;return(0,y.getRoundedNumber)(Number(t)-Number(o),n)}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),l}(e)}(function(e){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&St(e,t)}(l,e);var t,o,r,i,a=(r=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=wt(r);if(i){var o=wt(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return Ot(this,e)});function l(){return Bt(this,l),a.apply(this,arguments)}return t=l,o=[{key:"makeProposals",value:function(e){this.isNewTradeOption(e)&&(this.regeneratePurchaseReference(),this.trade_option=e,this.proposal_templates=function(e,t){return e.contractTypes.map((function(o){var n={amount:e.amount,basis:e.basis,contract_type:o,currency:e.currency,duration:e.duration,duration_unit:e.duration_unit,multiplier:e.multiplier,passthrough:{contract_type:o,purchase_reference:t},proposal:1,symbol:e.symbol};return void 0!==e.prediction&&(n.selected_tick=e.prediction),["TICKLOW","TICKHIGH"].includes(o)||void 0===e.prediction?void 0!==e.barrierOffset&&(n.barrier=e.barrierOffset):n.barrier=e.prediction,void 0!==e.secondBarrierOffset&&(n.barrier2=e.secondBarrierOffset),["MULTUP","MULTDOWN"].includes(o)&&(n.duration=void 0,n.duration_unit=void 0),(0,y.isEmptyObject)(e.limit_order)||(n.limit_order=e.limit_order),n}))}(e,this.getPurchaseReference()),this.renewProposalsOnPurchase())}},{key:"selectProposal",value:function(e){var t=this,o=this.data.proposals;if(0===o.length)throw Error((0,n.localize)("Proposals are not ready"));var r=o.find((function(o){if(o.contract_type===e&&o.purchase_reference===t.getPurchaseReference()){if(o.error)throw o.error;return o}return!1}));if(!r)throw new Error((0,n.localize)("Selected proposal does not exist"));return{id:r.id,askPrice:r.ask_price}}},{key:"renewProposalsOnPurchase",value:function(){var e=this;this.unsubscribeProposals().then((function(){return e.requestProposals()}))}},{key:"clearProposals",value:function(){this.data.proposals=[],this.store.dispatch({type:tt})}},{key:"requestProposals",value:function(){var e=this,t=!1;Promise.all(this.proposal_templates.map((function(o){O((function(){return e.api.send(o)})).catch((function(o){return"ContractBuyValidationError"===o.error.code?(e.data.proposals.push(Et(Et(Et({},o.error.echo_req),o.echo_req.passthrough),{},{error:o})),null):(t||(t=!0,e.$scope.observer.emit("Error",o.error)),null)}))})))}},{key:"observeProposals",value:function(){var e=this;this.api.onMessage().subscribe((function(t){if("proposal"===t.data.msg_type){var o=t.data,n=o.passthrough,r=o.proposal;r&&-1===e.data.proposals.findIndex((function(e){return e.id===r.id}))&&!e.data.forget_proposal_ids.includes(r.id)&&(e.data.proposals.push(Et(Et({},r),n)),e.checkProposalReady())}}))}},{key:"unsubscribeProposals",value:function(){var e=this,t=this.data.proposals,o=function(t){return e.data.forget_proposal_ids=e.data.forget_proposal_ids.filter((function(e){return e!==t}))};return this.clearProposals(),Promise.all(t.map((function(t){return e.data.forget_proposal_ids.includes(t.id)||e.data.forget_proposal_ids.push(t.id),t.error?(o(t.id),Promise.resolve()):O((function(){return e.api.forget(t.id)})).then((function(){o(t.id)}))})))}},{key:"checkProposalReady",value:function(){var e=this,t=this.data.proposals;t.length>0&&this.proposal_templates.every((function(e){return-1!==t.findIndex((function(t){return t.purchase_reference===e.passthrough.purchase_reference&&t.contract_type===e.contract_type}))}))&&this.startPromise.then((function(){return e.store.dispatch({type:et})}))}},{key:"isNewTradeOption",value:function(e){var t=this;return this.trade_option?["amount","barrierOffset","basis","duration","duration_unit","prediction","secondBarrierOffset","symbol"].some((function(o){return t.trade_option[o]!==e[o]})):(this.trade_option=e,!0)}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),l}(e)}((Bo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ro(e,t)}(l,e);var t,o,r,i,a=(r=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=lo(r);if(i){var o=lo(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return io(this,e)});function l(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(e=a.call(this)).sessionRuns=0,e.sessionProfit=0,p.P.register("statistics.clear",e.clearStatistics.bind(ao(e))),e}return t=l,(o=[{key:"clearStatistics",value:function(){if(this.sessionRuns=0,this.sessionProfit=0,this.accountInfo){var e=this.accountInfo.loginid;so[e]=oo({},co)}}},{key:"updateTotals",value:function(e){var t=e.sell_price,o=e.buy_price,n=e.currency,r=(0,y.getRoundedNumber)(Number(t)-Number(o),n),i=r>0,a=this.getAccountStat();a.totalWins+=i?1:0,a.totalLosses+=i?0:1,this.sessionProfit=(0,y.getRoundedNumber)(Number(this.sessionProfit)+Number(r),n),a.totalProfit=(0,y.getRoundedNumber)(Number(a.totalProfit)+Number(r),n),a.totalStake=(0,y.getRoundedNumber)(Number(a.totalStake)+Number(o),n),a.totalPayout=(0,y.getRoundedNumber)(Number(a.totalPayout)+Number(t),n),b({profit:r,contract:e,accountID:this.accountInfo.loginid,totalProfit:a.totalProfit,totalWins:a.totalWins,totalLosses:a.totalLosses,totalStake:a.totalStake,totalPayout:a.totalPayout}),v(i?c.F$.PROFIT:c.F$.LOST,{currency:n,profit:r})}},{key:"updateAndReturnTotalRuns",value:function(){return this.sessionRuns++,++this.getAccountStat().totalRuns}},{key:"getTotalRuns",value:function(){return this.getAccountStat().totalRuns}},{key:"getTotalProfit",value:function(e,t){var o=this.getAccountStat();return e&&0!==o.totalProfit?(0,y.getRoundedNumber)(+o.totalProfit,t):+o.totalProfit}},{key:"checkLimits",value:function(e){if(e.limitations){var t=e.limitations,o=t.maxLoss,r=t.maxTrades;if(o&&r){if(this.sessionRuns>=r)throw H("CustomLimitsReached",(0,n.localize)("Maximum number of trades reached"));if(this.sessionProfit<=-o)throw H("CustomLimitsReached",(0,n.localize)("Maximum loss amount reached"))}}}},{key:"getAccountStat",value:function(){var e=this.accountInfo.loginid;return e in so||(so[e]=oo({},co)),so[e]}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),l}(bo((function e(){ho(this,e)}))),function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xt(e,t)}(l,e);var t,o,r,i,a=(r=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Qt(r);if(i){var o=Qt(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return Zt(this,e)});function l(){return Kt(this,l),a.apply(this,arguments)}return t=l,o=[{key:"watchTicks",value:function(e){var t=this;if(e&&this.symbol!==e){var o=this.$scope.ticksService;o.stopMonitor({symbol:e,key:$t});var n=o.monitor({symbol:e,callback:function(e){t.checkProposalReady();var o=e.slice(-1)[0].epoch;t.store.dispatch({type:lt,payload:o})}});this.symbol=e,$t=n}}},{key:"getTicks",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(o){e.$scope.ticksService.request({symbol:e.symbol}).then((function(n){var r=e.getPipSize(),i=n.map((function(e){return t?e.quote.toFixed(r):e.quote}));o(i)}))}))}},{key:"getLastTick",value:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(n){return t.$scope.ticksService.request({symbol:t.symbol}).then((function(r){var i=e?(0,h.CT)(r):(0,h.CT)(r).quote;o&&!e&&(i=i.toFixed(t.getPipSize())),n(i)})).catch((function(e){"MarketIsClosed"===e.code&&(p.P.emit("Error",e),n(e.code))}))}))}},{key:"getLastDigit",value:function(){var e=this;return new Promise((function(t){return e.getLastTick(!1,!0).then((function(e){return t(T(e))}))}))}},{key:"getLastDigitList",value:function(){var e=this;return new Promise((function(t){return e.getTicks().then((function(e){return t(e.map((function(e){return T(e)})))}))}))}},{key:"checkDirection",value:function(e){var t=this;return new Promise((function(o){return t.$scope.ticksService.request({symbol:t.symbol}).then((function(t){return o(function(e){var t,o=e.length,n=(2,function(e){if(Array.isArray(e))return e}(t=e.slice(-2))||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(t)||function(e,t){if(e){if("string"==typeof e)return E(e,2);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?E(e,2):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=n[0],i=n[1],a="";return o>=2&&(a=r.quote<i.quote?"rise":a,a=r.quote>i.quote?"fall":a),a}(t)===e)}))}))}},{key:"getOhlc",value:function(e){var t=this,o=e||{},n=o.granularity,r=void 0===n?this.options.candleInterval||60:n,i=o.field;return new Promise((function(e){return t.$scope.ticksService.request({symbol:t.symbol,granularity:r}).then((function(t){return e(i?t.map((function(e){return e[i]})):t)}))}))}},{key:"getOhlcFromEnd",value:function(e){var t=this,o=(e||{}).index,r=function(e,t){if(!Y(e))throw H("PositiveIntegerExpected",t);return e}(Number(void 0===o?1:o),(0,n.localize)("Index must be a positive integer"));return new Promise((function(o){return t.getOhlc(e).then((function(e){return o(e.slice(-r)[0])}))}))}},{key:"getPipSize",value:function(){return this.$scope.ticksService.pipSizes[this.symbol]}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),l}(Bo))))))));function wo(e){return wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wo(e)}function Co(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Ao(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Co(Object(o),!0).forEach((function(t){Io(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Co(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Io(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function Ro(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Do(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xo(e,t,o){return t&&Do(e.prototype,t),o&&Do(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function Po(e,t){return Po=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Po(e,t)}function No(e,t){if(t&&("object"===wo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function zo(e){return zo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},zo(e)}var Lo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Po(e,t)}(r,e);var t,o,n=(t=r,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=zo(t);if(o){var r=zo(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return No(this,e)});function r(e){var t;return Ro(this,r),(t=n.call(this)).tradeEngine=new Oo(e),t.api=e.api,t.observer=e.observer,t.$scope=e,t}return xo(r,[{key:"getInterface",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Global";return"Bot"===t?Ao(Ao({},this.getBotInterface()),this.getToolsInterface()):{watch:function(){var t;return(t=e.tradeEngine).watch.apply(t,arguments)},sleep:function(){return e.sleep.apply(e,arguments)},alert:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return alert.apply(void 0,arguments)})),prompt:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return prompt.apply(void 0,arguments)})),console:{log:function(){for(var e,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];(e=console).log.apply(e,[(new Date).toLocaleTimeString()].concat(o))}}}}},{key:"getBotInterface",value:function(){var e=this,t=function(t){return(o=e.tradeEngine.data.contract,n=o.sell_price,r=o.buy_price,i=o.currency,a=(0,y.getRoundedNumber)(n-r,i),l=a<0?"loss":"win",[o.transaction_ids.buy,+o.buy_price,+o.sell_price,a,o.contract_type,(0,y.formatTime)(parseInt("".concat(o.entry_tick_time,"000")),"HH:mm:ss"),+o.entry_tick,(0,y.formatTime)(parseInt("".concat(o.exit_tick_time,"000")),"HH:mm:ss"),+o.exit_tick,+(o.barrier?o.barrier:0),l])[t];var o,n,r,i,a,l};return{init:function(){var t;return(t=e.tradeEngine).init.apply(t,arguments)},start:function(){var t;return(t=e.tradeEngine).start.apply(t,arguments)},stop:function(){var t;return(t=e.tradeEngine).stop.apply(t,arguments)},purchase:function(t){return e.tradeEngine.purchase(t)},getAskPrice:function(t){return Number(e.getProposal(t).ask_price)},getPayout:function(t){return Number(e.getProposal(t).payout)},getPurchaseReference:function(){return e.tradeEngine.getPurchaseReference()},isSellAvailable:function(){return e.tradeEngine.isSellAtMarketAvailable()},sellAtMarket:function(){return e.tradeEngine.sellAtMarket()},getSellPrice:function(){return e.getSellPrice()},isResult:function(e){return t(10)===e},isTradeAgain:function(e){return p.P.emit("bot.trade_again",e)},readDetails:function(e){return t(e-1)}}}},{key:"sleep",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Promise((function(o){return setTimeout((function(){o(),setTimeout((function(){return e.observer.emit("CONTINUE")}),0)}),1e3*t)}),(function(){}))}},{key:"getProposal",value:function(e){var t=this;return this.tradeEngine.data.proposals.find((function(o){return o.contract_type===e&&o.purchase_reference===t.tradeEngine.getPurchaseReference()}))}},{key:"getSellPrice",value:function(){return this.tradeEngine.getSellPrice()}}]),r}(function(e){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&je(e,t)}(l,e);var t,o,r,i,a=(r=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=He(r);if(i){var o=He(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return Ve(this,e)});function l(){return Ue(this,l),a.apply(this,arguments)}return t=l,(o=[{key:"getToolsInterface",value:function(){return Me(Me(Me(Me({dateTimeStringToTimestamp:function(e){var t=(0,n.localize)("Invalid date/time: {{ datetime_string }}",{datetime_string:e});if("string"!=typeof e)return t;var o,r=e.replace(/[^0-9.:-\s]/g,"").replace(/\s+/g," ").trim().split(" "),i=/^[12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])$/;if(o=r.length>=2?i.test(r[0])&&/^(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])(:([0-5][0-9])?)?$/.test(r[1])?"".concat(r[0],"T").concat(r[1]):null:1===r.length&&i.test(r[0])?r[0]:null){var a=new Date(o);if(a instanceof Date&&!isNaN(a))return a.getTime()/1e3}return t},getTime:function(){return parseInt((new Date).getTime()/1e3)}},this.getCandleInterface()),this.getMiscInterface()),this.getIndicatorsInterface()),{},{highlightBlock:function(e){var t=Blockly.derivWorkspace.getBlockById(e);t&&t.highlightExecutedBlock(t)}})}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ae(Ne(oe(e))))}(function(e){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(a,e);var t,o,n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=V(n);if(r){var o=V(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return j(this,e)});function a(){return F(this,a),i.apply(this,arguments)}return t=a,o=[{key:"getTicksInterface",value:function(){var e=this;return{getLastTick:function(){var t;return(t=e.tradeEngine).getLastTick.apply(t,arguments)},getLastDigit:function(){var t;return(t=e.tradeEngine).getLastDigit.apply(t,arguments)},getTicks:function(){var t;return(t=e.tradeEngine).getTicks.apply(t,arguments)},checkDirection:function(){var t;return(t=e.tradeEngine).checkDirection.apply(t,arguments)},getOhlcFromEnd:function(){var t;return(t=e.tradeEngine).getOhlcFromEnd.apply(t,arguments)},getOhlc:function(){var t;return(t=e.tradeEngine).getOhlc.apply(t,arguments)},getLastDigitList:function(){var t;return(t=e.tradeEngine).getLastDigitList.apply(t,arguments)}}}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(e)}(xo((function e(){Ro(this,e)})))));function Mo(e){return function(e){if(Array.isArray(e))return Uo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Fo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fo(e,t){if(e){if("string"==typeof e)return Uo(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Uo(e,t):void 0}}function Uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}f().prototype.takeStateSnapshot=function(){return(0,y.cloneThorough)(this.stateStack,void 0,void 0,void 0,!0)},f().prototype.restoreStateSnapshot=function(e){this.stateStack=(0,y.cloneThorough)(e,void 0,void 0,void 0,!0),this.global=this.stateStack[0].scope.object||this.stateStack[0].scope,this.initFunc_(this,this.global)};var jo=function(e){return e&&e.tradeEngine.options},Vo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return!c.Jr.includes(t)&&jo(e)&&e.tradeEngine.options.shouldRestartOnError},Ho=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t,o;return t=e,o=[{key:"init",value:function(){var e,t,o,r,i=this;this.$scope=(o=new p.Z,e="wss://".concat((0,y.getSocketURL)(),"/websockets/v3?app_id=").concat((0,y.getAppId)(),"&l=").concat((0,n.getLanguage)(),"&brand=").concat(y.website_name.toLowerCase()),t=new WebSocket(e),{observer:o,api:r=new(L())({connection:t}),ticksService:new N(r)}),this.bot=new Lo(this.$scope),this.stopped=!1,this.$scope.observer.register("REVERT",(function(e){return i.revert("before"===e?i.beforeState:i.duringState)}))}},{key:"run",value:function(e){var t=this,o=function(e,o){var n=t.bot.getInterface("Bot"),r=t.bot.getTicksInterface(),i=t.bot.getInterface(),a=i.alert,l=i.prompt,c=i.sleep,s=i.console;e.setProperty(o,"console",e.nativeToPseudo(s)),e.setProperty(o,"alert",e.nativeToPseudo(a)),e.setProperty(o,"prompt",e.nativeToPseudo(l)),e.setProperty(o,"getPurchaseReference",e.nativeToPseudo(n.getPurchaseReference));var u=e.nativeToPseudo(n);Object.entries(r).forEach((function(o){var n,r=(2,function(e){if(Array.isArray(e))return e}(n=o)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(n)||Fo(n,2)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],a=r[1];return e.setProperty(u,i,t.createAsync(e,a))})),e.setProperty(u,"start",e.nativeToPseudo((function(){var o=n.start;Vo(t.bot)&&(t.startState=e.takeStateSnapshot()),o.apply(void 0,arguments)}))),e.setProperty(u,"purchase",t.createAsync(e,n.purchase)),e.setProperty(u,"sellAtMarket",t.createAsync(e,n.sellAtMarket)),e.setProperty(o,"Bot",u),e.setProperty(o,"watch",t.createAsync(e,(function(e){var o,n=t.bot.getInterface().watch;if(o=t.bot,jo(o)&&o.tradeEngine.options.timeMachineEnabled){var r=t.interpreter.takeStateSnapshot();"before"===e?t.beforeState=r:t.duringState=r}return n(e)}))),e.setProperty(o,"sleep",t.createAsync(e,c))};return new Promise((function(n,r){t.$scope.observer.register("Error",(function e(o){var n;if(!t.stopped)if("InvalidToken"!==o.code){if(function(e){return!(!["SellNotAvailableCustom","ContractCreationFailure"].includes(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")||!jo(e))}(t.bot,null==o?void 0:o.code))return p.P.emit("ui.log.error",o.message),void p.P.emit("bot.click_stop");if(t.is_error_triggered=!0,Vo(t.bot,o.code)&&(i=t.bot,jo(i)&&i.tradeEngine.tradeOptions)){var i;p.P.emit("Error",o);var a=t.bot.tradeEngine,l=a.initArgs,c=a.tradeOptions;t.terminateSession(),t.init(),t.$scope.observer.register("Error",e),(n=t.bot.tradeEngine).init.apply(n,Mo(l)),t.bot.tradeEngine.start(c),t.revert(t.startState)}else r(o)}else p.P.emit("client.invalid_token")})),t.interpreter=new(f())(e,o),t.onFinish=n,t.loop()}))}},{key:"loop",value:function(){!this.stopped&&this.interpreter.run()||this.onFinish(this.interpreter.pseudoToNative(this.interpreter.value))}},{key:"revert",value:function(e){this.interpreter.restoreStateSnapshot(e),this.interpreter.paused_=!1,this.loop()}},{key:"terminateSession",value:function(){var e=this.$scope.api.connection;0===e.readyState?e.addEventListener("open",(function(){return e.close()})):1===e.readyState&&e.close(),this.stopped=!0,this.is_error_triggered=!1,p.P.emit("bot.stop")}},{key:"stop",value:function(){var e,t=this,o=null!==(e=p.P.getState("global_timeouts"))&&void 0!==e?e:[],n=Object.keys(o).every((function(e){return o[e].is_cancellable}));!this.bot.tradeEngine.contractId&&n?(o.forEach((function(e){return clearTimeout(o[e])})),this.terminateSession()):!1!==this.bot.tradeEngine.isSold||this.is_error_triggered?this.terminateSession():p.P.register("contract.status",(function(e){"contract.sold"===e.id&&t.terminateSession()}))}},{key:"createAsync",value:function(e,t){var o=this,n=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=r.pop(),l=r.slice().reverse(),c=l.findIndex((function(e){return void 0!==e})),s=c<0?[]:l.slice(c).reverse();t.apply(void 0,Mo(s.map((function(t){return e.pseudoToNative(t)})))).then((function(t){a(e.nativeToPseudo(t)),o.loop()})).catch((function(e){o.$scope.observer.emit("Error",e.error||e)}))};return Object.defineProperty(n,"length",{value:101}),e.createAsyncFunction(n)}},{key:"hasStarted",value:function(){return!this.stopped}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Jo(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function Go(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){Jo(i,n,r,a,l,"next",e)}function l(e){Jo(i,n,r,a,l,"throw",e)}a(void 0)}))}}function Wo(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}const Yo=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.interpreter=null,this.workspace=null,this.before_run_funcs=[]}var t,c,y,m;return t=e,c=[{key:"initWorkspace",value:(m=Go(regeneratorRuntime.mark((function t(n,c,p,y){var m,f=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,u.WN)();case 2:return m=t.sent,t.abrupt("return",new Promise((function(t,_){o.p=n,d.Z.setInstance(p),a.Z.setInstance(c);var h=window.innerWidth;try{var g,b=.8,v=a.Z.instance.handleFileChange;h<1640&&(b=y?.7:(null===(g=document.getElementById("scratch_div"))||void 0===g?void 0:g.offsetWidth)/h/1.5);var k=document.getElementById("scratch_div");if(!k)return;f.workspace=Blockly.inject(k,{grid:{spacing:40,length:11,colour:"#f3f3f3"},media:"".concat(o.p,"media/"),trashcan:!y,zoom:{wheel:!0,startScale:b},scrollbars:!0}),f.workspace.cached_xml={main:i},f.workspace.save_workspace_interval=setInterval(Go(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.l5)(Blockly.Xml.workspaceToDom(f.workspace),s.R.UNSAVED);case 2:case"end":return e.stop()}}),e)}))),1e4),f.workspace.addChangeListener(f.valueInputLimitationsListener.bind(f)),f.workspace.addChangeListener((function(e){return(0,r.P_)(f.workspace,e)})),f.workspace.addChangeListener((function(e){return f.workspace.dispatchBlockEventEffects(e)})),Blockly.derivWorkspace=f.workspace,f.addBeforeRunFunction(f.unselectBlocks.bind(f)),f.addBeforeRunFunction(f.disableStrayBlocks.bind(f)),f.addBeforeRunFunction(f.checkForErroredBlocks.bind(f)),f.addBeforeRunFunction(f.checkForRequiredBlocks.bind(f)),f.workspace.current_strategy_id=Blockly.utils.genUid(),Blockly.derivWorkspace.strategy_to_load=i;var E=l.v.default_file_name;if(m&&m.length){var T=m[0];Blockly.derivWorkspace.strategy_to_load=T.xml,E=T.name,Blockly.derivWorkspace.current_strategy_id=T.id}var B="dbot-load".concat(Date.now());Blockly.Events.setGroup(B),Blockly.Xml.domToWorkspace(Blockly.Xml.textToDom(Blockly.derivWorkspace.strategy_to_load),f.workspace),a.Z.instance.save_modal.updateBotName(E),f.workspace.cleanUp(),f.workspace.clearUndo(),window.dispatchEvent(new Event("resize")),window.addEventListener("dragover",e.handleDragOver),window.addEventListener("drop",(function(t){return e.handleDropOver(t,v)})),k.parentNode.style.overflow="hidden",t()}catch(e){throw _(e),e}})));case 4:case"end":return t.stop()}}),t)}))),function(e,t,o,n){return m.apply(this,arguments)})},{key:"addBeforeRunFunction",value:function(e){this.before_run_funcs.push(e)}},{key:"shouldRunBot",value:function(){return this.before_run_funcs.every((function(e){return!!e()}))}},{key:"runBot",value:function(){var e=this;try{var t=this.generateCode();null!==this.interpreter&&(this.interpreter=null),this.interpreter=new Ho,this.interpreter.run(t).catch((function(t){p.P.emit("Error",t),e.stopBot()}))}catch(e){p.P.emit("Error",e),this.interpreter&&this.stopBot()}}},{key:"generateCode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"\n            var BinaryBotPrivateInit;\n            var BinaryBotPrivateStart;\n            var BinaryBotPrivateBeforePurchase; \n            var BinaryBotPrivateDuringPurchase;\n            var BinaryBotPrivateAfterPurchase;\n            var BinaryBotPrivateLastTickTime;\n            var BinaryBotPrivateTickAnalysisList = [];\n            var BinaryBotPrivateHasCalledTradeOptions = false;\n            function BinaryBotPrivateRun(f, arg) {\n                if (f) return f(arg);\n                return false;\n            }\n            function BinaryBotPrivateTickAnalysis() {\n                var currentTickTime = Bot.getLastTick(true);\n                while (currentTickTime === 'MarketIsClosed') {\n                    sleep(5);\n                    currentTickTime = Bot.getLastTick(true);\n                }\n                currentTickTime = currentTickTime.epoch;\n                if (currentTickTime === BinaryBotPrivateLastTickTime) {\n                    return;\n                }\n                BinaryBotPrivateLastTickTime = currentTickTime;\n                for (var BinaryBotPrivateI = 0; BinaryBotPrivateI < BinaryBotPrivateTickAnalysisList.length; BinaryBotPrivateI++) {\n                    BinaryBotPrivateRun(BinaryBotPrivateTickAnalysisList[BinaryBotPrivateI]);\n                }\n            }\n            var BinaryBotPrivateLimitations = ".concat(JSON.stringify(e),";\n            ").concat(Blockly.JavaScript.workspaceToCode(this.workspace),"\n            BinaryBotPrivateRun(BinaryBotPrivateInit);\n            while (true) {\n                BinaryBotPrivateTickAnalysis();\n                BinaryBotPrivateRun(BinaryBotPrivateStart);\n                if (!BinaryBotPrivateHasCalledTradeOptions) {\n                    sleep(1);\n                    continue;\n                }\n                while (watch('before')) {\n                    BinaryBotPrivateTickAnalysis();\n                    BinaryBotPrivateRun(BinaryBotPrivateBeforePurchase);\n                }\n                while (watch('during')) {\n                    BinaryBotPrivateTickAnalysis();\n                    BinaryBotPrivateRun(BinaryBotPrivateDuringPurchase);\n                }\n                BinaryBotPrivateTickAnalysis();\n                if (!BinaryBotPrivateRun(BinaryBotPrivateAfterPurchase)) {\n                    break;\n                }\n            }")}},{key:"stopBot",value:function(){this.interpreter&&this.interpreter.stop()}},{key:"terminateBot",value:function(){this.interpreter&&(this.interpreter.terminateSession(),this.interpreter=null)}},{key:"unselectBlocks",value:function(){return Blockly.selected&&Blockly.selected.unselect(),!0}},{key:"disableStrayBlocks",value:function(){var e=this;return this.workspace.getTopBlocks().forEach((function(t){t.isMainBlock()||t.isIndependentBlock()||e.disableBlocksRecursively(t)})),!0}},{key:"disableBlocksRecursively",value:function(e){var t;e.setDisabled(!0),null!==(t=e.nextConnection)&&void 0!==t&&t.targetConnection&&this.disableBlocksRecursively(e.nextConnection.targetConnection.sourceBlock_)}},{key:"checkForErroredBlocks",value:function(){this.valueInputLimitationsListener({},!0);var e=this.workspace.getAllBlocks(!0).filter((function(e){return e.is_error_highlighted&&!e.disabled})).filter((function(e,t,o){return t===o.findIndex((function(t){return t.error_message===e.error_message}))}));return!e.length||(this.workspace.centerOnBlock(e[0].id),e.forEach((function(e){p.P.emit("ui.log.error",e.error_message)})),!1)}},{key:"centerAndHighlightBlock",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.workspace.getBlockById(e);if(o){var n=this.workspace.getAllBlocks();n.forEach((function(e){return e.setErrorHighlighted(!1)})),t&&o.blink(),o.setErrorHighlighted(!0),this.workspace.centerOnBlock(o.id)}}},{key:"unHighlightAllBlocks",value:function(){var e;null===(e=this.workspace)||void 0===e||e.getAllBlocks().forEach((function(e){return e.setErrorHighlighted(!1)}))}},{key:"checkForRequiredBlocks",value:function(){var e;return(0,r.tp)(this.workspace)?(0,r.nf)(this.workspace)||(e=new Error((0,n.localize)("One or more mandatory blocks are disabled in your workspace. Please enable the required block(s) and then try again."))):e=new Error((0,n.localize)("One or more mandatory blocks are missing from your workspace. Please add the required block(s) and then try again.")),!e||(p.P.emit("Error",e),!1)}},{key:"valueInputLimitationsListener",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t||this.workspace&&!this.workspace.isDragging()){Blockly.JavaScript.init(this.workspace),t&&Blockly.hideChaff(!1);var o=function(){return e.type===Blockly.Events.END_DRAG},n=function(){return e.type===Blockly.Events.BLOCK_DELETE},r=function(){return e.type===Blockly.Events.BLOCK_CREATE},i=function(){return e.type===Blockly.Events.UI&&("click"===e.element||"selected"===e.element)},a=function(t){return e.type===Blockly.Events.BLOCK_CHANGE&&e.blockId===t.id},l=function(t){return e.type===Blockly.Events.BLOCK_CHANGE&&t.inputList.some((function(t){if(t.connection){var o=t.connection.targetBlock();return o&&e.blockId===o.id}return!1}))},c=function(t){if(e.type===Blockly.Events.BLOCK_CHANGE&&"disabled"===e.element)for(var o=t.getParent();null!==o;){if(o.id===e.blockId)return!0;o=o.getParent()}return!1};this.workspace.getAllBlocks(!0).forEach((function(e){if(t||o()||n()||r()||i()||a(e)||l(e)||c(e)){if(e.disabled)return void function e(t){t.forEach((function(t){t.setErrorHighlighted(!1),e(t.getChildren())}))}([e]);if(!e.getRequiredValueInputs)return;var s=e.getRequiredValueInputs(),u=Object.keys(s).some((function(t){var o=Blockly.selected===e,n=e.disabled||e.getInheritedDisabled();if(o||n)return!1;if(e.isCollapsed()&&e.hasErrorHighlightedDescendant())return!0;var r=e.getInput(t);if(r||e.domToMutation){if(r.connection){var i=Blockly.JavaScript.ORDER_ATOMIC,a=Blockly.JavaScript.valueToCode(e,t,i),l=s[t];return"function"==typeof l?!!l(a):!a}}else console.warn("Detected a non-existent required input.",{input_name:t,type:e.type});return!0}));if(u&&e.removeSelect(),e.setErrorHighlighted(u,e.error_message||void 0),t&&(e.is_error_highlighted||e.hasErrorHighlightedDescendant()))for(var p=e;p;)p.setCollapsed(!1),p=p.getParent()}}))}}},{key:"getStrategySounds",value:function(){var e=this.workspace.getAllBlocks().filter((function(e){return"notify"===e.type})),t=[];return e.forEach((function(e){var o=e.inputList[0].fieldRow[3].value_;"silent"!==o&&t.push(o)})),t}}],y=[{key:"handleDragOver",value:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}},{key:"handleDropOver",value:function(e,t){var o=document.getElementById("scratch_div"),n=document.getElementById("load-strategy__local-dropzone-area");o.contains(e.target)?t(e):n&&n.contains(e.target)?t(e,!1):(e.stopPropagation(),e.preventDefault(),e.dataTransfer.effectAllowed="none",e.dataTransfer.dropEffect="none")}}],c&&Wo(t.prototype,c),y&&Wo(t,y),Object.defineProperty(t,"prototype",{writable:!1}),e}());var qo=o(5401),Ko=o(1408);var Xo,Zo,Qo,$o=function(){function e(t,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=t,this.parentElement=o,this.addEvents()}var t,o;return t=e,(o=[{key:"addEvents",value:function(){var e=this;"onLine"in navigator?(window.addEventListener("online",(function(){return e.setStatus()})),window.addEventListener("offline",(function(){return e.setStatus()}))):(navigator.onLine=!0,setInterval((function(){return e.setStatus()}),1e4)),this.setStatus()}},{key:"setStatus",value:function(){var e=this;navigator.onLine?(this.parentElement.html("<span class='connecting'></span>"),this.api.send({ping:"1"}).then((function(){e.parentElement.html("<span class='online'></span>")}))):this.parentElement.html("<span class='offline'></span>")}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),en=o(6715);const tn=(Zo=!1,Qo=new en.Z,{init:function(e){Zo||(Xo=e,Qo.resolve(Xo.server_time),Zo=!0)},get:function(){return Zo&&Xo.server_time?Xo.server_time.clone():void 0},timePromise:function(){return Zo?Promise.resolve(Xo.server_time):Qo.promise}});var on=o(4227),nn=function(e){var t=l.v.opposites,o=(0,n.localize)("Unknown");return Object.keys(t).forEach((function(n){t[n].forEach((function(t){var r=Object.entries(t)[0];if(r[0]===e.contract_type){if(["CALL","PUT"].includes(r[0])){var i=e.shortcode.split("_").slice(-2)[0],a=/^S0P$/.test(i);if(n!==(a?"CALLPUT":"HIGHERLOWER"))return}o=r[1]}}))})),o},rn=function(e){return new Promise((function(t,o){var n=document.createElement("script");n.src=e,n.async=!0,n.onload=function(){return t(window.external_global_component)},n.onerror=o,document.body.appendChild(n)}))},an=o(2620),ln=function(e){var t=new Date,o=(t.getTime()-e)/1e3;if(o<60)return(0,n.localize)("{{secondPast}}s ago",{secondPast:parseInt(o)});if(o<3600)return(0,n.localize)("{{minutePast}}m ago",{minutePast:parseInt(o/60)});if(o<=86400)return(0,n.localize)("{{hourPast}}h ago",{hourPast:parseInt(o/3600)});var r=new Date(e),i=r.getDate(),a=r.toDateString().match(/ [a-zA-Z]*/)[0].replace(" ",""),l="".concat(r.getFullYear()===t.getFullYear()?"":" ").concat(r.getFullYear());return"".concat(i," ").concat(a).concat(l)}},9789:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});var n=o(2273),r=["BTC","ETH","LTC","BCH","UST"],i={lists:{PAYOUTTYPE:[[(0,n.localize)("Stake"),"stake"]],CRYPTO_CURRENCIES:r,DETAILS:[[(0,n.localize)("deal reference id"),"1"],[(0,n.localize)("purchase price"),"2"],[(0,n.localize)("payout"),"3"],[(0,n.localize)("profit"),"4"],[(0,n.localize)("contract type"),"5"],[(0,n.localize)("entry spot time"),"6"],[(0,n.localize)("entry spot price"),"7"],[(0,n.localize)("exit spot time"),"8"],[(0,n.localize)("exit spot price"),"9"],[(0,n.localize)("barrier"),"10"],[(0,n.localize)("result"),"11"]],CHECK_RESULT:[[(0,n.localize)("Win"),"win"],[(0,n.localize)("Loss"),"loss"]],CHECK_DIRECTION:[[(0,n.localize)("Rise"),"rise"],[(0,n.localize)("Fall"),"fall"],[(0,n.localize)("No Change"),""]],BALANCE_TYPE:[[(0,n.localize)("string"),"STR"],[(0,n.localize)("number"),"NUM"]],NOTIFICATION_TYPE:[[(0,n.localize)("green"),"success"],[(0,n.localize)("blue"),"info"],[(0,n.localize)("yellow"),"warn"],[(0,n.localize)("red"),"error"]],NOTIFICATION_SOUND:[[(0,n.localize)("Silent"),"silent"],[(0,n.localize)("Announcement"),"announcement"],[(0,n.localize)("Earned money"),"earned-money"],[(0,n.localize)("Job done"),"job-done"],[(0,n.localize)("Error"),"error"],[(0,n.localize)("Severe error"),"severe-error"]],CURRENCY:["USD","EUR","GBP","AUD"].concat(r)},opposites:{MULTIPLIER:[{MULTUP:(0,n.localize)("Up")},{MULTDOWN:(0,n.localize)("Down")}],CALLPUT:[{CALL:(0,n.localize)("Rise")},{PUT:(0,n.localize)("Fall")}],CALLPUTEQUAL:[{CALLE:(0,n.localize)("Rise Equals")},{PUTE:(0,n.localize)("Fall Equals")}],HIGHERLOWER:[{CALL:(0,n.localize)("Higher")},{PUT:(0,n.localize)("Lower")}],TOUCHNOTOUCH:[{ONETOUCH:(0,n.localize)("Touch")},{NOTOUCH:(0,n.localize)("No Touch")}],ENDSINOUT:[{EXPIRYRANGE:(0,n.localize)("Ends Between")},{EXPIRYMISS:(0,n.localize)("Ends Outside")}],STAYSINOUT:[{RANGE:(0,n.localize)("Stays Between")},{UPORDOWN:(0,n.localize)("Goes Outside")}],ASIANS:[{ASIANU:(0,n.localize)("Asian Up")},{ASIAND:(0,n.localize)("Asian Down")}],MATCHESDIFFERS:[{DIGITMATCH:(0,n.localize)("Matches")},{DIGITDIFF:(0,n.localize)("Differs")}],EVENODD:[{DIGITEVEN:(0,n.localize)("Even")},{DIGITODD:(0,n.localize)("Odd")}],OVERUNDER:[{DIGITOVER:(0,n.localize)("Over")},{DIGITUNDER:(0,n.localize)("Under")}],HIGHLOWTICKS:[{TICKHIGH:(0,n.localize)("High Tick")},{TICKLOW:(0,n.localize)("Low Tick")}],RESET:[{RESETCALL:(0,n.localize)("Reset Call")},{RESETPUT:(0,n.localize)("Reset Put")}],RUNS:[{RUNHIGH:(0,n.localize)("Only Ups")},{RUNLOW:(0,n.localize)("Only Downs")}],CALLPUTSPREAD:[{CALLSPREAD:(0,n.localize)("Call Spread")},{PUTSPREAD:(0,n.localize)("Put Spread")}]},BARRIER_TYPES:[["Offset +","+"],["Offset -","-"]],ohlcFields:[[(0,n.localize)("Open"),"open"],[(0,n.localize)("High"),"high"],[(0,n.localize)("Low"),"low"],[(0,n.localize)("Close"),"close"],[(0,n.localize)("Open Time"),"epoch"]],candleIntervals:[[(0,n.localize)("Default"),"default"],[(0,n.localize)("1 minute"),"60"],[(0,n.localize)("2 minutes"),"120"],[(0,n.localize)("3 minutes"),"180"],[(0,n.localize)("5 minutes"),"300"],[(0,n.localize)("10 minutes"),"600"],[(0,n.localize)("15 minutes"),"900"],[(0,n.localize)("30 minutes"),"1800"],[(0,n.localize)("1 hour"),"3600"],[(0,n.localize)("2 hours"),"7200"],[(0,n.localize)("4 hours"),"14400"],[(0,n.localize)("8 hours"),"28800"],[(0,n.localize)("1 day"),"86400"]],mainBlocks:["trade_definition","before_purchase","during_purchase","after_purchase"],mandatoryMainBlocks:["trade_definition","purchase","before_purchase"],procedureDefinitionBlocks:["procedures_defnoreturn","procedures_defreturn"],single_instance_blocks:["trade_definition","before_purchase","during_purchase","after_purchase"],TRADE_TYPE_TO_CONTRACT_CATEGORY_MAPPING:{callput:["callput","higherlower"],asian:["asians"],digits:["matchesdiffers","evenodd","overunder"]},TRADE_TYPE_CATEGORIES:{multiplier:["multiplier"],callput:["callput","callputequal","higherlower"],touchnotouch:["touchnotouch"],inout:["endsinout","staysinout"],asian:["asians"],digits:["matchesdiffers","evenodd","overunder"],reset:["reset"],callputspread:["callputspread"],highlowticks:["highlowticks"],runs:["runs"]},TRADE_TYPE_CATEGORY_NAMES:{callput:(0,n.localize)("Up/Down"),touchnotouch:(0,n.localize)("Touch/No Touch"),inout:(0,n.localize)("In/Out"),asian:(0,n.localize)("Asians"),digits:(0,n.localize)("Digits"),reset:(0,n.localize)("Reset Call/Reset Put"),callputspread:(0,n.localize)("Call Spread/Put Spread"),highlowticks:(0,n.localize)("High/Low Ticks"),runs:(0,n.localize)("Only Ups/Only Downs"),multiplier:(0,n.localize)("Multipliers")},BARRIER_CATEGORIES:{euro_atm:["callput","callputequal"],euro_non_atm:["endsinout","higherlower","callputspread"],american:["staysinout","touchnotouch","highlowticks","runs","multiplier"],non_financial:["digits","overunder","evenodd","matchesdiffers"],asian:["asians"],reset:["reset"],lookback:["lookback"]},DEFAULT_DURATION_DROPDOWN_OPTIONS:[[(0,n.localize)("Ticks"),"t"],[(0,n.localize)("Seconds"),"s"],[(0,n.localize)("Minutes"),"m"],[(0,n.localize)("Hours"),"h"],[(0,n.localize)("Days"),"d"]],BARRIER_LABELS:[(0,n.localize)("High barrier"),(0,n.localize)("Low barrier")],ABSOLUTE_BARRIER_DROPDOWN_OPTION:[[(0,n.localize)("Absolute"),"absolute"]],NOT_AVAILABLE_DROPDOWN_OPTIONS:[[(0,n.localize)("Not available"),"na"]],NOT_AVAILABLE_DURATIONS:[{display:(0,n.localize)("Not available"),unit:"na",min:0}],BARRIER_TRADE_TYPES:["higherlower","touchnotouch","endsinout","staysinout","callputspread"],PREDICTION_TRADE_TYPES:["matchesdiffers","overunder","highlowticks"],DIGIT_CATEGORIES:["digits","highlowticks"],INDEPEDENT_BLOCKS:["block_holder","tick_analysis","loader","procedures_defreturn","procedures_defnoreturn"],bbResult:[[(0,n.localize)("upper"),"1"],[(0,n.localize)("middle"),"0"],[(0,n.localize)("lower"),"2"]],macdFields:[[(0,n.localize)("Histogram"),"0"],[(0,n.localize)("MACD"),"1"],[(0,n.localize)("Signal"),"2"]],gd:{cid:"828416594271-b4bhia944ecegn3j327oeb4l8o803bts.apps.googleusercontent.com",aid:"derivbot-248506",api:"AIzaSyA52MX2l8p75-w7nvab7fU6Lk6KwLqnyEI"},workspaces:{flyoutWorkspacesStartScale:.7,mainWorkspaceStartScale:.9,previewWorkspaceStartScale:.6},strategies:{martingale:{index:0,label:(0,n.localize)("Martingale"),description:(0,n.localize)("The Martingale Strategy is a classic trading technique that has been used for more than a hundred years, popularised by the French mathematician Paul Pierre Levy in the 18th century.")},dalembert:{index:1,label:(0,n.localize)("D'Alembert"),description:(0,n.localize)("The concept of the D’Alembert Strategy is said to be similar to the Martingale Strategy where you will increase your contract size after a loss. With the D’Alembert Strategy, you will also decrease your contract size after a successful trade.")},oscars_grind:{index:2,label:(0,n.localize)("Oscar's Grind"),description:(0,n.localize)("The Oscar's Grind Strategy is a low-risk positive progression strategy that first appeared in 1965. By using this strategy, the size of your contract will increase after successful trades, but remains unchanged after unsuccessful trades.")}},default_file_name:(0,n.localize)("Untitled Bot")}},7103:(e,t,o)=>{"use strict";o.d(t,{Jr:()=>n,LF:()=>r,Di:()=>i,F$:()=>a});var n=["InsufficientBalance","CustomLimitsReached","OfferingsValidationError","InvalidCurrency","ContractBuyValidationError","NotDefaultCurrency","PleaseAuthenticate","FinancialAssessmentRequired","PositiveIntegerExpected","OptionError","IncorrectPayoutDecimals","IncorrectStakeDecimals","NoMFProfessionalClient","AuthorizationRequired","InvalidToken","DailyLossLimitExceeded","InputValidationFailed"],r=Object.freeze({ERROR:"error",NOTIFY:"notify",SUCCESS:"success"}),i=Object.freeze({RECOVERABLE_ERRORS:"recoverable_errors",UNRECOVERABLE_ERRORS:"unrecoverable_errors"}),a=Object.freeze({LOAD_BLOCK:"load_block",PURCHASE:"purchase",SELL:"sell",NOT_OFFERED:"not_offered",PROFIT:"profit",LOST:"lost",WELCOME_BACK:"welcome_back"})},7929:(e,t,o)=>{"use strict";o.d(t,{R:()=>n});var n=Object.freeze({UNSAVED:"unsaved",LOCAL:"local",GOOGLE_DRIVE:"google drive"})},5730:(e,t,o)=>{var n=o(1723),r=n.goog,i=n.Blockly;i.JavaScript=o(9697),window.goog=r,window.Blockly=i,o(4294),o(7215),o(4730)},3751:(e,t,o)=>{"use strict";o.d(t,{N$:()=>n,xY:()=>r,e_:()=>i,dp:()=>a,DV:()=>l,M8:()=>c,dK:()=>s,fK:()=>u});var n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAAGXcA1uAAAAAXNSR0IArs4c6QAAAK9JREFUSA3tVUkOgCAMROP/f4PfU4iOaWQKLYmBg71AOksXTAyhGkeKKuECjTSDUwcFxVdNawNgQ10omJNKROqiJbMJsKJZgKgEouuESRYVFVxO35JTnxGDvk9aWQ5GCXfSPbRbsLHysr0lBeMESaKE3hkmbKk230SY9Ulky5rG/SVJU8udPrMU5s7w9bEugUlN886MWiJN86/o2dywFQ17g10b+dlJefH9X0t9X+YETM6gfmoeI+MAAAAASUVORK5CYII=",r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAWBJREFUOI2dk81KQmEQhp/5zgHRjhtz0apMXBUSdAcVLWrnxhswsHARSLcRhYm00CvIRbugrCtIaJHtIqlFQUsPBeY50yINM7WfZzV8M+/MOzCfMED8wE2q0Q0VVgSJASjaNEJNoHy7Fb7ur5dekChooGO7ewJZwAw27uIBh6Gok2+kpf3ZIFHQgG+7JwpLI4RfULiYiDprjbS0DYBvu/u/FXenLr88u7sAEj9wk2rp1TDb1VQQXyF9/Dp0HctnwajRjWFiAF9BRxuxOpZmJF5qNRTmfmt/gGujMD0qW00FOUoFxzWYsRnjcnHK+smBGoGHn6rGcG8Qzv6v11MjUObjwr5Rf/K4fByaAvA8IxUBmC21ikDub8Mp3OXC2wYgFHXyCOd/kNcitrMD3QNqpKUdmnTWUYqMWKdnG6UQsZz1elbeoO839kgUW/MdSzOisgrEus9N0FPPSOV+M3zTX/8O8E9xAaZDaSsAAAAASUVORK5CYII=",i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAAEgBckRAAAAAXNSR0IArs4c6QAAAvlJREFUaAXtmU1u00AUxxPEGoluKMcgJ8gCARsW9CZ0ReEU5BwFiYpWqtgYiQuQFSygJ2CRLV2E39+ZZ42dGc84XxIwT3p9X//34VfbsZPRaGNaQkpGPNu4yGESGfHUOtnYte0b6G8NdABJu7NoG4KXmi1GwUTACwtYomzp5r9ripP3/KB8zj7q4P4t0z9o9PfJowM0NhD6D9NN+sFm1xb05Rjybe171nKkDBLqfw6yt1Oqjjo3F4XArbli1dfmT7YpgOQGWPanLgjfFXyn6x9sU+QMfhdKxL/1OfSAGreh4vIR643H8pQ4hydRQCAAPv9owJ7AF1YH/bKr+z7FsPMbdBP8ZNNNOuwE+6v0bPILpJLAXsAvUrgSLxsoG4hsgAtoDDe3CoPhW7uFW8yXOffzcxK++ElOfxzwDXcxafAmhvscfjO8opdBgSfwjedqVPxaXbB5A0op5P+GH8ZwqXgwj6RtaO1kiDYJBiJOJop+HuScRZGyLfcUq2p5nJHVgAnrQzepXF/HnMIVnEckt84Os02qSkdfYN/Pq75KnpPQPFVYMZOBBq2B/EaxFVWApga0x2WT8vu64UIyq0EoMdfXeuC3JFZxhP7L7ByZe0Q5tQqmbKBsoGygbOCv2wAfHU/1SQp9Sw0P5nuNJCeFPUicYY7hW8fHqaYOr4dR5UQfSFN1dhJnAD1a/4RF2RsFq8d10Q0ce+LYyYy9RWiulw/R615gIEiOvuASpb/IDeRv7aLxq7r9FgOQbwvY7g2s72ho0vurgjuIfYmPfbMNijGhvsoSnQxKHABW7brDcvkhN23IBVS5otPc4hvgrHa1QW5/CpvR26loHkKuQuuvc/L7+BDO4sT0tiZ6ZL6dSgrr/VGkd54WrdzpYUM4FVJNF1u0CieM7g90CfjoM4Dn8BTu3v6u8LW2jZ3rA1rXlKz0Zy/Ehk7dlma7bkDdmav9cte1m3o0mLgmweugAW6gUHfuau/n/LeZaHLtGu1DXFufIssGygb+kw38ARimnBqQbBHiAAAAAElFTkSuQmCC",a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAAEgBckRAAAAAXNSR0IArs4c6QAAA45JREFUaAXtWDFrFUEQzoU0QhpjFVRs/Cc2Sf6AxD4BQSF/QBFtbPwDYici2ImFIqaVlBEEK7FICBaxCFEQRM/v29vZzO7O3dv3uGCEXdg3M998M7O7d7e37+bmZmpt2y4xEPLITABHazpOC0wLwt5wtVKHDGBeFJEg7og+okTaVY5hUgslSQwGFJhb2tZ6mARI3XQ77x/YbzQR9mlMTpc4u3rDoWEFomXtGe5+0zSXg28oCL69IT8r/kwJYocLF0p1yi2ITwl2YiL6+MTq5iQZiUNvtO24GaAywLc+5FfUqp7tFdCXUeulo0bMMfoy+WY8QdUcMU0O/xfPuZ/6fOJtyZH56chABcC94oMXFWyqOlffs2YFXge4hi3gu05gEU3Mj24ZklvDtkUCfgHdfMiBu+cXMnos3QbGZHDsQVyyEs+CYaYh9yzxNaauQF2BWVaATzL6WG01GwMzE4TgfhSdGzKyAUi8z5HvzEKA5Ez08TOkA34jGInCeDT5H2EX6Di9O+k17+d2nW1kwDjz0JL6Pa85xfKRS5BP0T8oV6aSWwYqFoPQHiqoVyUxc5pgwgLnM3loFxNXZJIQATRMULHgf+5596AfKlemmrkIou2gZxfQJ6b/Lfov9CdZVgDAN9B5fLFnANy9TyH7ijyD72pPch5ZeIu7uynjwOGqQrDI1H+zJJ6Jtb6gK2mH1jVnSFcx+0O86qsrUFegrkBdgboC/9MKZK91vPBG/ac88mLEnxmt5Hxjs2kfTDnHTH3M0HlKdNTioYxtXfM7KB6X9gddiJA8OHHgPESx8UCVXbEQaCjg30bnMf+c4TYh1kCX702szTFwLK6ZQRoUIiSPllwNHjOLBw7uFfQf6GxH6LtO635u6lpDOuicCGtzDO6YCxndGWY8SWymswBE6F2XoG0PIN3EIVfQ36G/KkhhUhDrmunUYDFRByU6cvBsL+0Qyh30iV8QkzSRKcki0DKKiVZwgiHXPDrv4W8+74uEUmz6+Ml3RjGxpzTiP/ocL4UC+5HHvgo2rfTx5ROQAC+5K5hfsNOBgLeAzgH/RtftNYzzKd+yweOuIzuRzlE+AUmMaH6QkK3U/Owi3FQi7gH6+xQfssHnzsPGmu5zDfkOwc9QrPNZRGCyD0/9YWpiwYSAWrJlRlfcGhdDo//dPtca5GMGeFuLxR5cc8bSuQ3rXPwvv6mBqtcVqCtQV+Dfr8BfZ6VurZP8obgAAAAASUVORK5CYII=",l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAAEgBckRAAAAAXNSR0IArs4c6QAAAa5JREFUaAXtV1tywzAIdDq5Rg/Ui/SGzYl8j1brzqYYidHDYWw60g/iIWABKc6yGOsG+XdaSr/uFLe0dkZkNC25Wt6U7zq7C05zJMH9FofBd0IymZIKR4qYWAyh95LfbCgAxYLwd/e3h+yJm0YQWiurk2V4cXkzaALO5owKAJV7E7gsr9zzQBaBiirVXaV3KYeTbtDVyNOgUIFU9q+CeFj0bBs9sL/k5fhJnSXHOakbnzxmUKH3kl5m0JK1ZQ/fxQBHncqk3Uskg217mX2mHBC4I3APMAB6HglfgXQPXvqaZgXBRTu4PqTT+M+1+00uPtfW+94rRy/cEbgHKJYIY8pRGykLz/7jEkmIslwt8mSzSrtsbznMDBsF7lM0A1Q74V6iagbTYFZgVsC7Ani7sbzjjPrPPhu1o4skv6YPj3edG/jDAOQXjQxgAe+1p0/rXPhfgvAAih+9bJukVgtfNSq9/plb+A6EB9A8QmePCkdG0/AdCA+geYR068hbo0W9pr326Tz+p35qP+SbAVjPHB2dRcOP0ARw1ugwbvgOtFziR0J72T807MSkswKDFfgBlTxsE+QpCHoAAAAASUVORK5CYII=",c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAAC+0lEQVR4Ae2bA4xeURCFp7bdoGvjv3OC2m1Q24xW0cZJ3caqzdhJ3Vi1bdu2po1T3v95Nvu+E/N+z5hDMf4RExMTE4N0HmkqsZS34RAu4iG+8kd+hEs4xNuw1FTySKSTRvIbYyLW4xbEHr7JG8z47CakBVOMlXgHcRZ+w6tRSNGCOmY874e4D+83E1CHoqCwBWbzI4gPuY85hS0oVGrwDDyD+JgnZibVoHDgXByCBJBDnBvG8kfiPSSgvOfBFCg1sRASbHhRYIdSSn3eDgk+vD2lPvlPfks+AgknfCS/pd8XzTRchYSYq4Vp5B/ogNuQkHPbdPTv4LkMiSCXclr5curiOCSinMivS17hZZAIs5S8YfpDIs5Ack9OKzyJWoAfozW5BVsgCrKF3GG6QHQk0ZVcUBsXIe5Dv+FJ4aKLlx6UQtQICEodb3++qUmAb1BtcgJPh2gSgGAaOQEX1QlcouQxPSHqBMT0dH791yDg/H5Q1Ig/qhT4UNSIksGMgqgUEDPK+fOnKgFeRsmAM1oFcCap9y+IWgFJ4mXf9NMsYPqRDZRpFkCZXWCJaoElZIP3aBbgPWQDp50v0D2OBU+TDb6pWYBv2gWeqxZ4bhf4rlrgm13gk2qBT2QDTzUL4CnZ4BuaBfhGNbiM6r6R7SYbWFrVHyUqNAtwOdnAQM0CiQFkI7uJZoH8xmSHT2kV4FOUDFiqVQBLq8dnlaJG+KBRgD8WNaLkwGaVApsoWbiHSoEe1eDzuuIfHDzd6S+me6oE7lNtcgZXaBLgchczoZp+s1Jtck6iK0RHTJdqOWrwE7Tmx5CI8wStyT0YGLWA6V+lB554mR8jZ8ciEzjmywRpTitcUj30Z8d0VD52aSeREvbgayIlHj3+83TmbaEsf1tK/eCaG4uUj9/bSQzDO9UFCDucy/sC2fb7ODe8EtB0/0tA4dew5uivYdlfeibyAW9FOJ6EOpFXEXk1v1VeRbR/0zYTHJdBNZLI/KOO+4kf4RIfDqKOGxMTExMT8wNOZdb6YlKT2wAAAABJRU5ErkJggg==",s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAAC+0lEQVR4Ae2bA4xeURCFp7bdoGvjv3OC2m1Q24xW0cZJ3caqzdhJ3Vi1bdu2po1T3v95Nvu+E/N+z5hDMf4RExMTE4N0HmkqsZS34RAu4iG+8kd+hEs4xNuw1FTySKSTRvIbYyLW4xbEHr7JG8z47CakBVOMlXgHcRZ+w6tRSNGCOmY874e4D+83E1CHoqCwBWbzI4gPuY85hS0oVGrwDDyD+JgnZibVoHDgXByCBJBDnBvG8kfiPSSgvOfBFCg1sRASbHhRYIdSSn3eDgk+vD2lPvlPfks+AgknfCS/pd8XzTRchYSYq4Vp5B/ogNuQkHPbdPTv4LkMiSCXclr5curiOCSinMivS17hZZAIs5S8YfpDIs5Ack9OKzyJWoAfozW5BVsgCrKF3GG6QHQk0ZVcUBsXIe5Dv+FJ4aKLlx6UQtQICEodb3++qUmAb1BtcgJPh2gSgGAaOQEX1QlcouQxPSHqBMT0dH791yDg/H5Q1Ig/qhT4UNSIksGMgqgUEDPK+fOnKgFeRsmAM1oFcCap9y+IWgFJ4mXf9NMsYPqRDZRpFkCZXWCJaoElZIP3aBbgPWQDp50v0D2OBU+TDb6pWYBv2gWeqxZ4bhf4rlrgm13gk2qBT2QDTzUL4CnZ4BuaBfhGNbiM6r6R7SYbWFrVHyUqNAtwOdnAQM0CiQFkI7uJZoH8xmSHT2kV4FOUDFiqVQBLq8dnlaJG+KBRgD8WNaLkwGaVApsoWbiHSoEe1eDzuuIfHDzd6S+me6oE7lNtcgZXaBLgchczoZp+s1Jtck6iK0RHTJdqOWrwE7Tmx5CI8wStyT0YGLWA6V+lB554mR8jZ8ciEzjmywRpTitcUj30Z8d0VD52aSeREvbgayIlHj3+83TmbaEsf1tK/eCaG4uUj9/bSQzDO9UFCDucy/sC2fb7ODe8EtB0/0tA4dew5uivYdlfeibyAW9FOJ6EOpFXEXk1v1VeRbR/0zYTHJdBNZLI/KOO+4kf4RIfDqKOGxMTExMT8wNOZdb6YlKT2wAAAABJRU5ErkJggg==",u="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAAC6ElEQVR4Ae2bA6weURCFp7bd4NnaOyeo3Qa1zaiKXpzUbazajJ3UjVXbtm1rGqO6u/sv5uXf74t91nfvHEpISEhISAgO5PAwU4nlvANHcBmP8Z0/8xNcwRHegeWmkochhzRS0hDjsBF3IHb5Nm8yYwoakRZMBVbjA8Sb/I7XooziBbXMGD4I8S8fNGNRi+KgrBnm8hNIAD7EvLJmFCnVeCpeQAL0mZlG1SgauAhHICF4hIsofHgYPkJC8iMPoFCpjsWQcOUloV1KmXV5JyR8eWdmXQqekuZ8DBKNfKykOQVLWTauQyL0elk2BQfa4S4kYu+a9sFdPFchMXilsEUgty5OQmLyVEltShVeAYnR5ZQapg8kZvuRfwpb4FncAfgpWpJfsA2iwG3kD9MRokOnE/mgJi5DlHjZx6IHMyCKnOH5+PNtTQH4FtUkL/AUiDInkxdwWV2AK+Qe0w2iT9NN//M/mPdBeQP+rDLAp/IG5AYzHKJTM1z796dFXkFuwDmIUs+5Wn9B9OpisW96aw5gepMNzIQodqY9wDLVAZaRDd6nOQDvIxs4C3EjBYzLCGfJBt/WHIBv2wO8VB3gpT3AT9UBftgDfFEd4AvZwHPNAfCcbPAtzQH4Vho8RnW/yPaSDSyv6p8SszUH4FlkA/00B3D6ko2CRqoXNA3JDp+B6JTPkAXtt/Hy9PitUt4AnyD65M/lDcgd2KoywBZyC3dVGaBrGvxeV7zBwVO8bjE9UBXgIdUkb/Bs7d9AFlBL0zYr1STvOJ20BDAd03PUgAgt+SkkZp9Zhj20rw5Mnyo98MQrghg5OxFbgBOBTJAWtsAV7UN/Fkx7/WOXFpzMqAdfncxk9Pgvw987IOHLOzLrhtfcWKJ//N6CMxgftBcgLHARHwjl2B/gouhKQFOCLwFFX8Oap7+GZV/0jONDqRXheDxqxV5F5LX8XnkV0f5P24xVXAZ1j5P3Rx33Cz/BFT4aRh03ISEhISHhF9FSCRjypNzcAAAAAElFTkSuQmCC"},7215:(e,t,o)=>{"use strict";o.r(t);var n=o(2273),r=o(3751);Blockly.Blocks.procedures_defnoreturn={init:function(){var e=this;this.arguments=[],this.argument_var_models=[],this.jsonInit(this.definition()),this.getField("NAME").setValidator(Blockly.Procedures.rename);var t=new Blockly.FieldImage(r.dK,24,24,"+",(function(){return e.onAddClick()}));this.appendDummyInput("ADD_ICON").appendField(t),this.setStatements(!0)},definition:function(){return{message0:(0,n.localize)("function {{ function_name }} {{ function_params }}",{function_name:"%1",function_params:"%2"}),args0:[{type:"field_input",name:"NAME",text:""},{type:"field_label",name:"PARAMS",text:""}],colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,tooltip:(0,n.localize)("Function with no return value"),category:Blockly.Categories.Functions}},meta:function(){return{display_name:(0,n.localize)("Function"),description:(0,n.localize)("This block creates a function, which is a group of instructions that can be executed at any time. Place other blocks in here to perform any kind of action that you need in your strategy. When all the instructions in a function have been carried out, your bot will continue with the remaining blocks in your strategy. Click the “do something” field to give it a name of your choice. Click the plus icon to send a value (as a named variable) to your function.")}},onchange:function(e){var t=[Blockly.Events.BLOCK_DELETE,Blockly.Events.BLOCK_CREATE,Blockly.Events.BLOCK_CHANGE];this.workspace&&!this.workspace.isFlyout&&t.includes(e.type)&&e.type===Blockly.Events.BLOCK_CHANGE&&e.blockId===this.id&&"NAME"===e.name&&this.getProcedureCallers().forEach((function(t){t.setFieldValue(e.newValue,"NAME")}))},onAddClick:function(){var e=this;this.workspace.options.readOnly||this.isInFlyout||setTimeout((function(){var t=(0,n.localize)("Specify a parameter name:");Blockly.prompt(t,"",(function(t){if(t){var o=Blockly.Variables.getOrCreateVariablePackage(e.workspace,null,t,"");o&&(e.arguments.push(t),e.argument_var_models.push(o),e.getField("PARAMS").setText("".concat((0,n.localize)("with: ")," ").concat(e.arguments.join(", "))),e.getProcedureCallers().forEach((function(t){t.setProcedureParameters(e.arguments),t.initSvg(),t.render(!1)})))}}))}),200)},setStatements:function(e){this.hasStatements!==e&&(e?(this.appendStatementInput("STACK").appendField(""),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements=e)},updateParams:function(){var e="";this.arguments.length&&(e="".concat((0,n.localize)("with:")," ").concat(this.arguments.join(", "))),Blockly.Events.disable();try{this.setFieldValue(e,"PARAMS")}finally{Blockly.Events.enable()}},mutationToDom:function(e){var t=this,o=document.createElement("mutation");return e&&o.setAttribute("name",this.getFieldValue("NAME")),this.argument_var_models.forEach((function(n,r){var i=document.createElement("arg");i.setAttribute("name",n.name),i.setAttribute("varid",n.getId()),e&&t.paramIds&&i.setAttribute("paramId",t.paramIds[r]),o.appendChild(i)})),this.hasStatements||o.setAttribute("statements","false"),o},domToMutation:function(e){var t=this;this.arguments=[],this.argument_var_models=[],e.childNodes.forEach((function(e){if("arg"===e.nodeName.toLowerCase()){var o=e.getAttribute("name"),n=e.getAttribute("varid")||e.getAttribute("varId"),r=Blockly.Variables.getOrCreateVariablePackage(t.workspace,n,o,"");t.arguments.push(o),null!==r?t.argument_var_models.push(r):console.log("Failed to create a variable with name ".concat(o,", ignoring."))}})),this.updateParams(),this.setStatements("false"!==e.getAttribute("statements"))},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments,!1]},getProcedureCallers:function(){var e=this;return this.workspace.getAllBlocks(!1).filter((function(t){return t.type===e.callType&&t.data===e.id}))},getVars:function(){return this.arguments},getVarModels:function(){return this.argument_var_models},customContextMenu:function(e){var t=this;if(!this.isInFlyout){var o={enabled:!0},r=this.getFieldValue("NAME");o.text=(0,n.localize)('Create "%1"').replace("%1",r);var i=document.createElement("mutation");i.setAttribute("name",r),this.arguments.forEach((function(e){var t=document.createElement("arg");t.setAttribute("name",e),i.appendChild(t)}));var a=document.createElement("block");a.setAttribute("type",this.callType),a.appendChild(i),o.callback=Blockly.ContextMenu.callbackFactory(this,a),e.push(o),this.isCollapsed()||this.argument_var_models.forEach((function(o){var r={enabled:!0};r.text=(0,n.localize)('Create "get %1"').replace("%1",o.name);var i=Blockly.Variables.generateVariableFieldDom(o),a=document.createElement("block");a.setAttribute("type","variables_get"),a.appendChild(i),r.callback=Blockly.ContextMenu.callbackFactory(t,a),e.push(r)}))}},callType:"procedures_callnoreturn"},Blockly.JavaScript.procedures_defnoreturn=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),o=Blockly.JavaScript.statementToCode(e,"STACK");if(Blockly.JavaScript.STATEMENT_PREFIX){var n=e.id.replace(/\$/g,"$$$$");o=Blockly.JavaScript.prefixLines(Blockly.JavaScript.STATEMENT_PREFIX.replace(/%1/g,"'".concat(n,"'")),Blockly.JavaScript.INDENT)+o}Blockly.JavaScript.INFINITE_LOOP_TRAP&&(o=Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,"'".concat(e.id,"'"))+o);var r=Blockly.JavaScript.valueToCode(e,"RETURN",Blockly.JavaScript.ORDER_NONE)||"";r&&(r="".concat(Blockly.JavaScript.INDENT,"return ").concat(r,";\n"));var i=e.arguments.map((function(e){return Blockly.JavaScript.variableDB_.getName(e,Blockly.Variables.NAME_TYPE)})),a=Blockly.JavaScript.scrub_(e,"\n    function ".concat(t,"(").concat(i.join(", "),") {\n        ").concat(o,"\n        ").concat(r,"\n    }\n"));return Blockly.JavaScript.definitions_["%".concat(t)]=a,null},Blockly.Blocks.procedures_defreturn={init:function(){var e=this;this.arguments=[],this.argument_var_models=[],this.jsonInit(this.definition()),this.getField("NAME").setValidator(Blockly.Procedures.rename);var t=new Blockly.FieldImage(r.M8,24,24,"+",(function(){return e.onAddClick()}));this.appendDummyInput("ADD_ICON").appendField(t),this.moveInputBefore("ADD_ICON","RETURN"),this.setStatements(!0)},definition:function(){return{message0:(0,n.localize)("function {{ function_name }} {{ function_params }} {{ dummy }}",{function_name:"%1",function_params:"%2",dummy:"%3"}),message1:"return %1",args0:[{type:"field_input",name:"NAME",text:""},{type:"field_label",name:"PARAMS",text:""},{type:"input_dummy"}],args1:[{type:"input_value",name:"RETURN",check:null,align:Blockly.ALIGN_RIGHT}],colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,tooltip:(0,n.localize)("Function that returns a value"),category:Blockly.Categories.Functions}},meta:function(){return{display_name:(0,n.localize)("Function that returns a value"),description:(0,n.localize)("This block is similar to the one above, except that this returns a value. The returned value can be assigned to a variable of your choice.")}},onAddClick:Blockly.Blocks.procedures_defnoreturn.onAddClick,onchange:Blockly.Blocks.procedures_defnoreturn.onchange,setStatements:Blockly.Blocks.procedures_defnoreturn.setStatements,updateParams:Blockly.Blocks.procedures_defnoreturn.updateParams,mutationToDom:Blockly.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:Blockly.Blocks.procedures_defnoreturn.domToMutation,getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments,!0]},getProcedureCallers:Blockly.Blocks.procedures_defnoreturn.getProcedureCallers,getVars:Blockly.Blocks.procedures_defnoreturn.getVars,getVarModels:Blockly.Blocks.procedures_defnoreturn.getVarModels,renameVarById:Blockly.Blocks.procedures_defnoreturn.renameVarById,displayRenamedVar:Blockly.Blocks.procedures_defnoreturn.displayRenamedVar,customContextMenu:Blockly.Blocks.procedures_defnoreturn.customContextMenu,callType:"procedures_callreturn",registerWorkspaceListener:Blockly.Blocks.procedures_defnoreturn.registerWorkspaceListener},Blockly.JavaScript.procedures_defreturn=Blockly.JavaScript.procedures_defnoreturn,Blockly.Blocks.procedures_callnoreturn={init:function(){this.arguments=[],this.argument_var_models=[],this.previousDisabledState=!1,this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2",args0:[{type:"field_label",name:"NAME",text:this.id},{type:"input_dummy",name:"TOPROW"}],colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Custom function"),category:Blockly.Categories.Functions}},meta:function(){return{display_name:(0,n.localize)("Custom function"),description:""}},onchange:function(e){if(this.workspace&&!this.workspace.isFlyout&&e.recordUndo)if(e.type===Blockly.Events.BLOCK_CREATE&&-1!==e.ids.indexOf(this.id)){var t=this.getProcedureCall(),o=Blockly.Procedures.getDefinition(t,this.workspace);if(!o||o.type===this.defType&&JSON.stringify(o.arguments)===JSON.stringify(this.arguments)||(o=null),o)return void(this.data=o.id);Blockly.Events.setGroup(e.group);var n=document.createElement("xml"),r=document.createElement("block");r.setAttribute("type",this.defType);var i=this.getRelativeToSurfaceXY(),a=i.x+Blockly.SNAP_RADIUS*(this.RTL?-1:1),l=i.y+2*Blockly.SNAP_RADIUS;r.setAttribute("x",a),r.setAttribute("y",l);var c=this.mutationToDom();r.appendChild(c);var s=document.createElement("field");s.setAttribute("name","NAME"),s.appendChild(document.createTextNode(this.getProcedureCall())),r.appendChild(s),n.appendChild(r),Blockly.Xml.domToWorkspace(n,this.workspace),Blockly.Events.setGroup(!1);var u=Blockly.Procedures.getDefinition(t,this.workspace);this.data=u.id}else if(e.type===Blockly.Events.BLOCK_DELETE){var p=this.getProcedureCall();Blockly.Procedures.getDefinition(p,this.workspace)||(Blockly.Events.setGroup(e.group),this.dispose(!0,!1),Blockly.Events.setGroup(!1))}else if(e.type===Blockly.Events.BLOCK_CHANGE&&"disabled"===e.element){var d=this.getProcedureCall(),y=Blockly.Procedures.getDefinition(d,this.workspace);if(y&&y.id===e.blockId){var m=Blockly.Events.getGroup();m&&console.log("Saw an existing group while responding to a definition change"),Blockly.Events.setGroup(e.group),e.newValue?(this.previousDisabledState=this.disabled,this.setDisabled(!0)):this.setDisabled(this.previousDisabledState),Blockly.Events.setGroup(m)}}},getProcedureDefinition:function(e){return this.workspace.getTopBlocks(!1).find((function(t){if(t.getProcedureDef){var o=t.getProcedureDef();return o&&Blockly.Names.equals(o[0],e)}return!1}))},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(e,t){Blockly.Names.equals(e,this.getProcedureCall())&&this.setFieldValue(t,"NAME")},setProcedureParameters:function(e){var t=this;this.arguments=[].concat(e),this.argument_var_models=this.arguments.map((function(e){return Blockly.Variables.getOrCreateVariablePackage(t.workspace,null,e,"")})),this.updateShape()},updateShape:function(){var e=this;this.arguments.forEach((function(t,o){var n=e.getField("ARGNAME".concat(o));if(n){Blockly.Events.disable();try{n.setValue(t)}finally{Blockly.Events.enable()}}else n=new Blockly.FieldLabel(t),e.appendValueInput("ARG".concat(o)).appendField(n,"ARGNAME".concat(o)).init()}));for(var t=this.arguments.length;this.getInput("ARG".concat(t));)this.removeInput("ARG".concat(t)),t++;var o=this.getInput("TOPROW");o&&(this.arguments.length?this.getField("WITH")||(o.appendField((0,n.localize)("with:"),"WITH"),o.init()):this.getField("WITH")&&o.removeField("WITH"))},mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("name",this.getProcedureCall()),this.arguments.forEach((function(t){var o=document.createElement("arg");o.setAttribute("name",t),e.appendChild(o)})),e},domToMutation:function(e){var t=e.getAttribute("name");this.renameProcedure(this.getProcedureCall(),t);var o=[],n=[];e.childNodes.forEach((function(e){"arg"===e.nodeName.toLowerCase()&&(o.push(e.getAttribute("name")),n.push(e.getAttribute("paramId")))})),this.setProcedureParameters(o,n)},getVarModels:function(){return this.argument_var_models},customContextMenu:function(e){var t=this,o=this.getProcedureCall(),r=this.workspace,i={enabled:!0};i.text=(0,n.localize)("Highlight function definition"),i.callback=function(){var e=t.getProcedureDefinition(o);e&&(r.centerOnBlock(e.id),e.select())},e.push(i)},defType:"procedures_defnoreturn"},Blockly.JavaScript.procedures_callnoreturn=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),o=e.arguments.map((function(t,o){return Blockly.JavaScript.valueToCode(e,"ARG".concat(o),Blockly.JavaScript.ORDER_COMMA)||"null"}));return"".concat(t,"(").concat(o.join(", "),");\n")},Blockly.Blocks.procedures_callreturn={init:function(){this.arguments=[],this.previousDisabledState=!1,this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2",args0:[{type:"field_label",name:"NAME",text:this.id},{type:"input_dummy",name:"TOPROW"}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,tooltip:(0,n.localize)("Custom function"),category:Blockly.Categories.Functions}},meta:function(){return{display_name:(0,n.localize)("Custom function"),description:""}},onchange:Blockly.Blocks.procedures_callnoreturn.onchange,getProcedureDefinition:Blockly.Blocks.procedures_callnoreturn.getProcedureDefinition,getProcedureCall:Blockly.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:Blockly.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters:Blockly.Blocks.procedures_callnoreturn.setProcedureParameters,updateShape:Blockly.Blocks.procedures_callnoreturn.updateShape,mutationToDom:Blockly.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:Blockly.Blocks.procedures_callnoreturn.domToMutation,getVarModels:Blockly.Blocks.procedures_callnoreturn.getVarModels,customContextMenu:Blockly.Blocks.procedures_callnoreturn.customContextMenu,defType:"procedures_defreturn"},Blockly.JavaScript.procedures_callreturn=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),o=e.arguments.map((function(t,o){return Blockly.JavaScript.valueToCode(e,"ARG".concat(o),Blockly.JavaScript.ORDER_COMMA)||"null"}));return["".concat(t,"(").concat(o.join(", "),")"),Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.procedures_ifreturn={init:function(){this.hasReturnValue=!0,this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("if {{ condition }} return {{ value }}",{condition:"%1",value:"%2"}),args0:[{type:"input_value",name:"CONDITION"},{type:"input_value",name:"VALUE"}],colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Prematurely returns a value within a function"),category:Blockly.Categories.Functions}},meta:function(){return{display_name:(0,n.localize)("Conditional return"),description:(0,n.localize)("This block returns a value when a condition is true. Use this block within either of the function blocks above.")}},mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("value",Number(this.hasReturnValue)),e},domToMutation:function(e){var t=e.getAttribute("value");this.hasReturnValue="1"===t,this.hasReturnValue||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField((0,n.localize)("return")),this.initSvg(),this.render())},onchange:function(){var e=this;if(this.workspace.isDragging&&!this.workspace.isDragging()){var t=!1,o=this;do{if(-1!==this.FUNCTION_TYPES.indexOf(o.type)){t=!0;break}o=o.getSurroundParent()}while(o);if(t){var r=function(){e.initSvg(),e.render()};"procedures_defnoreturn"===o.type&&this.hasReturnValue?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField((0,n.localize)("return")),r(),this.hasReturnValue=!1):"procedures_defreturn"!==o.type||this.hasReturnValue||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField((0,n.localize)("return")),r(),this.hasReturnValue=!0),this.isInFlyout||this.setDisabled(!1)}else this.isInFlyout||this.getInheritedDisabled()||this.setDisabled(!0)}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},Blockly.JavaScript.procedures_ifreturn=function(e){var t,o=Blockly.JavaScript.valueToCode(e,"CONDITION",Blockly.JavaScript.ORDER_NONE)||"false";if(e.hasReturnValue){var n=Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_NONE)||"null";t="return ".concat(n,";\n")}else t="return;\n";return"\n    if (".concat(o,") {\n        ").concat(t,"\n    }\n")};var i=o(6132);Blockly.Blocks.lists_create_with={protected_statements:["STACK"],allowed_children:["lists_statement"],init:function(){var e=new Blockly.FieldImage(r.M8,25,25,"",this.onIconClick.bind(this));this.jsonInit(this.definition()),this.appendDummyInput("ADD_ICON").appendField(e),this.moveInputBefore("ADD_ICON","STACK")},definition:function(){return{message0:(0,n.localize)("set {{ variable }} to create list with",{variable:"%1"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:(0,n.localize)("list")}],args1:[{type:"input_statement",name:"STACK"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("This block creates a list with strings and numbers."),category:Blockly.Categories.List}},meta:function(){return{display_name:(0,n.localize)("Create list"),description:(0,n.localize)("This block creates a list with strings and numbers.")}},onIconClick:function(){var e=this;this.workspace.options.readOnly||this.isInFlyout||(0,i.UR)(!1,(function(){var t=e.workspace.newBlock("lists_statement");t.required_parent_id=e.id,t.setMovable(!1),t.initSvg(),t.render(),e.getLastConnectionInStatement("STACK").connect(t.previousConnection)}))},onchange:function(e){var t=this;!this.workspace||this.isInFlyout||this.workspace.isDragging()||e.type===Blockly.Events.END_DRAG&&this.getBlocksInStatement("STACK").forEach((function(e){t.allowed_children.includes(e.type)||(0,i.$9)((function(){e.unplug(!1)}))}))}},Blockly.JavaScript.lists_create_with=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.getBlocksInStatement("STACK").map((function(e){var t=Blockly.JavaScript[e.type](e);return Array.isArray(t)?t[0]:t}));return"".concat(t," = [").concat(o.join(", "),"];\n")},Blockly.Blocks.lists_repeat={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("create list with item {{ input_item }} repeated {{ number }} times",{input_item:"%1",number:"%2"}),args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM"}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Creates a list by repeating a given item"),category:Blockly.Categories.List}},meta:function(){return{display_name:(0,n.localize)("Repeat an item"),description:(0,n.localize)("Creates a list with a given item repeated for a specific number of times.")}},getRequiredValueInputs:function(){return{ITEM:i.cM,NUM:i.cM}}},Blockly.JavaScript.lists_repeat=function(e){var t=Blockly.JavaScript.provideFunction_("listsRepeat",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(value, n) {\n            var array = [];\n            for (var i = 0; i < n; i++) {\n                array[i] = value;\n            }\n            return array;\n        }")]),o=Blockly.JavaScript.valueToCode(e,"ITEM",Blockly.JavaScript.ORDER_COMMA)||"null",n=Blockly.JavaScript.valueToCode(e,"NUM",Blockly.JavaScript.ORDER_COMMA)||"0";return["".concat(t,"(").concat(o,", ").concat(n,")"),Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.lists_length={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("length of {{ input_list }}",{input_list:"%1"}),args0:[{type:"input_value",name:"VALUE"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block gives you the total number of items in a given list."),category:Blockly.Categories.List}},meta:function(){return{display_name:(0,n.localize)("List Length"),description:(0,n.localize)("This block gives you the total number of items in a given list.")}},getRequiredValueInputs:function(){return{VALUE:null}}},Blockly.JavaScript.lists_length=function(e){var t=Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"[]";return["".concat(t,".length"),Blockly.JavaScript.ORDER_MEMBER]},Blockly.Blocks.lists_isEmpty={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("list {{ input_list }} is empty",{input_list:"%1"}),args0:[{type:"input_value",name:"VALUE",check:["Array"]}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Checks if a given list is empty"),category:Blockly.Categories.List}},meta:function(){return{display_name:(0,n.localize)("Is list empty?"),description:(0,n.localize)("This block checks if a given list is empty. It returns “True” if the list is empty, “False” if otherwise.")}},getRequiredValueInputs:function(){return{VALUE:null}}},Blockly.JavaScript.lists_isEmpty=function(e){var t=Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"[]";return[-1!==e.workspace.getAllVariables().findIndex((function(e){return e.name===t}))?"!".concat(t," || !").concat(t,".length"):"!".concat(t,".length"),Blockly.JavaScript.ORDER_LOGICAL_NOT]},Blockly.Blocks.lists_indexOf={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("in list {{ input_list }} find {{ first_or_last }} occurence of item {{ input_value }}",{input_list:"%1",first_or_last:"%2",input_value:"%3"}),args0:[{type:"input_value",name:"VALUE"},{type:"field_dropdown",name:"END",options:[[(0,n.localize)("first"),"FIRST"],[(0,n.localize)("last"),"LAST"]]},{type:"input_value",name:"FIND"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block gives you the position of an item in a given list."),category:Blockly.Categories.List}},meta:function(){return{display_name:(0,n.localize)("List item position"),description:(0,n.localize)("This block gives you the position of an item in a given list.")}},getRequiredValueInputs:function(){return{VALUE:null,FIND:null}}},Blockly.JavaScript.lists_indexOf=function(e){var t="FIRST"===e.getFieldValue("END")?"indexOf":"lastIndexOf",o=Blockly.JavaScript.valueToCode(e,"FIND",Blockly.JavaScript.ORDER_NONE)||"''",n=Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"''",r="".concat(n,".").concat(t,"(").concat(o,")");return e.workspace.options.oneBasedIndex?["".concat(r," + 1"),Blockly.JavaScript.ORDER_ADDITION]:[r,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.lists_getIndex={init:function(){var e=this;this.MODE_OPTIONS=[[(0,n.localize)("get"),"GET"],[(0,n.localize)("get and remove"),"GET_REMOVE"],[(0,n.localize)("remove"),"REMOVE"]],this.WHERE_OPTIONS=[["#","FROM_START"],[(0,n.localize)("# from end"),"FROM_END"],[(0,n.localize)("first"),"FIRST"],[(0,n.localize)("last"),"LAST"],[(0,n.localize)("random"),"RANDOM"]];var t=new Blockly.FieldDropdown(this.MODE_OPTIONS,(function(t){var o="REMOVE"===t;e.updateStatement(o)}));this.appendValueInput("VALUE").setCheck("Array").appendField((0,n.localize)("in list")),this.appendDummyInput().appendField(t,"MODE"),this.appendDummyInput("AT"),this.setColourFromRawValues_(Blockly.Colours.Base.colour,Blockly.Colours.Base.colourSecondary,Blockly.Colours.Base.colourTertiary),this.setTooltip("This block gives you the value of a specific item in a list, given the position of the item. It can also remove the item from the list."),this.setOutput(!0,null),this.setOutputShape(Blockly.OUTPUT_SHAPE_ROUND),this.updateAt(!0)},meta:function(){return{display_name:(0,n.localize)("Get list item"),description:(0,n.localize)("This block gives you the value of a specific item in a list, given the position of the item. It can also remove the item from the list."),category:Blockly.Categories.List}},mutationToDom:function(){var e=document.createElement("mutation"),t=!this.outputConnection,o=this.getInput("AT").type===Blockly.INPUT_VALUE;return e.setAttribute("statement",t),e.setAttribute("at",o),e},domToMutation:function(e){var t="true"===e.getAttribute("statement");this.updateStatement(t);var o="false"!==e.getAttribute("at");this.updateAt(o)},updateStatement:function(e){e!==!this.outputConnection&&(this.unplug(!0,!0),this.setOutput(!e),this.setPreviousStatement(e),this.setNextStatement(e),this.initSvg(),this.render(!1))},updateAt:function(e){var t=this;this.removeInput("AT",!0),e?this.appendValueInput("AT").setCheck("Number"):this.appendDummyInput("AT");var o=new Blockly.FieldDropdown(this.WHERE_OPTIONS,(function(o){var n=["FROM_START","FROM_END"].includes(o);if(n!==e)return t.updateAt(n),t.setFieldValue(o,"WHERE"),null}));this.getInput("AT").appendField(o,"WHERE"),this.initSvg(),this.render(!1)}},Blockly.JavaScript.lists_getIndex=function(e){var t,o,n=e.getFieldValue("MODE")||"GET",r=e.getFieldValue("WHERE")||"FIRST",i="RANDOM"===r?Blockly.JavaScript.ORDER_COMMA:Blockly.JavaScript.ORDER_MEMBER,a=Blockly.JavaScript.valueToCode(e,"VALUE",i)||"[]";if("FIRST"===r){if("GET"===n)t="".concat(a,"[0]"),o=Blockly.JavaScript.ORDER_MEMBER;else if("GET_REMOVE"===n)t="".concat(a,".shift()"),o=Blockly.JavaScript.ORDER_MEMBER;else if("REMOVE"===n)return"".concat(a,".shift();\n")}else if("LAST"===r){if("GET"===n)t="".concat(a,".slice(-1)[0]"),o=Blockly.JavaScript.ORDER_MEMBER;else if("GET_REMOVE"===n)t="".concat(a,".pop()"),o=Blockly.JavaScript.ORDER_MEMBER;else if("REMOVE"===n)return"".concat(a,".pop();\n")}else if("FROM_START"===r){var l=Blockly.JavaScript.getAdjusted(e,"AT");if("GET"===n)t="".concat(a,"[").concat(l,"]"),o=Blockly.JavaScript.ORDER_MEMBER;else if("GET_REMOVE"===n)t="".concat(a,".splice(").concat(l,", 1)[0]"),o=Blockly.JavaScript.ORDER_FUNCTION_CALL;else if("REMOVE"===n)return"".concat(a,".splice(").concat(l,", 1);\n")}else if("FROM_END"===r){var c=Blockly.JavaScript.getAdjusted(e,"AT",1,!0);if("GET"===n)t="".concat(a,".slice(").concat(c,")[0]"),o=Blockly.JavaScript.ORDER_FUNCTION_CALL;else if("GET_REMOVE"===n)t="".concat(a,".splice(").concat(c,", 1)[0]"),o=Blockly.JavaScript.ORDER_FUNCTION_CALL;else if("REMOVE"===n)return"".concat(a,".splice(").concat(c,", 1);\n")}else if("RANDOM"===r){var s=Blockly.JavaScript.provideFunction_("listsGetRandomItem",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(list, remove) {\n                var x = Math.floor(Math.random() * list.length);\n                if (remove) {\n                    return list.splice(x, 1)[0];\n                } else {\n                    return list[x];\n                }\n            }")]);if(t="".concat(s,"(").concat(a,", ").concat("GET"!==n,")"),"GET"===n||"GET_REMOVE"===n)o=Blockly.JavaScript.ORDER_FUNCTION_CALL;else if("REMOVE"===n)return"".concat(t,";\n")}return[t,o]},Blockly.Blocks.lists_setIndex={init:function(){this.MODE_OPTIONS=[[(0,n.localize)("set"),"SET"],[(0,n.localize)("insert at"),"INSERT"]],this.WHERE_OPTIONS=[[(0,n.localize)("#"),"FROM_START"],[(0,n.localize)("# from end"),"FROM_END"],[(0,n.localize)("first"),"FIRST"],[(0,n.localize)("last"),"LAST"],[(0,n.localize)("random"),"RANDOM"]],this.appendValueInput("LIST").setCheck("Array").appendField((0,n.localize)("in list")),this.appendDummyInput().appendField(new Blockly.FieldDropdown(this.MODE_OPTIONS),"MODE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField((0,n.localize)("as")),this.setColourFromRawValues_(Blockly.Colours.Base.colour,Blockly.Colours.Base.colourSecondary,Blockly.Colours.Base.colourTertiary),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip((0,n.localize)("This block replaces a specific item in a list with another given item. It can also insert the new item in the list at a specific position.")),this.updateAt(!0)},meta:function(){return{display_name:(0,n.localize)("Set list item"),description:(0,n.localize)("This block replaces a specific item in a list with another given item. It can also insert the new item in the list at a specific position."),category:Blockly.Categories.List}},mutationToDom:function(){var e=document.createElement("mutation"),t=this.getInput("AT").type===Blockly.INPUT_VALUE;return e.setAttribute("at",t),e},domToMutation:function(e){var t="false"!==e.getAttribute("at");this.updateAt(t)},updateAt:function(e){var t=this;this.removeInput("AT",!0),e?this.appendValueInput("AT").setCheck("Number"):this.appendDummyInput("AT");var o=new Blockly.FieldDropdown(this.WHERE_OPTIONS,(function(o){var n=["FROM_START","FROM_END"].includes(o);if(n!==e)return t.updateAt(n),t.setFieldValue(o,"WHERE"),null}));this.moveInputBefore("AT","TO"),this.getInput("AT").appendField(o,"WHERE"),this.initSvg(),this.render(!1)}},Blockly.JavaScript.lists_setIndex=function(e){var t,o=e.getFieldValue("MODE")||"SET",n=e.getFieldValue("WHERE")||"FIRST",r=Blockly.JavaScript.valueToCode(e,"TO",Blockly.JavaScript.ORDER_ASSIGNMENT)||"null",i=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_MEMBER)||"[]",a=function(){if(i.match(/^\w+$/))return"";var e=Blockly.JavaScript.variableDB_.getDistinctName("tmpList",Blockly.Variables.NAME_TYPE),t="var ".concat(e," = ").concat(i,";\n");return i=e,t};if("FIRST"===n)"SET"===o?t="".concat(i,"[0] = ").concat(r,";\n"):"INSERT"===o&&(t="".concat(i,".unshift(").concat(r,");\n"));else if("LAST"===n)"SET"===o?(t=a(),t+="".concat(i,"[").concat(i,".length - 1] = ").concat(r,";\n")):"INSERT"===o&&(t="".concat(i,".push(").concat(r,");\n"));else if("FROM_START"===n){var l=Blockly.JavaScript.getAdjusted(e,"AT");"SET"===o?t="".concat(i,"[").concat(l,"] = ").concat(r,";\n"):"INSERT"===o&&(t="".concat(i,".splice(").concat(l,", 0, ").concat(r,");\n"))}else if("FROM_END"===n){var c=Blockly.JavaScript.getAdjusted(e,"AT",1,!1,Blockly.JavaScript.ORDER_SUBTRACTION);t=a(),"SET"===o?t="".concat(i,"[").concat(i,".length - ").concat(c,"] = ").concat(r,";\n"):"INSERT"===o&&(t="".concat(i,".splice(").concat(i,".length - ").concat(c,", 0, ").concat(r,");\n"))}else if("RANDOM"===n){t=a();var s=Blockly.JavaScript.variableDB_.getDistinctName("tmpX",Blockly.Variables.NAME_TYPE);t+="var ".concat(s," = Math.floor(Math.random() * ").concat(i,".length);\n"),"SET"===o?t+="".concat(i,"[").concat(s,"] = ").concat(r,";\n"):"INSERT"===o&&(t+="".concat(i,".splice(").concat(s,", 0, ").concat(r,");\n"))}return t},Blockly.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[(0,n.localize)("get sub-list from #"),"FROM_START"],[(0,n.localize)("get sub-list from # from end"),"FROM_END"],[(0,n.localize)("get sub-list from first"),"FIRST"]],this.WHERE_OPTIONS_2=[[(0,n.localize)("#"),"FROM_START"],[(0,n.localize)("# from end"),"FROM_END"],[(0,n.localize)("last"),"LAST"]],this.appendValueInput("LIST").appendField((0,n.localize)("in list")),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),this.setColourFromRawValues_(Blockly.Colours.Base.colour,Blockly.Colours.Base.colourSecondary,Blockly.Colours.Base.colourTertiary),this.setOutput(!0,null),this.setOutputShape(Blockly.OUTPUT_SHAPE_ROUND),this.setTooltip((0,n.localize)("This block creates a list of items from an existing list, using specific item positions.")),this.updateAt(1,!0),this.updateAt(2,!0)},meta:function(){return{display_name:(0,n.localize)("Get sub-list"),description:(0,n.localize)("This block creates a list of items from an existing list, using specific item positions."),category:Blockly.Categories.List}},mutationToDom:function(){var e=document.createElement("mutation"),t=this.getInput("AT1").type===Blockly.INPUT_VALUE,o=this.getInput("AT2").type===Blockly.INPUT_VALUE;return e.setAttribute("at1",t),e.setAttribute("at2",o),e},domToMutation:function(e){var t="true"===e.getAttribute("at1"),o="true"===e.getAttribute("at2");this.updateAt(1,t),this.updateAt(2,o)},updateAt:function(e,t){var o=this;this.removeInput("AT".concat(e)),t?this.appendValueInput("AT".concat(e)).setCheck("Number"):this.appendDummyInput("AT".concat(e));var n=new Blockly.FieldDropdown(this["WHERE_OPTIONS_".concat(e)],(function(n){var r=["FROM_START","FROM_END"].includes(n);if(r!==t)return o.updateAt(e,r),o.setFieldValue(n,"WHERE".concat(e)),null}));this.getInput("AT".concat(e)).appendField(n,"WHERE".concat(e)),1===e&&this.moveInputBefore("AT1","AT2"),this.initSvg(),this.render(!1)}},Blockly.JavaScript.lists_getSublist=function(e){var t,o,n,r=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_MEMBER)||"[]",i=e.getFieldValue("WHERE1"),a=e.getFieldValue("WHERE2");if("FIRST"===i&&"LAST"===a)n="".concat(r,".slice(0)");else if(r.match(/^\w+$/)||"FROM_END"!==i&&"FROM_START"===a)"FROM_START"===i?t=Blockly.JavaScript.getAdjusted(e,"AT1"):"FROM_END"===i?(t=Blockly.JavaScript.getAdjusted(e,"AT1",1,!1,Blockly.JavaScript.ORDER_SUBTRACTION),t="".concat(r,".length - ").concat(t)):"FIRST"===i&&(t="0"),"FROM_START"===a?o=Blockly.JavaScript.getAdjusted(e,"AT2",1):"FROM_END"===a?(o=Blockly.JavaScript.getAdjusted(e,"AT2",0,!1,Blockly.JavaScript.ORDER_SUBTRACTION),o="".concat(r,".length - ").concat(o)):"LAST"===a&&(o="".concat(r,".length")),n="".concat(r,".slice(").concat(t,", ").concat(o,")");else{t=Blockly.JavaScript.getAdjusted(e,"AT1"),o=Blockly.JavaScript.getAdjusted(e,"AT2");var l={FROM_START:"FromStart",FROM_END:"FromEnd",FIRST:"First",LAST:"Last"},c=function(e,t,o){return"FIRST"===t?"0":"FROM_END"===t?"".concat(e,".length - 1 - ").concat(o):"LAST"===t?"".concat(e,".length - 1"):"".concat(o)},s="FROM_END"===i||"FROM_START"===i,u="FROM_END"===a||"FROM_START"===a,p=Blockly.JavaScript.provideFunction_("subsequence".concat(l[i]).concat(l[a]),["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(\n                    sequence").concat(s?", at1":"").concat(u?", at2":"","\n                ) {\n                    var start = ").concat(c("sequence",i,"at1"),";\n                    var end = ").concat(c("sequence",a,"at2")," + 1;\n\n                    return sequence.slice(start, end);\n                }")]);n="".concat(p,"(").concat(r).concat(s?", ".concat(t):"").concat(u?", ".concat(o):"",")")}return[n,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.lists_split={init:function(){var e=this,t=new Blockly.FieldDropdown([[(0,n.localize)("make list from text"),"SPLIT"],[(0,n.localize)("make text from list"),"JOIN"]],(function(t){return e.updateType(t)}));this.appendValueInput("INPUT").setCheck("String").appendField(t,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField("","SPACE1").appendField((0,n.localize)("with delimiter"),"DELIM_LABEL"),this.appendDummyInput().appendField("","SPACE2"),this.setOutput(!0,"Array"),this.setOutputShape(Blockly.OUTPUT_SHAPE_ROUND),this.setColourFromRawValues_(Blockly.Colours.Base.colour,Blockly.Colours.Base.colourSecondary,Blockly.Colours.Base.colourTertiary),this.setTooltip((0,n.localize)("This block creates a list from a given string of text, splitting it with the given delimiter. It can also join items in a list into a string of text."))},meta:function(){return{display_name:(0,n.localize)("Create list from text"),description:(0,n.localize)("This block creates a list from a given string of text, splitting it with the given delimiter. It can also join items in a list into a string of text."),category:Blockly.Categories.List}},mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("mode",this.getFieldValue("MODE")),e},domToMutation:function(e){this.updateType(e.getAttribute("mode"))},updateType:function(e){var t=this.getInput("DELIM"),o=this.getField("SPACE1");"SPLIT"===e?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String"),o||t.insertFieldAt(0,"","SPACE1")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck(null),o&&t.removeField("SPACE1")),this.initSvg(),this.render(!1)}},Blockly.JavaScript.lists_split=function(e){var t,o=Blockly.JavaScript.valueToCode(e,"INPUT",Blockly.JavaScript.ORDER_MEMBER),n=Blockly.JavaScript.valueToCode(e,"DELIM",Blockly.JavaScript.ORDER_NONE)||"''",r=e.getFieldValue("MODE");return"SPLIT"===r?t="".concat(o||"''",".split(").concat(n,")"):"JOIN"===r&&(t="".concat(o||"[]",".join(").concat(n,")")),[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.lists_sort={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("sort {{ sort_type }} {{ sort_direction }} {{ input_list }}",{sort_type:"%1",sort_direction:"%2",input_list:"%3"}),args0:[{type:"field_dropdown",name:"TYPE",options:[[(0,n.localize)("numeric"),"NUMERIC"],[(0,n.localize)("alphabetic"),"TEXT"]]},{type:"field_dropdown",name:"DIRECTION",options:[[(0,n.localize)("ascending"),"1"],[(0,n.localize)("descending"),"-1"]]},{type:"input_value",name:"LIST"}],output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Sorts the items in a given list"),category:Blockly.Categories.List}},meta:function(){return{display_name:(0,n.localize)("Sort list"),description:(0,n.localize)("Sorts the items in a given list, by their numeric or alphabetical value, in either ascending or descending order.")}},getRequiredValueInputs:function(){return{LIST:null}}},Blockly.JavaScript.lists_sort=function(e){var t=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_FUNCTION_CALL)||"[]",o="1"===e.getFieldValue("DIRECTION")?1:-1,n=e.getFieldValue("TYPE"),r=Blockly.JavaScript.provideFunction_("listsGetSortCompare",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(type, direction) {\n            var compareFuncs = {\n                NUMERIC: function(a, b) {\n                    return parseFloat(a) - parseFloat(b);\n                },\n                TEXT: function(a, b) {\n                    return a.toString() > b.toString() ? 1 : -1;\n                }\n            };\n\n            return function(a, b) {\n                return compareFuncs[type](a, b) * direction; \n            }\n        }")]);return["".concat(t,".sort().slice(0).sort(").concat(r,'("').concat(n,'", ').concat(o,"))"),Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.lists_statement={required_parent_type:"lists_create_with",init:function(){var e=this;this.required_parent_id="";var t=new Blockly.FieldImage(r.fK,25,25,"",(function(){return e.onIconClick()}));this.jsonInit(this.definition()),this.appendDummyInput("REMOVE_ICON").appendField(t)},definition:function(){return{message0:"%1",args0:[{type:"input_value",name:"VALUE"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,category:Blockly.Categories.List}},meta:function(){return{display_name:(0,n.localize)("List Statement"),description:""}},onIconClick:function(){var e=this;this.workspace.options.readOnly||this.isInFlyout||(0,i.UR)(!1,(function(){e.unplug(!0),e.dispose()}))},onchange:function(e){var t=this;if(this.workspace&&!this.isInFlyout&&!this.workspace.isDragging()&&e.type===Blockly.Events.END_DRAG){var o=this.getSurroundParent();if(o)if(this.required_parent_id||o.type!==this.required_parent_type){if(o.id!==this.required_parent_id){var n=this.workspace.getAllBlocks().find((function(e){return e.id===t.required_parent_id}));if(n){var r=n.getLastConnectionInStatement("STACK");(0,i.$9)((function(){r.connect(t.previousConnection)}))}else(0,i.$9)((function(){t.dispose(!0)}))}}else this.required_parent_id=o.id;else(0,i.$9)((function(){t.dispose()}))}}},Blockly.JavaScript.lists_statement=function(e){return[Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_ATOMIC)||"null",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.controls_repeat_ext={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("repeat {{ number }} times",{number:"%1"}),args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:(0,n.localize)("do %1"),args1:[{type:"input_statement",name:"DO"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Repeats inside instructions specified number of times"),category:Blockly.Categories.Loop}},meta:function(){return{display_name:(0,n.localize)("Repeat (2)"),description:(0,n.localize)("This block is similar to the block above, except that the number of times it repeats is determined by a given variable.")}},getRequiredValueInputs:function(){return{TIMES:null}}},Blockly.JavaScript.controls_repeat_ext=function(e){var t;t=e.getField("TIMES")?String(Number(e.getFieldValue("TIMES"))):Blockly.JavaScript.valueToCode(e,"TIMES",Blockly.JavaScript.ORDER_ATOMIC)||"0";var o=Blockly.JavaScript.statementToCode(e,"DO"),n="",r=Blockly.JavaScript.variableDB_.getDistinctName("count",Blockly.Variables.NAME_TYPE),i=t;return t.match(/^\w+$/)||Blockly.isNumber(t)||(i=Blockly.JavaScript.variableDB_.getDistinctName("repeat_end",Blockly.Variables.NAME_TYPE),n+="var ".concat(i," = ").concat(t,";\n")),n+"\n    for (var ".concat(r," = 0; ").concat(r," < ").concat(i,"; ").concat(r,"++) {\n        ").concat(o,"\n    }\n")},Blockly.Blocks.controls_repeat={init:function(){this.jsonInit(this.definition())},definition:function(){return{type:"controls_repeat",message0:(0,n.localize)("repeat {{ number }} times",{number:"%1"}),args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:(0,n.localize)("do %1"),args1:[{type:"input_statement",name:"DO"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Repeats inside instructions specified number of times"),category:Blockly.Categories.Loop}},meta:function(){return{display_name:(0,n.localize)("Repeat (1)"),description:(0,n.localize)("This block repeats the instructions contained within for a specific number of times.")}}},Blockly.JavaScript.controls_repeat=Blockly.JavaScript.controls_repeat_ext,Blockly.Blocks.controls_whileUntil={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("repeat {{ while_or_until }} {{ boolean }}",{while_or_until:"%1",boolean:"%2"}),args0:[{type:"field_dropdown",name:"MODE",options:[[(0,n.localize)("while"),"WHILE"],[(0,n.localize)("until"),"UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:(0,n.localize)("do %1"),args1:[{type:"input_statement",name:"DO"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("This block repeats instructions as long as a given condition is true"),category:Blockly.Categories.Loop}},meta:function(){return{display_name:(0,n.localize)("Repeat While/Until"),description:(0,n.localize)("This block repeats instructions as long as a given condition is true.")}},getRequiredValueInputs:function(){return{BOOL:null}}},Blockly.JavaScript.controls_whileUntil=function(e){var t=Blockly.JavaScript.statementToCode(e,"DO"),o="UNTIL"===e.getFieldValue("MODE"),r=o?Blockly.JavaScript.ORDER_LOGICAL_NOT:Blockly.JavaScript.ORDER_NONE,i=Blockly.JavaScript.valueToCode(e,"BOOL",r)||"false";o&&(i="!".concat(i));var a=Blockly.JavaScript.variableDB_.getDistinctName("maxLoops",Blockly.Variables.NAME_TYPE),l=Blockly.JavaScript.variableDB_.getDistinctName("currentLoop",Blockly.Variables.NAME_TYPE);return"\n        var ".concat(a," = 10000;\n        var ").concat(l," = 0;\n\n        while (").concat(i,") {\n            if (").concat(l," > ").concat(a,') {\n                throw new Error("').concat((0,n.localize)("Infinite loop detected"),'");\n            } else {\n                ').concat(l,"++;\n            }\n            \n            ").concat(t,"\n        }\n")},Blockly.Blocks.controls_for={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("count with {{ variable }} from {{ start_number }} to {{ end_number }} by {{ step_size }}",{variable:"%1",start_number:"%2",end_number:"%3",step_size:"%4"}),args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"},{type:"input_value",name:"BY",check:"Number"}],message1:(0,n.localize)("do %1"),args1:[{type:"input_statement",name:"DO"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("This block uses the variable “i” to control the iterations. With each iteration, the value of “i” is determined by the items in a given list."),category:Blockly.Categories.Loop}},meta:function(){return{display_name:(0,n.localize)("Iterate (1)"),description:(0,n.localize)("This block uses the variable “i” to control the iterations. With each iteration, the value of “i” is determined by the items in a given list.")}},getRequiredValueInputs:function(){return{FROM:null,TO:null,BY:null}}},Blockly.JavaScript.controls_for=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),o=Blockly.JavaScript.valueToCode(e,"FROM",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",n=Blockly.JavaScript.valueToCode(e,"TO",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",r=Blockly.JavaScript.valueToCode(e,"BY",Blockly.JavaScript.ORDER_ASSIGNMENT)||"1",i=Blockly.JavaScript.statementToCode(e,"DO");i=Blockly.JavaScript.addLoopTrap(i,e.id);var a="";if(Blockly.isNumber(o)&&Blockly.isNumber(n)&&Blockly.isNumber(r)){var l=parseFloat(o)<=parseFloat(n),c=l?"<=":">=",s=Math.abs(parseFloat(r)),u="".concat(t," = ").concat(o),p="".concat(t," ").concat(c," ").concat(n),d="".concat(t," ").concat(l?"+=":"-="," ").concat(s);a="\n        for (".concat(u,"; ").concat(p,"; ").concat(d,") {\n            ").concat(i,"\n        }\n")}else{var y=o;o.match(/^\w+$/)||Blockly.isNumber(o)||(y=Blockly.JavaScript.variableDB_.getDistinctName("".concat(t,"_start"),Blockly.Variables.NAME_TYPE),a="var ".concat(y," = ").concat(o,";\n"));var m=n;n.match(/^\w+$/)||Blockly.isNumber(n)||(m=Blockly.JavaScript.variableDB_.getDistinctName("".concat(t,"_end"),Blockly.Variables.NAME_TYPE),a+="var ".concat(m," = ").concat(n,";\n"));var f=Blockly.JavaScript.variableDB_.getDistinctName("".concat(t,"_inc"),Blockly.Variables.NAME_TYPE),_=Blockly.isNumber(r)?Math.abs(r):"Math.abs(".concat(r,")");a+="\n        var ".concat(f," = ").concat(_,";\n        if (").concat(y," > ").concat(m,") {\n            ").concat(f," = -").concat(f,";\n        }\n        for (\n           ").concat(t," = ").concat(y,"; \n           ").concat(f," >= 0 ? ").concat(t," <= ").concat(m," : ").concat(t," >= ").concat(m,";\n           ").concat(t," += ").concat(f,"\n        ) {\n            ").concat(i,";\n        }\n")}return a},Blockly.Blocks.controls_forEach={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("for each item {{ variable }} in list {{ input_list }}",{variable:"%1",input_list:"%2"}),args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:(0,n.localize)("do %1"),args1:[{type:"input_statement",name:"DO"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Iterates through a given list"),category:Blockly.Categories.Loop}},meta:function(){return{display_name:(0,n.localize)("Iterate (2)"),description:(0,n.localize)('This block uses the variable "i" to control the iterations. With each iteration, the value of "i" is determined by the items in a given list.')}},getRequiredValueInputs:function(){return{LIST:null}}},Blockly.JavaScript.controls_forEach=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),o=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_ASSIGNMENT)||"[]",n=Blockly.JavaScript.statementToCode(e,"DO");n=Blockly.JavaScript.addLoopTrap(n,e.id);var r="",i=o;o.match(/^\w+$/)||(i=Blockly.JavaScript.variableDB_.getDistinctName("".concat(t,"_list"),Blockly.Variables.NAME_TYPE),r="var ".concat(i," = ").concat(o,";\n"));var a=Blockly.JavaScript.variableDB_.getDistinctName("".concat(t,"_list"),Blockly.Variables.NAME_TYPE);return r+"\n    for (var ".concat(a," in ").concat(i,") {\n        ").concat(t," = ").concat(i,"[").concat(a,"];\n        ").concat(n,"\n    }\n")},Blockly.Blocks.controls_flow_statements={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("{{ break_or_continue }} of loop",{break_or_continue:"%1"}),args0:[{type:"field_dropdown",name:"FLOW",options:[[(0,n.localize)("break out"),"BREAK"],[(0,n.localize)("continue with next iteration"),"CONTINUE"]]}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("This block is used to either terminate or continue a loop, and can be placed anywhere within a loop block."),category:Blockly.Categories.Loop}},meta:function(){return{display_name:(0,n.localize)("Break out/continue"),description:(0,n.localize)("This block is used to either terminate or continue a loop, and can be placed anywhere within a loop block.")}}},Blockly.JavaScript.controls_flow_statements=function(e){var t="BREAK"===e.getFieldValue("FLOW")?"break":"continue";return"".concat(t,";\n")},Blockly.Blocks.variables_get={init:function(){this.jsonInit(this.definition())},definition:function(){return{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:(0,n.localize)("item")}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,tooltip:(0,n.localize)("Gets variable value"),category:Blockly.Categories.Variables}},meta:function(){return{display_name:(0,n.localize)("User-defined variable"),description:""}},onchange:function(e){if(e.type===Blockly.Events.VAR_RENAME){var t=this.workspace.getAllBlocks().filter((function(e){return"custom_functions"===e.category_})),o=e.oldName,r=e.newName;t.forEach((function(e){var t;if(null!==(t=e.arguments)&&void 0!==t&&t.length){var i=e.arguments.findIndex((function(e){return e===o}));-1!==i&&(e.arguments[i]=r,e.getField("PARAMS")&&e.setFieldValue("".concat((0,n.localize)("with: ")," ").concat(e.arguments.join(", ")),"PARAMS"),e.getField("WITH")&&e.updateShape())}}))}}},Blockly.JavaScript.variables_get=function(e){return[Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.variables_set={init:function(){this.jsonInit(this.definition())},definition:function(){return{type:"field_variable",message0:(0,n.localize)("set {{ variable }} to {{ value }}",{variable:"%1",value:"%2"}),args0:[{type:"field_variable",name:"VAR",variable:(0,n.localize)("item")},{type:"input_value",name:"VALUE"}],colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Sets variable value"),category:Blockly.Categories.Variables}},meta:function(){return{display_name:(0,n.localize)("Set variable"),description:(0,n.localize)("Assigns a given value to a variable")}}},Blockly.JavaScript.variables_set=function(e){var t=Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",o=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE);return"".concat(o," = ").concat(t,";\n")},Blockly.Blocks.after_purchase={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2 %3",message1:"%1",args0:[{type:"field_image",src:r.DV,width:25,height:25,alt:"F"},{type:"field_label",text:(0,n.localize)("4. Restart trading conditions"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"AFTERPURCHASE_STACK",check:"TradeAgain"}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,n.localize)("Get the last trade information and result, then trade again."),category:Blockly.Categories.After_Purchase}},meta:function(){return{display_name:(0,n.localize)("Restart trading conditions"),description:(0,n.localize)("Here is where you can decide if your bot should continue trading.")}}},Blockly.JavaScript.after_purchase=function(e){var t=Blockly.JavaScript.statementToCode(e,"AFTERPURCHASE_STACK");return"\n    BinaryBotPrivateAfterPurchase = function BinaryBotPrivateAfterPurchase() {\n        Bot.highlightBlock('".concat(e.id,"');\n        ").concat(t,"\n        Bot.isTradeAgain(false);\n        return false;\n    };")};var a=o(9789);Blockly.Blocks.contract_check_result={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Result is {{ win_or_loss }}",{win_or_loss:"%1"}),args0:[{type:"field_dropdown",name:"CHECK_RESULT",options:a.v.lists.CHECK_RESULT}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("True if the result of the last trade matches the selection"),category:Blockly.Categories.After_Purchase}},meta:function(){return{display_name:(0,n.localize)("Last trade result"),description:(0,n.localize)("You can check the result of the last trade with this block.")}},onchange:function(e){if(this.workspace&&!this.isInFlyout&&!this.workspace.isDragging()&&(e.type===Blockly.Events.BLOCK_CREATE||e.type===Blockly.Events.END_DRAG)){var t=this.getTopParent();t&&t.isMainBlock()&&"after_purchase"!==t.type&&this.setDisabled(!0)}}},Blockly.JavaScript.contract_check_result=function(e){var t=e.getFieldValue("CHECK_RESULT");return["Bot.isResult('".concat(t,"')"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.read_details={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Contract Details: {{ contract_detail }}",{contract_detail:"%1"}),args0:[{type:"field_dropdown",name:"DETAIL_INDEX",options:a.v.lists.DETAILS}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Reads a selected property from contract details list"),category:Blockly.Categories.After_Purchase}},meta:function(){return{display_name:(0,n.localize)("Contract details"),description:(0,n.localize)("This block gives you information about your last contract.")}},restricted_parents:["after_purchase"]},Blockly.JavaScript.read_details=function(e){var t=e.getFieldValue("DETAIL_INDEX");return["Bot.readDetails(".concat(t,")"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.trade_again={init:function(){this.jsonInit(this.definition()),this.setNextStatement(!1)},definition:function(){return{message0:(0,n.localize)("Trade again"),colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,tooltip:(0,n.localize)("These blocks transfer control to the Purchase conditions block."),category:Blockly.Categories.After_Purchase}},meta:function(){return{display_name:(0,n.localize)("Trade again"),description:(0,n.localize)("This block will transfer the control back to the Purchase conditions block, enabling you to purchase another contract."),key_words:(0,n.localize)("restart")}},restricted_parents:["after_purchase"]},Blockly.JavaScript.trade_again=function(){return"\n        Bot.isTradeAgain(true);\n\n        return true;\n\n    "},Blockly.Blocks.before_purchase={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2 %3",message1:"%1",args0:[{type:"field_image",src:r.e_,width:25,height:25,alt:"P"},{type:"field_label",text:(0,n.localize)("2. Purchase conditions"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"BEFOREPURCHASE_STACK",check:"Purchase"}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,n.localize)("Specify contract type and purchase conditions."),category:Blockly.Categories.Before_Purchase}},meta:function(){return{display_name:(0,n.localize)("Purchase conditions"),description:(0,n.localize)("This block is mandatory. Only one copy of this block is allowed. You can place the Purchase block (see below) here as well as conditional blocks to define your purchase conditions.")}}},Blockly.JavaScript.before_purchase=function(e){var t=Blockly.JavaScript.statementToCode(e,"BEFOREPURCHASE_STACK");return"BinaryBotPrivateBeforePurchase = function BinaryBotPrivateBeforePurchase() {\n        Bot.highlightBlock('".concat(e.id,"');\n        ").concat(t,"\n    };\n")};var l=o(1319);Blockly.Blocks.purchase={init:function(){this.jsonInit(this.definition()),this.setNextStatement(!1)},definition:function(){return{message0:(0,n.localize)("Purchase {{ contract_type }}",{contract_type:"%1"}),args0:[{type:"field_dropdown",name:"PURCHASE_LIST",options:[["",""]]}],previousStatement:null,colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,tooltip:(0,n.localize)("This block purchases contract of a specified type."),category:Blockly.Categories.Before_Purchase}},meta:function(){return{display_name:(0,n.localize)("Purchase"),description:(0,n.localize)("Use this block to purchase the specific contract you want. You may add multiple Purchase blocks together with conditional blocks to define your purchase conditions. This block can only be used within the Purchase conditions block."),key_words:(0,n.localize)("buy")}},onchange:function(e){!this.workspace||this.isInFlyout||this.workspace.isDragging()||(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id)?this.populatePurchaseList(e):e.type===Blockly.Events.BLOCK_CHANGE?"TYPE_LIST"!==e.name&&"TRADETYPE_LIST"!==e.name||this.populatePurchaseList(e):e.type===Blockly.Events.END_DRAG&&e.blockId===this.id&&""===this.getField("PURCHASE_LIST").menuGenerator_[0][0]&&this.populatePurchaseList(e))},populatePurchaseList:function(e){var t=this.workspace.getTradeDefinitionBlock();if(t){var o=t.getChildByType("trade_definition_tradetype").getFieldValue("TRADETYPE_LIST"),n=t.getChildByType("trade_definition_contracttype").getFieldValue("TYPE_LIST"),r=this.getField("PURCHASE_LIST"),i=r.getValue(),a=(0,l.M)(n,o);r.updateOptions(a,{default_value:i,event_group:e.group,should_pretend_empty:!0})}},restricted_parents:["before_purchase"]},Blockly.JavaScript.purchase=function(e){var t=e.getFieldValue("PURCHASE_LIST");return"Bot.purchase('".concat(t,"');\n")},Blockly.Blocks.ask_price={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Ask Price {{ contract_type }}",{contract_type:"%1"}),args0:[{type:"field_dropdown",name:"PURCHASE_LIST",options:[["",""]]}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block returns the purchase price for the selected trade type."),category:Blockly.Categories.Before_Purchase}},meta:function(){return{display_name:(0,n.localize)("Purchase price"),description:(0,n.localize)('This block returns the purchase price for the selected trade type. This block can be used only in the "Purchase conditions" root block.')}},onchange:Blockly.Blocks.purchase.onchange,populatePurchaseList:Blockly.Blocks.purchase.populatePurchaseList,enforceLimitations:Blockly.Blocks.purchase.enforceLimitations},Blockly.JavaScript.ask_price=function(e){var t=e.getFieldValue("PURCHASE_LIST");return["Bot.getAskPrice('".concat(t,"')"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.payout={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Payout {{ contract_type }}",{contract_type:"%1"}),args0:[{type:"field_dropdown",name:"PURCHASE_LIST",options:[["",""]]}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block returns the potential payout for the selected trade type"),category:Blockly.Categories.Before_Purchase}},meta:function(){return{display_name:(0,n.localize)("Potential payout"),description:(0,n.localize)('This block returns the potential payout for the selected trade type. This block can be used only in the "Purchase conditions" root block.')}},onchange:Blockly.Blocks.purchase.onchange,populatePurchaseList:Blockly.Blocks.purchase.populatePurchaseList,enforceLimitations:Blockly.Blocks.purchase.enforceLimitations},Blockly.JavaScript.payout=function(e){var t=e.getFieldValue("PURCHASE_LIST");return["Bot.getPayout('".concat(t,"')"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.during_purchase={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2 %3",message1:"%1",args0:[{type:"field_image",src:r.dp,width:25,height:25,alt:"S"},{type:"field_label",text:(0,n.localize)("3. Sell conditions"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"DURING_PURCHASE_STACK",check:"SellAtMarket"}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,n.localize)("Sell your active contract if needed (optional)"),category:Blockly.Categories.During_Purchase}},meta:function(){return{display_name:(0,n.localize)("Sell conditions"),description:(0,n.localize)("Here is where you can decide to sell your contract before it expires. Only one copy of this block is allowed.")}}},Blockly.JavaScript.during_purchase=function(e){var t=Blockly.JavaScript.statementToCode(e,"DURING_PURCHASE_STACK");return"BinaryBotPrivateDuringPurchase = function BinaryBotPrivateDuringPurchase() {\n        Bot.highlightBlock('".concat(e.id,"');\n        ").concat(t,"\n    };\n")},Blockly.Blocks.sell_at_market={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Sell at market price"),colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Use this block to sell your contract at the market price."),category:Blockly.Categories.During_Purchase}},meta:function(){return{display_name:(0,n.localize)("Sell at market price"),description:(0,n.localize)("Use this block to sell your contract at the market price.")}},restricted_parents:["during_purchase"]},Blockly.JavaScript.sell_at_market=function(){return"Bot.sellAtMarket();\n"},Blockly.Blocks.check_sell={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Sell is available"),output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("True if active contract can be sold before expiration at current market price"),category:Blockly.Categories.During_Purchase}},meta:function(){return{display_name:(0,n.localize)("Can contract be sold?"),description:(0,n.localize)("This block helps you check if your contract can be sold. If your contract can be sold, it returns “True”. Otherwise, it returns an empty string.")}},restricted_parents:["during_purchase"]},Blockly.JavaScript.check_sell=function(){return["Bot.isSellAvailable()",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.sell_price={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Sell profit/loss"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns the profit/loss from selling at market price"),category:Blockly.Categories.During_Purchase}},meta:function(){return{display_name:(0,n.localize)("Profit/loss from selling"),description:(0,n.localize)("This block gives you the potential profit or loss if you decide to sell your contract.")}},restricted_parents:["during_purchase"]},Blockly.JavaScript.sell_price=function(){return["Bot.getSellPrice()",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.bb_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period","std_dev_multiplier_up","std_dev_multiplier_down"],init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("set {{ variable }} to Bollinger Bands {{ band_type }} {{ dummy }}",{variable:"%1",band_type:"%2",dummy:"%3"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"bb"},{type:"field_dropdown",name:"BBRESULT_LIST",options:a.v.bbResult},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Calculates Bollinger Bands (BB) from a list with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}},meta:function(){return{display_name:(0,n.localize)("Bollinger Bands (BB)"),description:(0,n.localize)("BB is a technical analysis indicator that’s commonly used by traders. The idea behind BB is that the market price stays within the upper and lower bands for 95% of the time. The bands are the standard deviations of the market price, while the line in the middle is a simple moving average line. If the price reaches either the upper or lower band, there’s a possibility of a trend reversal.")}},onchange:function(e){var t=this;!this.workspace||this.isInFlyout||this.workspace.isDragging()||e.type===Blockly.Events.END_DRAG&&this.getBlocksInStatement("STATEMENT").forEach((function(e){t.required_child_blocks.includes(e.type)||(Blockly.Events.disable(),e.unplug(!1),Blockly.Events.enable())}))}},Blockly.JavaScript.bb_statement=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.getFieldValue("BBRESULT_LIST"),n=e.childValueToCode("input_list","INPUT_LIST"),r=e.childValueToCode("period","PERIOD"),i=e.childValueToCode("std_dev_multiplier_up","UPMULTIPLIER"),a=e.childValueToCode("std_dev_multiplier_down","DOWNMULTIPLIER");return"".concat(t," = Bot.bb(").concat(n,", { \n        periods: ").concat(r,", \n        stdDevUp: ").concat(i,", \n        stdDevDown: ").concat(a," \n    }, ").concat(o,");\n")},Blockly.Blocks.bba_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period","std_dev_multiplier_up","std_dev_multiplier_down"],init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("set {{ variable }} to Bollinger Bands Array {{ band_type }} {{ dummy }}",{variable:"%1",band_type:"%2",dummy:"%3"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"bba"},{type:"field_dropdown",name:"BBRESULT_LIST",options:a.v.bbResult},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Calculates Bollinger Bands (BB) list from a list with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}},meta:function(){return{display_name:(0,n.localize)("Bollinger Bands Array (BBA)"),description:(0,n.localize)("Similar to BB. This block gives you a choice of returning the values of either the lower band, higher band, or the SMA line in the middle.")}},onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.bba_statement=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.getFieldValue("BBRESULT_LIST"),n=e.childValueToCode("input_list","INPUT_LIST"),r=e.childValueToCode("period","PERIOD"),i=e.childValueToCode("std_dev_multiplier_up","UPMULTIPLIER"),a=e.childValueToCode("std_dev_multiplier_down","DOWNMULTIPLIER");return"".concat(t," = Bot.bba(").concat(n,", { \n        periods: ").concat(r,", \n        stdDevUp: ").concat(i,", \n        stdDevDown: ").concat(a," \n    }, ").concat(o,");\n")},Blockly.Blocks.ema_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period"],init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("set {{ variable }} to Exponential Moving Average {{ dummy }}",{variable:"%1",dummy:"%2"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"ema"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Calculates Exponential Moving Average (EMA) from a list with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}},meta:function(){return{display_name:(0,n.localize)("Exponential Moving Average (EMA)"),description:(0,n.localize)("EMA is a type of moving average that places more significance on the most recent data points. It’s also known as the exponentially weighted moving average. EMA is different from SMA in that it reacts more significantly to recent price changes.")}},onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.ema_statement=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.childValueToCode("input_list","INPUT_LIST"),n=e.childValueToCode("period","PERIOD");return"".concat(t," = Bot.ema(").concat(o,", ").concat(n,");\n")},Blockly.Blocks.emaa_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period"],init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("set {{ variable }} to Exponential Moving Average Array {{ dummy }}",{variable:"%1",dummy:"%2"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"emaa"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Calculates Exponential Moving Average (EMA) list from a list of values with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}},meta:function(){return{display_name:(0,n.localize)("Exponential Moving Average Array (EMAA)"),description:(0,n.localize)("This block is similar to EMA, except that it gives you the entire EMA line based on the input list and the given period.")}},onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.emaa_statement=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.childValueToCode("input_list","INPUT_LIST"),n=e.childValueToCode("period","PERIOD");return"".concat(t," = Bot.emaa(").concat(o,", ").concat(n,");\n")},Blockly.Blocks.rsi_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period"],init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("set {{ variable }} to Relative Strength Index {{ dummy }}",{variable:"%1",dummy:"%2"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"rsi"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Relative Strength Index (RSI) from a list with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}},meta:function(){return{display_name:(0,n.localize)("Relative Strength Index (RSI)"),description:(0,n.localize)("RSI is a technical analysis tool that helps you identify the market trend. It will give you a value from 0 to 100. An RSI value of 70 and above means that the asset is overbought and the current trend may reverse, while a value of 30 and below means that the asset is oversold.")}},onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.rsi_statement=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.childValueToCode("input_list","INPUT_LIST"),n=e.childValueToCode("period","PERIOD");return"".concat(t," = Bot.rsi(").concat(o,", ").concat(n,");\n")},Blockly.Blocks.rsia_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period"],init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("set {{ variable }} to Relative Strength Index Array {{ dummy }}",{variable:"%1",dummy:"%2"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"rsia"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Calculates Relative Strength Index (RSI) list from a list of values with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}},meta:function(){return{display_name:(0,n.localize)("Relative Strength Index Array (RSIA)"),description:(0,n.localize)("Similar to RSI, this block gives you a list of values for each entry in the input list.")}},onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.rsia_statement=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.childValueToCode("input_list","INPUT_LIST"),n=e.childValueToCode("period","PERIOD");return"".concat(t," = Bot.rsia(").concat(o,", ").concat(n,");\n")},Blockly.Blocks.sma_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period"],init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("set {{ variable }} to Simple Moving Average {{ dummy }}",{variable:"%1",dummy:"%2"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"sma"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Calculates Simple Moving Average (SMA) from a list with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}},meta:function(){return{display_name:(0,n.localize)("Simple Moving Average (SMA)"),description:(0,n.localize)("SMA is a frequently used indicator in technical analysis. It calculates the average market price over a specified period, and is usually used to identify market trend direction: up or down. For example, if the SMA is moving upwards, it means the market trend is up. ")}},onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.sma_statement=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.childValueToCode("input_list","INPUT_LIST"),n=e.childValueToCode("period","PERIOD");return"".concat(t," = Bot.sma(").concat(o,", ").concat(n,");\n")},Blockly.Blocks.smaa_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period"],init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("set {{ variable }} to Simple Moving Average Array {{ dummy }}",{variable:"%1",dummy:"%2"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"smaa"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Calculates Simple Moving Average line from a list with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}},meta:function(){return{display_name:(0,n.localize)("Simple Moving Average Array (SMAA)"),description:(0,n.localize)("Similar to SMA, this block gives you the entire SMA line containing a list of all values for a given period.")}},onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.smaa_statement=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.childValueToCode("input_list","INPUT_LIST"),n=e.childValueToCode("period","PERIOD");return"".concat(t," = Bot.smaa(").concat(o,", ").concat(n,");\n")},Blockly.Blocks.macda_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","fast_ema_period","slow_ema_period","signal_ema_period"],init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("set {{ variable }} to MACD Array {{ dropdown }} {{ dummy }}",{variable:"%1",dropdown:"%2",dummy:"%3"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"macda"},{type:"field_dropdown",name:"MACDFIELDS_LIST",options:a.v.macdFields},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Calculates Moving Average Convergence Divergence (MACD) from a list"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}},meta:function(){return{display_name:(0,n.localize)("Moving Average Convergence Divergence"),description:(0,n.localize)("MACD is calculated by subtracting the long-term EMA (26 periods) from the short-term EMA (12 periods). If the short-term EMA is greater or lower than the long-term EMA than there’s a possibility of a trend reversal.")}},onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.macda_statement=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.getFieldValue("MACDFIELDS_LIST"),n=e.childValueToCode("input_list","INPUT_LIST"),r=e.childValueToCode("fast_ema_period","FAST_EMA_PERIOD"),i=e.childValueToCode("slow_ema_period","SLOW_EMA_PERIOD"),a=e.childValueToCode("signal_ema_period","SIGNAL_EMA_PERIOD");return"".concat(t," = Bot.macda(").concat(n,", { \n        fastEmaPeriod: ").concat(r,",\n        slowEmaPeriod: ").concat(i,",\n        signalEmaPeriod: ").concat(a,",\n    }, ").concat(o,");\n")},Blockly.Blocks.input_list={init:function(){this.jsonInit({message0:(0,n.localize)("Input List {{ input_list }}",{input_list:"%1"}),args0:[{type:"input_value",name:"INPUT_LIST",check:"Array"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:function(e){var t=this;if(this.workspace&&!this.isInFlyout&&!this.workspace.isDragging()){var o=function(){var e=t.getSurroundParent();e&&!t.required_parent_id&&t.allowed_parents.includes(e.type)&&(t.required_parent_id=e.id)};if(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id))o();else if(e.type===Blockly.Events.END_DRAG){o();var n=this.getSurroundParent(),r=!!n,a=!r||n.id!==this.required_parent_id;r&&!a||(0,i.$9)((function(){t.unplug(!0);var e=t.workspace.getAllBlocks().find((function(e){return e.id===t.required_parent_id}));e?e.getLastConnectionInStatement("STATEMENT").connect(t.previousConnection):t.dispose()}))}}},allowed_parents:["bb_statement","bba_statement","ema_statement","emaa_statement","macda_statement","rsi_statement","rsia_statement","sma_statement","smaa_statement"],getRequiredValueInputs:function(){return{INPUT_LIST:null}}},Blockly.JavaScript.input_list=function(){},Blockly.Blocks.period={init:function(){this.jsonInit({message0:(0,n.localize)("Period {{ input_period }}",{input_period:"%1"}),args0:[{type:"input_value",name:"PERIOD",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:Blockly.Blocks.input_list.onchange,allowed_parents:["bb_statement","bba_statement","ema_statement","emaa_statement","macda_statement","rsi_statement","rsia_statement","sma_statement","smaa_statement"],getRequiredValueInputs:function(){return{PERIOD:null}}},Blockly.JavaScript.period=function(){},Blockly.Blocks.std_dev_multiplier_up={init:function(){this.jsonInit({message0:(0,n.localize)("Standard Deviation Up Multiplier {{ input_number }}",{input_number:"%1"}),args0:[{type:"input_value",name:"UPMULTIPLIER",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:Blockly.Blocks.input_list.onchange,allowed_parents:["bb_statement","bba_statement"],getRequiredValueInputs:function(){return{UPMULTIPLIER:null}}},Blockly.JavaScript.std_dev_multiplier_up=function(){},Blockly.Blocks.std_dev_multiplier_down={init:function(){this.jsonInit({message0:(0,n.localize)("Standard Deviation Down Multiplier {{ input_number }}",{input_number:"%1"}),args0:[{type:"input_value",name:"DOWNMULTIPLIER",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:Blockly.Blocks.input_list.onchange,allowed_parents:["bb_statement","bba_statement"],getRequiredValueInputs:function(){return{DOWNMULTIPLIER:null}}},Blockly.JavaScript.std_dev_multiplier_down=function(){},Blockly.Blocks.fast_ema_period={init:function(){this.jsonInit({message0:(0,n.localize)("Fast EMA Period {{ input_number }}",{input_number:"%1"}),args0:[{type:"input_value",name:"FAST_EMA_PERIOD",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:Blockly.Blocks.input_list.onchange,allowed_parents:["macda_statement"],getRequiredValueInputs:function(){return{FAST_EMA_PERIOD:null}}},Blockly.JavaScript.fast_ema_period=function(){},Blockly.Blocks.slow_ema_period={init:function(){this.jsonInit({message0:(0,n.localize)("Slow EMA Period {{ input_number }}",{input_number:"%1"}),args0:[{type:"input_value",name:"SLOW_EMA_PERIOD",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:Blockly.Blocks.input_list.onchange,allowed_parents:["macda_statement"],getRequiredValueInputs:function(){return{SLOW_EMA_PERIOD:null}}},Blockly.JavaScript.slow_ema_period=function(){},Blockly.Blocks.signal_ema_period={init:function(){this.jsonInit({message0:(0,n.localize)("Signal EMA Period {{ input_number }}",{input_number:"%1"}),args0:[{type:"input_value",name:"SIGNAL_EMA_PERIOD",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:Blockly.Blocks.input_list.onchange,allowed_parents:["macda_statement"],getRequiredValueInputs:function(){return{SIGNAL_EMA_PERIOD:null}}},Blockly.JavaScript.signal_ema_period=function(){},Blockly.Blocks.tick={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Last Tick"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns the value of the last tick"),category:Blockly.Categories.Tick_Analysis}},meta:function(){return{display_name:(0,n.localize)("Last tick"),description:(0,n.localize)("This block gives you the value of the last tick.")}}},Blockly.Blocks.tick_string={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Last Tick String"),output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns the value of the latest tick in string format"),category:Blockly.Categories.Tick_Analysis}},meta:function(){return{display_name:(0,n.localize)("Tick value"),description:(0,n.localize)("Tick value Description")}},onchange:Blockly.Blocks.tick.onchange},Blockly.JavaScript.tick=function(){return["Bot.getLastTick(false, false)",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.tick_string=function(){return["Bot.getLastTick(false, true)",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.ticks={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Ticks list"),output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block gives you a list of the last 1000 tick values."),category:Blockly.Categories.Tick_Analysis}},meta:function(){return{display_name:(0,n.localize)("Tick list"),description:(0,n.localize)("This block gives you a list of the last 1000 tick values.")}}},Blockly.Blocks.ticks_string={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Ticks String List"),output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns the list of tick values in string format"),category:Blockly.Categories.Tick_Analysis}},meta:function(){return{display_name:(0,n.localize)("Tick List String"),description:(0,n.localize)("Tick List String Description")}},onchange:Blockly.Blocks.ticks.onchange},Blockly.JavaScript.ticks=function(){return["Bot.getTicks(false)",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.ticks_string=function(){return["Bot.getTicks(true)",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.ohlc={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Candles List"),message1:(0,n.localize)("with interval: {{ candle_interval_type }}",{candle_interval_type:"%1"}),args1:[{type:"field_dropdown",name:"CANDLEINTERVAL_LIST",options:a.v.candleIntervals}],output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block gives you a list of candles within a selected time interval."),category:Blockly.Categories.Tick_Analysis}},meta:function(){return{display_name:(0,n.localize)("Get candle list"),description:(0,n.localize)("This block gives you a list of candles within a selected time interval.")}}},Blockly.JavaScript.ohlc=function(e){var t=e.getFieldValue("CANDLEINTERVAL_LIST");return["Bot.getOhlc({ granularity: ".concat("default"===t?"undefined":t," })"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.ohlc_values={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Make a List of {{ candle_property }} values in candles list with interval: {{ candle_interval_type }}",{candle_property:"%1",candle_interval_type:"%2"}),args0:[{type:"field_dropdown",name:"OHLCFIELD_LIST",options:a.v.ohlcFields},{type:"field_dropdown",name:"CANDLEINTERVAL_LIST",options:a.v.candleIntervals}],output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns a list of specific values from a candle list according to selected time interval"),category:Blockly.Categories.Tick_Analysis}},meta:function(){return{display_name:(0,n.localize)("Create a list of candle values (1)"),description:(0,n.localize)("This block gives you the selected candle value from a list of candles within the selected time interval.")}}},Blockly.JavaScript.ohlc_values=function(e){var t=e.getFieldValue("CANDLEINTERVAL_LIST"),o="default"===t?"undefined":t,n=e.getFieldValue("OHLCFIELD_LIST");return["Bot.getOhlc({ field: '".concat(n,"', granularity: ").concat(o," })"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.read_ohlc={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("In candles list read {{ candle_property }} # from end {{ input_number }}",{candle_property:"%1",input_number:"%2"}),message1:(0,n.localize)("with interval: %1"),args0:[{type:"field_dropdown",name:"OHLCFIELD_LIST",options:a.v.ohlcFields},{type:"input_value",name:"CANDLEINDEX",check:"Number"}],args1:[{type:"field_dropdown",name:"CANDLEINTERVAL_LIST",options:a.v.candleIntervals}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Read the selected candle value"),category:Blockly.Categories.Tick_Analysis}},meta:function(){return{display_name:(0,n.localize)("Read candle value (1)"),description:(0,n.localize)("This block gives you the specified candle value for a selected time interval.")}},getRequiredValueInputs:function(){return{CANDLEINDEX:null}}},Blockly.JavaScript.read_ohlc=function(e){var t=e.getFieldValue("CANDLEINTERVAL_LIST"),o="default"===t?"undefined":t,n=e.getFieldValue("OHLCFIELD_LIST"),r=Blockly.JavaScript.valueToCode(e,"CANDLEINDEX",Blockly.JavaScript.ORDER_ATOMIC)||"1";return["Bot.getOhlcFromEnd({ field: '".concat(n,"', index: ").concat(r,", granularity: ").concat(o," })"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.get_ohlc={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("in candle list get # from end {{ input_number }}",{input_number:"%1"}),message1:(0,n.localize)("with interval: {{ candle_interval_type }}",{candle_interval_type:"%1"}),args0:[{type:"input_value",name:"CANDLEINDEX",check:"Number"}],args1:[{type:"field_dropdown",name:"CANDLEINTERVAL_LIST",options:a.v.candleIntervals}],output:"Candle",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block gives you a specific candle from within the selected time interval."),category:Blockly.Categories.Tick_Analysis}},meta:function(){return{display_name:(0,n.localize)("Get candle"),description:(0,n.localize)("This block gives you a specific candle from within the selected time interval.")}},getRequiredValueInputs:function(){return{CANDLEINDEX:null}}},Blockly.JavaScript.get_ohlc=function(e){var t=e.getFieldValue("CANDLEINTERVAL_LIST"),o="default"===t?"undefined":t,n=Blockly.JavaScript.valueToCode(e,"CANDLEINDEX",Blockly.JavaScript.ORDER_ATOMIC)||"1";return["Bot.getOhlcFromEnd({ index: ".concat(n,", granularity: ").concat(o," })"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.check_direction={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Direction is {{ direction_type }}",{direction_type:"%1"}),args0:[{type:"field_dropdown",name:"CHECK_DIRECTION",options:a.v.lists.CHECK_DIRECTION}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("True if the market direction matches the selection"),category:Blockly.Categories.Tick_Analysis}},meta:function(){return{display_name:(0,n.localize)("Market direction"),description:(0,n.localize)("This block is used to determine if the market price moves in the selected direction or not. It gives you a value of “True” or “False”.")}}},Blockly.JavaScript.check_direction=function(e){var t=e.getFieldValue("CHECK_DIRECTION");return["Bot.checkDirection('".concat(t,"')"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.tick_analysis={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2 %3",args0:[{type:"field_label",text:(0,n.localize)("The content of this block is called on every tick"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"},{type:"input_statement",name:"TICKANALYSIS_STACK",check:null}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,n.localize)("You can use this block to analyze the ticks, regardless of your trades"),category:Blockly.Categories.Tick_Analysis}},meta:function(){return{display_name:(0,n.localize)("Run on every tick"),description:(0,n.localize)("The content of this block is called on every tick. Place this block outside of any root block.")}}},Blockly.JavaScript.tick_analysis=function(e){var t=Blockly.JavaScript.statementToCode(e,"TICKANALYSIS_STACK")||"";return"\n    BinaryBotPrivateTickAnalysisList.push(function BinaryBotPrivateTickAnalysis() {\n        ".concat(t,"\n    });\n")},Blockly.Blocks.last_digit={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Last Digit"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns the last digit of the latest tick"),category:Blockly.Categories.Tick_Analysis}},meta:function(){return{display_name:(0,n.localize)("Last Digit"),description:(0,n.localize)("This block gives you the last digit of the latest tick value.")}}},Blockly.JavaScript.last_digit=function(){return["Bot.getLastDigit()",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.lastDigitList={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Last digits list"),output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns the list of last digits of 1000 recent tick values"),category:Blockly.Categories.Tick_Analysis}},meta:function(){return{display_name:(0,n.localize)("Last Digits List"),description:(0,n.localize)("This block gives you a list of the last digits of the last 1000 tick values.")}}},Blockly.JavaScript.lastDigitList=function(){return["Bot.getLastDigitList()",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.is_candle_black={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Is candle {{ input_candle }} black?",{input_candle:"%1"}),args0:[{type:"input_value",name:"OHLCOBJ",check:"Candle"}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)('Returns "True" if the given candle is black'),category:Blockly.Categories.Candle}},meta:function(){return{display_name:(0,n.localize)("Is candle black?"),description:(0,n.localize)("This block returns “True” if the last candle is black. It can be placed anywhere on the canvas except within the Trade parameters root block.")}},getRequiredValueInputs:function(){return{OHLCOBJ:null}}},Blockly.JavaScript.is_candle_black=function(e){var t=Blockly.JavaScript.valueToCode(e,"OHLCOBJ",Blockly.JavaScript.ORDER_ATOMIC)||"{}";return["Bot.isCandleBlack(".concat(t,")"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.ohlc_values_in_list={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Make a list of {{ candle_property }} values from candles list {{ candle_list }}",{candle_property:"%1",candle_list:"%2"}),args0:[{type:"field_dropdown",name:"OHLCFIELD_LIST",options:a.v.ohlcFields},{type:"input_value",name:"OHLCLIST"}],output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns a list of specific values from a given candle list"),category:Blockly.Categories.Candle}},meta:function(){return{display_name:(0,n.localize)("Create a list of candle values (2)"),description:(0,n.localize)("This block gives you the selected candle value from a list of candles.")}},getRequiredValueInputs:function(){return{OHLCLIST:null}}},Blockly.JavaScript.ohlc_values_in_list=function(e){var t=e.getFieldValue("OHLCFIELD_LIST")||"open",o=Blockly.JavaScript.valueToCode(e,"OHLCLIST",Blockly.JavaScript.ORDER_ATOMIC)||"[]";return["Bot.candleValues(".concat(o,", '").concat(t,"')"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.read_ohlc_obj={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Read {{ candle_property }} value in candle {{ input_candle }}",{candle_property:"%1",input_candle:"%2"}),args0:[{type:"field_dropdown",name:"OHLCFIELD_LIST",options:a.v.ohlcFields},{type:"input_value",name:"OHLCOBJ"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block gives you the selected candle value."),category:Blockly.Categories.Candle}},meta:function(){return{display_name:(0,n.localize)("Read candle value (2)"),description:(0,n.localize)("This block gives you the selected candle value.")}},getRequiredValueInputs:function(){return{OHLCOBJ:null}}},Blockly.JavaScript.read_ohlc_obj=function(e){var t=e.getFieldValue("OHLCFIELD_LIST"),o=Blockly.JavaScript.valueToCode(e,"OHLCOBJ",Blockly.JavaScript.ORDER_ATOMIC)||"{}";return["Bot.candleField(".concat(o,", '").concat(t,"')"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.balance={init:function(){var e=this;this.jsonInit(this.definition()),this.getField("BALANCE_TYPE").setValidator((function(t){"STR"===t?e.setOutput(!0,"String"):"NUM"===t&&e.setOutput(!0,"Number"),e.initSvg(),e.render(!1)}))},definition:function(){return{message0:(0,n.localize)("Balance: %1"),args0:[{type:"field_dropdown",name:"BALANCE_TYPE",options:a.v.lists.BALANCE_TYPE}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block returns account balance"),category:Blockly.Categories.Miscellaneous}},meta:function(){return{display_name:(0,n.localize)("Account balance"),description:(0,n.localize)("This block gives you the balance of your account either as a number or a string of text.")}}},Blockly.JavaScript.balance=function(e){var t=e.getFieldValue("BALANCE_TYPE");return["Bot.getBalance('".concat(t,"')"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.barrier_offset={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_dropdown",name:"BARRIEROFFSET_IN",options:a.v.BARRIER_TYPES}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Adds a sign to a number to create a barrier offset. (deprecated)"),category:Blockly.Categories.Miscellaneous})}},Blockly.JavaScript.barrier_offset=function(){},Blockly.Blocks.block_holder={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2 %3",args0:[{type:"field_label",text:"Ignore",class:"blocklyTextRootBlockHeader"},{type:"input_dummy"},{type:"input_statement",name:"USELESS_STACK",check:null}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,n.localize)("Put your blocks in here to prevent them from being removed"),category:Blockly.Categories.Miscellaneous}},meta:function(){return{display_name:(0,n.localize)("Ignore"),description:(0,n.localize)("Use this block if you want some instructions to be ignored when your bot runs. Instructions within this block won’t be executed.")}}},Blockly.JavaScript.block_holder=function(){return""};var c=o(8421),s=o(7103);Blockly.Blocks.loader={init:function(){this.blocks_added_by_me=[],this.current_url="",this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Load block from URL: {{ input_url }}",{input_url:"%1"}),args0:[{type:"field_input",name:"URL",text:"http://www.example.com/block.xml"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Loads blocks from URL"),category:Blockly.Categories.Miscellaneous}},meta:function(){return{display_name:(0,n.localize)("Loads from URL"),description:(0,n.localize)("This block allows you to load blocks from a URL if you have them stored on a remote server, and they will be loaded only when your bot runs.")}},onchange:function(e){var t=this;this.workspace&&!this.isInFlyout&&(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id)?(this.current_url=this.getFieldValue("URL"),this.workspace.getAllBlocks().filter((function(e){return"loader"===e.type})).forEach((function(e){e.id!==t.id&&e.current_url===t.current_url&&t.setDisabled(!0)})),this.disabled||this.loadBlocksFromCurrentUrl()):e.type===Blockly.Events.BLOCK_CHANGE&&e.blockId===this.id&&e.newValue&&e.oldValue!==e.newValue&&(e.newValue===this.current_url?this.setDisabled(!1):this.isValidUrl(e.newValue)&&!this.isKnownUrl(e.newValue)?(this.setDisabled(!1),this.loadBlocksFromCurrentUrl()):this.setDisabled(!0)))},loadBlocksFromCurrentUrl:function(){var e=this;this.current_url=this.getFieldValue("URL"),(0,i.$9)((function(){e.blocks_added_by_me.forEach((function(e){return e.dispose()}))})),(0,i.oG)(this).then((function(){c.P.emit("ui.log.success",{log_type:s.F$.LOAD_BLOCK})})).catch((function(t){c.P.emit("ui.log.error",t),e.setDisabled(!0)}))},isKnownUrl:function(e){var t=this;return this.workspace.getAllBlocks().filter((function(e){return"loader"===e.type})).some((function(o){return o.id!==t.id&&o.current_url===e}))},isValidUrl:function(e){return String(e).match(/[^/]*\.[a-zA-Z]{3}$/)}},Blockly.JavaScript.loader=function(){},Blockly.Blocks.notify={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Notify {{ notification_type }} with sound: {{ notification_sound }} {{ input_message }}",{notification_type:"%1",notification_sound:"%2",input_message:"%3"}),args0:[{type:"field_dropdown",name:"NOTIFICATION_TYPE",options:a.v.lists.NOTIFICATION_TYPE},{type:"field_dropdown",name:"NOTIFICATION_SOUND",options:a.v.lists.NOTIFICATION_SOUND},{type:"input_value",name:"MESSAGE",check:null}],colour:Blockly.Colours.Special3.colour,colourSecondary:Blockly.Colours.Special3.colourSecondary,colourTertiary:Blockly.Colours.Special3.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Displays a notification and optionally play selected sound"),category:Blockly.Categories.Miscellaneous}},meta:function(){return{display_name:(0,n.localize)("Notify"),description:(0,n.localize)("This block displays a message. You can specify the color of the message and choose from 6 different sound options.")}},getRequiredValueInputs:function(){return{MESSAGE:i.cM}}},Blockly.JavaScript.notify=function(e){var t=e.getFieldValue("NOTIFICATION_TYPE"),o=e.getFieldValue("NOTIFICATION_SOUND"),r=e.getInputTargetBlock("MESSAGE"),i=null;if("variables_get"===r.type){var a=r.getFieldValue("VAR");i=Blockly.derivWorkspace.getVariableById(a).name}var l=Blockly.JavaScript.valueToCode(e,"MESSAGE",Blockly.JavaScript.ORDER_ATOMIC)||'"'.concat((0,n.localize)("<empty message>"),'"');return"Bot.notify({ className: 'journal__text--".concat(t,"', message: ").concat(l,", sound: '").concat(o,"', block_id: '").concat(e.id,"', variable_name: '").concat(i,"' });\n")},Blockly.Blocks.notify_telegram={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Notify Telegram {{ dummy }} Access Token: {{ input_access_token }} Chat ID: {{ input_chat_id }} Message: {{ input_message }}",{dummy:"%1",input_access_token:"%2",input_chat_id:"%3",input_message:"%4"}),args0:[{type:"input_dummy"},{type:"input_value",name:"TELEGRAM_ACCESS_TOKEN"},{type:"input_value",name:"TELEGRAM_CHAT_ID"},{type:"input_value",name:"TELEGRAM_MESSAGE"}],colour:Blockly.Colours.Special3.colour,colourSecondary:Blockly.Colours.Special3.colourSecondary,colourTertiary:Blockly.Colours.Special3.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Sends a message to Telegram"),category:Blockly.Categories.Miscellaneous}},meta:function(){return{display_name:(0,n.localize)("Notify Telegram"),description:(0,n.localize)("This block sends a message to a Telegram channel.")}},getRequiredValueInputs:function(){return{TELEGRAM_ACCESS_TOKEN:i.cM,TELEGRAM_CHAT_ID:i.cM,TELEGRAM_MESSAGE:i.cM}}},Blockly.JavaScript.notify_telegram=function(e){var t=Blockly.JavaScript.valueToCode(e,"TELEGRAM_ACCESS_TOKEN",Blockly.JavaScript.ORDER_ATOMIC)||"",o=Blockly.JavaScript.valueToCode(e,"TELEGRAM_CHAT_ID",Blockly.JavaScript.ORDER_ATOMIC)||"",n=Blockly.JavaScript.valueToCode(e,"TELEGRAM_MESSAGE",Blockly.JavaScript.ORDER_ATOMIC)||"";return t&&o&&n?"Bot.notifyTelegram(".concat(t,", ").concat(o,", ").concat(n,");\n"):""},Blockly.Blocks.total_profit={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Total profit/loss"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns the total profit/loss"),category:Blockly.Categories.Miscellaneous}},meta:function(){return{display_name:(0,n.localize)("Total profit/loss"),description:(0,n.localize)("This block gives you the total profit/loss of your trading strategy since your bot started running. You can reset this by clicking “Clear stats” on the Transaction Stats window, or by refreshing this page in your browser.")}},onchange:function(e){!this.workspace||this.isInFlyout||this.workspace.isDragging()||(e.type===Blockly.Events.END_DRAG||e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id))&&"INITIALIZATION"===this.getRootInputTargetBlock()&&this.unplug(!0)}},Blockly.Blocks.total_profit_string={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Total Profit String"),output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns the total profit in string format"),category:Blockly.Categories.Miscellaneous}},meta:function(){return{display_name:(0,n.localize)("Total Profit String"),description:(0,n.localize)("Total Profit String Description")}},onchange:Blockly.Blocks.total_profit.onchange},Blockly.JavaScript.total_profit=function(){return["Bot.getTotalProfit(false)",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.total_profit_string=function(){return["Bot.getTotalProfit(true)",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.total_runs={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Number of runs"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns the number of runs"),category:Blockly.Categories.Miscellaneous}},meta:function(){return{display_name:(0,n.localize)("Number of runs"),description:(0,n.localize)("This block gives you the total number of times your bot has run. You can reset this by clicking “Clear stats” on the Transaction Stats window, or by refreshing this page in your browser.")}},onchange:Blockly.Blocks.total_profit.onchange},Blockly.JavaScript.total_runs=function(){return["Bot.getTotalRuns()",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.useless_block={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_label",text:(0,n.localize)("Conversion Helper Block"),class:"blocklyTextRootBlockHeader"}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,n.localize)("This block was required to correctly convert your old strategy."),category:Blockly.Categories.Miscellaneous,nextStatement:null,previousStatement:null})}},Blockly.JavaScript.useless_block=function(){},Blockly.Blocks.console={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Console {{ message_type }} value: {{ input_message }}",{message_type:"%1",input_message:"%2"}),args0:[{type:"field_dropdown",name:"CONSOLE_TYPE",options:[[(0,n.localize)("Log"),"log"],[(0,n.localize)("Warn"),"warn"],[(0,n.localize)("Error"),"error"],[(0,n.localize)("Table"),"table"]]},{type:"input_value",name:"MESSAGE",check:null}],colour:Blockly.Colours.Special3.colour,colourSecondary:Blockly.Colours.Special3.colourSecondary,colourTertiary:Blockly.Colours.Special3.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Display messages in the developer’s console."),category:Blockly.Categories.Miscellaneous}},meta:function(){return{display_name:(0,n.localize)("Console"),description:(0,n.localize)("This block displays messages in the developer's console with an input that can be either a string of text, a number, boolean, or an array of data.")}},getRequiredValueInputs:function(){return{MESSAGE:i.cM}}},Blockly.JavaScript.console=function(e){var t=e.getFieldValue("CONSOLE_TYPE")||"log",o=Blockly.JavaScript.valueToCode(e,"MESSAGE",Blockly.JavaScript.ORDER_ATOMIC)||'"'.concat((0,n.localize)("<empty message>"),'"');return"Bot.console({ type: '".concat(t,"', message: ").concat(o,"});\n")},Blockly.Blocks.epoch={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Seconds Since Epoch"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns the number of seconds since January 1st, 1970"),category:Blockly.Categories.Time}},meta:function(){return{display_name:(0,n.localize)("Second Since Epoch"),description:(0,n.localize)("This block returns the number of seconds since January 1st, 1970.")}}},Blockly.JavaScript.epoch=function(){return["Bot.getTime()",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.timeout={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("{{ dummy }} {{ stack_input }} Run after {{ number }} second(s)",{dummy:"%1",stack_input:"%2",number:"%3"}),args0:[{type:"input_dummy"},{type:"input_statement",name:"TIMEOUTSTACK"},{type:"input_value",name:"SECONDS"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Run the blocks inside after a given number of seconds"),category:Blockly.Categories.Time}},meta:function(){return{display_name:(0,n.localize)("Delayed run"),description:(0,n.localize)("This block delays execution for a given number of seconds. You can place any blocks within this block. The execution of other blocks in your strategy will be paused until the instructions in this block are carried out.")}},getRequiredValueInputs:function(){return{SECONDS:null}}},Blockly.JavaScript.timeout=function(e){var t=Blockly.JavaScript.statementToCode(e,"TIMEOUTSTACK"),o=Blockly.JavaScript.valueToCode(e,"SECONDS",Blockly.JavaScript.ORDER_ATOMIC)||"1";return"sleep(".concat(o,");\n").concat(t,"\n")},Blockly.Blocks.todatetime={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("To date/time {{ input_timestamp }} {{ dummy }}",{input_timestamp:"%1",dummy:"%2"}),args0:[{type:"input_value",name:"TIMESTAMP",check:"Number"},{type:"input_dummy"}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block converts the number of seconds since the Unix Epoch (1 January 1970) into a string of text representing the date and time."),category:Blockly.Categories.Time}},meta:function(){return{display_name:(0,n.localize)("Convert to date/time"),description:(0,n.localize)("This block converts the number of seconds since the Unix Epoch (1 January 1970) into a string of text representing the date and time.")}},getRequiredValueInputs:function(){return{TIMESTAMP:null}}},Blockly.JavaScript.todatetime=function(e){var t=Blockly.JavaScript.valueToCode(e,"TIMESTAMP",Blockly.JavaScript.ORDER_ATOMIC),o="".concat((0,n.localize)("Invalid timestamp"),":"),r=Blockly.JavaScript.provideFunction_("timestampToDateString",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,'(timestamp) {\n            var datetime = new Date(timestamp * 1000);\n\n            if (!datetime.getTime()) {\n                return "').concat(o," \" + timestamp;\n            }\n\n            var getTwoDigitValue = function(input) {\n                return input < 10 ? '0' + input : input;\n            }\n\n            var year    = datetime.getFullYear();\n            var month   = getTwoDigitValue(datetime.getMonth() + 1);\n            var day     = getTwoDigitValue(datetime.getDate());\n            var hours   = getTwoDigitValue(datetime.getHours());\n            var minutes = getTwoDigitValue(datetime.getMinutes());\n            var seconds = getTwoDigitValue(datetime.getSeconds());\n\n            var formatGmtOffset = function() {\n                var gmt_offset_raw = datetime.getTimezoneOffset();\n                var sign           = gmt_offset_raw > 0 ? '-' : '+';\n                var gmt_offset     = Math.abs(gmt_offset_raw);\n                var hour           = Math.floor(gmt_offset / 60);\n                var minute         = gmt_offset - hour * 60;\n\n                return 'GMT' + sign + getTwoDigitValue(hour) + getTwoDigitValue(minute);\n            }\n\n            var date_string = year + '-' + month + '-' + day;\n            var time_string = hours + ':' + minutes + ':' + seconds;\n\n            return date_string + ' ' + time_string + ' ' + formatGmtOffset();\n        }")]);return["".concat(r,"(").concat(t,")"),Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.totimestamp={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("To timestamp {{ input_datetime }} {{ dummy }}",{input_datetime:"%1",dummy:"%2"}),args0:[{type:"input_value",name:"DATETIME"},{type:"input_dummy"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Converts a string representing a date/time string into seconds since Epoch. Example: 2019-01-01 21:03:45 GMT+0800 will be converted to 1546347825. Time and time zone offset are optional."),category:Blockly.Categories.Time}},meta:function(){return{display_name:(0,n.localize)("Convert to timestamp"),description:(0,n.localize)("This block converts a string of text that represents the date and time into seconds since the Unix Epoch (1 January 1970). The time and time zone offset are optional. Example: 2019-01-01 21:03:45 GMT+0800 will be converted to 1546347825.")}},getRequiredValueInputs:function(){return{DATETIME:i.cM}}},Blockly.JavaScript.totimestamp=function(e){var t=Blockly.JavaScript.valueToCode(e,"DATETIME",Blockly.JavaScript.ORDER_ATOMIC);return["Bot.dateTimeStringToTimestamp(".concat(t,")"),Blockly.JavaScript.ORDER_FUNCTION_CALL]};var u=o(282);Blockly.Blocks.trade_definition={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2 %3",message1:"%1",message2:"%1 %2 %3",message3:"%1",message4:"%1 %2 %3",message5:"%1",args0:[{type:"field_image",src:r.N$,width:25,height:25,alt:"T"},{type:"field_label",text:(0,n.localize)("1. Trade parameters"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"TRADE_OPTIONS"}],args2:[{type:"field_image",src:"",width:4,height:25},{type:"field_label",text:(0,n.localize)("Run once at start:"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"}],args3:[{type:"input_statement",name:"INITIALIZATION",check:null}],args4:[{type:"field_image",src:"",width:4,height:25},{type:"field_label",text:(0,n.localize)("Trade options:"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"}],args5:[{type:"input_statement",name:"SUBMARKET"}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,n.localize)("Here is where you define the parameters of your contract."),category:Blockly.Categories.Trade_Definition}},meta:function(){return{display_name:(0,n.localize)("Trade parameters"),description:(0,n.localize)("Here is where you define the parameters of your contract."),key_words:(0,n.localize)("market, trade type, contract type")}},onchange:function(e){var t=this;if(this.workspace&&!this.workspace.isDragging()&&!this.isInFlyout&&(e.type===Blockly.Events.BLOCK_CHANGE||e.type===Blockly.Events.END_DRAG)){var o=this.getBlocksInStatement("TRADE_OPTIONS");o.length>0?o.forEach((function(e){/^trade_definition_.+$/.test(e.type)||(0,i.$9)((function(){e.unplug(!0)}))})):(0,i.$9)((function(){t.dispose()}))}}},Blockly.JavaScript.trade_definition=function(e){var t=u.Z.instance.client;if(!t||!t.is_logged_in)throw new Error("Please login");var o=t.loginid,n=t.getToken(o),r=e.getChildByType("trade_definition_market"),i=e.getChildByType("trade_definition_tradetype"),l=e.getChildByType("trade_definition_contracttype"),c=e.getChildByType("trade_definition_candleinterval"),s=e.getChildByType("trade_definition_restartonerror"),p=e.getChildByType("trade_definition_restartbuysell"),d=r.getFieldValue("SYMBOL_LIST"),y=i.getFieldValue("TRADETYPE_LIST"),m=l.getFieldValue("TYPE_LIST"),f=c.getFieldValue("CANDLEINTERVAL_LIST"),_="FALSE"!==s.getFieldValue("RESTARTONERROR"),h="FALSE"!==p.getFieldValue("TIME_MACHINE_ENABLED"),g=a.v.opposites,b="both"===m?g[y.toUpperCase()].map((function(e){return Object.keys(e)[0]})):[m],v=Blockly.JavaScript.statementToCode(e,"INITIALIZATION"),k=Blockly.JavaScript.statementToCode(e,"SUBMARKET");return"  \n    BinaryBotPrivateInit = function BinaryBotPrivateInit() {\n        Bot.init('".concat(n,"', {\n          symbol              : '").concat(d,"',\n          contractTypes       : ").concat(JSON.stringify(b),",\n          candleInterval      : '").concat(f||"FALSE","',\n          shouldRestartOnError: ").concat(_,",\n          timeMachineEnabled  : ").concat(h,",\n        });\n        ").concat(v.trim(),"\n    };\n      BinaryBotPrivateStart = function BinaryBotPrivateStart() {\n        BinaryBotPrivateHasCalledTradeOptions = false;\n        Bot.highlightBlock('").concat(e.id,"');\n        ").concat(k.trim(),"\n      };\n")};var p=o(9633);function d(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?y(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}Blockly.Blocks.trade_definition_market={init:function(){this.jsonInit({message0:(0,n.localize)("Market: {{ input_market }} > {{ input_submarket }} > {{ input_symbol }}",{input_market:"%1",input_submarket:"%2",input_symbol:"%3"}),args0:[{type:"field_dropdown",name:"MARKET_LIST",options:[["",""]]},{type:"field_dropdown",name:"SUBMARKET_LIST",options:[["",""]]},{type:"field_dropdown",name:"SYMBOL_LIST",options:[["",""]]}],colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:function(e){var t=-1!==["BLOCK_CREATE","BLOCK_CHANGE","END_DRAG"].findIndex((function(t){return e.type===Blockly.Events[t]}));if(this.workspace&&!this.isInFlyout&&!this.workspace.isDragging()&&t){this.enforceLimitations();var o=p.Z.instance.active_symbols,n=this.getField("MARKET_LIST"),r=this.getField("SUBMARKET_LIST"),i=this.getField("SYMBOL_LIST"),a=n.getValue(),l=r.getValue(),c=i.getValue(),s=o.getMarketDropdownOptions().filter((function(e){return"cryptocurrency"!==e[1]})),u=function(){n.updateOptions(s,{default_value:a,should_pretend_empty:!0,event_group:e.group})};e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id)?u():e.type===Blockly.Events.BLOCK_CHANGE&&e.blockId===this.id?"MARKET_LIST"===e.name?r.updateOptions(o.getSubmarketDropdownOptions(a),{default_value:l,should_pretend_empty:!0,event_group:e.group}):"SUBMARKET_LIST"===e.name&&i.updateOptions(o.getSymbolDropdownOptions(l),{default_value:c,should_pretend_empty:!0,event_group:e.group}):e.type===Blockly.Events.END_DRAG&&e.blockId===this.getRootBlock().id&&(n.isEmpty()||r.isEmpty()||i.isEmpty())&&u()}},enforceLimitations:function(){var e=this;(0,i.$9)((function(){if(e.isDescendantOf("trade_definition"))e.disabled&&e.setDisabled(!1);else{e.unplug(!1);var t=e.workspace.getTopBlocks().find((function(e){return"trade_definition"===e.type}));t?t.getLastConnectionInStatement("TRADE_OPTIONS").connect(e.previousConnection):e.dispose()}}))}},Blockly.JavaScript.trade_definition_market=function(){},Blockly.Blocks.trade_definition_tradetype={init:function(){this.jsonInit({message0:(0,n.localize)("Trade Type: {{ trade_type_category }} > {{ trade_type }}",{trade_type_category:"%1",trade_type:"%2"}),args0:[{type:"field_dropdown",name:"TRADETYPECAT_LIST",options:[["",""]]},{type:"field_dropdown",name:"TRADETYPE_LIST",options:[["",""]]}],colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:function(e){var t=this;if(this.workspace&&!this.isInFlyout&&!this.workspace.isDragging()&&(this.enforceLimitations(),e.type===Blockly.Events.BLOCK_CHANGE&&("SYMBOL_LIST"===e.name||"TRADETYPECAT_LIST"===e.name))){var o=p.Z.instance.contracts_for,n=this.getTopParent().getChildByType("trade_definition_market"),r=n.getFieldValue("MARKET_LIST"),i=n.getFieldValue("SUBMARKET_LIST"),a=n.getFieldValue("SYMBOL_LIST"),l=this.getFieldValue("TRADETYPECAT_LIST"),c=this.getFieldValue("TRADETYPE_LIST");"SYMBOL_LIST"===e.name?o.getTradeTypeCategories(r,i,a).then((function(o){var n=t.getField("TRADETYPECAT_LIST");n&&n.updateOptions(o,{default_value:l,should_pretend_empty:!0,event_group:e.group})})):"TRADETYPECAT_LIST"===e.name&&e.blockId===this.id&&o.getTradeTypes(r,i,a,l).then((function(o){t.getField("TRADETYPE_LIST").updateOptions(o,{default_value:c,should_pretend_empty:!0,event_group:e.group})}))}},enforceLimitations:Blockly.Blocks.trade_definition_market.enforceLimitations},Blockly.JavaScript.trade_definition_tradetype=function(){},Blockly.Blocks.trade_definition_contracttype={init:function(){this.jsonInit({message0:(0,n.localize)("Contract Type: {{ contract_type }}",{contract_type:"%1"}),args0:[{type:"field_dropdown",name:"TYPE_LIST",options:[["",""]]}],colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:function(e){if(this.workspace&&!this.isInFlyout&&!this.workspace.isDragging()){this.enforceLimitations();var t=/^dbot-load/.test(e.group);if(Blockly.Events.BLOCK_CHANGE&&"TRADETYPE_LIST"===e.name){var o=e.newValue,r=this.getField("TYPE_LIST"),i=[],c=(0,l.M)("both",o);c.length>1&&i.push([(0,n.localize)("Both"),"both"]),i.push.apply(i,d(c)),0===i.length&&i.push.apply(i,d(a.v.NOT_AVAILABLE_DROPDOWN_OPTIONS)),r.updateOptions(i,{event_group:e.group,default_value:t?r.getValue():void 0})}}},enforceLimitations:Blockly.Blocks.trade_definition_market.enforceLimitations},Blockly.JavaScript.trade_definition_contracttype=function(){return""},Blockly.Blocks.trade_definition_candleinterval={init:function(){this.jsonInit({message0:(0,n.localize)("Default Candle Interval: {{ candle_interval_type }}",{candle_interval_type:"%1"}),args0:[{type:"field_dropdown",name:"CANDLEINTERVAL_LIST",options:a.v.candleIntervals.slice(1)}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:function(){!this.workspace||this.isInFlyout||this.workspace.isDragging()||this.enforceLimitations()},enforceLimitations:Blockly.Blocks.trade_definition_market.enforceLimitations},Blockly.JavaScript.trade_definition_candleinterval=function(){},Blockly.Blocks.trade_definition_restartbuysell={init:function(){this.jsonInit({message0:(0,n.localize)("Restart buy/sell on error (disable for better performance): {{ checkbox }}",{checkbox:"%1"}),args0:[{type:"field_image_checkbox",name:"TIME_MACHINE_ENABLED",checked:!1}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:function(){!this.workspace||this.isInFlyout||this.workspace.isDragging()||this.enforceLimitations()},enforceLimitations:Blockly.Blocks.trade_definition_market.enforceLimitations,required_inputs:["TIME_MACHINE_ENABLED"]},Blockly.JavaScript.trade_definition_restartbuysell=function(){},Blockly.Blocks.trade_definition_restartonerror={init:function(){this.jsonInit({message0:(0,n.localize)("Restart last trade on error (bot ignores the unsuccessful trade): {{ checkbox }}",{checkbox:"%1"}),args0:[{type:"field_image_checkbox",name:"RESTARTONERROR",checked:!0}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setNextStatement(!1),this.setMovable(!1),this.setDeletable(!1)},onchange:function(){!this.workspace||this.isInFlyout||this.workspace.isDragging()||this.enforceLimitations()},enforceLimitations:Blockly.Blocks.trade_definition_market.enforceLimitations,required_inputs:["RESTARTONERROR"]},Blockly.JavaScript.trade_definition_restartonerror=function(){};var m=o(5770);function f(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function _(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?f(Object(o),!0).forEach((function(t){h(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):f(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function h(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}Blockly.Blocks.trade_definition_tradeoptions={durations:[],init:function(){this.jsonInit(this.definition()),this.setNextStatement(!1)},definition:function(){var e="trade_definition_tradeoptions"===this.type;return{message0:(0,n.localize)("Duration: {{ duration_unit }} {{ duration_value }}",{duration_unit:"%1",duration_value:"%2"}),message1:"".concat(e?(0,n.localize)("Stake"):(0,n.localize)("Payout"),": %1 %2 %3"),args0:[{type:"field_dropdown",name:"DURATIONTYPE_LIST",options:[["",""]]},{type:"input_value",name:"DURATION",check:"Number"}],args1:[{type:"field_label",name:"CURRENCY_LIST",text:(0,m.getCurrencyDisplayCode)(a.v.lists.CURRENCY[0])},{type:"input_value",name:"AMOUNT",check:"Number"},{type:"field_label",name:"AMOUNT_LIMITS",text:""}],colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Define your trade options such as duration and stake."),category:Blockly.Categories.Trade_Definition}},meta:function(){return{display_name:(0,n.localize)("Trade options"),description:(0,n.localize)("Define your trade options such as duration and stake. Some options are only applicable for certain trade types.")}},onchange:function(e){if("change"===e.type){var t,o=this.workspace.getBlockById(e.blockId);null==o||null===(t=o.parentBlock_)||void 0===t||t.inputList.filter((function(e){return["DURATION","AMOUNT"].includes(e.name)})).forEach((function(e){var t=e.connection.targetBlock(),o=t.getFieldValue("NUM");if(o.startsWith("0")){var n=o.includes(".")?parseFloat("".concat(o)):parseInt("".concat(o));t.setFieldValue(n.toString(),"NUM")}}))}if(this.workspace&&!this.workspace.isDragging()&&!this.isInFlyout){var n=this.workspace.getAllBlocks(!0).find((function(e){return"trade_definition"===e.type}));if(n){var r=n.getChildByType("trade_definition_market"),i=n.getChildByType("trade_definition_tradetype");if(r&&i){this.selected_symbol=r.getFieldValue("SYMBOL_LIST"),this.selected_market=r.getFieldValue("MARKET_LIST"),this.selected_trade_type_category=i.getFieldValue("TRADETYPECAT_LIST"),this.selected_trade_type=i.getFieldValue("TRADETYPE_LIST"),this.selected_duration=this.getFieldValue("DURATIONTYPE_LIST"),this.selected_barrier_types=[this.getFieldValue("BARRIEROFFSETTYPE_LIST")||a.v.BARRIER_TYPES[0][1],this.getFieldValue("SECONDBARRIEROFFSETTYPE_LIST")||a.v.BARRIER_TYPES[1][1]],(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id)||e.type===Blockly.Events.END_DRAG)&&(this.setCurrency(),this.updateAmountLimits());var l=/^dbot-load/.test(e.group);if(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id))l?(this.updateBarrierInputs(!1,!1),this.updateDurationInput(!1,!1),this.updatePredictionInput(!1),this.updateAmountLimits()):(this.updateBarrierInputs(!0,!0),this.enforceSingleBarrierType("BARRIEROFFSETTYPE_LIST",!0),this.updateDurationInput(!0,!0),this.updatePredictionInput(!0));else if(e.type===Blockly.Events.BLOCK_CHANGE)if(l)"TRADETYPE_LIST"===e.name&&(this.updateBarrierInputs(!1,!1),this.enforceSingleBarrierType(!1),this.updateDurationInput(!1,!1),this.updatePredictionInput(!1));else if(e.blockId===this.id)switch(e.name){case"DURATIONTYPE_LIST":this.updateBarrierInputs(!0,!0),this.enforceSingleBarrierType("BARRIEROFFSETTYPE_LIST",!0),this.updateDurationInput(!1,!0);break;case"BARRIEROFFSETTYPE_LIST":case"SECONDBARRIEROFFSETTYPE_LIST":this.updateBarrierInputs(!1,!0),this.enforceSingleBarrierType(e.name,!1)}else"SYMBOL_LIST"!==e.name&&"TRADETYPE_LIST"!==e.name||(this.updateBarrierInputs(!0,!0),this.enforceSingleBarrierType(!0),this.updateDurationInput(!0,!0),this.updatePredictionInput(!0),this.updateAmountLimits());else if(e.type===Blockly.Events.END_DRAG&&e.blockId===this.id)if(this.selected_duration)"multiplier"===this.selected_trade_type&&this.updateDurationInput(!1,!1);else{var c=new Blockly.Events.Create(this);c.recordUndo=!1,Blockly.Events.fire(c)}}}}},createPredictionInput:function(e){var t=this;(0,i.$9)((function(){if(0===e.length)t.removeInput("PREDICTION_LABEL",!0),t.removeInput("PREDICTION",!0);else if(!t.getInput("PREDICTION")){t.appendDummyInput("PREDICTION_LABEL").appendField((0,n.localize)("Prediction:"));var o=t.appendValueInput("PREDICTION"),r=t.workspace.newBlock("math_number_positive");r.setShadow(!0),r.setFieldValue(e[0],"NUM"),r.outputConnection.connect(o.connection),r.initSvg(),r.render(!0)}}))},createBarrierInputs:function(e){var t=this;(0,i.$9)((function(){for(var o=["BARRIEROFFSET","SECONDBARRIEROFFSET"],r=0;r<e.values.length;r++){var i=1===e.values.length?(0,n.localize)("Barrier"):a.v.BARRIER_LABELS[r],l=t.getInput(o[r]);if(l)l.fieldRow[0].setText(i);else{l=t.appendValueInput(o[r]).appendField(i,"".concat(o[r],"_LABEL")).appendField(new Blockly.FieldDropdown(a.v.BARRIER_TYPES),"".concat(o[r],"TYPE_LIST"));var c=t.workspace.newBlock("math_number_positive");c.setShadow(!0),c.setFieldValue(e.values[r],"NUM"),c.outputConnection.connect(l.connection),c.initSvg(),c.render(!0)}}for(var s=o.length;s>e.values.length;s--)t.removeInput(o[s-1],!0)}))},updateAmountLimits:function(){var e=this,t=p.Z.instance.account_limits,o=u.Z.instance.client,r=o.currency,a=o.landing_company_shortcode;t.getStakePayoutLimits(r,a,this.selected_market).then((function(t){if(e.getField("AMOUNT_LIMITS")){e.amount_limits=t;var o=t.max_payout,r=t.min_stake;o&&r&&(0,i.$9)((function(){e.setFieldValue((0,n.localize)("(min: {{min_stake}} - max: {{max_payout}})",{min_stake:r,max_payout:o}),"AMOUNT_LIMITS")}))}}))},updateDurationInput:function(e,t){var o=this,n=p.Z.instance.contracts_for;"multiplier"===this.selected_trade_type&&this.isDescendantOf("trade_definition")?(0,i.$9)((function(){(0,i.UR)(!1,(function(){var e=o.workspace.newBlock("trade_definition_multiplier");e.initSvg(),e.render();var t=o.workspace.getTradeDefinitionBlock().getInput("SUBMARKET").connection,n=e.previousConnection;t.connect(n);var r=e.getInput("AMOUNT"),i=o.workspace.newBlock("math_number_positive");i.setShadow(!0),i.setFieldValue(1,"NUM"),i.outputConnection.connect(r.connection),i.initSvg(),i.render();var a=o.workspace.newBlock("multiplier_take_profit"),l=a.getInput("AMOUNT"),c=o.workspace.newBlock("math_number_positive");c.setShadow(!0),c.setFieldValue(0,"NUM"),c.outputConnection.connect(l.connection),c.initSvg(),c.render(),e.getLastConnectionInStatement("MULTIPLIER_PARAMS").connect(a.previousConnection),a.initSvg(),a.render();var s=o.workspace.newBlock("multiplier_stop_loss"),u=s.getInput("AMOUNT"),p=o.workspace.newBlock("math_number_positive");p.setShadow(!0),p.setFieldValue(0,"NUM"),p.outputConnection.connect(u.connection),p.initSvg(),p.render(),e.getLastConnectionInStatement("MULTIPLIER_PARAMS").connect(s.previousConnection),s.initSvg(),s.render(),o.dispose(),Blockly.derivWorkspace.cleanUp()}))})):n.getDurations(this.selected_symbol,this.selected_trade_type).then((function(n){o.durations=n;var r=o.getField("DURATIONTYPE_LIST"),a=o.getInput("DURATION"),l=n.map((function(e){return[e.display,e.unit]}));if(null==r||r.updateOptions(l,{default_value:e?void 0:r.getValue()}),t&&a&&a.connection){var c=a.connection.targetBlock();if(c&&c.isShadow()){var s=n.find((function(e){return e.unit===o.selected_duration}));s&&(0,i.$9)((function(){c.setFieldValue(s.min,"NUM")}))}}}))},updateBarrierInputs:function(e,t){var o=this,n=p.Z.instance.contracts_for,r=a.v.BARRIER_TYPES;n.getBarriers(this.selected_symbol,this.selected_trade_type,this.selected_duration,this.selected_barrier_types).then((function(n){o.createBarrierInputs(n);for(var l=["BARRIEROFFSET","SECONDBARRIEROFFSET"],c=0;c<n.values.length;c++){var s=o.getField("".concat(l[c],"TYPE_LIST")),u=a.v.ABSOLUTE_BARRIER_DROPDOWN_OPTION,p=e?r[c][1]:s.getValue();if("d"===o.selected_duration)s.updateOptions(u,{default_value:"absolute"});else if(n.allow_both_types||n.allow_absolute_type){var d=[].concat(r,u);s.updateOptions(d,{default_value:p})}else s.updateOptions(r,{default_value:p});var y=o.getInput(l[c]).connection;t&&y&&function(){var e=y.targetBlock();if(e&&e.isShadow()){var t=!1!==n.values[c]?n.values[c]:"";(0,i.$9)((function(){e.setFieldValue(t,"NUM")}))}}()}}))},updatePredictionInput:function(e){var t=this;p.Z.instance.contracts_for.getPredictionRange(this.selected_symbol,this.selected_trade_type).then((function(o){if(t.createPredictionInput(o),o.length>0){var n=t.getInput("PREDICTION").connection;if(e&&n){var r=n.targetBlock();if(r&&r.isShadow()){var a=Math.max(1,o[0]);(0,i.$9)((function(){r.setFieldValue(a,"NUM")}))}}}}))},enforceSingleBarrierType:function(e,t){var o=this.getFieldValue(e),n="BARRIEROFFSETTYPE_LIST"===e?"SECONDBARRIEROFFSETTYPE_LIST":"BARRIEROFFSETTYPE_LIST",r=this.getField(n),l=a.v.BARRIER_TYPES;if(r){var c=-1!==l.findIndex((function(e){return e[1]===o})),s=r.getValue();(0,i.$9)((function(){if(c&&("absolute"===s||t)){var e=l.find((function(e){return e[1]!==o}));r.setValue(e[1])}else"absolute"===o&&"absolute"!==s&&r.setValue("absolute")}))}},domToMutation:function(e){var t="true"===e.getAttribute("has_first_barrier"),o="true"===e.getAttribute("has_second_barrier"),n="true"===e.getAttribute("has_prediction");t&&o?this.createBarrierInputs({values:[1,-1]}):t?this.createBarrierInputs({values:[1]}):n&&this.createPredictionInput([1])},mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("has_first_barrier",!!this.getInput("BARRIEROFFSET")),e.setAttribute("has_second_barrier",!!this.getInput("SECONDBARRIEROFFSET")),e.setAttribute("has_prediction",!!this.getInput("PREDICTION")),e},setCurrency:function(){var e=this.getField("CURRENCY_LIST"),t=u.Z.instance.client.currency;e.setText((0,m.getCurrencyDisplayCode)(t))},restricted_parents:["trade_definition"],getRequiredValueInputs:function(){var e=this;return{AMOUNT:function(t){var o,r,i=Number(t),a=null===(o=e.amount_limits)||void 0===o?void 0:o.max_payout,l=null===(r=e.amount_limits)||void 0===r?void 0:r.min_stake;return l&&i<l?(e.error_message=(0,n.localize)("Please enter a stake amount that's at least {{min_stake}}.",{min_stake:l}),i<l):a&&i>a?(e.error_message=(0,n.localize)("Please enter a payout amount that's lower than {{max_payout}}.",{max_payout:a}),i>a):(e.error_message=(0,n.localize)("Amount must be a positive number."),!isNaN(i)&&i<=0)},DURATION:function(t){var o=Number(t);if(isNaN(o)||!e.durations.length)return!1;var r=e.durations.find((function(t){return t.unit===e.selected_duration}));if(r){var i=r.min,a=r.max,l=o>=i&&o<=a;return e.error_message=i===a?(0,n.localize)("Duration value is not allowed. To run the bot, please enter {{min}}.",{min:i}):(0,n.localize)("Duration value is not allowed. To run the bot, please enter a value between {{min}} to {{max}}.",{min:i,max:a}),!l}return!1}}}},Blockly.Blocks.trade_definition_tradeoptions_payout=Blockly.Blocks.trade_definition_tradeoptions,Blockly.JavaScript.trade_definition_tradeoptions=function(e){var t,o,n,r=Blockly.JavaScript.valueToCode(e,"AMOUNT",Blockly.JavaScript.ORDER_ATOMIC)||"0",i=u.Z.instance.client.currency,a=e.getFieldValue("DURATIONTYPE_LIST")||"0",l=Blockly.JavaScript.valueToCode(e,"DURATION",Blockly.JavaScript.ORDER_ATOMIC)||"0",c=(0,m.getDecimalPlaces)(i),s="+(Number(".concat(r,").toFixed(").concat(c,"))"),p=function(e,t){return/^(\d+(\.\d+)?)$/.test(t)?"absolute"===e?"'".concat(t,"'"):"'".concat(e).concat(t,"'"):"absolute"===e?t:"'".concat(e,"' + ").concat(t)};return e.getInput("PREDICTION")&&(t=Blockly.JavaScript.valueToCode(e,"PREDICTION",Blockly.JavaScript.ORDER_ATOMIC)||"-1"),e.getInput("BARRIEROFFSET")&&(o=p(e.getFieldValue("BARRIEROFFSETTYPE_LIST"),Blockly.JavaScript.valueToCode(e,"BARRIEROFFSET",Blockly.JavaScript.ORDER_ATOMIC)||"0")),e.getInput("SECONDBARRIEROFFSET")&&(n=p(e.getFieldValue("SECONDBARRIEROFFSETTYPE_LIST"),Blockly.JavaScript.valueToCode(e,"SECONDBARRIEROFFSET",Blockly.JavaScript.ORDER_ATOMIC)||"0")),"\n        Bot.start({\n            limitations        : BinaryBotPrivateLimitations,\n            duration           : ".concat(l,",\n            duration_unit      : '").concat(a,"',\n            currency           : '").concat(i,"',\n            amount             : ").concat(s,",\n            prediction         : ").concat(t||"undefined",",\n            barrierOffset      : ").concat(o||"undefined",",\n            secondBarrierOffset: ").concat(n||"undefined",",\n            basis              : '").concat("trade_definition_tradeoptions"===e.type?"stake":"payout","',\n        });\n        BinaryBotPrivateHasCalledTradeOptions = true;\n    ")},Blockly.JavaScript.trade_definition_tradeoptions_payout=Blockly.JavaScript.trade_definition_tradeoptions,Blockly.Blocks.trade_definition_multiplier={init:function(){this.jsonInit(this.definition()),this.setNextStatement(!1)},definition:function(){return{message0:(0,n.localize)("Multiplier: {{ multiplier }}",{multiplier:"%1"}),message1:"".concat((0,n.localize)("Stake"),": %1 %2 %3"),message2:"%1",message3:"%1",args0:[{type:"field_dropdown",name:"MULTIPLIERTYPE_LIST",options:[["",""]]}],args1:[{type:"field_label",name:"CURRENCY_LIST",text:(0,m.getCurrencyDisplayCode)(a.v.lists.CURRENCY[0])},{type:"input_value",name:"AMOUNT",check:"Number"},{type:"field_label",name:"AMOUNT_LIMITS",text:""}],args2:[{type:"input_dummy"}],args3:[{type:"input_statement",name:"MULTIPLIER_PARAMS"}],colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Define your trade options such as multiplier and stake."),category:Blockly.Categories.Trade_Definition}},meta:function(){return{display_name:(0,n.localize)("Multiplier trade options"),description:(0,n.localize)("Define your trade options such as multiplier and stake. This block can only be used with the multipliers trade type. If you select another trade type, this block will be replaced with the Trade options block.")}},validateBlocksInStatement:function(){var e=this.getBlocksInStatement("MULTIPLIER_PARAMS");if(e.length>0){var t=[];e.forEach((function(e){t.push(e.type),/^multiplier_.+$/.test(e.type)&&new Set(t).size===t.length||(0,i.$9)((function(){e.unplug(!0)}))}))}},onchange:function(e){if(this.workspace&&!this.isInFlyout&&!this.workspace.isDragging()){var t=this.workspace.getAllBlocks(!0).find((function(e){return"trade_definition"===e.type}));if(t){var o=t.getChildByType("trade_definition_market"),n=t.getChildByType("trade_definition_tradetype");if(o&&n){this.selected_symbol=o.getFieldValue("SYMBOL_LIST"),this.selected_market=o.getFieldValue("MARKET_LIST"),this.selected_trade_type_category=n.getFieldValue("TRADETYPECAT_LIST"),this.selected_trade_type=n.getFieldValue("TRADETYPE_LIST"),this.selected_multiplier=this.getFieldValue("MULTIPLIERTYPE_LIST");var r=/^dbot-load/.test(e.group);if(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id))return this.setCurrency(),this.updateAmountLimits(),void(r?this.updateMultiplierInput(!1):this.updateMultiplierInput(!0));if(e.type!==Blockly.Events.BLOCK_CHANGE){if(e.type===Blockly.Events.END_DRAG&&(this.setCurrency(),this.updateAmountLimits(),this.validateBlocksInStatement(),e.blockId===this.id))if(this.selected_multiplier)"multiplier"!==this.selected_trade_type&&this.updateMultiplierInput(!0);else{var i=new Blockly.Events.Create(this);i.recordUndo=!1,Blockly.Events.fire(i)}}else this.validateBlocksInStatement(),r?"TRADETYPE_LIST"===e.name&&this.updateMultiplierInput(!1):e.blockId===this.id?"MULTIPLIERTYPE_LIST"===e.name&&this.updateMultiplierInput(!1):"SYMBOL_LIST"!==e.name&&"TRADETYPE_LIST"!==e.name||(this.updateMultiplierInput(!0),this.updateAmountLimits())}}}},updateAmountLimits:Blockly.Blocks.trade_definition_tradeoptions.updateAmountLimits,updateMultiplierInput:function(e){var t=this,o=p.Z.instance.contracts_for;"multiplier"!==this.selected_trade_type?this.isDescendantOf("trade_definition")&&(0,i.$9)((function(){(0,i.UR)(!1,(function(){var e=t.workspace.newBlock("trade_definition_tradeoptions");e.initSvg(),e.render();var o=t.workspace.getTradeDefinitionBlock().getInput("SUBMARKET").connection,n=e.previousConnection;o.connect(n);var r=e.getInput("DURATION"),i=t.workspace.newBlock("math_number_positive");i.setShadow(!0),i.outputConnection.connect(r.connection),i.initSvg(),i.render(!0);var a=e.getInput("AMOUNT"),l=t.workspace.newBlock("math_number_positive");l.setShadow(!0),l.setFieldValue(1,"NUM"),l.outputConnection.connect(a.connection),l.initSvg(),l.render(!0),t.dispose(),Blockly.derivWorkspace.cleanUp()}))})):o.getMultiplierRange(this.selected_symbol,this.selected_trade_type).then((function(o){if(o.length>0){var n=t.getField("MULTIPLIERTYPE_LIST"),r=o.map((function(e){var t=e.toString();return[t,t]}));null==n||n.updateOptions(r,{default_value:e?void 0:n.getValue()})}}))},setCurrency:Blockly.Blocks.trade_definition_tradeoptions.setCurrency,restricted_parents:["trade_definition"],getRequiredValueInputs:function(){var e=this;return{AMOUNT:function(t){var o,r,i=Number(t),a=null===(o=e.amount_limits)||void 0===o?void 0:o.max_payout,l=null===(r=e.amount_limits)||void 0===r?void 0:r.min_stake;return l&&i<l?(e.error_message=(0,n.localize)("Please enter a stake amount that's at least {{min_stake}}.",{min_stake:l}),i<l):a&&i>a?(e.error_message=(0,n.localize)("Please enter a payout amount that's lower than {{max_payout}}.",{max_payout:a}),i>a):(e.error_message=(0,n.localize)("Amount must be a positive number."),!isNaN(i)&&i<=0)}}}},Blockly.JavaScript.trade_definition_multiplier=function(e){var t,o,n=Blockly.JavaScript.valueToCode(e,"AMOUNT",Blockly.JavaScript.ORDER_ATOMIC)||"0",r=u.Z.instance.client.currency,i=u.Z.instance.setContractUpdateConfig,a=e.getFieldValue("MULTIPLIERTYPE_LIST")||"1",l=!(null!==(t=e.getChildByType("multiplier_stop_loss"))&&void 0!==t&&t.disabled)&&e.childValueToCode("multiplier_stop_loss","AMOUNT"),c=!(null!==(o=e.getChildByType("multiplier_take_profit"))&&void 0!==o&&o.disabled)&&e.childValueToCode("multiplier_take_profit","AMOUNT"),s={};s.take_profit=c?+c:void 0,s.stop_loss=l?+l:void 0,i(c,l);var p=(0,m.getDecimalPlaces)(r),d="+(Number(".concat(n,").toFixed(").concat(p,"))");return"\n        Bot.start({\n            limitations        : BinaryBotPrivateLimitations,\n            multiplier         : ".concat(a,",\n            currency           : '").concat(r,"',\n            amount             : ").concat(d,",\n            limit_order        : ").concat(JSON.stringify(s),",\n            basis              : 'stake',\n        });\n        BinaryBotPrivateHasCalledTradeOptions = true;\n    ")},Blockly.Blocks.multiplier_stop_loss={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Stop Loss: {{ currency }} {{ stop_loss }}",{currency:"%1",stop_loss:"%2"}),args0:[{type:"field_label",name:"CURRENCY_LIST",text:(0,m.getCurrencyDisplayCode)(a.v.lists.CURRENCY[0])},{type:"input_value",name:"AMOUNT",check:"Number"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Your contract is closed automatically when your loss is more than or equals to this amount."),category:Blockly.Categories.Trade_Definition}},meta:function(){return{display_name:(0,n.localize)("Stop loss"),description:(0,n.localize)("Your contract is closed automatically when your loss is more than or equals to this amount.")}},onchange:function(e){!this.workspace||this.isInFlyout||this.workspace.isDragging()||(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id)||e.type===Blockly.Events.END_DRAG)&&this.setCurrency()},restricted_parents:["trade_definition_multiplier"],setCurrency:Blockly.Blocks.trade_definition_tradeoptions.setCurrency,getRequiredValueInputs:function(){var e=this;return this.getInput("AMOUNT").connection.targetBlock()?{AMOUNT:function(t){var o=Number(t);return e.error_message=(0,n.localize)("Stop loss must be a positive number."),!isNaN(o)&&o<=0}}:{}}},Blockly.JavaScript.multiplier_stop_loss=function(){},Blockly.Blocks.multiplier_take_profit={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Take Profit: {{ currency }} {{ take_profit }}",{currency:"%1",take_profit:"%2"}),args0:[{type:"field_label",name:"CURRENCY_LIST",text:(0,m.getCurrencyDisplayCode)(a.v.lists.CURRENCY[0])},{type:"input_value",name:"AMOUNT",check:"Number"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Your contract is closed automatically when your profit is more than or equals to this amount."),category:Blockly.Categories.Trade_Definition}},meta:function(){return{display_name:(0,n.localize)("Take Profit"),description:(0,n.localize)("Your contract is closed automatically when your profit is more than or equals to this amount.")}},onchange:function(e){!this.workspace||this.isInFlyout||this.workspace.isDragging()||(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id)||e.type===Blockly.Events.END_DRAG)&&this.setCurrency()},restricted_parents:["trade_definition_multiplier"],setCurrency:Blockly.Blocks.trade_definition_tradeoptions.setCurrency,getRequiredValueInputs:function(){var e=this;return this.getInput("AMOUNT").connection.targetBlock()?{AMOUNT:function(t){var o=Number(t);return e.error_message=(0,n.localize)("Take profit must be a positive number."),!isNaN(o)&&o<=0}}:{}}},Blockly.JavaScript.multiplier_take_profit=function(){},Blockly.Blocks.logic_compare={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["≠","NEQ"],["‏<","LT"],["‏≤","LTE"],["‏>","GT"],["‏≥","GTE"]]},{type:"input_value",name:"B"}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Compares two values"),category:Blockly.Categories.Logic}},meta:function(){return{display_name:(0,n.localize)("Compare"),description:(0,n.localize)("This block compares two values and is used to build a conditional structure.")}},getRequiredValueInputs:function(){return{A:null,B:null}}},Blockly.JavaScript.logic_compare=function(e){var t={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[e.getFieldValue("OP")||"EQ"],o=["==","!="].includes(t)?Blockly.JavaScript.ORDER_EQUALITY:Blockly.JavaScript.ORDER_RELATIONAL,n=Blockly.JavaScript.valueToCode(e,"A",o)||"false",r=Blockly.JavaScript.valueToCode(e,"B",o)||"false";return["".concat(n," ").concat(t," ").concat(r),o]},Blockly.Blocks.controls_if={init:function(){this.value_connections=[null],this.statement_connections=[null],this.else_statement_connection=null,this.else_if_count=0,this.else_count=0,this.jsonInit(this.definition()),this.updateShape()},definition:function(){return{message0:(0,n.localize)("if {{ condition }} then",{condition:"%1"}),message1:"%1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],args1:[{type:"input_statement",name:"DO0"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Conditional block"),category:Blockly.Categories.Logic}},meta:function(){return{display_name:(0,n.localize)("Conditional block"),description:(0,n.localize)("This block evaluates a statement and will perform an action only when the statement is true.")}},mutationToDom:function(){var e=document.createElement("mutation");return this.else_if_count&&e.setAttribute("elseif",this.else_if_count),this.else_count&&e.setAttribute("else",1),e},domToMutation:function(e){this.else_if_count=parseInt(e.getAttribute("elseif"))||0,this.else_count=parseInt(e.getAttribute("else"))||0,this.rebuildShape()},rebuildShape:function(){for(var e,t,o=[null],n=[null],r=(null===(e=this.getInput("ELSE"))||void 0===e||null===(t=e.connection)||void 0===t?void 0:t.targetConnection)||null,i=1;;){var a=this.getIfInputNames(i),l=this.getInput(a.IF);if(!l)break;var c=this.getInput(a.DO);o.push(l.connection.targetConnection),n.push(c.connection.targetConnection),i++}this.updateShape(),this.reconnectChildBlocks(o,n,r)},update:function(e){var t=this;Blockly.Events.setGroup(!0);var o=this.mutationToDom(),n=o&&Blockly.Xml.domToText(o),r=this.rendered;this.rendered=!1,e&&e.call(this),this.updateShape(),this.rendered=r,this.initSvg();var i=Blockly.Events.getGroup(),a=this.mutationToDom(),l=a&&Blockly.Xml.domToText(a);if(n!==l){var c=new Blockly.Events.BlockChange(this,"mutation",null,n,l);Blockly.Events.fire(c),setTimeout((function(){Blockly.Events.setGroup(i),t.bumpNeighbours_(),Blockly.Events.setGroup(!1)}),Blockly.BUMP_DELAY)}this.rendered&&this.render(),Blockly.Events.setGroup(!1)},updateShape:function(){var e=this;this.getInput("ELSE")&&(this.removeInput("ELSE"),this.removeInput("ELSE_LABEL"),this.removeInput("DELETE_ELSE"));for(var t=1;;){var o=this.getIfInputNames(t);if(!this.getInput(o.IF))break;this.removeInput(o.IF_LABEL),this.removeInput(o.IF),this.removeInput(o.THEN_LABEL),this.removeInput(o.DELETE_ICON),this.removeInput(o.DO),t++}this.getInput("MUTATOR")&&this.removeInput("MUTATOR");for(var i=function(t){var o=e.getIfInputNames(t);e.appendDummyInput(o.IF_LABEL).appendField((0,n.localize)("else if")),e.appendValueInput(o.IF).setCheck("Boolean"),e.appendDummyInput(o.THEN_LABEL).appendField((0,n.localize)("then")),e.appendDummyInput(o.DELETE_ICON).appendField(new Blockly.FieldImage(r.fK,24,24,"-",(function(){return e.modifyElseIf(!1,t)}))),e.appendStatementInput(o.DO)},a=1;a<=this.else_if_count;a++)i(a);this.else_count>0&&(this.appendDummyInput("ELSE_LABEL").appendField((0,n.localize)("else")),this.appendDummyInput("DELETE_ELSE").appendField(new Blockly.FieldImage(r.fK,24,24,"-",(function(){return e.modifyElse(!1)}),!1)),this.appendStatementInput("ELSE")),this.appendDummyInput("MUTATOR").appendField(new Blockly.FieldImage(r.M8,24,24,"+",(function(){0===e.else_count?e.modifyElse(!0):(e.else_if_count||(e.else_if_count=0),e.modifyElseIf(!0))}),!1)),this.initSvg(),this.render()},storeConnections:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.value_connections=[null],this.statement_connections=[null],this.else_statement_connection=null;for(var t=1;t<=this.else_if_count;t++)if(e!==t){var o=this.getIfInputNames(t);this.value_connections.push(this.getInput(o.IF).connection.targetConnection),this.statement_connections.push(this.getInput(o.DO).connection.targetConnection)}var n=this.getInput("ELSE");n&&(this.else_statement_connection=n.connection.targetConnection)},reconnectChildBlocks:function(e,t,o){for(var n=null!=e?e:this.value_connections,r=null!=t?t:this.statement_connections,i=null!=o?o:this.else_statement_connection,a=1;a<=this.else_if_count;a++){var l=this.getIfInputNames(a),c=n[a],s=r[a];c&&this.getInput(l.IF)&&Blockly.Mutator.reconnect(c,this,l.IF),s&&this.getInput(l.DO)&&Blockly.Mutator.reconnect(s,this,l.DO)}i&&this.getInput("ELSE")&&Blockly.Mutator.reconnect(i,this,"ELSE")},modifyElse:function(e){var t=this;this.storeConnections(),this.update((function(){t.else_count+=e?1:-1})),this.reconnectChildBlocks()},modifyElseIf:function(e,t){var o=this;this.storeConnections(t),this.update((function(){o.else_if_count+=e?1:-1})),this.reconnectChildBlocks()},getRequiredValueInputs:function(){var e={};return this.inputList.filter((function(e){return/^IF[0-9]*?$/.test(e.name)})).forEach((function(t){return e[t.name]=null})),e},getIfInputNames:function(e){return{IF_LABEL:"IF_LABEL".concat(e),IF:"IF".concat(e),THEN_LABEL:"THEN_LABEL".concat(e),DELETE_ICON:"DELETE_ICON".concat(e),DO:"DO".concat(e)}}},Blockly.JavaScript.controls_if=function(e){var t=0,o="";do{var n=Blockly.JavaScript.valueToCode(e,"IF".concat(t),Blockly.JavaScript.ORDER_NONE)||"false";o+="\n        ".concat(t>0?"else if":"if"," (").concat(n,") {\n            ").concat(Blockly.JavaScript.statementToCode(e,"DO".concat(t)),"\n        }"),t++}while(e.getInput("IF".concat(t)));return e.getInput("ELSE")&&(o+="\n        else {\n            ".concat(Blockly.JavaScript.statementToCode(e,"ELSE"),"\n        }")),"".concat(o,"\n")},Blockly.Blocks.logic_boolean={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[[(0,n.localize)("true"),"TRUE"],[(0,n.localize)("false"),"FALSE"]]}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns either True or False"),category:Blockly.Categories.Logic}},meta:function(){return{display_name:(0,n.localize)("True-False"),description:(0,n.localize)("This is a single block that returns a boolean value, either true or false.")}}},Blockly.JavaScript.logic_boolean=function(e){return["TRUE"===e.getFieldValue("BOOL")?"true":"false",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.logic_operation={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[[(0,n.localize)("and"),"AND"],[(0,n.localize)("or"),"OR"]]},{type:"input_value",name:"B"}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Performs selected logic operation"),category:Blockly.Categories.Logic}},meta:function(){return{display_name:(0,n.localize)("Logic operation"),description:(0,n.localize)('This block performs the "AND" or the "OR" logic operation.')}},getRequiredValueInputs:function(){return{A:null,B:null}}},Blockly.JavaScript.logic_operation=function(e){var t,o,n=e.getFieldValue("OP");"AND"===n?(t="&&",o=Blockly.JavaScript.ORDER_LOGICAL_AND):"OR"===n&&(t="||",o=Blockly.JavaScript.ORDER_LOGICAL_OR);var r=Blockly.JavaScript.valueToCode(e,"A",Blockly.JavaScript.ORDER_ATOMIC)||"false",i=Blockly.JavaScript.valueToCode(e,"B",Blockly.JavaScript.ORDER_ATOMIC)||"false";return["".concat(r," ").concat(t," ").concat(i),o]},Blockly.Blocks.logic_null={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"null",output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block assigns a null value to an item or statement."),category:Blockly.Categories.Logic}},meta:function(){return{display_name:(0,n.localize)("Null"),description:(0,n.localize)("This block assigns a null value to an item or statement.")}}},Blockly.JavaScript.logic_null=function(){return["null",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.logic_ternary={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("test {{ condition }}",{condition:"%1"}),message1:(0,n.localize)("if true {{ return_value }}",{return_value:"%1"}),message2:(0,n.localize)("if false {{ return_value }}",{return_value:"%1"}),args0:[{type:"input_value",name:"IF",check:"Boolean"}],args1:[{type:"input_value",name:"THEN"}],args2:[{type:"input_value",name:"ELSE"}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block tests if a given value is true or false and returns “True” or “False” accordingly."),category:Blockly.Categories.Logic}},meta:function(){return{display_name:(0,n.localize)("Test value"),description:(0,n.localize)("This block tests if a given value is true or false and returns “True” or “False” accordingly.")}},getRequiredValueInputs:function(){return{IF:null,THEN:null,ELSE:null}}},Blockly.JavaScript.logic_ternary=function(e){var t=Blockly.JavaScript.valueToCode(e,"IF",Blockly.JavaScript.ORDER_CONDITIONAL)||"false",o=Blockly.JavaScript.valueToCode(e,"THEN",Blockly.JavaScript.ORDER_CONDITIONAL)||"null",n=Blockly.JavaScript.valueToCode(e,"ELSE",Blockly.JavaScript.ORDER_CONDITIONAL)||"null";return["(".concat(t," ? ").concat(o," : ").concat(n,")"),Blockly.JavaScript.ORDER_CONDITIONAL]},Blockly.Blocks.logic_negate={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("not {{ boolean }}",{boolean:"%1"}),args0:[{type:"input_value",name:"BOOL"}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Converts a given True or False to the opposite value"),category:Blockly.Categories.Logic}},meta:function(){return{display_name:(0,n.localize)("Logic negation"),description:(0,n.localize)("This block converts the boolean value (true or false) to its opposite.")}},getRequiredValueInputs:function(){return{BOOL:null}}},Blockly.JavaScript.logic_negate=function(e){var t=Blockly.JavaScript.ORDER_LOGICAL_NOT,o=Blockly.JavaScript.valueToCode(e,"BOOL",t)||"true";return["!".concat(o),t]},Blockly.Blocks.math_change={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("change {{ variable }} by {{ number }}",{variable:"%1",number:"%2"}),args0:[{type:"field_variable",name:"VAR",variable:(0,n.localize)("item")},{type:"input_value",name:"DELTA",check:"Number"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("This block adds the given number to the selected variable"),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Change variable"),description:(0,n.localize)("This block adds the given number to the selected variable.")}},getRequiredValueInputs:function(){return{DELTA:null}}},Blockly.JavaScript.math_change=function(e){var t=e.getFieldValue("VAR"),o=Blockly.JavaScript.variableDB_.getName(t,Blockly.Variables.NAME_TYPE),n=Blockly.JavaScript.valueToCode(e,"DELTA",Blockly.JavaScript.ORDER_ADDITION)||"0";return"".concat(o," = (typeof ").concat(o," === 'number' ? ").concat(o," : 0) + ").concat(n,";")},Blockly.Blocks.math_constant={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["π","PI"],["ℇ","E"],["ϕ","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(½)","SQRT1_2"],["∞","INFINITY"]]}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block gives you the selected constant values."),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Mathematical constants"),description:(0,n.localize)("This block gives you the selected constant values.")}}},Blockly.JavaScript.math_constant=function(e){var t,o,n=e.getFieldValue("CONSTANT");return"PI"===n?(t="Math.PI",o=Blockly.JavaScript.ORDER_MEMBER):"E"===n?(t="Math.E",o=Blockly.JavaScript.ORDER_MEMBER):"GOLDEN_RATIO"===n?(t="(1 + Math.sqrt(5)) / 2",o=Blockly.JavaScript.ORDER_DIVISION):"SQRT2"===n?(t="Math.SQRT2",o=Blockly.JavaScript.ORDER_MEMBER):"SQRT1_2"===n?(t="Math.SQRT1_2",o=Blockly.JavaScript.ORDER_MEMBER):"INFINITY"===n&&(t="Infinity",o=Blockly.JavaScript.ORDER_ATOMIC),[t,o]},Blockly.Blocks.math_constrain={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("constrain {{ number }} low {{ low_number }} high {{ high_number }}",{number:"%1",low_number:"%2",high_number:"%3"}),args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block constrains a given number so that it is within a set range."),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Constrain within a range"),description:(0,n.localize)("This block constrains a given number so that it is within a set range.")}},getRequiredValueInputs:function(){return{VALUE:null,LOW:null,HIGH:null}}},Blockly.JavaScript.math_constrain=function(e){var t=Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_COMMA)||"0",o=Blockly.JavaScript.valueToCode(e,"LOW",Blockly.JavaScript.ORDER_COMMA)||"0",n=Blockly.JavaScript.valueToCode(e,"HIGH",Blockly.JavaScript.ORDER_COMMA)||"0";return["Math.min(Math.max(".concat(t,", ").concat(o,"), ").concat(n,")"),Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.math_modulo={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("remainder of {{ number1 }} ÷ {{ number2 }}",{number1:"%1",number2:"%2"}),args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns the remainder after a division"),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Remainder after division"),description:(0,n.localize)(" Returns the remainder after the division of the given numbers.")}},getRequiredValueInputs:function(){return{DIVIDEND:null,DIVISOR:null}}},Blockly.JavaScript.math_modulo=function(e){var t=Blockly.JavaScript.valueToCode(e,"DIVIDEND",Blockly.JavaScript.ORDER_MODULUS)||"0",o=Blockly.JavaScript.valueToCode(e,"DIVISOR",Blockly.JavaScript.ORDER_MODULUS)||"0";return["".concat(t," % ").concat(o),Blockly.JavaScript.ORDER_MODULUS]},Blockly.Blocks.math_number={init:function(){var e=this;this.jsonInit(this.definition()),this.getField("NUM").setValidator((function(t){return e.numberValidator(t)}))},definition:function(){return{message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Please use `.` as a decimal separator for fractional numbers."),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Number"),description:(0,n.localize)("Enter an integer or fractional number into this block. Please use `.` as a decimal separator for fractional numbers.")}},numberValidator:function(e){if(!(/^-?([0][.]|[0-9]+[.])?([0]|[1-9]){1,}$/.test(e)&&e<Number.MAX_SAFE_INTEGER))return null}},Blockly.JavaScript.math_number=function(e){return[e.getFieldValue("NUM"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.math_number_positive={init:Blockly.Blocks.math_number.init,definition:Blockly.Blocks.math_number.definition,meta:function(){return{display_name:(0,n.localize)("Math Number Positive"),description:(0,n.localize)("Math Number Description")}},numberValidator:function(e){if(!(/^([0][.]|[0-9]+[.])?([0]|[1-9]){1,}$/.test(e)&&e<Number.MAX_SAFE_INTEGER))return null}},Blockly.JavaScript.math_number_positive=Blockly.JavaScript.math_number,Blockly.Blocks.math_number_property={init:function(){var e=this;this.jsonInit(this.definition()),this.setOnChange((function(t){if("PROPERTY"===t.name){var o="DIVISIBLE_BY"===e.getFieldValue("PROPERTY");e.updateShape(o)}}))},definition:function(){return{message0:(0,n.localize)("{{ number }} is {{ type }}",{number:"%1",type:"%2"}),args0:[{type:"input_value",name:"NUMBER_TO_CHECK"},{type:"field_dropdown",name:"PROPERTY",options:[[(0,n.localize)("even"),"EVEN"],[(0,n.localize)("odd"),"ODD"],[(0,n.localize)("prime"),"PRIME"],[(0,n.localize)("whole"),"WHOLE"],[(0,n.localize)("positive"),"POSITIVE"],[(0,n.localize)("negative"),"NEGATIVE"],[(0,n.localize)("divisible by"),"DIVISIBLE_BY"]]}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,toolip:(0,n.localize)("This block tests a given number according to the selection"),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Test a number"),description:(0,n.localize)("This block tests a given number according to the selection and it returns a value of “True” or “False”. Available options: Even, Odd, Prime, Whole, Positive, Negative, Divisible")}},domToMutation:function(e){var t="true"===e.getAttribute("divisor_input");this.updateShape(t)},mutationToDom:function(){var e=document.createElement("mutation"),t="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return e.setAttribute("divisor_input",t),e},updateShape:function(e){var t=this.getInput("DIVISOR");e?t||(this.appendValueInput("DIVISOR").setCheck("Number"),this.initSvg(),this.render(!1)):this.removeInput("DIVISOR")},getRequiredValueInputs:function(){return{NUMBER_TO_CHECK:null}}},Blockly.JavaScript.math_number_property=function(e){var t,o=Blockly.JavaScript.valueToCode(e,"NUMBER_TO_CHECK",Blockly.JavaScript.ORDER_MODULUS)||"0",n=e.getFieldValue("PROPERTY");if("PRIME"===n){var r=Blockly.JavaScript.provideFunction_("mathIsPrime",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(n) {\n                // https://en.wikipedia.org/wiki/Primality_test#Naive_methods\n                if (n == 2 || n == 3) {\n                    return true;\n                }\n\n                // False if n is NaN, negative, is 1, or not whole.\n                // And false if n is divisible by 2 or 3.\n                if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {\n                    return false;\n                }\n\n                // Check all the numbers of form 6k +/- 1, up to sqrt(n).\n                for (var x  = 6; x <= Math.sqrt(n) + 1; x += 6) {\n                    if (n % (x - 1) == 0 || n % (x + 1) == 0) {\n                        return false;\n                    }\n                }\n                return true;\n            }")]);return[t="".concat(r,"(").concat(o,")"),Blockly.JavaScript.ORDER_FUNCTION_CALL]}if("EVEN"===n)t="".concat(o," % 2 === 0");else if("ODD"===n)t="".concat(o," % 2 === 1");else if("WHOLE"===n)t="".concat(o," % 1 === 0");else if("POSITIVE"===n)t="".concat(o," > 0");else if("NEGATIVE"===n)t="".concat(o," < 0");else if("DIVISIBLE_BY"===n){var i=Blockly.JavaScript.valueToCode(e,"DIVISOR",Blockly.JavaScript.ORDER_MODULUS)||"0";t="".concat(o," % ").concat(i," == 0")}return[t,Blockly.JavaScript.ORDER_EQUALITY]},Blockly.Blocks.math_on_list={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("{{ calculation }} of list {{ input_list }}",{calculation:"%1",input_list:"%2"}),args0:[{type:"field_dropdown",name:"OP",options:[[(0,n.localize)("sum"),"SUM"],[(0,n.localize)("min"),"MIN"],[(0,n.localize)("max"),"MAX"],[(0,n.localize)("average"),"AVERAGE"],[(0,n.localize)("median"),"MEDIAN"],[(0,n.localize)("mode"),"MODE"],[(0,n.localize)("antimode"),"ANTIMODE"],[(0,n.localize)("standard deviation"),"STD_DEV"],[(0,n.localize)("random item"),"RANDOM"]]},{type:"input_value",name:"LIST"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Aggregate operations"),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Aggregate operations"),description:(0,n.localize)("This block performs the following operations on a given list: sum, minimum, maximum, average, median, mode, antimode, standard deviation, random item.")}},getRequiredValueInputs:function(){return{LIST:function(e){return"list"!==e}}}},Blockly.JavaScript.math_on_list=function(e){var t,o,n=e.getFieldValue("OP");if("SUM"===n)o=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_MEMBER)||"[]",t="(".concat(o," || [0]).reduce(function(x, y) { return x + y; })");else if("MIN"===n)o=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_COMMA)||"[]",t="Math.min.apply(null, (".concat(o," || [0]))");else if("MAX"===n)o=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_COMMA)||"[]",t="Math.max.apply(null, (".concat(o," || [0]))");else if("AVERAGE"===n){var r=Blockly.JavaScript.provideFunction_("mathMean",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(myList) {\n                if (!myList || !myList.length) {\n                    return null;\n                }\n\n                return myList.reduce(function(x, y) { \n                    return x + y; \n                }) / myList.length;\n            }")]);o=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",t="".concat(r,"((").concat(o," || [0]))")}else if("MEDIAN"===n){var i=Blockly.JavaScript.provideFunction_("mathMedian",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(myList) {\n                var localList = myList.filter(function(x) { \n                    return typeof x == 'number'; \n                });\n                if (!localList.length) {\n                    return null;\n                }\n                localList.sort(function(a, b) { \n                    return b - a; \n                });\n                if (localList.length % 2 == 0) {\n                    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;\n                } else {\n                    return localList[(localList.length - 1) / 2];\n                }\n            }")]);o=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",t="".concat(i,"((").concat(o," || [0]))")}else if("MODE"===n){var a=Blockly.JavaScript.provideFunction_("mathModes",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(values) {\n                var modes = [];\n                var counts = [];\n                var maxCount = 0;\n\n                for (var i = 0; i < values.length; i++) {\n                    var value = values[i];\n                    var found = false;\n                    var thisCount;\n\n                    for (var j = 0; j < counts.length; j++) {\n                        if (counts[j][0] === value) {\n                            thisCount = ++counts[j][1];\n                            found = true;\n                            break;\n                        }\n                    }\n\n                    if (!found) {\n                        counts.push([value, 1]);\n                        thisCount = 1;\n                    }\n                    maxCount = Math.max(thisCount, maxCount);\n                }\n                \n                for (var j = 0; j < counts.length; j++) {\n                    if (counts[j][1] == maxCount) {\n                        modes.push(counts[j][0]);\n                    }\n                }\n\n                return modes;\n            }")]);o=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",t="".concat(a,"((").concat(o," || [0]))")}else if("ANTIMODE"===n){var l=Blockly.JavaScript.provideFunction_("mathAntiMode",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(values) {\n                var antiMode = [];\n                var counts = [];\n                var minCount = 1;\n                var countArray = [];\n    \n                for (var i = 0; i < values.length; i++) {\n                    var value = values[i];\n                    var found = false;\n                    var thisCount;\n\n                    for (var j = 0; j < counts.length; j++) {\n                        if (counts[j][0] === value) {\n                            thisCount = ++counts[j][1];\n                            found = true;\n                            break;\n                        }\t\n                    }\n                    \n                    if (!found) {\n                        counts.push([value, 1]);\n                        thisCount = 1;\n                    }\n                }\n\n                 minCount = Math.min.apply(null, counts.map(function(element) {\n                     return element[1];\n                 }));\n\n                 for (var j = 0; j < counts.length; j++) {\n                    if (counts[j][1] == minCount) {\n                        antiMode.push(counts[j][0]);\n                    }\n                }\n\n                return antiMode;\n            }")]);o=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",t="".concat(l,"((").concat(o," || [0]))")}else if("STD_DEV"===n){var c=Blockly.JavaScript.provideFunction_("mathStandardDeviation",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(numbers) {\n                var n = numbers.length;\n                if (!n) {\n                    return null;\n                }\n\n                var mean = numbers.reduce(function(x, y) {\n                    return x + y;\n                }) / n;\n\n                var variance = 0;\n                for (var j = 0; j < n; j++) {\n                    variance += Math.pow(numbers[j] - mean, 2);\n                }\n                variance = variance / n;\n                return Math.sqrt(variance);\n            }")]);o=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",t="".concat(c,"((").concat(o," || [0]))")}else if("RANDOM"===n){var s=Blockly.JavaScript.provideFunction_("mathRandomList",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(list) {\n                var x = Math.floor(Math.random() * list.length);\n                return list[x];\n            }")]);o=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",t="".concat(s,"((").concat(o," || [0]))")}return[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.math_random_float={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("random fraction"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block gives you a random fraction between 0.0 to 1.0"),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Random fraction number"),description:(0,n.localize)("This block gives you a random fraction between 0.0 to 1.0.")}}},Blockly.JavaScript.math_random_float=function(){return["Math.random()",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.math_random_int={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("random integer from {{ start_number }} to {{ end_number }}",{start_number:"%1",end_number:"%2"}),args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block gives you a random number from within a set range"),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Random integer"),description:(0,n.localize)("This block gives you a random number from within a set range.")}},getRequiredValueInputs:function(){return{FROM:null,TO:null}}},Blockly.JavaScript.math_random_int=function(e){var t=Blockly.JavaScript.valueToCode(e,"FROM",Blockly.JavaScript.ORDER_COMMA)||"0",o=Blockly.JavaScript.valueToCode(e,"TO",Blockly.JavaScript.ORDER_COMMA)||"0",n=Blockly.JavaScript.provideFunction_("mathRandomInt",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(a, b) {\n            if (a > b) {\n                // Swap a and b to ensure a is smaller.\n                var c = a;\n                a = b;\n                b = c;\n            }\n            return Math.floor(Math.random() * (b - a + 1) + a);\n        }")]);return["".concat(n,"(").concat(t,", ").concat(o,")"),Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.math_round={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["round","ROUND"],["round up","ROUNDUP"],["round down","ROUNDDOWN"]]},{type:"input_value",name:"NUM"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Rounds a given number to an integer"),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Rounding operation"),description:(0,n.localize)("This block rounds a given number according to the selection: round, round up, round down.")}},getRequiredValueInputs:function(){return{NUM:null}}},Blockly.JavaScript.math_round=function(e){var t,o=e.getFieldValue("OP"),n=Blockly.JavaScript.valueToCode(e,"NUM",Blockly.JavaScript.ORDER_ATOMIC)||"0";return"ROUND"===o?t="Math.round(".concat(n,")"):"ROUNDUP"===o?t="Math.ceil(".concat(n,")"):"ROUNDDOWN"===o&&(t="Math.floor(".concat(n,")")),[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.math_arithmetic={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["+","ADD"],["-","MINUS"],["*","MULTIPLY"],["/","DIVIDE"],["^","POWER"]]},{type:"input_value",name:"B",check:"Number"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("This block performs arithmetic operations between two numbers."),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Arithmetical operations"),description:(0,n.localize)("This block performs arithmetic operations between two numbers.")}},getRequiredValueInputs:function(){return{A:null,B:null}}},Blockly.JavaScript.math_arithmetic=function(e){var t={ADD:["+",Blockly.JavaScript.ORDER_ADDITION],MINUS:["-",Blockly.JavaScript.ORDER_SUBTRACTION],MULTIPLY:["*",Blockly.JavaScript.ORDER_MULTIPLICATION],DIVIDE:["/",Blockly.JavaScript.ORDER_DIVISION],POWER:[null,Blockly.JavaScript.ORDER_COMMA]}[e.getFieldValue("OP")],o=t[0],n=t[1],r=Blockly.JavaScript.valueToCode(e,"A",n)||"0",i=Blockly.JavaScript.valueToCode(e,"B",n)||"0";return o?["".concat(r," ").concat(o," ").concat(i),n]:["Math.pow(".concat(r,", ").concat(i,")"),Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.math_single={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[[(0,n.localize)("square root"),"ROOT"],[(0,n.localize)("absolute"),"ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Operations on a given number"),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Operations on a given number"),description:(0,n.localize)("This block performs the selected operations to a given number.")}},getRequiredValueInputs:function(){return{NUM:null}}},Blockly.JavaScript.math_single=function(e){var t,o,n=e.getFieldValue("OP");return"NEG"===n?("-"===(o=Blockly.JavaScript.valueToCode(e,"NUM",Blockly.JavaScript.ORDER_UNARY_NEGATION)||"0")[0]&&(o=" ".concat(o)),[t="-".concat(o),Blockly.JavaScript.ORDER_UNARY_NEGATION]):(o=["SIN","COS","TAN"].includes(n)?Blockly.JavaScript.valueToCode(e,"NUM",Blockly.JavaScript.ORDER_DIVISION)||"0":Blockly.JavaScript.valueToCode(e,"NUM",Blockly.JavaScript.ORDER_NONE)||"0","ABS"===n?t="Math.abs(".concat(o,")"):"ROOT"===n?t="Math.sqrt(".concat(o,")"):"LN"===n?t="Math.log(".concat(o,")"):"EXP"===n?t="Math.pow(Math.E, ".concat(o,")"):"POW10"===n?t="Math.pow(10, ".concat(o,")"):"ROUND"===n?t="Math.round(".concat(o,")"):"ROUNDUP"===n?t="Math.ceil(".concat(o,")"):"ROUNDDOWN"===n?t="Math.floor(".concat(o,")"):"SIN"===n?t="Math.sin(".concat(o," / 180 * Math.PI)"):"COS"===n?t="Math.cos(".concat(o," / 180 * Math.PI)"):"TAN"===n&&(t="Math.tan(".concat(o," / 180 * Math.PI)")),t?[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]:("LOG10"===n?t="Math.log(".concat(o,") / Math.log(10)"):"ASIN"===n?t="Math.asin(".concat(o,") / Math.PI * 180"):"ACOS"===n?t="Math.acos(".concat(o,") / Math.PI * 180"):"ATAN"===n&&(t="Math.atan(".concat(o,") / Math.PI * 180")),[t,Blockly.JavaScript.ORDER_DIVISION]))},Blockly.Blocks.math_trig={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["sin","SIN"],["cos","COS"],["tan","TAN"],["asin","ASIN"],["acos","ACOS"],["atan","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Trigonometric functions"),category:Blockly.Categories.Mathematical}},meta:function(){return{display_name:(0,n.localize)("Trigonometric functions"),description:(0,n.localize)("This block performs trigonometric functions.")}},getRequiredValueInputs:function(){return{NUM:null}}},Blockly.JavaScript.math_trig=Blockly.JavaScript.math_single,Blockly.Blocks.text={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:"%1",args0:[{type:"field_input",name:"TEXT"}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Enter some text here"),category:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Text"),description:(0,n.localize)("A  block that can contain text.")}}},Blockly.JavaScript.text=function(e){return[Blockly.JavaScript.quote_(e.getFieldValue("TEXT")),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.text_join={protected_statements:["STACK"],allowed_children:["text_statement"],init:function(){var e=new Blockly.FieldImage(r.M8,25,25,"",this.onIconClick.bind(this));this.jsonInit(this.definition()),this.appendDummyInput("ADD_ICON").appendField(e),this.moveInputBefore("ADD_ICON","STACK")},definition:function(){return{message0:(0,n.localize)("set {{ variable }} to create text with",{variable:"%1"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:(0,n.localize)("text")}],args1:[{type:"input_statement",name:"STACK"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Text join"),category:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Text join"),description:(0,n.localize)("Creates a single text string from combining the text value of each attached item, without spaces in between. The number of items can be added accordingly.")}},onIconClick:function(){var e=this;this.workspace.options.readOnly||this.isInFlyout||(0,i.UR)(!1,(function(){var t=e.workspace.newBlock("text_statement");t.required_parent_id=e.id,t.setMovable(!0),t.initSvg(),t.render();var o=e.workspace.newBlock("text");o.setShadow(!0),o.setFieldValue("","TEXT"),o.initSvg(),o.render(),t.getInput("TEXT").connection.connect(o.outputConnection),e.getLastConnectionInStatement("STACK").connect(t.previousConnection)}))},onchange:Blockly.Blocks.lists_create_with.onchange},Blockly.JavaScript.text_join=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.getBlocksInStatement("STACK").map((function(e){var t=Blockly.JavaScript[e.type](e);return Array.isArray(t)?t[0]:t}));return"".concat(t," = [").concat(o,'].join(" ");\n')},Blockly.Blocks.text_statement={required_parent_type:"text_join",init:function(){this.required_parent_id="";var e=new Blockly.FieldImage(r.fK,25,25,"",this.onIconClick.bind(this));this.jsonInit(this.definition()),this.appendDummyInput("REMOVE_ICON").appendField(e)},definition:function(){return{message0:"%1",args0:[{type:"input_value",name:"TEXT"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,category:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Text Statement"),description:""}},onchange:function(e){var t=this;if(this.workspace&&!this.isInFlyout&&!this.workspace.isDragging()){var o=this.getSurroundParent();if(e.type===Blockly.Events.BLOCK_CREATE&&(this.setMovable(!0),this.required_parent_id||(null==o?void 0:o.type)!==this.required_parent_type||(this.required_parent_id=o.id)),e.type===Blockly.Events.END_DRAG){var n=Blockly.getMainWorkspace().getBlockById(e.blockId);if(this.required_parent_id&&(!o||o.id!==this.required_parent_id)){var r=Blockly.getMainWorkspace().getBlockById(this.required_parent_id);if(r)if(r.getInputTargetBlock("STACK")){var a=r.getLastConnectionInStatement("STACK");(0,i.$9)((function(){a.connect(t.previousConnection)}))}else(0,i.$9)((function(){r.getInput("STACK").connection.connect(n.previousConnection)}))}}}},onIconClick:Blockly.Blocks.lists_statement.onIconClick},Blockly.JavaScript.text_statement=function(e){return["String(".concat(Blockly.JavaScript.valueToCode(e,"TEXT",Blockly.JavaScript.ORDER_ATOMIC),")"),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.text_append={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("to {{ variable }} append text {{ input_text }}",{variable:"%1",input_text:"%2"}),args0:[{type:"field_variable",name:"VAR",variable:(0,n.localize)("text")},{type:"input_value",name:"TEXT"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Appends a given text to a variable"),category:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Text Append"),description:(0,n.localize)("Appends a given text to a variable.")}},getRequiredValueInputs:function(){return{TEXT:i.cM}}},Blockly.JavaScript.text_append=function(e){var t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),o=Blockly.JavaScript.valueToCode(e,"TEXT",Blockly.JavaScript.ORDER_NONE)||"''",n="".concat(t," += ").concat(function(e){return/^\s*'([^']|\\')*'\s*$/.test(e)?e:"String(".concat(e,")")}(o),";\n");return n},Blockly.Blocks.text_length={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("length of {{ input_text }}",{input_text:"%1"}),args0:[{type:"input_value",name:"VALUE"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Text String Length"),category:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Text String Length"),description:(0,n.localize)("Returns the number of characters of a given string of text, including numbers, spaces, punctuation marks, and symbols.")}},getRequiredValueInputs:function(){return{VALUE:i.cM}}},Blockly.JavaScript.text_length=function(e){var t=Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_FUNCTION_CALL)||"''";return["".concat(t,".length"),Blockly.JavaScript.ORDER_MEMBER]},Blockly.Blocks.text_isEmpty={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("text {{ input_text }} is empty",{input_text:"%1"}),args0:[{type:"input_value",name:"VALUE",check:["String"]}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Tests if a given text string is empty"),category:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Text Is empty"),description:(0,n.localize)("Tests whether a string of text is empty. Returns a boolean value (true or false).")}},getRequiredValueInputs:function(){return{VALUE:i.cM}}},Blockly.JavaScript.text_isEmpty=function(e){var t=Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"''";return[-1!==e.workspace.getAllVariables().findIndex((function(e){return e.name===t}))?"!".concat(t," || !").concat(t,".length"):"!".concat(t,".length"),Blockly.JavaScript.ORDER_LOGICAL_NOT]},Blockly.Blocks.text_indexOf={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("in text {{ input_text1 }} find {{ first_or_last }} occurence of text {{ input_text2 }}",{input_text1:"%1",first_or_last:"%2",input_text2:"%3"}),args0:[{type:"input_value",name:"VALUE"},{type:"field_dropdown",name:"END",options:[[(0,n.localize)("first"),"FIRST"],[(0,n.localize)("last"),"LAST"]]},{type:"input_value",name:"FIND"}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Search for a given string"),cateogry:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Search for string"),description:(0,n.localize)("Searches through a string of text for a specific occurrence of a given character or word, and returns the position.")}},getRequiredValueInputs:function(){return{VALUE:i.cM,FIND:i.cM}}},Blockly.JavaScript.text_indexOf=function(e){var t="FIRST"===e.getFieldValue("END")?"indexOf":"lastIndexOf",o=Blockly.JavaScript.valueToCode(e,"FIND",Blockly.JavaScript.ORDER_NONE)||"''",n=Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"''",r="".concat(n,".").concat(t,"(").concat(o,")");return e.workspace.options.oneBasedIndex?["".concat(r," + 1"),Blockly.JavaScript.ORDER_ADDITION]:[r,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.text_charAt={init:function(){var e=this;this.jsonInit(this.definition()),this.getField("WHERE").setValidator((function(t){var o=["FROM_START","FROM_END"].includes(t);if(o!==e.isAt)return e.updateAt(o),e.setFieldValue(t,"WHERE"),null})),this.updateAt(!0)},definition:function(){return{message0:(0,n.localize)("in text %1 get %2"),args0:[{type:"input_value",name:"VALUE"},{type:"field_dropdown",name:"WHERE",options:[[(0,n.localize)("letter #"),"FROM_START"],[(0,n.localize)("letter # from end"),"FROM_END"],[(0,n.localize)("first letter"),"FIRST"],[(0,n.localize)("last letter"),"LAST"],[(0,n.localize)("random letter"),"RANDOM"]]}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns a specific character from a given string"),category:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Get character"),description:(0,n.localize)("Returns the specific character from a given string of text according to the selected option. ")}},mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("at",!!this.isAt),e},domToMutation:function(e){var t="false"!==e.getAttribute("at");this.updateAt(t)},updateAt:function(e){this.removeInput("AT",!0),e&&this.appendValueInput("AT").setCheck("Number"),this.isAt=e,this.initSvg(),this.render(!1)},getRequiredValueInputs:function(){return{VALUE:i.cM,AT:i.cM}}},Blockly.JavaScript.text_charAt=function(e){var t,o=e.getFieldValue("WHERE")||"FROM_START",n="RANDOM"===o?Blockly.JavaScript.ORDER_NONE:Blockly.JavaScript.ORDER_MEMBER,r=Blockly.JavaScript.valueToCode(e,"VALUE",n)||"''";if("FROM_START"===o){var i=Blockly.JavaScript.getAdjusted(e,"AT");t="".concat(r,".charAt(").concat(i,")")}else if("FROM_END"===o){var a=Blockly.JavaScript.getAdjusted(e,"AT",1,!0);t="".concat(r,".slice(").concat(a,").charAt(0)")}else if("FIRST"===o)t="".concat(r,".charAt(0)");else if("LAST"===o)t="".concat(r,".slice(-1)");else if("RANDOM"===o){var l=Blockly.JavaScript.provideFunction_("textRandomLetter",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(text) {\n                var x = Math.floor(Math.random() * text.length);\n                return text[x];\n            }")]);t="".concat(l,"(").concat(r,")")}return[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[(0,n.localize)("letter #"),"FROM_START"],[(0,n.localize)("letter # from end"),"FROM_END"],[(0,n.localize)("first"),"FIRST"]],this.WHERE_OPTIONS_2=[[(0,n.localize)("letter #"),"FROM_START"],[(0,n.localize)("letter # from end"),"FROM_END"],[(0,n.localize)("last"),"LAST"]],this.jsonInit(this.definition()),this.updateAt(1,!0),this.updateAt(2,!0)},definition:function(){return{message0:(0,n.localize)("in text {{ input_text }} get substring from {{ position1 }} {{ index1 }} to {{ position2 }} {{ index2 }}",{input_text:"%1",position1:"%2",index1:"%3",position2:"%4",index2:"%5"}),args0:[{type:"input_value",name:"STRING"},{type:"field_dropdown",name:"WHERE1",options:this.WHERE_OPTIONS_1},{type:"input_dummy",name:"AT1"},{type:"field_dropdown",name:"WHERE2",options:this.WHERE_OPTIONS_2},{type:"input_dummy",name:"AT2"}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Returns a specific portion of a given string of text."),category:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Get substring"),description:(0,n.localize)("Returns a specific portion of a given string of text.")}},mutationToDom:function(){var e=document.createElement("mutation"),t=this.getInput("AT1").type===Blockly.INPUT_VALUE,o=this.getInput("AT2").type===Blockly.INPUT_VALUE;return e.setAttribute("at1",t),e.setAttribute("at2",o),e},domToMutation:function(e){var t="true"===e.getAttribute("at1"),o="true"===e.getAttribute("at2");this.updateAt(1,t),this.updateAt(2,o)},updateAt:function(e,t){var o,n=this,r=this.getInput("AT".concat(e));r&&(r.fieldRow.some((function(e){e instanceof Blockly.FieldLabel&&(o=e.text_)})),this.removeInput("AT".concat(e)));var i=t?this.appendValueInput("AT".concat(e)).setCheck("Number"):this.appendDummyInput("AT".concat(e));o&&i.insertFieldAt(0,new Blockly.FieldLabel(o));var a=new Blockly.FieldDropdown(this["WHERE_OPTIONS_".concat(e)],(function(o){var r=["FROM_START","FROM_END"].includes(o);if(r!==t)return n.updateAt(e,r),n.setFieldValue(o,"WHERE".concat(e)),null}));this.getInput("AT".concat(e)).appendField(a,"WHERE".concat(e)),1===e&&this.moveInputBefore("AT1","AT2"),this.initSvg(),this.render(!1)},getRequiredValueInputs:function(){var e=this,t=function(t){var o;return(null===(o=e.getInput(t))||void 0===o?void 0:o.type)===Blockly.INPUT_VALUE};return _(_({STRING:i.cM},t("AT1")?{AT1:i.cM}:{}),t("AT2")?{AT2:i.cM}:{})}},Blockly.JavaScript.text_getSubstring=function(e){var t,o,n,r=Blockly.JavaScript.valueToCode(e,"STRING",Blockly.JavaScript.ORDER_FUNCTION_CALL)||"''",i=e.getFieldValue("WHERE1"),a=e.getFieldValue("WHERE2");if("FIRST"===i&&"LAST"===a)n=r;else if(r.match(/^'?\w+'?$/)||"FROM_END"!==i&&"LAST"!==i&&"FROM_END"!==a&&"LAST"!==a){switch(i){case"FROM_START":t=Blockly.JavaScript.getAdjusted(e,"AT1");break;case"FROM_END":t=Blockly.JavaScript.getAdjusted(e,"AT1",1,!1,Blockly.JavaScript.ORDER_SUBTRACTION),t="".concat(r,".length - ").concat(t);break;case"FIRST":t="0"}switch(a){case"FROM_START":o=Blockly.JavaScript.getAdjusted(e,"AT2",1);break;case"FROM_END":o=Blockly.JavaScript.getAdjusted(e,"AT2",0,!1,Blockly.JavaScript.ORDER_SUBTRACTION),o="".concat(r,".length - ").concat(o);break;case"LAST":o="".concat(r,".length")}n="".concat(r,".slice(").concat(t,", ").concat(o,")")}else{t=Blockly.JavaScript.getAdjusted(e,"AT1"),o=Blockly.JavaScript.getAdjusted(e,"AT2");var l=function(e,t,o){return"FIRST"===t?"0":"FROM_END"===t?"".concat(e,".length - 1 - ").concat(o):"LAST"===t?"".concat(e,".length - 1"):o},c={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"},s=Blockly.JavaScript.provideFunction_("subsequence".concat(c[i]).concat(c[a]),["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(\n                    sequence\n                    ").concat("FROM_END"===i||"FROM_START"===i?", at1":"","\n                    ").concat("FROM_END"===a||"FROM_START"===a?", at2":"","\n                ) {\n                    var start = ").concat(l("sequence",i,"at1"),";\n                    var end   = ").concat(l("sequence",a,"at2")," + 1;\n                    \n                    return sequence.slice(start, end);\n                }")]);n="".concat(s,"(\n            ").concat(r,"\n            ").concat("FROM_END"===i||"FROM_START"===i?", ".concat(t):"","\n            ").concat("FROM_END"===a||"FROM_START"===a?", ".concat(o):"","\n        )")}return[n,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.text_changeCase={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("Transform {{ input_text }} to {{ transform_type }}",{input_text:"%1",transform_type:"%2"}),args0:[{type:"input_value",name:"TEXT"},{type:"field_dropdown",name:"CASE",options:[[(0,n.localize)("UPPER CASE"),"UPPERCASE"],[(0,n.localize)("lower case"),"LOWERCASE"],[(0,n.localize)("Title Case"),"TITLECASE"]]}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Changes text case accordingly"),category:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Change text case"),description:(0,n.localize)("Changes the capitalisation of a string of text to Upper case, Lower case, Title case.")}},getRequiredValueInputs:function(){return{TEXT:i.cM}}},Blockly.JavaScript.text_changeCase=function(e){var t,o={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[e.getFieldValue("CASE")],n=o?Blockly.JavaScript.ORDER_MEMBER:Blockly.JavaScript.ORDER_NONE,r=Blockly.JavaScript.valueToCode(e,"TEXT",n)||"''";if(o)t="".concat(r).concat(o);else{var i=Blockly.JavaScript.provideFunction_("textToTitleCase",["function ".concat(Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_,"(str) {\n                return str.toLowerCase().split(' ').map(function(word) {\n                    return word.replace(word[0], word[0].toUpperCase());\n                }).join(' ');\n            }")]);t="".concat(i,"(").concat(r,")")}return[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.text_trim={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("trim spaces from {{ side }} of {{ input_text }}",{side:"%1",input_text:"%2"}),args0:[{type:"field_dropdown",name:"MODE",options:[[(0,n.localize)("both sides"),"BOTH"],[(0,n.localize)("left side"),"LEFT"],[(0,n.localize)("right side"),"RIGHT"]]},{type:"input_value",name:"TEXT"}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,n.localize)("Trims spaces"),category:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Trim spaces"),description:(0,n.localize)("Trims the spaces within a given string or text.")}},getRequiredValueInputs:function(){return{TEXT:i.cM}}},Blockly.JavaScript.text_trim=function(e){var t={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[e.getFieldValue("MODE")],o=Blockly.JavaScript.valueToCode(e,"TEXT",Blockly.JavaScript.ORDER_MEMBER)||"''";return["".concat(o).concat(t),Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.text_print={init:function(){this.jsonInit(this.definition())},definition:function(){return{message0:(0,n.localize)("print {{ input_text }}",{input_text:"%1"}),args0:[{type:"input_value",name:"TEXT"}],colour:Blockly.Colours.Special3.colour,colourSecondary:Blockly.Colours.Special3.colourSecondary,colourTertiary:Blockly.Colours.Special3.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,n.localize)("Displays a dialog window with a message"),category:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Print"),description:(0,n.localize)('This block displays a dialog box with a customised message. When the dialog box is displayed, your strategy is paused and will only resume after you click "OK".')}},getRequiredValueInputs:function(){return{TEXT:i.cM}}},Blockly.JavaScript.text_print=function(e){var t=Blockly.JavaScript.valueToCode(e,"TEXT",Blockly.JavaScript.ORDER_NONE)||"''";return"window.alert(".concat(t,");\n")},Blockly.Blocks.text_prompt_ext={init:function(){var e=this;this.jsonInit(this.definition()),this.getField("TYPE").setValidator((function(t){"TEXT"===t?e.setOutput(!0,"String"):"NUMBER"===t&&e.setOutput(!0,"Number"),e.initSvg(),e.render(!1)}))},definition:function(){return{message0:(0,n.localize)("prompt for {{ string_or_number }} with message {{ input_text }}",{string_or_number:"%1",input_text:"%2"}),args0:[{type:"field_dropdown",name:"TYPE",options:[[(0,n.localize)("string"),"TEXT"],[(0,n.localize)("number"),"NUMBER"]]},{type:"input_value",name:"TEXT"}],output:"function"==typeof this.getFieldValue&&"TEXT"===this.getFieldValue("TYPE")?"String":"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Special3.colour,colourSecondary:Blockly.Colours.Special3.colourSecondary,colourTertiary:Blockly.Colours.Special3.colourTertiary,tooltip:(0,n.localize)("Request an input"),category:Blockly.Categories.Text}},meta:function(){return{display_name:(0,n.localize)("Request an input"),description:(0,n.localize)('This block displays a dialog box that uses a customised message to prompt for an input. The input can be either a string of text or a number and can be assigned to a variable. When the dialog box is displayed, your strategy is paused and will only resume after you enter a response and click "OK".')}},getRequiredValueInputs:function(){return{TEXT:i.cM}}},Blockly.JavaScript.text_prompt_ext=function(e){var t;return t=e.getField("TEXT")?Blockly.JavaScript.quote_(e.getFieldValue("TEXT")):Blockly.JavaScript.valueToCode(e,"TEXT",Blockly.JavaScript.ORDER_NONE)||"''",["NUMBER"===e.getFieldValue("TYPE")?"parseFloat(window.prompt(".concat(t,"))"):"window.prompt(".concat(t,")"),Blockly.JavaScript.ORDER_FUNCTION_CALL]}},282:(e,t,o)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}function i(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function l(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,o){return t&&l(e.prototype,t),o&&l(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}o.d(t,{Z:()=>p});var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)}(l,e);var t,o,n=(t=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=a(t);if(o){var r=a(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return i(this,e)});function l(e){var t;return s(this,l),(t=n.call(this)).is_mobile=e.is_mobile||!1,t.is_dark_mode_on=e.is_dark_mode_on||!1,t.client=e.client,t.flyout=e.flyout,t.populateConfig=e.populateConfig,t.toolbar=e.toolbar,t.toolbox=e.toolbox,t.save_modal=e.save_modal,t.setContractUpdateConfig=e.setContractUpdateConfig,t.toggleStrategyModal=e.toggleStrategyModal,t.handleFileChange=e.handleFileChange,t.startLoading=e.startLoading,t.endLoading=e.endLoading,t}return c(l,null,[{key:"setInstance",value:function(e){return this.singleton=new l(e),this.instance}},{key:"instance",get:function(){return this.singleton}}]),l}(c((function e(){s(this,e),this.handleFileChange=function(){throw Error("handleFileChange has not been implemented.")},this.toggleStrategyModal=function(){throw Error("handleFileChange has not been implemented.")}})));u.singleton=null;const p=u},129:()=>{Blockly.BlockSvg.MIN_BLOCK_X_WITH_STATEMENT=100*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.START_HAT_PATH="m 0,".concat(Blockly.BlockSvg.CORNER_RADIUS," A ").concat(Blockly.BlockSvg.CORNER_RADIUS,", ").concat(Blockly.BlockSvg.CORNER_RADIUS," 0 0,1 ").concat(Blockly.BlockSvg.CORNER_RADIUS,",0"),Blockly.BlockSvg.EXTRA_STATEMENT_ROW_Y=10*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.EDITABLE_FIELD_PADDING=16,Blockly.BlockSvg.prototype.updateColour=function(){var e=this.getColourTertiary(),t=this.isShadow()&&!Blockly.scratchBlocksUtils.isShadowArgumentReporter(this);t&&this.parentBlock_&&(e=this.parentBlock_.getColourTertiary(),this.inputList[0]&&this.inputList[0].fieldRow[0]&&(this.inputList[0].fieldRow[0]instanceof Blockly.FieldColour||this.inputList[0].fieldRow[0]instanceof Blockly.FieldColourSlider)&&(e=Blockly.Colours.colourPickerStroke)),this.svgPath_.setAttribute("stroke",e);var o=this.getColour();(this.isGlowingBlock_||t)&&(o=this.getShadowColour()?this.getShadowColour():this.getColourSecondary()),this.svgPath_.setAttribute("fill",o),this.svgPath_.setAttribute("fill-opacity",this.getOpacity());for(var n,r=0;n=this.inputList[r];r++)n.outlinePath&&n.outlinePath.setAttribute("fill",this.getColourTertiary());for(var i=this.getIcons(),a=0;a<i.length;a++)i[a].updateColour();for(var l,c=0;l=this.inputList[c];c++)for(var s,u=0;s=l.fieldRow[u];u++)s.setText(null);this.inputList.forEach((function(e){e.outlinePath&&(e.outlinePath.setAttribute("fill","#fff"),e.outlinePath.setAttribute("stroke","#6d7278"),e.outlinePath.setAttribute("stroke-width","0.3px"))}))},Blockly.BlockSvg.prototype.computeOutputPadding_=function(e){if(this.getOutputShape()&&this.outputConnection&&(!this.isShadow()||Blockly.scratchBlocksUtils.isShadowArgumentReporter(this))&&!(e.length>1)){var t=e[0],o=this.getOutputShape();t.paddingStart=0,t.paddingEnd=0;var n,r=t[0];if(r.fieldRow[0])n=0;else{var i=r.connection;if(!i)return;if(n=i.targetConnection?i.targetConnection.getSourceBlock().getOutputShape():i.getOutputShape(),o===Blockly.OUTPUT_SHAPE_HEXAGONAL&&n!==Blockly.OUTPUT_SHAPE_HEXAGONAL){var a=r.renderHeight-Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER;t.paddingStart+=a/2}}t.paddingStart+=Blockly.BlockSvg.SHAPE_IN_SHAPE_PADDING[o][n];var l=t[t.length-1];if(l.connection){var c=l.connection;if(n=c.targetConnection?c.targetConnection.getSourceBlock().getOutputShape():c.getOutputShape(),o===Blockly.OUTPUT_SHAPE_HEXAGONAL&&n!==Blockly.OUTPUT_SHAPE_HEXAGONAL){var s=l.renderHeight-Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER;t.paddingEnd+=s/2}}else n=0;t.paddingEnd+=Blockly.BlockSvg.SHAPE_IN_SHAPE_PADDING[o][n]}}},2646:()=>{Blockly.Colours.RootBlock={colour:"#064e72",colourSecondary:"#064e72",colourTertiary:"#6d7278"},Blockly.Colours.Base={colour:"#e5e5e5",colourSecondary:"#ffffff",colourTertiary:"#6d7278"},Blockly.Colours.Special1={colour:"#e5e5e5",colourSecondary:"#ffffff",colourTertiary:"#6d7278"},Blockly.Colours.Special2={colour:"#e5e5e5",colourSecondary:"#ffffff",colourTertiary:"#6d7278"},Blockly.Colours.Special3={colour:"#e5e5e5",colourSecondary:"#ffffff",colourTertiary:"#6d7278"}},7779:()=>{Blockly.Connection.prototype.getOutputShape=function(){return Blockly.OUTPUT_SHAPE_ROUND}},1863:()=>{Blockly.Categories={Trade_Definition:"trade_parameters",Before_Purchase:"purchase_conditions",During_Purchase:"sell_conditions",After_Purchase:"trade_results",Mathematical:"math",Logic:"logic",Text:"text",Variables:"variables",Functions:"custom_functions",List:"lists",Indicators:"indicators",Time:"time",Tick_Analysis:"technical_analysis",Candle:"candle",Miscellaneous:"miscellaneous",Loop:"loops"},Blockly.DRAG_RADIUS=3,Blockly.FLYOUT_DRAG_RADIUS=1},119:()=>{Blockly.Css.CONTENT=["@keyframes blinkEffect {","0% {","stroke: var(--status-danger);","stroke-width: 5px;","}","50% {","stroke: var(--status-warning);","stroke-width: 8px;","}","100% {","stroke: var(--status-danger);","stroke-width: 5px;","}","}",".block--error-highlighted > .blocklyPath {","stroke: var(--status-danger);","stroke-width: 5px;","}","@keyframes fade-in-out {","0%{","stroke-opacity: 0;","}","50%{","stroke-opacity: 1;","stroke-width: 6px;","}","100%{","stroke-opacity: 0;","}}",".block--execution-highlighted > .blocklyPath {","stroke: #89B2AF;","animation: fade-in-out 1.5s","}",".block--blink > .blocklyPath {","animation: blinkEffect 1s infinite;","}",".blocklySvg {","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyRelativeWrapper {","position: relative;","width: 100%;","height: 100%;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none","}",".blocklyNonSelectable {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","-ms-user-select: none;","}",".blocklyWidgetDiv.fieldTextInput {","overflow: hidden;","border: 1px solid;","box-sizing: border-box;","transform-origin: 0 0;","-ms-transform-origin: 0 0;","-moz-transform-origin: 0 0;","-webkit-transform-origin: 0 0;","}",".blocklyWidgetDiv.fieldTextInput.removableTextInput {","overflow: visible;","}",".blocklyTextDropDownArrow {","position: absolute;","}",".blocklyTextRemoveIcon {","position: absolute;","width: 24px;","height: 24px;","top: -40px;","left: 50%;","margin-left: -12px;","cursor: pointer;","}",".blocklyNonSelectable {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","-ms-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","}",".blocklyWsDragSurface.blocklyOverflowVisible {","overflow: visible;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyTooltipDiv {","min-height: 34px;","background-color: #d6dadb;","border-radius: 4px;","color: var(--text-prominent);","padding: 8px;","font-size: 12px;",'font-family: "IBM Plex Sans";',"line-height: 1.5;","letter-spacing: normal;","position: absolute;","z-index: 100000;","}",".blocklyDropDownDiv {","position: fixed;","left: 0;","top: 0;","z-index: 1000;","display: none;","border: 1px solid;","border-radius: 4px;","box-shadow: 0px 0px 8px 1px ".concat(Blockly.Colours.dropDownShadow,";"),"padding: 4px;","-webkit-user-select: none;","min-height: 15px","}",".blocklyDropDownContent {","max-height: 300px;","overflow: auto;","}",".blocklyDropDownArrow {","position: absolute;","left: 0;","top: 0;","width: 16px;","height: 16px;","z-index: -1;","background-color: inherit;","border-color: inherit;","}",".blocklyDropDownButton {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","border-radius: 4px;","outline: none;","border: 1px solid;","transition: box-shadow .1s;","cursor: pointer;","}",".blocklyDropDownButtonHover {","box-shadow: 0px 0px 0px 4px ".concat(Blockly.Colours.fieldShadow,";"),"}",".blocklyDropDownButton:active {","box-shadow: 0px 0px 0px 6px ".concat(Blockly.Colours.fieldShadow,";"),"}",".blocklyDropDownButton > img {","width: 80%;","height: 80%;","margin-top: 5%","}",".blocklyDropDownPlaceholder {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","}",".blocklyNumPadButton {","display: inline-block;","float: left;","padding: 0;","width: 48px;","height: 48px;","margin: 4px;","border-radius: 4px;","background: $colour_numPadBackground;","color: $colour_numPadText;","outline: none;","border: 1px solid $colour_numPadBorder;","cursor: pointer;","font-weight: 600;","font-size: 12pt;","-webkit-tap-highlight-color: rgba(0,0,0,0);","}",".blocklyNumPadButton > img {","margin-top: 10%;","width: 80%;","height: 80%;","}",".blocklyNumPadButton:active {","background: $colour_numPadActiveBackground;","-webkit-tap-highlight-color: rgba(0,0,0,0);","}",".arrowTop {","border-top: 1px solid;","border-left: 1px solid;","border-top-left-radius: 4px;","border-color: inherit;","}",".arrowBottom {","border-bottom: 1px solid;","border-right: 1px solid;","border-bottom-right-radius: 4px;","border-color: inherit;","}",".valueReportBox {","min-width: 50px;","max-width: 300px;","max-height: 200px;","overflow: auto;","word-wrap: break-word;","text-align: center;","font-size: .8em;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #888;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPath {","stroke-width: 0.3px;","}",".blocklySelected>.blocklyPath {","stroke: #ffc358;","stroke-width: 3px;","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","cursor: -moz-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","cursor: -moz-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","cursor: -moz-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","cursor: -moz-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyDragging.blocklyDraggingMouseThrough {","pointer-events: none;","}",".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxGrab {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: 1.0;","stroke-opacity: 1.0;","}",".blocklyDragging>.blocklyPath {","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyInsertionMarker>.blocklyPath {","stroke: none;","}",".blocklyText {","fill: var(--text-general);","font-family: inherit;","font-size: var(--text-size-s);","font-weight: normal;","font-stretch: normal;","font-style: normal;","line-height: 1.5;","letter-spacing: normal;","}",".blocklyTextTruncated {","font-size: 11pt;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyNonEditableText>text,",".blocklyEditableText>text {","}",".blocklyEditableText>.blocklyEditableLabel {","fill: var(--text-general);","}",".blocklyDropdownText {","fill: var(--text-general) !important;","}",".blocklyBubbleText {","fill: $colour_text;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyFlyoutButton {","fill: none;","pointer-events: all;","}",".blocklyFlyoutButtonBackground {","stroke: #c6c6c6;","}",".blocklyFlyoutButton .blocklyText {","fill: $colour_text;","}",".blocklyFlyoutButtonShadow {","fill: transparent;","}",".blocklyFlyoutButton:hover {","fill: white;","cursor: pointer;","}",".blocklyFlyoutLabel {","cursor: default;","}",".blocklyFlyoutLabelBackground {","opacity: 0;","}",".blocklyFlyoutLabelText {","font-size: 14pt;","fill: #575E75;","font-weight: bold;","}",".blocklySvg text, .blocklyBlockDragSurface text, .blocklyFlyout text, .blocklyToolboxDiv text {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyCommentForeignObject {","position: relative;","z-index: 0;","}",".blocklyCommentRect {","fill: #E7DE8E;","stroke: #bcA903;","stroke-width: 1px","}",".blocklyCommentTarget {","fill: transparent;","stroke: #bcA903;","}",".blocklyCommentTargetFocused {","fill: none;","}",".blocklyCommentHandleTarget {","fill: none;","}",".blocklyCommentHandleTargetFocused {","fill: transparent;","}",".blocklyFocused>.blocklyCommentRect {","fill: #B9B272;","stroke: #B9B272;","}",".blocklySelected>.blocklyCommentTarget {","stroke: #fc3;","stroke-width: 3px;","}",".blocklyCommentTextarea {","background-color: #fef49c;","border: 0;","outline: 0;","margin: 0;","padding: 3px;","resize: none;","display: block;","overflow: hidden;","}",".blocklyCommentDeleteIcon {","cursor: pointer;","fill: #000;","display: none","}",".blocklySelected > .blocklyCommentDeleteIcon {","display: block","}",".blocklyDeleteIconShape {","fill: #000;","stroke: #000;","stroke-width: 1px;","}",".blocklyDeleteIconShape.blocklyDeleteIconHighlighted {","stroke: #fc3;","}",".scratchCommentForeignObject {","position: relative;","}",".scratchCommentBody {","background-color: #fef49c;","border-radius: 4px;","}",".scratchCommentRect {","fill: #fef49c;","}",".scratchCommentTarget {","fill: transparent;","}",".scratchWorkspaceCommentBorder {","stroke: #bcA903;","stroke-width: 1px;","}",".scratchCommentTargetFocused {","fill: none;","}",".scratchCommentTopBar {","fill: #000000;","fill-opacity: 0.1","}",".scratchCommentText {","font-size: 12pt;","font-weight: 400;","}",".scratchCommentTextarea {","background-color: #fef49c;","border: 0;","outline: 0;","padding: 0;","resize: none;","overflow: hidden;","}",".scratchCommentResizeSE {","cursor: se-resize;","fill: transparent;","}",".scratchCommentResizeSW {","cursor: sw-resize;","fill: transparent;","}",".blocklyHtmlInput {","border: none;","font-size: 12pt;","height: 100%;","margin: 0;","outline: none;","box-sizing: border-box;","width: 100%;","text-align: center;","color: $colour_text;","font-weight: 500;","}",".blocklyMainBackground {","stroke-width: 0;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: $colour_flyout;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal, .blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: $colour_scrollbar;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: $colour_scrollbarHover;","}",".blocklyZoom>image {","opacity: 1;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyAngleCircle {","stroke: ".concat(Blockly.Colours.motion.tertiary,";"),"stroke-width: 1;","fill: ".concat(Blockly.Colours.motion.secondary,";"),"}",".blocklyAngleCenterPoint {","stroke: #fff;","stroke-width: 1;","fill: #fff;","}",".blocklyAngleDragHandle {","stroke: #fff;","stroke-width: 5;","stroke-opacity: 0.25;","fill: #fff;","cursor: pointer;","}",".blocklyAngleDragArrow {","pointer-events: none","}",".blocklyAngleMarks {","stroke: #fff;","stroke-width: 1;","stroke-opacity: 0.5;","}",".blocklyAngleGauge {","fill: #fff;","fill-opacity: 0.20;","}",".blocklyAngleLine {","stroke: #fff;","stroke-width: 1;","stroke-linecap: round;","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","max-height: 100%;","}",".blocklyDropdownMenu {","padding: 0 !important;","}",".blocklyDropDownNumPad {","background-color: $colour_numPadBackground;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px !important;","}",".blocklyToolboxDiv {","background-color: $colour_toolbox;","color: $colour_toolboxText;","overflow-x: visible;","overflow-y: auto;","position: absolute;","z-index: 40;","-webkit-tap-highlight-color: transparent;","}",".blocklyTreeRoot {","padding: 4px 0;","}",".blocklyTreeRoot:focus {","outline: none;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",".blocklyHorizontalTree {","float: left;","margin: 1px 5px 8px 0;","}",".blocklyHorizontalTreeRtl {","float: right;","margin: 1px 0 8px 5px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","}",".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: #e4e4e4;","}",".blocklyTreeSeparator {","border-bottom: solid #e5e5e5 1px;","height: 0;","margin: 5px 0;","}",".blocklyTreeSeparatorHorizontal {","border-right: solid #e5e5e5 1px;","width: 0;","padding: 5px 0;","margin: 0 5px;","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","width: 16px;","}",".blocklyTreeIconClosedLtr {","background-position: -32px -1px;","}",".blocklyTreeIconClosedRtl {","background-position: 0px -1px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedLtr {","background-position: -32px -17px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedRtl {","background-position: 0px -17px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeIconNone,",".blocklyTreeSelected>.blocklyTreeIconNone {","background-position: -48px -1px;","}",".blocklyTreeLabel {","cursor: default;","font-size: 16px;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}",".blocklyDropDownDiv .goog-slider-horizontal {","margin: 8px;","height: 22px;","width: 150px;","position: relative;","outline: none;","border-radius: 11px;","margin-bottom: 20px;","}",".blocklyDropDownDiv .goog-slider-horizontal .goog-slider-thumb {","width: 26px;","height: 26px;","top: -1px;","position: absolute;","background-color: white;","border-radius: 100%;","-webkit-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);","-moz-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);","box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);","}",".scratchEyedropper {","background: none;","outline: none;","border: none;","width: 100%;","text-align: center;","border-top: 1px solid #ddd;","padding-top: 5px;","cursor: pointer;","}",".scratchColourPickerLabel {","font-size: 0.65rem;","color: $colour_toolboxText;","margin: 8px;","}",".scratchColourPickerLabelText {","font-weight: bold;","}",".scratchColourPickerReadout {","margin-left: 10px;","}",".scratchMatrixButtonDiv {","width: 50%;","text-align: center;","float: left;","}",".scratchNotePickerKeyLabel {","font-size: 0.75rem;","fill: $colour_text;","pointer-events: none;","}",".blocklyWidgetDiv .goog-menu {","background: #fff;","border-color: #ccc #666 #666 #ccc;","border-style: solid;","border-width: 1px;","cursor: default;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","z-index: 20000;","}",".blocklyDropDownDiv .goog-menu {","cursor: default;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"outline: none;","z-index: 20000;","}",".blocklyWidgetDiv .goog-menuitem {","color: #000;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"list-style: none;","margin: 0;","padding: 4px 7em 4px 28px;","white-space: nowrap;","}",".blocklyDropDownDiv .goog-menuitem {","color: var(--text-general);",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"font-weight: bold;","list-style: none;","margin: 0;","min-height: 24px;","padding: 4px 7em 4px 28px;","white-space: nowrap;","}",".blocklyWidgetDiv .goog-menuitem.goog-menuitem-rtl, ",".blocklyDropDownDiv .goog-menuitem.goog-menuitem-rtl {","padding-left: 7em;","padding-right: 28px;","}",".blocklyWidgetDiv .goog-menu-nocheckbox .goog-menuitem,",".blocklyWidgetDiv .goog-menu-noicon .goog-menuitem, ",".blocklyDropDownDiv .goog-menu-nocheckbox .goog-menuitem,",".blocklyDropDownDiv .goog-menu-noicon .goog-menuitem { ","padding-left: 12px;","}",".blocklyWidgetDiv .goog-menu-noaccel .goog-menuitem, ",".blocklyDropDownDiv .goog-menu-noaccel .goog-menuitem {","padding-right: 20px;","}",".blocklyWidgetDiv .goog-menuitem-content ",".blocklyDropDownDiv .goog-menuitem-content {","color: #000;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-accel,",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-content, ",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-accel,",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-content {","color: #ccc !important;","}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-icon, ",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-icon {","opacity: 0.3;","-moz-opacity: 0.3;","filter: alpha(opacity=30);","}",".blocklyWidgetDiv .goog-menuitem-highlight,",".blocklyWidgetDiv .goog-menuitem-hover {","background-color: #d6e9f8;","border-color: #d6e9f8;","border-style: dotted;","border-width: 1px 0;","padding-bottom: 3px;","padding-top: 3px;","}",".blocklyDropDownDiv .goog-menuitem-highlight,",".blocklyDropDownDiv .goog-menuitem-hover {","background-color: rgba(0, 0, 0, 0.2);","}",".blocklyWidgetDiv .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-icon, ",".blocklyDropDownDiv .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-menuitem-icon {","background-repeat: no-repeat;","height: 16px;","left: 6px;","position: absolute;","right: auto;","vertical-align: middle;","width: 16px;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon,",".blocklyDropDownDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-option-selected .goog-menuitem-icon {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px !important;","position: static;","float: left;","margin-left: -24px;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-icon,",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-icon {","float: right;","margin-right: -24px;","}",".blocklyWidgetDiv .goog-menuitem-accel, ",".blocklyDropDownDiv .goog-menuitem-accel {","color: #999;","direction: ltr;","left: auto;","padding: 0 6px;","position: absolute;","right: 0;","text-align: right;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-accel, ",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-accel {","left: 0;","right: auto;","text-align: left;","}",".blocklyWidgetDiv .goog-menuitem-mnemonic-hint, ",".blocklyDropDownDiv .goog-menuitem-mnemonic-hint {","text-decoration: underline;","}",".blocklyWidgetDiv .goog-menuitem-mnemonic-separator, ",".blocklyDropDownDiv .goog-menuitem-mnemonic-separator {","color: #999;","font-size: 12px;","padding-left: 4px;","}",".blocklyWidgetDiv .goog-menuseparator, ",".blocklyDropDownDiv .goog-menuseparator {","border-top: 1px solid #ccc;","margin: 4px 0;","padding: 0;","}",".blocklyFlyoutCheckbox {","fill: white;","stroke: #c8c8c8;","}",".blocklyFlyoutCheckbox.checked {","fill: ".concat(Blockly.Colours.motion.primary,";"),"stroke: ".concat(Blockly.Colours.motion.tertiary,";"),"}",".blocklyFlyoutCheckboxPath {","stroke: white;","stroke-width: 3;","stroke-linecap: round;","stroke-linejoin: round;","}",".scratchCategoryMenu {","width: 60px;","background: $colour_toolbox;","color: $colour_toolboxText;","font-size: .7rem;","user-select: none;","-webkit-user-select: none;","-moz-user-select: none;","-ms-user-select: none;","}",".scratchCategoryMenuHorizontal {","width: 100%;","height: 50px;","background: $colour_toolbox;","color: $colour_toolboxText;","font-size: .7em;","user-select: none;","-webkit-user-select: none;","-moz-user-select: none;","-ms-user-select: none;","}",".scratchCategoryMenuHorizontal .scratchCategoryMenuRow {","float: left;","margin: 3px;","}",".scratchCategoryMenuRow {","}",".scratchCategoryMenuItem {","padding: 0.375rem 0px;","cursor: pointer;","text-align: center;","}",".scratchCategoryMenuHorizontal .scratchCategoryMenuItem {","padding: 6px 5px;","}",".scratchCategoryMenuItem.categorySelected {","background: $colour_toolboxSelected;","}",".scratchCategoryItemBubble {","width: 1.25rem;","height: 1.25rem;","border: 1px solid;","border-radius: 100%;","margin: 0 auto 0.125rem;","}",".scratchCategoryItemIcon {","width: 1.25rem;","height: 1.25rem;","margin: 0 auto 0.125rem;","background-size: 100%;","}",".scratchCategoryMenuItem:hover {","color: $colour_toolboxHover !important;","}",""]},4128:()=>{Blockly.FieldImage=function(e,t,o,n,r,i){this.sourceBlock_=null,this.height_=Number(o),this.width_=Number(t),this.size_=new goog.math.Size(this.width_,this.height_),this.flipRtl_=i,this.tooltip_="",this.setValue(e),this.setText(n),"function"==typeof r&&(this.clickHandler_=r)},goog.inherits(Blockly.FieldImage,Blockly.Field),Blockly.FieldImage.fromJson=function(e){var t=Blockly.utils.replaceMessageReferences(e.src),o=Number(Blockly.utils.replaceMessageReferences(e.width)),n=Number(Blockly.utils.replaceMessageReferences(e.height)),r=Blockly.utils.replaceMessageReferences(e.alt),i=!!e.flipRtl;return new Blockly.FieldImage(t,o,n,r,null,i)},Blockly.FieldImage.prototype.EDITABLE=!1,Blockly.FieldImage.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=Blockly.utils.createSvgElement("g",{},null),this.visible_||(this.fieldGroup_.style.display="none"),this.imageElement_=Blockly.utils.createSvgElement("image",{height:"".concat(this.height_,"px"),width:"".concat(this.width_,"px")},this.fieldGroup_),this.setValue(this.src_),this.setText(this.text_),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.tooltip_?this.imageElement_.tooltip=this.tooltip_:this.setTooltip(this.sourceBlock_),Blockly.Tooltip.bindMouseEvents(this.imageElement_),this.maybeAddClickHandler_())},Blockly.FieldImage.prototype.dispose=function(){goog.dom.removeNode(this.fieldGroup_),this.fieldGroup_=null,this.imageElement_=null},Blockly.FieldImage.prototype.maybeAddClickHandler_=function(){!this.clickHandler_||this.sourceBlock_.workspace.options.readOnly||this.sourceBlock_.isInFlyout||(this.mouseDownWrapper_=Blockly.bindEventWithChecks_(this.fieldGroup_,"mousedown",this,this.clickHandler_),this.fieldGroup_.style.cursor="pointer")},Blockly.FieldImage.prototype.setTooltip=function(e){this.tooltip_=e,this.imageElement_&&(this.imageElement_.tooltip=e)},Blockly.FieldImage.prototype.getValue=function(){return this.src_},Blockly.FieldImage.prototype.setValue=function(e){null!==e&&(this.src_=e,this.imageElement_&&this.imageElement_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e||""))},Blockly.FieldImage.prototype.getFlipRtl=function(){return this.flipRtl_},Blockly.FieldImage.prototype.setText=function(e){null!==e&&(this.text_=e,this.imageElement_&&this.imageElement_.setAttribute("alt",e||""))},Blockly.FieldImage.prototype.render_=function(){},Blockly.FieldImage.prototype.forceRerender=function(){},Blockly.FieldImage.prototype.updateWidth=function(){},Blockly.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},Blockly.Field.register("field_image",Blockly.FieldImage)},1874:()=>{Blockly.FieldTextInput.prototype.init=function(){if(!this.fieldGroup_){var e=!this.sourceBlock_.isShadow();e&&(this.className_+=" blocklyEditableLabel"),this.maxDisplayLength=17,Blockly.FieldTextInput.superClass_.init.call(this),e&&(this.box_=Blockly.utils.createSvgElement("rect",{rx:4*Blockly.BlockSvg.CORNER_RADIUS,ry:4*Blockly.BlockSvg.CORNER_RADIUS,x:0,y:0,width:this.size_.width,height:this.size_.height,fill:this.sourceBlock_.getColourSecondary(),stroke:this.sourceBlock_.getColourTertiary(),"stroke-width":"0.3px"}),this.fieldGroup_.insertBefore(this.box_,this.textElement_))}}},2038:()=>{Blockly.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!(this.targetBlock_.disabled||this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)||(this.startWorkspace_=this.flyout_.targetWorkspace_,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.mostRecentEvent_,this.targetBlock_),this.targetBlock_.select(),0))}},3696:()=>{Blockly.Icon.prototype.renderIcon=function(e){if(this.collapseHidden&&this.block_.isCollapsed())return this.iconGroup_.setAttribute("display","none"),e;this.iconGroup_.setAttribute("display","block");var t=e,o=this.SIZE;return this.block_.RTL&&(t-=o),this.iconGroup_.setAttribute("transform","localize(".concat(t,",").concat(9,")")),this.computeIconLocation(),this.block_.RTL?t-=Blockly.BlockSvg.SEP_SPACE_X:t+=o+Blockly.BlockSvg.SEP_SPACE_X,t}},4730:(e,t,o)=>{"use strict";o.r(t);var n=o(9789);Blockly.Block.Dimensions={},Blockly.Block.prototype.getDisplayName=function(){if(this.meta){var e=this.meta();return e&&e.display_name}return this.type},Blockly.Block.prototype.getSiblings=function(){var e=this,t=[this];return["getPreviousBlock","getNextBlock"].forEach((function(o){for(var n=e[o]();null!==n;){var r=e.getParent();if(r&&r.id===n.id)break;t.push(n),n=n[o]()}})),t},Blockly.Block.prototype.getChildByType=function(e){return this.getDescendants().find((function(t){return t.type===e}))},Blockly.Block.prototype.getChildFieldValue=function(e,t){var o=this.getChildByType(e);return o?o.getFieldValue(t):null},Blockly.Block.prototype.childValueToCode=function(e,t){var o=this.getChildByType(e);return o&&Blockly.JavaScript.valueToCode(o,t,Blockly.JavaScript.ORDER_ATOMIC)},Blockly.Block.prototype.getBlocksInStatement=function(e){var t=this.getInputTargetBlock(e);return t?t.getSiblings():[]},Blockly.Block.prototype.getLastConnectionInStatement=function(e){var t=this.getInputTargetBlock(e);return t?t.lastConnectionInStack():this.getInput(e).connection},Blockly.Block.prototype.isEnabled=function(){return!this.disabled},Blockly.Block.prototype.isDescendantOf=function(e){for(var t=this.getParent();null!==t;){if(t.type===e)return!0;t=t.getParent()}return!1},Blockly.Block.prototype.getTopParent=function(){for(var e=this.getParent();null!==e;){var t=e.getParent();if(!t)return e;e=t}return null},Blockly.Block.getDimensions=function(e){var t=Object.keys(Blockly.Block.Dimensions).find((function(t){return e.outerHTML===t}));if(t)return Blockly.Block.Dimensions[t];var n=new Blockly.Options({media:"".concat(o.p,"media/")}),r=document.createElement("div"),i=Blockly.createDom_(r,n),a=Blockly.createMainWorkspace_(i,n,!1,!1),l=Blockly.Xml.domToBlock(e,a).getHeightWidth();return a.dispose(),Blockly.Block.Dimensions[e.outerHTML]=l,l},Blockly.Block.prototype.isMainBlock=function(){return n.v.mainBlocks.includes(this.type)},Blockly.Block.prototype.isIndependentBlock=function(){return n.v.INDEPEDENT_BLOCKS.includes(this.type)},Blockly.Block.prototype.getRootInputTargetBlock=function(){for(var e,t=this.getParent();t;){var o=this.getRootBlock().getInputWithBlock(t);o&&o.name&&(e=o.name),t=t.getParent()}return e},Blockly.Block.prototype.hasErrorHighlightedDescendant=function(){return function e(t){return t.some((function(t){var o=t.is_error_highlighted,n=e(t.getChildren());return o||n}))}(this.getChildren())},Blockly.Block.isDynamic=function(e){return/^((procedures_)|(variables_)|(math_change$))/.test(e)},o(129);var r=o(2273),i=o(282),a=o(6132);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}Blockly.BlockSvg.prototype.addSelect=function(){if(!this.isInFlyout){var e=i.Z.instance.flyout;e&&e.setVisibility(!1),Blockly.utils.addClass(this.svgGroup_,"blocklySelected")}},Blockly.BlockSvg.prototype.setDisabled=function(e){this.disabled!==e&&(Blockly.BlockSvg.superClass_.setDisabled.call(this,e),this.rendered&&this.updateDisabled())},Blockly.BlockSvg.prototype.updateDisabled=function(){if(this.disabled||this.getInheritedDisabled()){Blockly.utils.addClass(this.svgGroup_,"blocklyDisabled");var e="url(#".concat(this.workspace.options.disabledPatternId,")");this.svgPath_.getAttribute("fill")!==e&&this.svgPath_.setAttribute("fill",e)}else Blockly.utils.removeClass(this.svgGroup_,"blocklyDisabled")&&this.updateColour();this.getChildren(!1).forEach((function(e){return e.updateDisabled()}))},Blockly.BlockSvg.prototype.showContextMenu_=function(e){var t;if(!this.workspace.options.readOnly&&this.contextMenu){var o=this,n=[];if(this.isDeletable()&&this.isMovable()&&!o.isInFlyout)n.push(Blockly.ContextMenu.blockDuplicateOption(o,e)),n.push(Blockly.ContextMenu.blockDetachOption(o,e)),this.isEditable()&&this.workspace.options.comments&&n.push(Blockly.ContextMenu.blockCommentOption(o)),n.push(Blockly.ContextMenu.blockDeleteOption(o));else if(this.parentBlock_&&this.isShadow_)return void this.parentBlock_.showContextMenu_(e);if(this.workspace.options.collapse)if(this.collapsed_){var i={enabled:!0};i.text=(0,r.localize)("Expand Block"),i.callback=function(){return o.setCollapsed(!1)},n.push(i)}else{var l={enabled:!0};l.text=(0,r.localize)("Collapse Block"),l.callback=function(){return o.setCollapsed(!0)},n.push(l)}if(this.workspace.options.disable){var c=o.restricted_parents||[],s=this.type.includes("trade_definition_")&&!this.isMovable(),u={text:this.disabled?(0,r.localize)("Enable Block"):(0,r.localize)("Disable Block"),enabled:!s&&(!this.disabled||0===c.length||c.some((function(e){return o.isDescendantOf(e)}))),callback:function(){var e=Blockly.Events.getGroup();e||Blockly.Events.setGroup(!0),o.setDisabled(!o.disabled),e||Blockly.Events.setGroup(!1)}};n.push(u)}if(this.isMovable()){var p=o.nextConnection&&o.nextConnection.isConnected(),d=function(e){var t=Blockly.Xml.textToDom("<xml/>"),n=Blockly.Xml.blockToDom(o),i=e?o.type:"".concat(o.type,"_").concat((0,r.localize)("stack"));e&&Blockly.Xml.deleteNext(n),t.appendChild(n),(0,a.a1)(i,!0,t)};n.push({text:(0,r.localize)("Download block"),enabled:!0,callback:function(){return d(!0)}}),p&&n.push({text:(0,r.localize)("Download stack"),enabled:!0,callback:function(){return d(!1)}})}null!==(t=o.nextConnection)&&void 0!==t&&t.targetConnection&&(n.push(Blockly.ContextMenu.blockEnableOption(o,e)),n.push(Blockly.ContextMenu.blockDisableOption(o,e))),this.customContextMenu&&this.customContextMenu(n),Blockly.ContextMenu.show(e,n,this.RTL),Blockly.ContextMenu.currentBlock=this}},Blockly.BlockSvg.prototype.setErrorHighlighted=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,r.localize)('The block(s) highlighted in red are missing input values. Please update them and click "Run bot".');if(this.is_error_highlighted!==e){var o="block--error-highlighted";e?Blockly.utils.addClass(this.svgGroup_,o):Blockly.utils.removeClass(this.svgGroup_,o),this.is_error_highlighted=e,this.error_message=t}},Blockly.BlockSvg.prototype.highlightExecutedBlock=function(){var e=this,t="block--execution-highlighted";Blockly.utils.hasClass(this.svgGroup_,t)||(Blockly.utils.addClass(this.svgGroup_,t),setTimeout((function(){e.svgGroup_&&Blockly.utils.removeClass(e.svgGroup_,t)}),1505))},Blockly.BlockSvg.prototype.blink=function(){var e=this,t="block--blink";Blockly.utils.addClass(this.svgGroup_,t),setTimeout((function(){Blockly.utils.removeClass(e.svgGroup_,t)}),2e3)},Blockly.BlockSvg.prototype.setCollapsed=function(e){var t=this;if(this.collapsed_!==e){navigator.userAgent.search("Firefox")>0&&setTimeout((function(){t.workspace.getAllFields().forEach((function(e){return e.forceRerender()}))}),0);var o=[],n="_TEMP_COLLAPSED_INPUT";if(this.inputList.forEach((function(t){var n;o.push.apply(o,function(e){if(Array.isArray(e))return l(e)}(n=t.setVisible(!e))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?l(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e&&1===t.type&&!t.connection.targetConnection&&t.outlinePath&&(t.outlinePath.style.visibility="hidden")})),e){this.getIcons().filter((function(e){return!(e instanceof Blockly.ScratchBlockComment)})).forEach((function(e){return e.setVisible(!1)}));var i=null;this.inputList.some((function(e){return e.fieldRow.some((function(e){return!!e.class_&&(i=e.class_,!0)}))}));var c=this.workspace.options.pathToMedia+((0,a.YQ)(this.getColour())?"dropdown-arrow.svg":"dropdown-arrow-dark.svg"),s=new Blockly.FieldImage(c,16,16,(0,r.localize)("Expand"),(function(){return t.setCollapsed(!1)}));if("procedures_defreturn"===this.type||"procedures_defnoreturn"===this.type){var u=this.getFieldValue("NAME"),p=" (".concat(this.arguments.join(", "),")");this.appendDummyInput(n).appendField(new Blockly.FieldLabel((0,r.localize)("function"),i)).appendField(new Blockly.FieldLabel(u+p,"header__title")).appendField(s).init()}else{var d=this.toString(Blockly.COLLAPSE_CHARS),y=new Blockly.FieldLabel(d,i);this.appendDummyInput(n).appendField(y).appendField(s).init()}}else this.removeInput(n),this.setWarningText(null);Blockly.BlockSvg.superClass_.setCollapsed.call(this,e),o.length||o.push(this),this.rendered&&o.forEach((function(e){return e.render()})),this.setErrorHighlighted(e&&this.hasErrorHighlightedDescendant())}},Blockly.BlockSvg.prototype.initSvg=function(){if(goog.asserts.assert(this.workspace.rendered,"Workspace is headless."),!this.isInsertionMarker()){for(var e,t=0;e=this.inputList[t];t++)e.init(),e.initOutlinePath(this.svgGroup_);for(var o=this.getIcons(),n=0;n<o.length;n++)o[n].createIcon()}this.updateColour(),this.updateMovable(),this.workspace.options.readOnly||this.eventsInit_||Blockly.bindEventWithChecks_(this.getSvgRoot(),"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,!this.getSvgRoot().parentNode&&this.workspace.getCanvas()&&this.workspace.getCanvas().appendChild(this.getSvgRoot())},o(2646),o(7779),o(1863),Blockly.ContextMenu.blockDuplicateOption=function(e){return{callback:function(){Blockly.duplicate_(e)},enabled:!n.v.single_instance_blocks.includes(e.type),text:(0,r.localize)("Duplicate")}},Blockly.ContextMenu.wsCleanupOption=function(e,t){return{text:(0,r.localize)("Rearrange Vertically"),enabled:t>1,callback:e.cleanUp.bind(e)}},Blockly.ContextMenu.wsCollapseOption=function(e,t){return{enabled:e,text:(0,r.localize)("Collapse All Blocks"),callback:function(){Blockly.ContextMenu.toggleCollapseFn_(t,!0)}}},Blockly.ContextMenu.wsExpandOption=function(e,t){return{enabled:e,text:(0,r.localize)("Expand All Blocks"),callback:function(){Blockly.ContextMenu.toggleCollapseFn_(t,!1)}}},Blockly.ContextMenu.toggleCollapseFn_=function(e,t){e.forEach((function(e){return e.setCollapsed(t)}))},Blockly.ContextMenu.wsDeleteOption=function(e,t){var o=Blockly.WorkspaceSvg.buildDeleteList_(t),n=o.filter((function(e){return!e.isShadow()})).length,i=Blockly.utils.genUid(),a=function e(){Blockly.Events.setGroup(i);var t=o.shift();t&&(t.workspace?(t.dispose(!1,!0),setTimeout(e,10)):e()),Blockly.Events.setGroup(!1)};return{text:1===n?(0,r.localize)("Delete Block"):(0,r.localize)("Delete {{ delete_count }} Blocks",{delete_count:n}),enabled:n>0,callback:function(){if(e.currentGesture_&&e.currentGesture_.cancel(),n<2)a();else{var t=(0,r.localize)("Delete all {{ delete_count }} blocks?",{delete_count:n});Blockly.confirm(t,(function(e){e&&a()}))}}}},Blockly.ContextMenu.blockCommentOption=function(e){var t={enabled:!goog.userAgent.IE};return e.comment?(t.text=(0,r.localize)("Remove comment"),t.callback=function(){e.setCommentText(null)}):(t.text=(0,r.localize)("Add comment"),t.callback=function(){var t=e.collapsed_;t&&e.setCollapsed(!1),e.setCommentText(""),e.collapsed_!==t&&e.setCollapsed(t)}),t},Blockly.ContextMenu.blockDetachOption=function(e){var t=e.getConnections_().some((function(e){var t;return e.isConnected()&&!(null!==(t=e.targetConnection)&&void 0!==t&&t.sourceBlock_.isShadow_)}));return{callback:function(){e.unplug(!0),e.moveBy(250,100)},enabled:e.parentBlock_&&t,text:(0,r.localize)("Detach Block")}},Blockly.ContextMenu.blockDisableOption=function(e){var t=function e(t){var o,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return r.push(!t.disabled),null!==(o=t.nextConnection)&&void 0!==o&&o.targetConnection?e(null===(n=t.nextConnection)||void 0===n?void 0:n.targetConnection.sourceBlock_,r):r.includes(!0)}(e),o=function e(t){var o,n;t.setDisabled(!0),null!==(o=t.nextConnection)&&void 0!==o&&o.targetConnection&&e(null===(n=t.nextConnection)||void 0===n?void 0:n.targetConnection.sourceBlock_)};return{callback:function(){o(e)},enabled:t,text:(0,r.localize)("Disable stack")}},Blockly.ContextMenu.blockEnableOption=function(e){var t=function e(t){var o,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return!(null===(o=t.restricted_parents)||void 0===o||!o.some((function(e){return t.isDescendantOf(e)})))&&(i.push(t.disabled),null!==(n=t.nextConnection)&&void 0!==n&&n.targetConnection?e(null===(r=t.nextConnection)||void 0===r?void 0:r.targetConnection.sourceBlock_,i):i.includes(!0))}(e),o=function e(t){var o,n;t.setDisabled(!1),null!==(o=t.nextConnection)&&void 0!==o&&o.targetConnection&&e(null===(n=t.nextConnection)||void 0===n?void 0:n.targetConnection.sourceBlock_)};return{callback:function(){o(e)},enabled:t,text:(0,r.localize)("Enable stack")}},o(119),Blockly.DataCategory=function(e){var t=e.getVariablesOfType(""),o=[];return Blockly.DataCategory.addCreateVariable(o,e),o.concat(Blockly.DataCategory.search(t,["variables_set","variables_get","math_change"]))},Blockly.DataCategory.search=function(e){var t=[];if(e.length>0){var o=function(e){return'<field name="VAR" id="'.concat(e.getId(),'" variabletype="').concat(goog.string.htmlEscape(e.type),'">').concat(goog.string.htmlEscape(e.name),"</field>")},n=e[0];if(Blockly.Blocks.variables_set){var r=Blockly.Blocks.math_change?8:24,i='<xml><block type="variables_set" gap="'.concat(r,'">').concat(o(n),"</block></xml>"),a=Blockly.Xml.textToDom(i).firstChild;t.push(a)}Blockly.Blocks.variables_get&&(e.sort((function(t,o){return e.indexOf(o)-e.indexOf(t)})),e.forEach((function(e){var n='<xml><block type="variables_get">'.concat(o(e),"</block></xml>"),r=Blockly.Xml.textToDom(n).firstChild;t.push(r)})))}return t},Blockly.DataCategory.addCreateVariable=function(e,t){var o=goog.dom.createDom("button"),n=goog.dom.createDom("input"),a=(0,r.localize)("Create"),l="CREATE_VARIABLE",c=(0,r.localize)("New variable name");o.setAttribute("text",a),o.setAttribute("className","flyout__button-new"),o.setAttribute("callbackKey",l),n.setAttribute("className","flyout__input"),n.setAttribute("name","variable"),n.setAttribute("type","text"),n.setAttribute("placeholder",c),t.registerButtonCallback(l,(function(e){var t=document.querySelector(".flyout__input").firstChild;e.getTargetWorkspace().createVariable(t.value,""),t.value="",i.Z.instance.flyout.refreshCategory()})),e.push(n),e.push(o)},Blockly.FieldDropdown.prototype.updateOptions=function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Blockly.DropDownDiv.isVisible()&&Blockly.DropDownDiv.hideWithoutAnimation(),this.menuGenerator_=e;var n=this.getValue();o.should_pretend_empty&&(n="");var r=-1!==e.findIndex((function(e){return e[1]===o.default_value}));if((0,a.zJ)((function(){t.setValue(""),r?t.setValue(o.default_value):e.length>0?t.setValue(t.menuGenerator_[0][1]):t.setValue(n)})),!o.should_trigger_event||!0===o.should_trigger_event){var i=new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,n,this.getValue());i.recordUndo=!1,i.group=o.event_group,Blockly.Events.fire(i)}},Blockly.FieldDropdown.prototype.init=function(){if(!this.fieldGroup_){this.arrowSize_=12,this.arrowX_=0,this.arrowY_=11,this.arrow_=Blockly.utils.createSvgElement("image",{height:"".concat(this.arrowSize_,"px"),width:"".concat(this.arrowSize_,"px")}),this.arrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","".concat(Blockly.mainWorkspace.options.pathToMedia,"dropdown-arrow-dark.svg")),this.className_+=" blocklyDropdownText",this.disableColourChange_=!0,Blockly.FieldDropdown.superClass_.init.call(this),this.sourceBlock_.isShadow()||(this.box_=Blockly.utils.createSvgElement("rect",{rx:4*Blockly.BlockSvg.CORNER_RADIUS,ry:4*Blockly.BlockSvg.CORNER_RADIUS,x:0,y:0,width:this.size_.width,height:this.size_.height,stroke:this.sourceBlock_.getColourTertiary(),"stroke-width":"0.3px",fill:this.sourceBlock_.getColourSecondary(),"fill-opacity":1},null),this.fieldGroup_.insertBefore(this.box_,this.textElement_));var e=this.text_;this.text_=null,this.setText(e)}},Blockly.FieldDropdown.prototype.isEmpty=function(){return 0===this.menuGenerator_.length||!this.menuGenerator_[0][1]},Blockly.Field.register("field_image_checkbox",function e(){var t=function(e){return e?(0,r.localize)("Y"):(0,r.localize)("N")},o=new Blockly.FieldImage(!0,16,16,t(!0),(function(){this.sourceBlock_.workspace.options.readOnly||this.sourceBlock_.isInFlyout||(this.is_checked=!this.is_checked,this.setValue(this.is_checked),this.setText(t(this.is_checked)))}));return o.fromJson=function(){return e()},o.setValue=function(e){var t=!0===e||"TRUE"===e,o=this.getValue();this.src_=t?"TRUE":"FALSE";var n=this.fieldGroup_;n&&(Array.from(n.children).forEach((function(e){return n.removeChild(e)})),Blockly.utils.createSvgElement("rect",{fill:this.sourceBlock_.getColourSecondary(),"fill-rule":"nonzero",height:this.height_,width:this.width_,rx:2,stroke:this.sourceBlock_.getColourTertiary()},n),t&&Blockly.utils.createSvgElement("path",{fill:"var(--text-general)",d:"M6 10.086L3.707 7.793a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l7-7a1 1 0 10-1.414-1.414L6 10.086z"},n)),this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,o,this.getValue()))},o}()),o(4128),Blockly.Flyout.prototype.createBlock=function(e,t){Blockly.Events.disable();var o=this.targetWorkspace_,r=o.getAllVariables();o.setResizesEnabled(!1);var a=null;try{a=this.placeNewBlock_(e,t),Blockly.hideChaff()}finally{Blockly.Events.enable()}var l=Blockly.Variables.getAddedVariables(o,r);Blockly.Events.isEnabled()&&(Blockly.Events.setGroup(!0),n.v.single_instance_blocks.includes(a.type)&&o.getAllBlocks().forEach((function(e){e.type===a.type&&e.id!==a.id&&e.dispose()})),l.forEach((function(e){Blockly.Events.fire(new Blockly.Events.VarCreate(e))})),Blockly.Events.fire(new Blockly.Events.Create(a))),this.autoClose&&this.hide();var c=i.Z.instance.flyout;return c.setIsSearchFlyout(!1),c.setVisibility(!1),a.isInFlyout=!1,a},Blockly.Flyout.prototype.placeNewBlock_=function(e,t){var o=this.targetWorkspace_;if(!t.getSvgRoot())throw new Error("old_block is not rendered.");var n=Blockly.Xml.blockToDom(t,!0);o.setResizesEnabled(!1);var r=Blockly.Xml.domToBlock(n,o);if(!r.getSvgRoot())throw new Error("block is not rendered.");if(e){var i=o.getOriginOffsetInPixels(),a=new goog.math.Coordinate(e.clientX?e.clientX:0,e.clientY?e.clientY-56-48:0),l=goog.math.Coordinate.difference(a,i).scale(1/o.scale);r.moveBy(l.x,l.y)}return r},o(2038),o(884),o(3696),o(9379),Blockly.Procedures.flyoutCategory=function(e){var t=[];if(Blockly.Blocks.procedures_defnoreturn){var o=document.createElement("block");o.setAttribute("type","procedures_defnoreturn"),o.setAttribute("gap",16);var n=document.createElement("field");n.setAttribute("name","NAME"),n.appendChild(document.createTextNode((0,r.localize)("do something"))),o.appendChild(n),t.push(o)}if(Blockly.Blocks.procedures_defreturn){var i=document.createElement("block");i.setAttribute("type","procedures_defreturn"),i.setAttribute("gap",16);var a=document.createElement("field");a.setAttribute("name","NAME"),a.appendChild(document.createTextNode((0,r.localize)("do something"))),i.appendChild(a),t.push(i)}if(Blockly.Blocks.procedures_ifreturn){var l=document.createElement("block");l.setAttribute("type","procedures_ifreturn"),l.setAttribute("gap",16),t.push(l)}t.length&&t[t.length-1].setAttribute("gap",24);var c=Blockly.Procedures.allProcedures(e);return t.concat(Blockly.Procedures.populateDynamicProcedures(c))},Blockly.Procedures.populateDynamicProcedures=function(e){var t=[],o=function(e,t){var o=[];if(!e)return o;for(var n=function(n){var r=e[n][0],i=e[n][1],a=document.createElement("block");a.setAttribute("type",t),a.setAttribute("gap",16);var l=document.createElement("mutation");l.setAttribute("name",r),a.appendChild(l),i.forEach((function(e){var t=document.createElement("arg");t.setAttribute("name",e),l.appendChild(t)})),o.push(a)},r=0;r<e.length;r++)n(r);return o};return(t=t.concat(o(e[0],"procedures_callnoreturn"))).concat(o(e[1],"procedures_callreturn"))},Blockly.Procedures.getDefinition=function(e,t){for(var o=t.getTopBlocks(!1),n=0;n<o.length;n++)if(o[n].getProcedureDef){var r=o[n].getProcedureDef();if(r&&Blockly.Names.equals(r[0],e))return o[n]}return null},Blockly.Procedures.isNameUsed=function(e,t,o){return t.getAllBlocks(!1).some((function(t){if(t!==o&&t.getProcedureDef){var n=t.getProcedureDef();return Blockly.Names.equals(n[0],e)}return!1}))},Blockly.WorkspaceDragger.prototype.drag=function(e){if(!this.workspace_.isFlyout){var t=this.startDragMetrics_,o=goog.math.Coordinate.sum(this.startScrollXY_,e),n=Math.min(o.x,-t.contentLeft),r=Math.min(o.y,-t.contentTop);n=Math.max(n,t.viewWidth-t.contentLeft-t.contentWidth),r=Math.max(r,t.viewHeight-t.contentTop-t.contentHeight),n=-n-t.contentLeft,r=-r-t.contentTop,this.updateScroll_(n,r)}},o(7850),o(5651),o(7058);var c=o(6715);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}Blockly.Workspace.prototype.wait_events=[],Blockly.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0;var e=i.Z.instance.toolbar;e.setHasRedoStack(),e.setHasUndoStack(),Blockly.Events.clearPendingUndo()},Blockly.Workspace.prototype.fireChangeListener=function(e){if(e.recordUndo){this.undoStack_.push(e),this.redoStack_.length=0,this.undoStack_.length>this.MAX_UNDO&&this.undoStack_.unshift();var t=i.Z.instance.toolbar;t.setHasRedoStack(),t.setHasUndoStack()}this.listeners_.slice().forEach((function(t){t(e)}))},Blockly.Workspace.prototype.getTradeDefinitionBlock=function(){return this.getAllBlocks(!0).find((function(e){return"trade_definition"===e.type}))},Blockly.Workspace.prototype.waitForBlockEvent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=new c.Z;return this.wait_events.some((function(o){return o.blockId===e&&o.type===t}))||this.wait_events.push({blockId:e,promise:o,type:t}),o},Blockly.Workspace.prototype.waitForBlockEvent=function(e){var t=e.block_type,o=e.event_type,n=e.timeout,r=new c.Z;return this.wait_events.push({block_type:t,event_type:o,promise:r}),n&&setTimeout((function(){r.isPending&&r.reject()}),n),r},Blockly.Workspace.prototype.dispatchBlockEventEffects=function(e){var t=this;this.wait_events.forEach((function(o,n){if(e.blockId){var r=t.getBlockById(e.blockId);if(r){var i=o.block_type===r.type,a=null===o.event_type||o.event_type===e.type;i&&a&&setTimeout((function(){o.promise.resolve(),t.wait_events.splice(n,1)}),500)}}}))},Blockly.Workspace.prototype.getAllFields=function(e){return this.getAllBlocks(e).reduce((function(e,t){return t.inputList.forEach((function(t){return e.push.apply(e,function(e){if(Array.isArray(e))return s(e)}(o=t.fieldRow)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?s(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var o})),e}),[])},o(8993);var u=o(2620);Blockly.WorkspaceSvg.prototype.onMouseDown_=function(e){e instanceof MouseEvent&&Blockly.derivWorkspace.cachedParentSvg_.dispatchEvent(new e.constructor(e.type,e));var t=this.getGesture(e);t&&t.handleWsStart(e,this)},Blockly.WorkspaceSvg.prototype.centerOnBlock=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.scrollbar){var o=this.getBlockById(e);if(o){var n=o.getRelativeToSurfaceXY(),r=o.getHeightWidth(),i=n.y+r.height/2,a=this.RTL?-1:1,l=n.x+a*r.width/2,c=this.scale,s=l*c,u=i*c,p=this.getMetrics(),d=s-p.contentLeft,y=u-p.contentTop,m=p.viewWidth/2,f=p.viewHeight/2,_=d-m,h=y-f;t&&Blockly.hideChaff(),this.scrollbar.set(_,h)}}else console.warn("Tried to scroll a non-scrollable workspace.")},Blockly.WorkspaceSvg.prototype.addBlockNode=function(e){var t=i.Z.instance.flyout,o=Blockly.Xml.domToBlock(e,t.getFlyout().workspace_),n=this.getTopBlocks(!0),r=t.getFlyout().createBlock(!1,o);if(n.length){var a=n[n.length-1],l=a.getRelativeToSurfaceXY(),c=a.startHat_?Blockly.BlockSvg.START_HAT_HEIGHT:0,s=l.y+a.getHeightWidth().height+c+30;r.moveBy(l.x,s)}Blockly.svgResize(r.workspace),this.centerOnBlock(r.id,!1)},Blockly.WorkspaceSvg.prototype.cleanUp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.setResizesEnabled(!1),Blockly.Events.setGroup(Blockly.Events.getGroup()||!0);var r=0!==o.length,i=r?o:this.getTopBlocks(!0),a=i.filter((function(e){return e.isMainBlock()})).sort((function(e,t){var o=function(e){return n.v.mainBlocks.findIndex((function(t){return t===e.type}))};return o(e)-o(t)})),l=2,c=Math.ceil(a.length/l),s=t;if(a.length){var u=0;a.forEach((function(o,n){n===(u+1)*c&&(s=t,u++);var i=o.getRelativeToSurfaceXY(),l=r?e:-i.x,p=s-(r?0:i.y);if(0===u)o.moveBy(l,p);else{var d=(u-1)*c,y=a.slice(d,d+c).reduce((function(e,t){return e.getHeightWidth().width>t.getHeightWidth().width?e:t})),m=l+y.getHeightWidth().width+Blockly.BlockSvg.MIN_BLOCK_X;r||(m+=y.getRelativeToSurfaceXY().x),o.moveBy(m,p)}o.snapToGrid(),s=o.getRelativeToSurfaceXY().y+o.getHeightWidth().height+Blockly.BlockSvg.MIN_BLOCK_Y}));var p=a.reduce((function(e,t){return e.getRelativeToSurfaceXY().y+e.getHeightWidth().height>t.getRelativeToSurfaceXY().y+t.getHeightWidth().height?e:t}));s=p.getRelativeToSurfaceXY().y+p.getHeightWidth().height+Blockly.BlockSvg.MIN_BLOCK_Y}var d=i.filter((function(e){return!e.isMainBlock()}));d.forEach((function(t){var o=t.getRelativeToSurfaceXY(),n=r?e:-o.x,i=s-(r?0:o.y);t.moveBy(n,i),t.snapToGrid(),s=t.getRelativeToSurfaceXY().y+t.getHeightWidth().height+Blockly.BlockSvg.MIN_BLOCK_Y})),Blockly.Events.setGroup(!1),this.setResizesEnabled(!0)},Blockly.WorkspaceSvg.getTopLevelWorkspaceMetrics_=function(){var e=Blockly.WorkspaceSvg.getDimensionsPx_(this.toolbox_),t=Blockly.WorkspaceSvg.getDimensionsPx_(this.flyout_),o=Blockly.svgSize(this.getParentSvg());this.toolbox_&&(this.toolboxPosition===Blockly.TOOLBOX_AT_TOP||this.toolboxPosition===Blockly.TOOLBOX_AT_BOTTOM?o.height-=e.height:this.toolboxPosition!==Blockly.TOOLBOX_AT_LEFT&&this.toolboxPosition!==Blockly.TOOLBOX_AT_RIGHT||(o.width-=e.width));var n=Blockly.WorkspaceSvg.getContentDimensions_(this,o),r=0,i=0;return this.toolbox_&&this.toolboxPosition===Blockly.TOOLBOX_AT_LEFT&&(i=50,r=e.width),this.toolbox_&&this.toolboxPosition===Blockly.TOOLBOX_AT_TOP&&(i=e.height+50),{contentHeight:n.height,contentWidth:n.width,contentTop:n.top,contentLeft:n.left,viewHeight:o.height,viewWidth:o.width,viewTop:-this.scrollY,viewLeft:-this.scrollX,absoluteTop:i,absoluteLeft:r,toolboxWidth:e.width,toolboxHeight:e.height,flyoutWidth:t.width,flyoutHeight:t.height,toolboxPosition:this.toolboxPosition}},Blockly.WorkspaceSvg.prototype.paste=function(e){this.rendered&&(this.currentGesture_&&this.currentGesture_.cancel(),"comment"===e.tagName.toLowerCase()?this.pasteWorkspaceComment_(e):((0,u.kH)(this,e.getAttribute("type")),this.pasteBlock_(e)))},Blockly.WorkspaceSvg.prototype.showContextMenu_=function(e){if(!this.options.readOnly&&!this.isFlyout){var t=[],o=this.getTopBlocks(!0),n=this.getAllBlocks(!0);if(t.push(Blockly.ContextMenu.wsUndoOption(this)),t.push(Blockly.ContextMenu.wsRedoOption(this)),this.scrollbar&&t.push(Blockly.ContextMenu.wsCleanupOption(this,o.length)),this.options.collapse){var r=n.some((function(e){return e.isCollapsed()})),i=n.some((function(e){return!e.isCollapsed()}));t.push(Blockly.ContextMenu.wsExpandOption(r,n)),t.push(Blockly.ContextMenu.wsCollapseOption(i,n))}this.options.comments&&t.push(Blockly.ContextMenu.workspaceCommentOption(this,e)),t.push(Blockly.ContextMenu.wsDeleteOption(this,o)),Blockly.ContextMenu.show(e,t,this.RTL)}},Blockly.WorkspaceSvg.prototype.dispose=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=function(){e.rendered=!1,e.currentGesture_&&e.currentGesture_.cancel(),Blockly.WorkspaceSvg.superClass_.dispose.call(e),e.svgGroup_&&(goog.dom.removeNode(e.svgGroup_),e.svgGroup_=null),e.svgBlockCanvas_=null,e.svgBubbleCanvas_=null,e.toolbox_&&(e.toolbox_.dispose(),e.toolbox_=null),e.flyout_&&(e.flyout_.dispose(),e.flyout_=null),e.trashcan&&(e.trashcan.dispose(),e.trashcan=null),e.scrollbar&&(e.scrollbar.dispose(),e.scrollbar=null),e.zoomControls_&&(e.zoomControls_.dispose(),e.zoomControls_=null),e.audioManager_&&(e.audioManager_.dispose(),e.audioManager_=null),e.grid_&&(e.grid_.dispose(),e.grid_=null),e.toolboxCategoryCallbacks_&&(e.toolboxCategoryCallbacks_=null),e.flyoutButtonCallbacks_&&(e.flyoutButtonCallbacks_=null),e.options.parentWorkspace||goog.dom.removeNode(e.getParentSvg().parentNode),e.resizeHandlerWrapper_&&(Blockly.unbindEvent_(e.resizeHandlerWrapper_),e.resizeHandlerWrapper_=null)};if(t){var n=i.Z.instance,r=n.startLoading,a=n.endLoading;r(),setTimeout((function(){o(),a()}),50)}else o()},Blockly.WorkspaceSvg.prototype.asyncClear=function(){var e=this,t=i.Z.instance,o=t.startLoading,n=t.endLoading;return o(),new Promise((function(t){e.clear(),n(),t()}))},o(5338),o(1874),o(839);var p=o(3751);Blockly.Tooltip.HOVER_MS=50,Blockly.Tooltip.show_=function(){var e;if(Blockly.Tooltip.DIV=(Blockly.Tooltip.poisonedElement_=Blockly.Tooltip.element_,Blockly.Tooltip.DIV),!Blockly.Tooltip.blocked_){for(Blockly.Tooltip.DIV.innerHTML="",e=Blockly.Tooltip.element_.tooltip;"function"==typeof e;)e=e();(e=(e=Blockly.utils.string.wrap(e,Blockly.Tooltip.LIMIT)).split("\n")).forEach((function(e,t){var o=document.createElement("div"),n=document.createElement("span");if(n.appendChild(document.createTextNode(e)),n.style.verticalAlign="middle",Blockly.Tooltip.DIV.appendChild(o),t)n.style.paddingLeft="24px";else{var r=document.createElement("img"),i=document.createElement("span");r.src=p.xY,r.style.paddingRight="8px",r.style.verticalAlign="middle",o.appendChild(i),i.appendChild(r)}o.appendChild(n)}));var t=Blockly.Tooltip.element_.RTL,o=document.documentElement.clientWidth,n=document.documentElement.clientHeight;Blockly.Tooltip.DIV&&(Blockly.Tooltip.DIV.style.direction=t?"rtl":"ltr"),Blockly.Tooltip.DIV.style.display="block",Blockly.Tooltip.visible=!0;var r=Blockly.Tooltip.lastX_;r=t?r-(Blockly.Tooltip.OFFSET_X+Blockly.Tooltip.DIV.offsetWidth):r+Blockly.Tooltip.OFFSET_X;var i=Blockly.Tooltip.lastY_+Blockly.Tooltip.OFFSET_Y;i+Blockly.Tooltip.DIV.offsetHeight>n+window.scrollY&&(i-=Blockly.Tooltip.DIV.offsetHeight+2*Blockly.Tooltip.OFFSET_Y),t&&(r=Math.max(Blockly.Tooltip.MARGINS-window.scrollX,r)),r+Blockly.Tooltip.DIV.offsetWidth>o+window.scrollX-2*Blockly.Tooltip.MARGINS&&(r=o-Blockly.Tooltip.DIV.offsetWidth-2*Blockly.Tooltip.MARGINS),Blockly.Tooltip.DIV.style.top="".concat(i,"px"),Blockly.Tooltip.DIV.style.left="".concat(r,"px")}},Blockly.Tooltip.hide=function(){var e;Blockly.Tooltip.visible&&Blockly.Tooltip.DIV&&(Blockly.Tooltip.visible=!1,setTimeout((function(){return Blockly.Tooltip.DIV.style.display="none"}),Blockly.Tooltip.HOVER_MS)),Blockly.Tooltip.showPid_&&clearTimeout(Blockly.Tooltip.showPid_),null!==(e=Blockly.Tooltip.DIV)&&void 0!==e&&e.style.direction||(Blockly.Tooltip.visible=!1,Blockly.Tooltip.DIV.style.display="none")}},9379:()=>{Blockly.createVirtualWorkspace_=function(e,t,o,n){t.parentWorkspace=null;var r=new Blockly.WorkspaceSvg(t,o,n);return r.scale=t.zoomOptions.startScale,e.appendChild(r.createDom("blocklyMainBackground")),r}},839:()=>{Blockly.ScratchBlockComment.prototype.updateColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.getColour())}},7850:()=>{Blockly.Trashcan.prototype.MARGIN_BOTTOM_=68,Blockly.Trashcan.prototype.MARGIN_SIDE_=16,Blockly.Trashcan.prototype.click=function(){}},884:()=>{Blockly.utils.string={wrap:Blockly.utils.wrap}},5651:()=>{Blockly.VariableMap.prototype.createVariable=function(e,t,o,n,r){var i=this.getVariable(e,t);if(i)return i;if(o&&(i=this.getVariableById(o)))return i;var a=o||Blockly.utils.genUid(),l=t||"";return i=new Blockly.VariableModel(this.workspace,e,l,a,n,r),this.variableMap_[l]?this.variableMap_[l].push(i):this.variableMap_[l]=[i],i}},7058:()=>{Blockly.Variables.allUsedVarModels=function(e){var t=e.getAllBlocks(!1),o=Object.create(null);t.forEach((function(e){var t=e.getVarModels();t&&t.forEach((function(e){var t=e.getId();t&&(o[t]=e)}))}));var n=[];return Object.keys(o).forEach((function(e){n.push(o[e])})),n},Blockly.Variables.generateVariableFieldDom=function(e){var t=document.createElement("field");t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.type);var o=document.createTextNode(e.name);return t.appendChild(o),t}},8993:()=>{Blockly.WorkspaceAudio.prototype.preload=function(){}},5338:()=>{Blockly.Xml.NODE_BLOCK="BLOCK",Blockly.Xml.NODE_BUTTON="BUTTON",Blockly.Xml.NODE_LABEL="LABEL",Blockly.Xml.NODE_SHADOW="SHADOW",Blockly.Xml.NODE_INPUT="INPUT"},1319:(e,t,o)=>{"use strict";o.d(t,{p:()=>a,M:()=>l});var n=o(6782),r=o.n(n),i=o(9789),a=function(e){var t=e.data,o=e.filename,n=e.type,i=new Blob([t],{type:n});r().saveAs(i,o)},l=function(e,t){var o=i.v.opposites[t.toUpperCase()];if(!o)return i.v.NOT_AVAILABLE_DROPDOWN_OPTIONS;var n=o.map((function(e){return Object.entries(e)[0].reverse()}));return"both"!==e?n.filter((function(t){return t[1]===e})):n}},6132:(e,t,o)=>{"use strict";o.d(t,{cM:()=>x,tp:()=>O,nf:()=>w,YQ:()=>P,zD:()=>v,oG:()=>T,UR:()=>A,zJ:()=>R,$9:()=>I,a1:()=>b,yW:()=>C,P_:()=>D,Hh:()=>g});var n=o(2273),r=o(1319),i=o(9789),a=o(9633);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.blocks_pending_reconnect={},this.workspace=this.createWorkspace(),this.workspace_variables={}}var t,r;return t=e,r=[{key:"getConversions",value:function(){var e=this,t=function(t,o,n,r){var i=e.workspace.newBlock(o),a=Array.from(t.children),l=a.find((function(e){return"mutation"===e.tagName.toLowerCase()}));if(l){var c=parseInt(l.getAttribute("items"))||0;if(c>0){for(var s=0;s<c;s++)i.onIconClick();a.filter((function(e){return"value"===e.tagName.toLowerCase()})).forEach((function(t){var o=t.getAttribute("name"),n=parseInt(o.replace(/[^0-9]+/g,""));Array.from(t.children).forEach((function(t){var o=e.convertBlockNode(t,i),a=i.getBlocksInStatement("STACK").find((function(e,t){return n===t}));a.getInput(r).connection.connect(o.outputConnection)})),t.parentNode.removeChild(t)}))}}var u=e.generateUniqueVariable(n),p=e.workspace.newBlock("variables_get");return p.setFieldValue(u.getId(),"VAR"),i.setFieldValue(u.getId(),"VARIABLE"),{block_to_attach:p,statement_blocks:[i]}},o=function(t,o,n){var r=e.workspace.newBlock(o),i={input_list:[{old:"INPUT",new:"INPUT_LIST"}],period:[{old:"PERIOD",new:"PERIOD"}],fast_ema_period:[{old:"FAST_EMA_PERIOD",new:"FAST_EMA_PERIOD"}],signal_ema_period:[{old:"SMA_PERIOD",new:"SIGNAL_EMA_PERIOD"},{old:"SIGNAL_EMA_PERIOD",new:"SIGNAL_EMA_PERIOD"}],slow_ema_period:[{old:"SLOW_EMA_PERIOD",new:"SLOW_EMA_PERIOD"}],std_dev_multiplier_up:[{old:"UPMULTIPLIER",new:"UPMULTIPLIER"}],std_dev_multiplier_down:[{old:"DOWNMULTIPLIER",new:"DOWNMULTIPLIER"}]};switch(o){case"bb_statement":case"bba_statement":var a=r.getField("BBRESULT_LIST");a&&a.setValue(e.getFieldValue(t,"BBRESULT_LIST"));break;case"macda_statement":var l=r.getField("MACDFIELDS_LIST");l&&l.setValue(e.getFieldValue(t,"MACDFIELDS_LIST"))}(r.required_child_blocks||[]).forEach((function(t){var o=e.workspace.newBlock(t);r.getLastConnectionInStatement("STATEMENT").connect(o.previousConnection)})),r.getBlocksInStatement("STATEMENT").forEach((function(o){var n=i[o.type];n&&n.forEach((function(n){var i=t.querySelector('value[name="'.concat(n.old,'"]'));if(i){var a=o.getInput(n.new);Array.from(i.children).forEach((function(t){var o=e.convertBlockNode(t,r);"shadow"===t.tagName.toLowerCase()&&o.setShadow(!0),a.connection.connect(o.outputConnection)})),i.parentNode.removeChild(i)}}))}));var c=e.generateUniqueVariable(n),s=e.workspace.newBlock("variables_get");return s.setFieldValue(c.getId(),"VAR"),r.setFieldValue(c.getId(),"VARIABLE"),{block_to_attach:s,statement_blocks:[r]}},r=function(t){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.workspace.newBlock("trade_definition_tradeoptions"),r=t;if(o)return!1;var i=["DURATIONTYPE_LIST","CURRENCY_LIST","BARRIEROFFSETTYPE_LIST","SECONDBARRIEROFFSETTYPE_LIST"],a=Array.from(r.children),l=0,c=!1;return a.filter((function(e){return"value"===e.tagName.toLowerCase()})).forEach((function(e){var t=e.getAttribute("name");"BARRIEROFFSET"===t||"SECONDBARRIEROFFSET"===t?l++:"PREDICTION"===t&&(c=!0)})),l>0&&n.createBarrierInputs({allow_both_types:!0,values:[1,-1]}),c&&n.createPredictionInput([0]),i.forEach((function(t){var o=n.getField(t);o&&o.setValue(e.getFieldValue(r,t))})),{block_to_attach:n}};return{bb:function(e){return o(e,"bb_statement","bb")},bba:function(e){return o(e,"bba_statement","bba")},ema:function(e){return o(e,"ema_statement","ema")},emaa:function(e){return o(e,"emaa_statement","emaa")},lists_create_with:function(e){return t(e,"lists_create_with",(0,n.localize)("list"),"VALUE")},macda:function(e){return o(e,"macda_statement","macda")},market:function(e){return r(e)},rsi:function(e){return o(e,"rsi_statement","rsi")},rsia:function(e){return o(e,"rsia_statement","rsia")},sma:function(e){return o(e,"sma_statement","sma")},smaa:function(e){return o(e,"smaa_statement","smaa")},text_join:function(e){return t(e,"text_join",(0,n.localize)("text"),"TEXT")},trade:function(t){var o=e.workspace.newBlock("trade_definition"),n={trade_definition_market:["MARKET_LIST","SUBMARKET_LIST","SYMBOL_LIST"],trade_definition_tradetype:["TRADETYPECAT_LIST","TRADETYPE_LIST"],trade_definition_contracttype:["TYPE_LIST"],trade_definition_candleinterval:["CANDLEINTERVAL_LIST"],trade_definition_restartbuysell:["TIME_MACHINE_ENABLED"],trade_definition_restartonerror:["RESTARTONERROR"]},r={};return Object.keys(n).forEach((function(o){var i=e.workspace.newBlock(o);n[o].forEach((function(o){i.setFieldValue(e.getFieldValue(t,o),o)})),r[o]=i})),Object.values(r).forEach((function(e){o.getLastConnectionInStatement("TRADE_OPTIONS").connect(e.previousConnection)})),{block_to_attach:o}},tradeOptions:r}}},{key:"getIllegalBlocks",value:function(){var e=[],t=a.Z.instance.active_symbols.active_symbols,o=i.v.opposites;return t.forEach((function(t){var o=t.symbol.toLowerCase();e.includes(o)||e.push(o)})),Object.keys(o).forEach((function(t){return e.push(t)})),e}},{key:"createWorkspace",value:function(){var e=new Blockly.Options({media:"".concat(o.p,"media/")}),t=new DocumentFragment;return Blockly.createVirtualWorkspace_(t,e,!1,!1)}},{key:"getFieldValue",value:function(e,t){var o=e.querySelector('field[name="'.concat(t,'"]'));return o?o.textContent:""}},{key:"getFirstBlockInStack",value:function(e){var t=e.previousConnection,o=e.getPreviousBlock();if(!t)return e;for(;o&&o!==e.getSurroundParent();)t=o.previousConnection,o=o.getPreviousBlock();return t.sourceBlock_}},{key:"updateRenamedFields",value:function(e){var t={MARKET_LIST:{volidx:"synthetic_index"},TRADETYPECAT_LIST:{endsinout:"inout",staysinout:"inout",callputequal:"callput"},TRADETYPE_LIST:{risefall:"callput",risefallequals:"callputequal"}};return Object.keys(t).forEach((function(o){var n=e.querySelector('field[name="'.concat(o,'"]'));if(n){var r=n.innerText;Object.keys(t[o]).forEach((function(e){r===e&&(n.innerText=t[o][e])}))}})),e}},{key:"naivelyFixLegacyStrategyAfterConversion",value:function(){var e=this.workspace.getTradeDefinitionBlock();e&&e.getBlocksInStatement("SUBMARKET").forEach((function(t){if("trade_definition_tradeoptions"!==t.type){var o=e.getLastConnectionInStatement("INITIALIZATION");t.unplug(!0),o.connect(t.previousConnection)}}))}},{key:"generateUniqueVariable",value:function(e){for(var t=e,o=0;Object.values(this.workspace_variables).includes(t);)t=e+ ++o;var n=Blockly.Variables.getOrCreateVariablePackage(this.workspace,"",t,"");return this.workspace_variables[n.id_]=t,n}},{key:"convertStrategy",value:function(e,t){var o=this;Blockly.Events.disable();var n=this.updateRenamedFields(e);if(e.hasAttribute("is_dbot")&&"true"===e.getAttribute("is_dbot"))return Blockly.Events.enable(),n;if(this.getIllegalBlocks().some((function(e){return!!n.querySelector('block[type="'.concat(e,'"]'))})))return t&&t(),Blockly.Events.enable(),Blockly.Xml.textToDom("<xml />");var r=[],i=[];Array.from(n.children).forEach((function(e){switch(e.nodeName.toLowerCase()){case"block":case"shadow":i.push(e);break;case"variables":r.push.apply(r,function(e){if(Array.isArray(e))return l(e)}(t=e.children)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?l(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}var t}));var a=function(e){e.forEach((function(e){var t=e.getAttribute("id"),n=e.textContent;if(!o.workspace_variables[t]){var r=Blockly.Variables.getOrCreateVariablePackage(o.workspace,t,n,"");o.workspace_variables[r.id_]=r.name}}))};a(r),a(n.querySelectorAll('field[name="VAR"]')),i.forEach((function(e){return o.convertBlockNode(e)})),Object.keys(this.blocks_pending_reconnect).forEach((function(e){var t=o.workspace.getBlockById(e),n=o.blocks_pending_reconnect[e],r=t.previousConnection;if(r){var i=r.targetConnection,a=r;if(n.reverse().forEach((function(e){a.connect(e.nextConnection),a=e.previousConnection})),i){for(var l=t.previousConnection,c=t.getPreviousBlock();c&&c!==c.getSurroundParent();)l=c.previousConnection,c=c.getPreviousBlock();i.connect(l)}}})),this.naivelyFixLegacyStrategyAfterConversion(),this.workspace.getAllBlocks(!0).forEach((function(e){e.initSvg(),e.render()})),this.workspace.cleanUp();var c=Blockly.Xml.workspaceToDom(this.workspace);return e.hasAttribute("collection")&&"true"===e.getAttribute("collection")&&c.setAttribute("collection","true"),c.setAttribute("is_dbot","true"),this.workspace=null,Blockly.Events.enable(),c}},{key:"convertBlockNode",value:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getConversions(),r=e.getAttribute("type"),i=Object.keys(n).includes(r),a=null,l=e.getAttribute("collapsed")&&"true"===e.getAttribute("collapsed"),c=e.getAttribute("movable")&&"false"===e.getAttribute("movable"),s=e.getAttribute("deletable")&&"false"===e.getAttribute("deletable"),u=e.getAttribute("disabled")&&"true"===e.getAttribute("disabled"),p=function(e){e.setCollapsed(l),e.setMovable(!c),e.setDeletable(!s),e.setDisabled(u)};if(i){var d=n[r](e);d.block_to_attach&&(a=d.block_to_attach,p(a)),o&&d.statement_blocks&&d.statement_blocks.forEach((function(e){p(e);var n=t.getClosestLegalPreviousConnection(o);if(n){var r=n.sourceBlock_;t.blocks_pending_reconnect[r.id]||(t.blocks_pending_reconnect[r.id]=[]),t.blocks_pending_reconnect[r.id].push(e)}}))}else{var y=Object.keys(Blockly.Blocks).includes(r);if(y&&(a=this.workspace.newBlock(r),p(a),a)){var m=Array.from(e.children).find((function(e){return"mutation"===e.tagName.toLowerCase()}));m&&a.domToMutation&&a.domToMutation(m)}}return a?(o&&(a.conversion_parent=o),Array.from(e.children).forEach((function(e){switch(e.tagName.toLowerCase()){case"field":var o=e.getAttribute("name"),n=a.getField(o);if(n)if(n instanceof Blockly.FieldVariable){var r=e.getAttribute("id"),i=e.innerText.trim(),l=Blockly.Variables.getOrCreateVariablePackage(t.workspace,r,i,"");t.workspace_variables[l.id_]=i,n.setValue(l.id_)}else n.setValue(e.innerText);break;case"value":t.processValueInputs(a,e);break;case"statement":var c=e.getAttribute("name");t.processStatementInputs(a,c,e);break;case"next":var s=e.closest("statement");if(s){var u=s.getAttribute("name");t.processStatementInputs(a,u,e,a.conversion_parent)}else a.nextConnection&&Array.from(e.children).forEach((function(e){var o=t.convertBlockNode(e);a.nextConnection.connect(o.previousConnection)}));break;case"comment":var p="true"!==e.getAttribute("pinned"),d=e.innerText;a.comment=new Blockly.ScratchBlockComment(a,d,null,0,0,p),a.comment.iconXY_={x:0,y:0},a.comment.setVisible(!0)}})),a):(console.warn("Unrecognised block found.",r),!1)}},{key:"processValueInputs",value:function(e,t){var o=this,n=t.getAttribute("name"),r=e.getInput(n);if(!r)return console.warn("Unrecognised value input",n),!1;Array.from(t.children).forEach((function(t){var n=o.convertBlockNode(t,e);if(!n)return console.warn("Illegal child.",t.getAttribute("type")),!1;"shadow"===t.tagName.toLowerCase()&&n.setShadow(!0),r.connection.connect(n.outputConnection)}))}},{key:"processStatementInputs",value:function(e,t,o){var n=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=r||e,a=i.getInput(t);if(!a)return console.warn("Unrecognised statement input",t),!1;Array.from(o.children).forEach((function(e){var o=n.convertBlockNode(e,i);if(!o)return console.warn("Unrecognised child in statement",e.getAttribute("type")),!1;var r=i.getInput(t);r&&o.previousConnection&&r.connection.connect(o.previousConnection)}))}},{key:"getClosestLegalPreviousConnection",value:function(e){if(i.v.procedureDefinitionBlocks.includes(e.type)){if(0===e.getBlocksInStatement("STACK").length){var t=e.getInput("STACK"),o=this.workspace.newBlock("useless_block");return t.connection.connect(o.previousConnection),o.previousConnection}return e.getInputTargetBlock("STACK").previousConnection}for(var n=this.getFirstBlockInStack(e),r=this.isConnectedToProtectedStatementInput(n);r;){var a=n.getParent();a&&(n=a,r=this.isConnectedToProtectedStatementInput(n))}return n.previousConnection?n.previousConnection:!!e.conversion_parent&&this.getClosestLegalPreviousConnection(e.conversion_parent)}},{key:"isConnectedToProtectedStatementInput",value:function(e){var t=this.getFirstBlockInStack(e).previousConnection;if(t){var o=t.targetConnection;if(o){var n=o.sourceBlock_,r=n.getInputWithConnection(o),i=n.protected_statements||[];if(r&&i.includes(r.name))return!0}}return!1}}],r&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),s=o(8421),u=o(2620),p=o(2626),d=o(282),y=o(7103);function m(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function _(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function h(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){_(i,n,r,a,l,"next",e)}function l(e){_(i,n,r,a,l,"throw",e)}a(void 0)}))}}var g=function(){var e,t=null!==(e=d.Z.instance.save_modal.bot_name)&&void 0!==e?e:i.v.default_file_name;if(document.title.indexOf("-")>-1){var o=document.title.substr(document.title.indexOf("-")),n=document.title.replace(o,"- ".concat(t));document.title=n}else document.title+=" - ".concat(t)},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@deriv/bot",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2?arguments[2]:void 0;o.setAttribute("is_dbot","true"),o.setAttribute("collection",t?"true":"false");var n=Blockly.Xml.domToPrettyText(o);(0,r.p)({data:n,type:"text/xml;charset=utf-8",filename:"".concat(e,".xml")})},v=function(e){var t=e.block_string,o=e.drop_event,r=e.file_name,i=e.strategy_id,a=e.from,l=e.workspace,m=e.showIncompatibleStrategyDialog,f=d.Z.instance,_=f.startLoading,g=f.endLoading;_(),setTimeout(h(regeneratorRuntime.mark((function e(){var f,_,h,b,v,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f=function(){g();var e=(0,n.localize)("XML file contains unsupported elements. Please check or modify file.");s.P.emit("ui.log.error",e)},e.prev=1,!(new DOMParser).parseFromString(t,"application/xml").getElementsByTagName("parsererror").length){e.next=5;break}return e.abrupt("return",f());case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",f());case 10:e.prev=10,_=Blockly.Xml.textToDom(t),e.next=17;break;case 14:return e.prev=14,e.t1=e.catch(10),e.abrupt("return",f());case 17:if(h=new c,_=h.convertStrategy(_,m),(b=_.querySelectorAll("block")).length){e.next=22;break}return e.abrupt("return",f());case 22:if(!Array.from(b).some((function(e){var t=e.getAttribute("type");return!Object.keys(Blockly.Blocks).includes(t)}))){e.next=25;break}return e.abrupt("return",f());case 25:if(e.prev=25,v=_.hasAttribute("collection")&&"true"===_.getAttribute("collection"),T=v?"load_collection".concat(Date.now()):"dbot-load".concat(Date.now()),Blockly.Events.setGroup(T),(0,u.kH)(l,Array.from(b).map((function(e){return e.getAttribute("type")}))),!v){e.next=34;break}k(_,o,T,l),e.next=44;break;case 34:return e.next=36,E(_,T,l);case 36:if(l!==Blockly.derivWorkspace){e.next=44;break}return d.Z.instance.save_modal.updateBotName(r),l.clearUndo(),l.current_strategy_id=i||Blockly.utils.genUid(),e.next=44,(0,p.l5)(_,a);case 44:l.getAllBlocks().forEach((function(e){e.disabled&&(e.is_user_disabled_state=!0)})),l===Blockly.derivWorkspace&&s.P.emit("ui.log.success",{log_type:y.F$.LOAD_BLOCK}),e.next=52;break;case 48:return e.prev=48,e.t2=e.catch(25),console.error(e.t2),e.abrupt("return",f());case 52:return e.prev=52,g(),e.finish(52);case 55:return e.abrupt("return",!0);case 56:case"end":return e.stop()}}),e,null,[[1,7],[10,14],[25,48,52,55]])}))),500)},k=function(e,t,o,n){Blockly.Events.setGroup(o);var r=Blockly.Xml.domToWorkspace(e,n).map((function(e){return n.getBlockById(e)}));t&&0!==Object.keys(t).length?function(e,t,o){var n=t||{},r=n.clientX,i=void 0===r?0:r,a=n.clientY,l=void 0===a?0:a,c=o.getMetrics(),s=1/o.scale,u=c.absoluteLeft-c.viewLeft,p=document.body.offsetHeight-c.viewHeight-c.viewTop,d=i?(i-u)*s:0,y=l?(l-p-76)*s:0;o.cleanUp(d,y,e)}(r,t,n):n.cleanUp()},E=function(){var e=h(regeneratorRuntime.mark((function e(t,o,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Blockly.Events.setGroup(o),e.next=3,n.asyncClear();case 3:Blockly.Xml.domToWorkspace(t,n);case 4:case"end":return e.stop()}}),e)})));return function(t,o,n){return e.apply(this,arguments)}}(),T=function(e){return new Promise((function(t,o){var r=e.getFieldValue("URL");-1===r.indexOf("http")&&(r="http://".concat(r));var i="/"===r.slice(-1)[0];if(!r.match(/[^/]*\.[a-zA-Z]{3}$/)&&!i)return o((0,n.localize)("Target must be an XML file"));if(i&&(r+="index.xml"),e.isKnownUrl(r))return e.setDisabled(!0),o((0,n.localize)("This URL is already loaded"));var a=function(){return o((0,n.localize)("An error occured while trying to load the URL"))};fetch(r).then((function(o){o.ok?o.text().then((function(o){(function(e,t){return new Promise((function(o,r){var i;try{i=Blockly.Xml.textToDom(e)}catch(e){return r((0,n.localize)("Unrecognized file format"))}try{i.hasAttribute("collection")&&"true"===i.getAttribute("collection")||r((0,n.localize)("Remote blocks to load must be a collection.")),B(i).then((function(){Array.from(i.children).forEach((function(e){return S(e,t)})),o()})).catch((function(){r()}))}catch(e){r((0,n.localize)("Unable to load the block file."))}}))})(o,e).then((function(){return t(e)})).catch(a)})):a()})).catch(a)}))},B=function(e){return new Promise((function(t,o){var n=[];Array.from(e.children).forEach((function(e){if("loader"===e.getAttribute("type")){e.remove();var t=Blockly.Xml.domToBlock(e,Blockly.derivWorkspace);n.push(T(t))}})),n.length?Promise.all(n).then(t,o):t([])}))},S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("variables"===e.tagName.toLowerCase())return Blockly.Xml.domToVariables(e,Blockly.derivWorkspace);var o=e.getAttribute("type"),n=new c,r=Blockly.Xml.blockToDom(n.convertBlockNode(e));Array.from(r.getElementsByTagName("arg")).forEach((function(e){e.hasAttribute("varid")&&e.setAttribute("varId",e.getAttribute("varid"))})),(0,u.kH)(Blockly.derivWorkspace,o);var i=Blockly.Xml.domToBlock(r,Blockly.derivWorkspace);return t&&t.blocks_added_by_me.push(i),i},O=function(e){var t=e.getAllBlocks(),o="multiplier"===e.getAllBlocks(!0).find((function(e){return"trade_definition_tradetype"===e.type})).getFieldValue("TRADETYPE_LIST")?"trade_definition_multiplier":"trade_definition_tradeoptions",n=i.v.mandatoryMainBlocks,r=[o].concat(m(n)),a=t.map((function(e){return e.type}));return r.every((function(e){return a.includes(e)}))},w=function(e){var t="multiplier"===e.getAllBlocks(!0).find((function(e){return"trade_definition_tradetype"===e.type})).getFieldValue("TRADETYPE_LIST")?"trade_definition_multiplier":"trade_definition_tradeoptions",o=i.v.mandatoryMainBlocks,n=[t].concat(m(o)),r=e.getAllBlocks().filter((function(e){return!e.disabled})).map((function(e){return e.type}));return n.every((function(e){return r.includes(e)}))},C=function(e,t,o,n){var r=e.getMetrics(),i=r.viewLeft-r.contentLeft,a=r.viewTop-r.contentTop;o?(i+=n?t:-t,a+=-20):(i+=-20,a+=n?t:-t),e.scrollbar.set(i,a)},A=function(e,t,o){var n=e&&Blockly.Events.getGroup()||o||!0;Blockly.Events.setGroup(n),t(),e||Blockly.Events.setGroup(!1)},I=function(e){var t=Blockly.Events.recordUndo;Blockly.Events.recordUndo=!1,e(),Blockly.Events.recordUndo=t},R=function(e){Blockly.Events.disable(),e(),Blockly.Events.enable()},D=function(e,t){t.type===Blockly.Events.END_DRAG&&e.getAllBlocks().forEach((function(e){if(e.getParent()&&!e.is_user_disabled_state){var o=e.restricted_parents||[];if(0!==o.length){var n=!o.some((function(t){return e.isDescendantOf(t)}));A(!0,(function(){e.setDisabled(n)}),t.group),Blockly.Events.setGroup(!1)}}}))},x=function(e){return!e||"''"===e},P=function(e){var t=e.substring(1),o=parseInt(t,16);return.2126*(o>>16&255)+.7152*(o>>8&255)+.0722*(o>>0&255)<160}},5401:(e,t,o)=>{"use strict";o.d(t,{Z:()=>c});var n=o(2273),r=o(6715),i=o(9789);function a(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var c=function(){function e(t,o){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sortDropdownOptions=function(e,t){var o,r=function(e){if(Array.isArray(e))return l(e)}(o=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?l(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return r.sort((function(e,o){var r=t.call(n,e[1]),i=t.call(n,o[1]);return r&&!i?1:r===i?0:-1})),r},this.active_symbols=[],this.disabled_markets=[],this.disabled_symbols=["frxGBPNOK","frxUSDNOK","frxUSDNEK","frxUSDSEK"],this.disabled_submarkets=["energy","step_index","crash_index"],this.init_promise=new r.Z,this.is_initialised=!1,this.processed_symbols={},this.trading_times=o,this.ws=t}var t,o,c,s;return t=e,o=[{key:"retrieveActiveSymbols",value:(c=regeneratorRuntime.mark((function e(){var t,o,n,r=this,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]&&i[0],e.next=3,this.trading_times.initialise();case 3:if(t||!this.is_initialised){e.next=7;break}return e.next=6,this.init_promise;case 6:return e.abrupt("return",this.active_symbols);case 7:return this.is_initialised=!0,e.next=10,this.ws.authorized.activeSymbols();case 10:return o=e.sent,n=o.active_symbols,this.active_symbols=n,this.processed_symbols=this.processActiveSymbols(),this.trading_times.onMarketOpenCloseChanged=function(e){Object.keys(e).forEach((function(t){var o=r.active_symbols[t];o&&(o.exchange_is_open=e[t])})),r.changes=e,r.processActiveSymbols()},this.init_promise.resolve(),e.abrupt("return",this.active_symbols);case 17:case"end":return e.stop()}}),e,this)})),s=function(){var e=this,t=arguments;return new Promise((function(o,n){var r=c.apply(e,t);function i(e){a(r,o,n,i,l,"next",e)}function l(e){a(r,o,n,i,l,"throw",e)}i(void 0)}))},function(){return s.apply(this,arguments)})},{key:"processActiveSymbols",value:function(){var e=this;return this.active_symbols.reduce((function(t,o){if(e.disabled_markets.includes(o.market)||e.disabled_symbols.includes(o.symbol)||e.disabled_submarkets.includes(o.submarket))return t;var n=function(e,t){return-1!==Object.keys(e).findIndex((function(e){return e===o[t]}))};n(t,"market")||(t[o.market]={display_name:o.market_display_name,submarkets:{}});var r=t[o.market].submarkets;n(r,"submarket")||(r[o.submarket]={display_name:o.submarket_display_name,symbols:{}});var i=r[o.submarket].symbols;return n(i,"symbol")||(i[o.symbol]={display_name:o.display_name,pip_size:"".concat(o.pip).length-2,is_active:!o.is_trading_suspended&&o.exchange_is_open}),t}),{})}},{key:"getAllSymbols",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=[];return Object.keys(this.processed_symbols).forEach((function(n){if(!t||!e.isMarketClosed(n)){var r=e.processed_symbols[n],i=r.submarkets;Object.keys(i).forEach((function(e){var t=i[e],a=t.symbols;Object.keys(a).forEach((function(i){var l=a[i];o.push({market:n,market_display:r.display_name,submarket:e,submarket_display:t.display_name,symbol:i,symbol_display:l.display_name})}))}))}})),o}},{key:"getMarketDropdownOptions",value:function(){var e=this,t=[];if(Object.keys(this.processed_symbols).forEach((function(o){var r=e.processed_symbols[o].display_name+(e.isMarketClosed(o)?" ".concat((0,n.localize)("(Closed)")):"");t.push([r,o])})),0===t.length)return i.v.NOT_AVAILABLE_DROPDOWN_OPTIONS;if(t.sort((function(e){return"synthetic_index"===e[1]?-1:1})),t.some((function(t){return e.isMarketClosed(t[1])}))){var o=this.sortDropdownOptions(t,this.isMarketClosed);return this.isMarketClosed("forex")?o.sort((function(e){return"synthetic_index"===e[1]?-1:1})):o}return t}},{key:"getSubmarketDropdownOptions",value:function(e){var t=this,o=[],r=this.processed_symbols[e];if(r){var a=r.submarkets;Object.keys(a).forEach((function(e){var r=a[e].display_name+(t.isSubmarketClosed(e)?" ".concat((0,n.localize)("(Closed)")):"");o.push([r,e])}))}return 0===o.length?i.v.NOT_AVAILABLE_DROPDOWN_OPTIONS:("synthetic_index"===e&&o.sort((function(e){return"random_index"===e[1]?-1:1})),this.sortDropdownOptions(o,this.isSubmarketClosed))}},{key:"getSymbolDropdownOptions",value:function(e){var t=this,o=Object.keys(this.processed_symbols).reduce((function(o,r){var i=t.processed_symbols[r].submarkets;return Object.keys(i).forEach((function(r){if(r===e){var a=i[r].symbols;Object.keys(a).forEach((function(e){var r=a[e].display_name+(t.isSymbolClosed(e)?" ".concat((0,n.localize)("(Closed)")):"");o.push([r,e])}))}})),o}),[]);return 0===o.length?i.v.NOT_AVAILABLE_DROPDOWN_OPTIONS:this.sortDropdownOptions(o,this.isSymbolClosed)}},{key:"isMarketClosed",value:function(e){var t=this,o=this.processed_symbols[e];return!o||Object.keys(o.submarkets).every((function(e){return t.isSubmarketClosed(e)}))}},{key:"isSubmarketClosed",value:function(e){var t=this,o=Object.keys(this.processed_symbols).find((function(o){var n=t.processed_symbols[o];return Object.keys(n.submarkets).includes(e)}));if(!o)return!0;var n=this.processed_symbols[o].submarkets[e];if(!n)return!0;var r=n.symbols;return Object.keys(r).every((function(e){return t.isSymbolClosed(e)}))}},{key:"isSymbolClosed",value:function(e){return this.active_symbols.some((function(t){return t.symbol===e&&(!t.exchange_is_open||t.is_trading_suspended)}))}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},9633:(e,t,o)=>{"use strict";o.d(t,{Z:()=>s});var n=o(4227),r=o(1408),i=o(5401);var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ws=t.ws}var t,o;return t=e,o=[{key:"getStakePayoutLimits",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AUD",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"svg",o=arguments.length>2?arguments[2]:void 0;return this.ws.send({landing_company_details:t}).then((function(t){var n,r=null==t||null===(n=t.landing_company_details)||void 0===n?void 0:n.currency_config[o];return r?r[e]:{}}))}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.trading_times=new n.Z(t),this.contracts_for=new r.Z(t),this.active_symbols=new i.Z(t.ws,this.trading_times),this.account_limits=new a(t)}var t,o;return t=e,o=[{key:"setInstance",value:function(t){return this.singleton||(this.singleton=new e(t)),this.instance}},{key:"instance",get:function(){return this.singleton}}],o&&l(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.singleton=null;const s=c},1408:(e,t,o)=>{"use strict";o.d(t,{Z:()=>s});var n=o(9789),r=o(6715);function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function l(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function c(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){l(i,n,r,a,c,"next",e)}function c(e){l(i,n,r,a,c,"throw",e)}a(void 0)}))}}var s=function(){function e(t){var o=t.ws,n=t.server_time;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache_age_in_min=10,this.contracts_for={},this.ws=o,this.server_time=n,this.disabled_options=[{submarket:"smart_fx",trade_type:"higherlower"},{submarket:"minor_pairs",trade_type:"higherlower"},{submarket:"metals",trade_type:"callputequal"},{market:"indices",trade_type:"callputequal"},{symbol:"OTC_AS51",trade_type_category:"inout"},{trade_type_category:"lookback"},{trade_type_category:"callputspread"}],this.retrieving_contracts_for={}}var t,o,a,l,s,u,p,d,y,m,f,_,h,g;return t=e,o=[{key:"getBarriers",value:(g=c(regeneratorRuntime.mark((function e(t,o,r,i){var a,l,c,s,u,p,d,y=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={values:[]},n.v.BARRIER_TRADE_TYPES.includes(o)){e.next=3;break}return e.abrupt("return",a);case 3:return l=["high_barrier","low_barrier"],e.next=6,this.getContractsByTradeType(t,o);case 6:return c=e.sent,e.next=9,this.getDurations(t,o,!1);case 9:return s=e.sent,u=new RegExp("^[-|+]([0-9]+.[0-9]+)$"),p=function(e){return e&&u.test(e.toString())},d=!0,c.length>0&&(i.forEach((function(e,t){var m=["+","-"].includes(e),f=y.getContractCategoryByTradeType(o),_=c.find((function(e){var i=n.v.BARRIER_CATEGORIES,a=Object.keys(i).find((function(e){return i[e].includes(o)})),c=e.contract_category===f,u=-1!==s.findIndex((function(e){return e.unit===r})),d=e.barrier_category===a,y=m&&p(e.barrier||e[l[t]])||!m&&!p(e.barrier||e[l[t]]);return c&&u&&d&&y}));if(_||(_=c.filter((function(e){return e.barrier||e.high_barrier})).sort((function(e,t){var o=e.barrier||e.high_barrier,n=t.barrier||t.high_barrier;return parseFloat(o)-parseFloat(n)})).shift())&&!m&&(d=!1),_){var h=1===_.barriers?"barrier":l[t];if(_[h]){var g="".concat(_[h]).match(u);a.values[t]=g?g[1]:_[h]}Object.assign(a,{allow_both_types:["intraday","tick"].includes(_.expiry_type)&&p(_[h]),allow_absolute_type:"absolute"===e&&!p(_[h])}),1===_.barriers&&i.splice(t+1,1)}})),d?2===a.values.length&&i.every((function(e){return e===i[0]}))&&a.values.every((function(e){return e===a.values[0]}))&&(a.values[1]=(.95*a.values[0]).toFixed(1)):a.values=a.values.map((function(){return!1}))),e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,o,n){return g.apply(this,arguments)})},{key:"getContractCategoryByTradeType",value:function(e){var t=n.v.TRADE_TYPE_TO_CONTRACT_CATEGORY_MAPPING;return Object.keys(t).find((function(o){return t[o].includes(e)}))||e}},{key:"getTradeTypeCategoryByTradeType",value:function(e){var t=n.v.TRADE_TYPE_CATEGORIES;return Object.keys(t).find((function(o){return t[o].includes(e)}))||e}},{key:"getTradeTypeCategoryNameByTradeType",value:function(e){return n.v.TRADE_TYPE_CATEGORY_NAMES[this.getTradeTypeCategoryByTradeType(e)]}},{key:"getBarrierCategoryByTradeType",value:function(e){var t=n.v.BARRIER_CATEGORIES;return Object.keys(t).find((function(o){return t[o].includes(e)}))}},{key:"getContractsByTradeType",value:(h=c(regeneratorRuntime.mark((function e(t,o){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getContractsFor(t);case 2:return n=e.sent,r=this.getContractCategoryByTradeType(o),i=this.getBarrierCategoryByTradeType(o),e.abrupt("return",n.filter((function(e){var t=e.contract_category===r,o=e.barrier_category===i;return t&&o})));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"getContractsFor",value:(_=c(regeneratorRuntime.mark((function e(t){var o,n,i,a,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"na"!==t){e.next=2;break}return e.abrupt("return",[]);case 2:if(o=function(){var e=c(regeneratorRuntime.mark((function e(){var o,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.retrieving_contracts_for[t]){e.next=4;break}return e.next=3,l.retrieving_contracts_for[t];case 3:return e.abrupt("return",l.contracts_for[t].contracts);case 4:return l.retrieving_contracts_for[t]=new r.Z,e.next=7,l.ws.send({contracts_for:t});case 7:if(!(o=e.sent).error){e.next=10;break}return e.abrupt("return",[]);case 10:return n=o.contracts_for.available,i=n.filter((function(e){return"forward"!==e.start_type})),l.contracts_for[t]={contracts:i,timestamp:l.server_time.unix()},l.retrieving_contracts_for[t].resolve(),delete l.retrieving_contracts_for[t],e.abrupt("return",i);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),!this.contracts_for[t]){e.next=8;break}return n=this.contracts_for[t],i=n.contracts,a=n.timestamp,this.server_time.unix()-a>60*this.cache_age_in_min&&o(),e.abrupt("return",i);case 8:return e.abrupt("return",o());case 9:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"getDurations",value:(f=c(regeneratorRuntime.mark((function e(t,o){var r,i,a,l,c,s,u,p,d,y=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(y.length>2&&void 0!==y[2])||y[2],"multiplier"!==o){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,this.getContractsFor(t);case 5:if(i=e.sent,a=n.v.NOT_AVAILABLE_DURATIONS,l=n.v.DEFAULT_DURATION_DROPDOWN_OPTIONS,0!==i.length){e.next=9;break}return e.abrupt("return",a);case 9:return e.next=11,this.getContractsByTradeType(t,o);case 11:if(c=e.sent,s=[],u=function(e){return l.findIndex((function(t){return t[1]===e.replace(/\d+/g,"")}))},p=function(e,t){var o=e.replace(/\D/g,""),n=u(e),r=l.findIndex((function(e){return e[1]===t})),i=parseInt(o);return l.slice(r+1,n+1).reverse().forEach((function(e){switch(e[1]){case"m":case"h":i*=60;break;case"d":i*=24}})),i},c.forEach((function(e){if(e.min_contract_duration&&e.max_contract_duration){var t=u(e.min_contract_duration),o=u("1d"===e.max_contract_duration&&r?"24h":e.max_contract_duration);l.slice(t,o+1).forEach((function(t,o){-1!==s.findIndex((function(e){return e.unit===t[1]}))||s.push({display:t[0],unit:t[1],min:0===o?parseInt(e.min_contract_duration.replace(/\D/g,"")):1,max:p(e.max_contract_duration,t[1])})}))}})),c.every((function(e){return"intraday"===e.expiry_type}))&&-1!==(d=s.findIndex((function(e){return"d"===e[1]})))&&s.splice(d,1),0!==s.length){e.next=19;break}return e.abrupt("return",a);case 19:return e.abrupt("return",s.sort((function(e,t){return u(e.unit)-u(t.unit)})));case 20:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"getPredictionRange",value:(m=c(regeneratorRuntime.mark((function e(t,o){var r,a,l,c,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getContractsByTradeType(t,o);case 2:return r=e.sent,a=this.getContractCategoryByTradeType(o),l=[],c=n.v.DIGIT_CATEGORIES,s=n.v.opposites,c.includes(a)&&"evenodd"!==o&&((u=r.find((function(e){return Object.keys(s).some((function(t){return s[t].map((function(e){return Object.keys(e)[0]})).includes(e.contract_type)}))})))&&u.last_digit_range?l.push.apply(l,i(u.last_digit_range)):l.push(1,2,3,4,5,6,7,8)),e.abrupt("return",l);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"getMultiplierRange",value:(y=c(regeneratorRuntime.mark((function e(t,o){var r,a,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getContractsByTradeType(t,o);case 2:return r=e.sent,a=[],l=n.v.opposites,null!=(c=r.find((function(e){return Object.keys(l).some((function(t){return l[t].map((function(e){return Object.keys(e)[0]})).includes(e.contract_type)}))})))&&c.multiplier_range&&a.push.apply(a,i(c.multiplier_range)),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"getMarketBySymbol",value:(d=c(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getContractsFor(t);case 2:if((o=e.sent).length){e.next=5;break}return e.abrupt("return","na");case 5:return e.abrupt("return",o[0].market);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getSubmarketBySymbol",value:(p=c(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getContractsFor(t);case 2:if((o=e.sent).length){e.next=5;break}return e.abrupt("return","na");case 5:return e.abrupt("return",o[0].submarket);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"getGroupedTradeTypes",value:(u=c(regeneratorRuntime.mark((function e(t){var o,n,r,i,a,l,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getContractsFor(t);case 2:o=e.sent,n={},r=0;case 5:if(!(r<o.length)){e.next=17;break}return i=o[r].market,a=o[r].submarket,l=this.getTradeTypeCategoryByTradeType(o[r].contract_category),c=this.getTradeTypeCategoryNameByTradeType(o[r].contract_category),e.next=12,this.getTradeTypeByTradeCategory(i,a,t,l);case 12:s=e.sent,c&&(this.isDisabledOption({market:i,submarket:a,symbol:t,trade_type_category:l})||(n[c]=s));case 14:r++,e.next=5;break;case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"getTradeTypeByTradeCategory",value:(s=c(regeneratorRuntime.mark((function e(t,o,r,i){var a,l,c,s,u,p,d,y,m,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.v.NOT_AVAILABLE_DURATIONS,l=n.v.TRADE_TYPE_CATEGORIES,c=n.v.opposites,s=l[i],u=[],!s||!s.length){e.next=16;break}p=0;case 5:if(!(p<s.length)){e.next=16;break}return d=s[p],e.next=9,this.getDurations(r,d);case 9:y=e.sent,m=JSON.stringify(y)!==JSON.stringify(a),!this.isDisabledOption({market:t,submarket:o,symbol:r,trade_type_category:i,trade_type:d})&&m&&(f=c[d.toUpperCase()],u.push({name:f.map((function(e){return e[Object.keys(e)[0]]})).join("/"),value:d,icon:[Object.keys(f[0])[0],Object.keys(f[1])[0]]}));case 13:p++,e.next=5;break;case 16:return e.abrupt("return",u);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t,o,n){return s.apply(this,arguments)})},{key:"getTradeTypeCategories",value:(l=c(regeneratorRuntime.mark((function e(t,o,r){var i,a,l,c,s,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.v.TRADE_TYPE_CATEGORY_NAMES,a=n.v.NOT_AVAILABLE_DROPDOWN_OPTIONS,e.next=3,this.getContractsFor(r);case 3:if(l=e.sent,c=[],l.forEach((function(e){var n=u.getTradeTypeCategoryByTradeType(e.contract_category),i=u.getTradeTypeCategoryNameByTradeType(e.contract_category);i&&(u.isDisabledOption({market:t,submarket:o,symbol:r,trade_type_category:n})||-1!==c.findIndex((function(e){return e[1]===n}))||c.push([i,n]))})),!(c.length>0)){e.next=9;break}return s=Object.keys(i),e.abrupt("return",c.sort((function(e,t){return s.findIndex((function(t){return t===e[1]}))-s.findIndex((function(e){return e===t[1]}))})));case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,o){return l.apply(this,arguments)})},{key:"getTradeTypes",value:(a=c(regeneratorRuntime.mark((function e(t,o,r,i){var a,l,c,s,u,p,d,y,m,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.v.NOT_AVAILABLE_DURATIONS,l=n.v.TRADE_TYPE_CATEGORIES,c=n.v.opposites,s=[],!(u=l[i])){e.next=16;break}p=0;case 5:if(!(p<u.length)){e.next=16;break}return d=u[p],e.next=9,this.getDurations(r,d);case 9:y=e.sent,m=JSON.stringify(y)!==JSON.stringify(a),!this.isDisabledOption({market:t,submarket:o,symbol:r,trade_type_category:i,trade_type:d})&&m&&(f=c[d.toUpperCase()],s.push([f.map((function(e){return e[Object.keys(e)[0]]})).join("/"),d]));case 13:p++,e.next=5;break;case 16:return e.abrupt("return",s.length>0?s:n.v.NOT_AVAILABLE_DROPDOWN_OPTIONS);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t,o,n){return a.apply(this,arguments)})},{key:"isDisabledOption",value:function(e){return this.disabled_options.some((function(t){return Object.keys(t).every((function(o){return e[o]===t[o]}))}))}},{key:"disposeCache",value:function(){this.contracts_for={}}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},4227:(e,t,o)=>{"use strict";o.d(t,{Z:()=>a});var n=o(6715);function r(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function i(e){return function(){var t=this,o=arguments;return new Promise((function(n,i){var a=e.apply(t,o);function l(e){r(a,n,i,l,c,"next",e)}function c(e){r(a,n,i,l,c,"throw",e)}l(void 0)}))}}var a=function(){function e(t){var o=t.ws,r=t.server_time;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init_promise=new n.Z,this.is_initialised=!1,this.trading_times={},this.ws=o,this.server_time=r.clone()}var t,o,r,a;return t=e,o=[{key:"initialise",value:(a=i(regeneratorRuntime.mark((function e(){var t,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.is_initialised){e.next=2;break}return e.abrupt("return",this.init_promise);case 2:if(this.is_initialised=!0,this.last_update_moment=this.server_time.local(),Object.keys(this.trading_times).length){e.next=11;break}return e.next=7,this.updateTradingTimes();case 7:return this.init_promise.resolve(),t=function(){var e=i(regeneratorRuntime.mark((function e(){var n,r,i,a,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.updateMarketOpenClosed(),Object.keys(n).length>0&&o.onMarketOpenCloseChanged&&o.onMarketOpenCloseChanged(n),r=o.nextUpdateDate()){e.next=14;break}return i=o.server_time.local(),a=o.last_update_moment.clone().add(1,"days"),i.isAfter(a)?o.last_update_moment=i.clone():o.last_update_moment=a.clone(),l={},Object.keys(o.trading_times).forEach((function(e){l[e]=o.trading_times[e].is_opened})),e.next=11,o.updateTradingTimes();case 11:Object.keys(o.trading_times).forEach((function(e){o.trading_times[e].is_opened=l[e]})),a.set({hour:0,minute:0,second:0}),r=a.toDate();case 14:c=r-o.server_time.local().toDate(),o.update_timer=setTimeout(t,c);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=11,t();case 11:return e.abrupt("return",this.init_promise);case 12:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"updateTradingTimes",value:(r=i(regeneratorRuntime.mark((function e(){var t,o,n,r,i,a,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.last_update_moment.format("YYYY-MM-DD"),e.next=3,this.ws.tradingTimes(t);case 3:if(!(o=e.sent).error){e.next=6;break}return e.abrupt("return");case 6:if(this.trading_times={},n=this.server_time.local().toDate(),r=n.toISOString().substring(0,11),i=function(e){return new Date("".concat(r).concat(e,"Z"))},a=o.trading_times.markets){e.next=13;break}return e.abrupt("return");case 13:a.forEach((function(e){e.submarkets.forEach((function(e){e.symbols.forEach((function(e){var t,o=e.times,n=e.symbol,r=o.open,a=o.close,c=1===r.length&&"00:00:00"===r[0]&&"23:59:59"===a[0],s=1===r.length&&"--"===r[0]&&"--"===a[0];c||s||(t=r.map((function(e,t){return{open:i(e),close:i(a[t])}}))),l.trading_times[n]={is_open_all_day:c,is_closed_all_day:s,times:t}}))}))}));case 14:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"updateMarketOpenClosed",value:function(){var e=this,t={};return Object.keys(this.trading_times).forEach((function(o){var n=e.calcIsMarketOpened(o),r=e.trading_times[o];r.is_opened!==n&&(r.is_opened=n,t[o]=n)})),t}},{key:"calcIsMarketOpened",value:function(e){var t=this.server_time.local().unix(),o=this.trading_times[e],n=o.times,r=o.is_open_all_day;return!o.is_closed_all_day&&(!!r||n.some((function(e){var o=e.open,n=e.close;return t>=o&&t<n})))}},{key:"nextUpdateDate",value:function(){var e,t=this,o=this.server_time.local().toDate();return Object.keys(this.trading_times).forEach((function(n){var r=t.trading_times[n],i=r.times,a=r.is_open_all_day,l=r.is_closed_all_day;a||l||i.forEach((function(t){var n=t.open,r=t.close;n>o&&(!e||n<e)&&(e=n),r>o&&(!e||r<e)&&(e=r)}))})),e}},{key:"isMarketOpened",value:function(e){var t=Object.keys(this.trading_times);return!(!t.length||!t.includes(e))&&this.trading_times[e].is_opened}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},2626:(e,t,o)=>{"use strict";o.d(t,{l5:()=>p,WN:()=>d,lY:()=>y});var n=o(6954),r=o.n(n),i=o(5486),a=o.n(i),l=o(282),c=o(7929);function s(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function u(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){s(i,n,r,a,l,"next",e)}function l(e){s(i,n,r,a,l,"throw",e)}a(void 0)}))}}var p=function(){var e=u(regeneratorRuntime.mark((function e(t){var o,n,i,s,u,p,y,m,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=f.length>1&&void 0!==f[1]?f[1]:c.R.UNSAVED,t.setAttribute("is_dbot",!0),n=l.Z.instance.save_modal,i=Blockly.derivWorkspace.current_strategy_id||Blockly.utils.genUid(),e.next=6,d();case 6:s=e.sent,u=Blockly.Xml.domToText(t),p=Date.now(),(y=s.findIndex((function(e){return e.id===i})))>=0?((m=s[y]).xml=u,m.name=n.bot_name,m.timestamp=p,m.save_type=o):s.push({id:i,timestamp:p,name:n.bot_name,xml:u,save_type:o}),s.sort((function(e,t){return new Date(e.timestamp)-new Date(t.timestamp)})).reverse(),s.length>10&&s.pop(),a().setItem("saved_workspaces",r().compress(JSON.stringify(s)));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t1=JSON,e.t2=r(),e.next=5,a().getItem("saved_workspaces");case 5:if(e.t3=e.sent,e.t4=e.t2.decompress.call(e.t2,e.t3),e.t0=e.t1.parse.call(e.t1,e.t4),e.t0){e.next=10;break}e.t0=[];case 10:return e.abrupt("return",e.t0);case 13:return e.prev=13,e.t5=e.catch(0),e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=u(regeneratorRuntime.mark((function e(t){var o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d();case 2:return o=e.sent,(n=o.findIndex((function(e){return e.id===t})))>=0&&o.splice(n,1),e.next=7,a().setItem("saved_workspaces",r().compress(JSON.stringify(o)));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},8421:(e,t,o)=>{"use strict";o.d(t,{Z:()=>c,P:()=>s});var n=o(6670);function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eam=new n.Map}var t,o;return t=e,o=[{key:"register",value:function(e,t,o,r,i){var a=this;i&&this.unregisterAll(e);var c=function e(t){t.type===r.type&&(a.unregister("api.error",e),r.unregister.forEach((function(e){var t;e instanceof Array?a.unregister.apply(a,function(e){if(Array.isArray(e))return l(e)}(t=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?l(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()):a.unregisterAll(e)})))};r&&this.register("api.error",c);var s=function(){o&&a.unregister(e,t),r&&a.unregister("api.error",c),t.apply(void 0,arguments)},u=this.eam.get(e);this.eam=u?this.eam.set(e,u.push({action:s,searchBy:t})):this.eam.set(e,(new n.List).push({action:s,searchBy:t}))}},{key:"unregister",value:function(e,t){this.eam=this.eam.set(e,this.eam.get(e).filter((function(e){return e.searchBy!==t})))}},{key:"isRegistered",value:function(e){return this.eam.has(e)}},{key:"unregisterAll",value:function(e){this.eam=this.eam.delete(e)}},{key:"emit",value:function(e,t){this.eam.has(e)&&this.eam.get(e).forEach((function(e){return e.action(t)}))}},{key:"setState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=i(i({},this.state),e)}},{key:"getState",value:function(e){var t;return null===(t=this.state)||void 0===t?void 0:t[e]}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),s=new c},6715:(e,t,o)=>{"use strict";function n(){var e,t,o=new Promise((function(o,n){e=o,t=n}));return o.isPending=!0,o.resolve=function(t){o.isPending=!1,e(t)},o.reject=function(e){o.isPending=!1,t(e)},o}o.d(t,{Z:()=>n})},2620:(e,t,o)=>{"use strict";o.d(t,{N0:()=>r,kH:()=>i});var n=o(9789),r=function(){var e=Blockly.derivWorkspace;if(e){e.getAllFields().forEach((function(e){return e.forceRerender()}));var t=document.getElementById("scratch_div");t&&(t.style.width="100vw",t.style.height="var(--bot-content-height)",Blockly.svgResize(e))}},i=function(e,t){(Array.isArray(t)?t:[t]).forEach((function(t){n.v.single_instance_blocks.includes(t)&&e.getAllBlocks().forEach((function(e){e.type===t&&e.dispose()}))}))}},9394:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>Nu});var n={};o.r(n),o.d(n,{after_purchase:()=>jn,balance:()=>Vn,before_purchase:()=>Hn,check_direction:()=>Jn,console:()=>Gn,contract_check_result:()=>Wn,controls_flow_statements:()=>Yn,controls_for:()=>qn,controls_forEach:()=>Kn,controls_if:()=>Xn,controls_whileUntil:()=>Zn,during_purchase:()=>Qn,epoch:()=>$n,get_ohlc:()=>er,is_candle_black:()=>tr,last_digit:()=>or,logic_operation:()=>nr,math_arithmetic:()=>rr,math_constrain:()=>ir,math_single:()=>ar,notify_telegram:()=>lr,ohlc:()=>cr,ohlc_values:()=>sr,ohlc_values_in_list:()=>ur,procedures_ifreturn:()=>pr,read_details:()=>dr,read_ohlc:()=>yr,read_ohlc_obj:()=>mr,sell_at_market:()=>fr,sell_price:()=>_r,sma_statement:()=>hr,text_print:()=>gr,text_prompt_ext:()=>br,tick_analysis:()=>vr,todatetime:()=>kr,totimestamp:()=>Er,trade_again:()=>Tr,trade_definition:()=>Br,trade_definition_multiplier:()=>Or,trade_definition_tradeoptions:()=>Sr,variables_set:()=>wr});var r,i=o(57),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=window.location;return/^\/(br_)/.test(t.pathname)?"/".concat(t.pathname.split("/")[1]).concat(/^\//.test(e)?e:"/".concat(e)):e};r=a("/"),o.p=r,(0,i.setSmartChartsPublicPath)(a("/js/smartcharts/"));var l=o(8156),c=o(1336),s=o(2330);const u=function(){return l.createElement(l.Fragment,null,l.createElement("audio",{id:"announcement",src:"".concat(o.p,"media/announcement.mp3"),autostart:"false"}),l.createElement("audio",{id:"earned-money",src:"".concat(o.p,"media/coins.mp3"),autostart:"false"}),l.createElement("audio",{id:"job-done",src:"".concat(o.p,"media/job-done.mp3"),autostart:"false"}),l.createElement("audio",{id:"error",src:"".concat(o.p,"media/out-of-bounds.mp3"),autostart:"false"}),l.createElement("audio",{id:"severe-error",src:"".concat(o.p,"media/i-am-being-serious.mp3"),autostart:"false"}))};var p=o(3980),d=o.n(p),y=o(5264);function m(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function f(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?m(Object(o),!0).forEach((function(t){_(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):m(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function _(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var h=l.createContext(null),g=function(e){var t=e.store,o=e.children;return l.createElement(h.Provider,{value:f(f({},t),t.core)},o)},b=function(e){return function(t){return function(e,t){var o=function(o){var n=l.useContext(h),r=t;return function(e){return!("function"!=typeof e||!e.prototype||!e.prototype.isReactComponent)}(t)&&(r=function(e){return l.createElement(t,e)}),(0,y.useObserver)((function(){return r(f(f({},o),e(n,o)))}))};return o.displayName=t.name,o}(e,t)}},v=function(e){var t=e.is_loading;return l.createElement(l.Fragment,null,t&&l.createElement("div",{className:"bot__loading"},l.createElement(c.Loading,null)))};v.propTypes={is_loading:d().bool};const k=b((function(e){return{is_loading:e.blockly_store.is_loading}}))(v);var E=o(8310),T=o.n(E),B=o(2273),S=Object.freeze({WORKSPACE:"Workspace",CHART:"Chart"}),O=function(){return l.createElement(c.Popover,{alignment:"top",message:(0,B.localize)("Security and privacy")},l.createElement(c.StaticUrl,{className:"footer__link",href:"tnc/security-and-privacy.pdf",is_document:!0},l.createElement(c.Icon,{icon:"IcSecurityAndPrivacy"})))},w=function(e){var t=e.active_tab,o=e.populateFooterExtensions,n=e.setActiveTab;l.useEffect((function(){return i()})),l.useEffect((function(){return function(){return o([])}}),[o]);var r=function(){return l.createElement("div",{className:"bot-footer-extensions"},Object.keys(S).map((function(e){var o=S[e];return l.createElement("span",{key:e,className:T()("bot-footer-extensions__button",{"bot-footer-extensions__button--active":t===o}),onClick:function(){return n(o)}},o===S.WORKSPACE&&l.createElement(B.Localize,{i18n_default_text:"Workspace"}),o===S.CHART&&l.createElement(B.Localize,{i18n_default_text:"Chart"}))})))},i=function(){o([{position:"left",Component:r},{position:"right",Component:O,has_right_separator:!0}])};return null};w.propTypes={active_tab:d().string,populateFooterExtensions:d().func,setActiveTab:d().func};const C=b((function(e){var t=e.ui,o=e.main_content;return{active_tab:o.active_tab,populateFooterExtensions:t.populateFooterExtensions,setActiveTab:o.setActiveTab}}))(w);var A=function(e){var t=e.is_drawer_open,o=e.Notifications;return l.createElement("div",{className:T()("notifications-container",{"notifications-container--is-panel-open":t})},l.createElement(o,null))};A.propTypes={is_drawer_open:p.PropTypes.bool,notifications_length:p.PropTypes.number};const I=b((function(e){var t=e.core;return{is_drawer_open:e.run_panel.is_drawer_open,Notifications:t.ui.notification_messages_ui}}))(A);var R=function(e){var t=e.updateChartType,o=e.updateGranularity;return l.createElement(i.ToolbarWidget,null,l.createElement(i.ChartMode,{portalNodeId:"modal_root",onChartType:t,onGranularity:o}),l.createElement(i.StudyLegend,{portalNodeId:"modal_root",searchInputClassName:"data-hj-whitelist"}),l.createElement(i.DrawTools,{portalNodeId:"modal_root"}),l.createElement(i.Views,{portalNodeId:"modal_root",searchInputClassName:"data-hj-whitelist"}),l.createElement(i.Share,{portalNodeId:"modal_root"}))};R.propTypes={updateChartType:d().func,updateGranularity:d().func};const D=R;var x=function(e){var t=e.chart_type,o=e.granularity,n=e.is_mobile,r=e.is_socket_opened,a=e.onSymbolChange,c=e.setChartStatus,s=e.settings,u=e.show_digits_stats,p=e.symbol,d=e.updateChartType,y=e.updateGranularity,m=e.wsForget,f=e.wsForgetStream,_=e.wsSendRequest,h=e.wsSubscribe,g=e.getMarketsOrder;return l.createElement(i.SmartChart,{id:"dbot",barriers:[],showLastDigitStats:u,chartControlsWidgets:null,enabledChartFooter:!1,chartStatusListener:function(e){return c(!e)},toolbarWidget:function(){return l.createElement(D,{updateChartType:d,updateGranularity:y})},chartType:t,isMobile:n,granularity:o,requestAPI:_,requestForget:m,requestForgetStream:f,requestSubscribe:h,settings:s,symbol:p,topWidgets:function(){return l.createElement(i.ChartTitle,{onChange:a})},isConnectionOpened:r,getMarketsOrder:g})};x.PropTypes={chart_type:p.PropTypes.string,granularity:p.PropTypes.number,is_mobile:p.PropTypes.bool,is_socket_opened:p.PropTypes.bool,onSymbolChange:p.PropTypes.func,setChartStatus:p.PropTypes.func,settings:p.PropTypes.object,show_digits_stats:p.PropTypes.bool,symbol:p.PropTypes.object,updateChartType:p.PropTypes.func,updateGranularity:p.PropTypes.func,wsForget:p.PropTypes.func,wsForgetStream:p.PropTypes.func,wsSendRequest:p.PropTypes.func,wsSubscribe:p.PropTypes.func,getMarketsOrder:p.PropTypes.func};const P=b((function(e){var t=e.chart_store,o=e.common,n=e.ui;return{is_mobile:n.is_mobile,is_socket_opened:o.is_socket_opened,updateChartType:t.updateChartType,updateGranularity:t.updateGranularity,granularity:t.granularity,chart_type:t.chart_type,onSymbolChange:t.onSymbolChange,settings:{assetInformation:!1,countdown:!0,isHighestLowestMarkerEnabled:!1,language:o.current_language.toLowerCase(),position:n.is_chart_layout_default?"bottom":"left",theme:"light"},last_contract:{is_digit_contract:!1},symbol:t.symbol,setChartStatus:t.setChartStatus,wsForget:t.wsForget,wsForgetStream:t.wsForgetStream,wsSendRequest:t.wsSendRequest,wsSubscribe:t.wsSubscribe,getMarketsOrder:t.getMarketsOrder}}))(x);var N=o(4782);const z=function(){return l.createElement(N.ZP,{height:153,width:334,speed:3},l.createElement("rect",{x:"12",y:"15",rx:"0",ry:"0",width:"41",height:"25"}),l.createElement("rect",{x:"61",y:"24",rx:"0",ry:"0",width:"91",height:"8"}),l.createElement("rect",{x:"180",y:"15",rx:"0",ry:"0",width:"41",height:"25"}),l.createElement("rect",{x:"229",y:"24",rx:"0",ry:"0",width:"91",height:"8"}),l.createElement("rect",{x:"12",y:"48",rx:"0",ry:"0",width:"60",height:"8"}),l.createElement("rect",{x:"12",y:"64",rx:"0",ry:"0",width:"308",height:"8"}),l.createElement("rect",{x:"12",y:"80",rx:"0",ry:"0",width:"308",height:"1"}),l.createElement("rect",{x:"12",y:"89",rx:"0",ry:"0",width:"140",height:"8"}),l.createElement("rect",{x:"12",y:"105",rx:"0",ry:"0",width:"60",height:"8"}),l.createElement("rect",{x:"12",y:"121",rx:"0",ry:"0",width:"140",height:"8"}),l.createElement("rect",{x:"12",y:"137",rx:"0",ry:"0",width:"60",height:"8"}),l.createElement("rect",{x:"180",y:"89",rx:"0",ry:"0",width:"140",height:"8"}),l.createElement("rect",{x:"180",y:"105",rx:"0",ry:"0",width:"60",height:"8"}),l.createElement("rect",{x:"180",y:"121",rx:"0",ry:"0",width:"140",height:"8"}),l.createElement("rect",{x:"180",y:"137",rx:"0",ry:"0",width:"60",height:"8"}))};var L=function(e){var t=e.profit>=0;return l.createElement("div",{className:T()("db-contract-card__result",e.className,{"db-contract-card__result--won":t,"db-contract-card__result--lost":!t})},l.createElement(c.Text,{weight:"bold",className:"db-contract-card__result-caption"},t?l.createElement(l.Fragment,null,(0,B.localize)("Won"),l.createElement(c.Icon,{icon:"IcCheckmarkCircle",className:"db-contract-card__result-icon",color:"green"})):l.createElement(l.Fragment,null,(0,B.localize)("Lost"),l.createElement(c.Icon,{icon:"IcCrossCircle",className:"db-contract-card__result-icon",color:"red"}))))};L.propTypes={profit:d().number};const M=L;var F=function(e){var t,o,n=e.tab,r=e.onClickDownloadTransaction,i=e.onClickDownloadJournal,a=e.is_clear_stat_disabled;return"transactions"===n?(t=r,o=(0,B.localize)("Download your transaction history.")):"journal"===n&&(t=i,o=(0,B.localize)("Download your journal.")),l.createElement(c.Popover,{className:"run-panel__info",classNameBubble:"run-panel__info--bubble",alignment:"bottom",message:o,zIndex:5},l.createElement(c.Button,{id:"download-button",is_disabled:a,className:"download__button",icon:l.createElement(c.Icon,{icon:"IcDownload",color:a&&"disabled",className:"download__icon"}),onClick:t}))};F.propTypes={onClickDownloadTransaction:d().func,onClickDownloadJournal:d().func,tab:d().string,is_clear_stat_disabled:d().bool};const U=b((function(e){var t=e.download,o=e.run_panel;return{onClickDownloadTransaction:t.onClickDownloadTransaction,onClickDownloadJournal:t.onClickDownloadJournal,is_clear_stat_disabled:o.is_clear_stat_disabled}}))(F);var j="text",V="image",H="block",J="example",G=j,W=V,Y=H,q=J,K=function(e){return o.p=e,{procedures_ifreturn:[{type:G},{type:Y},{type:G},{type:q,example_id:"if-return"}],math_arithmetic:[{type:G},{type:Y},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G}],math_single:[{type:G},{type:Y},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G}],math_constrain:[{type:G},{type:Y},{type:G},{type:G},{type:q,example_id:"constrain"}],text_print:[{type:G},{type:Y},{type:G}],text_prompt_ext:[{type:G},{type:Y},{type:G}],tick_analysis:[{type:G},{type:Y}],read_details:[{type:G},{type:Y},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G}],last_digit:[{type:G},{type:Y}],read_ohlc:[{type:G},{type:Y},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:q,example_id:"in_candle_list_read"}],read_ohlc_obj:[{type:G},{type:Y},{type:G},{type:G},{type:q,example_id:"read_candle_value"}],check_direction:[{type:G},{type:Y},{type:G},{type:G},{type:G}],get_ohlc:[{type:G},{type:Y},{type:G},{type:q,example_id:"get_candle"},{type:G}],ohlc:[{type:G},{type:Y},{type:G},{type:q,example_id:"candle_list_1"}],ohlc_values:[{type:G},{type:Y},{type:G},{type:q,example_id:"candle_list"}],is_candle_black:[{type:G},{type:Y},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:W,width:"100%",url:"".concat(o.p,"media/is_candle_black.jpeg")},{type:G},{type:W,width:"100%",url:"".concat(o.p,"media/is_candle_black_1.jpeg")},{type:G}],ohlc_values_in_list:[{type:G},{type:Y},{type:G},{type:G},{type:q,example_id:"candle_list_1"}],variables_gets:[{type:G},{type:Y},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G}],variables_set:[{type:G},{type:Y},{type:G},{type:G},{type:G},{type:W,width:"100%",url:"".concat(o.p,"media/create_variable.jpg")},{type:G},{type:W,width:"100%",url:"".concat(o.p,"media/set_variable.png")}],epoch:[{type:G},{type:Y},{type:G},{type:G},{type:G},{type:G},{type:G},{type:q,example_id:"epoch"}],todatetime:[{type:G},{type:Y},{type:G},{type:q,example_id:"todatetime"},{type:G}],totimestamp:[{type:G},{type:Y},{type:G},{type:q,example_id:"totimestamp"},{type:G}],notify_telegram:[{type:G},{type:Y},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:q,example_id:"notify_telegram"}],console:[{type:G},{type:G},{type:G},{type:G},{type:G},{type:G}],balance:[{type:G},{type:Y},{type:G},{type:G},{type:G},{type:G},{type:G}],sma_statement:[{type:G},{type:Y},{type:G},{type:W,width:"60%",url:"".concat(o.p,"media/sma_formula.png")},{type:G},{type:G},{type:G},{type:G},{type:W,width:"100%",url:"".concat(o.p,"media/sma_chart_1.png")},{type:G},{type:W,width:"100%",url:"".concat(o.p,"media/sma_chart_2.png")},{type:G},{type:G},{type:G},{type:G},{type:G},{type:q,example_id:"sma_block_example"},{type:G},{type:G},{type:q,example_id:"sma_block_example_1"},{type:G},{type:G},{type:q,example_id:"sma_array"},{type:G},{type:G},{type:G},{type:W,width:"100%",url:"".concat(o.p,"media/sma_array_explanation.jpeg")}],trade_definition:[{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:G},{type:Y}],trade_definition_tradeoptions:[{type:G},{type:Y}],trade_definition_multiplier:[{type:G},{type:G},{type:G},{type:G}],before_purchase:[{type:G},{type:Y},{type:G}],during_purchase:[{type:G},{type:Y},{type:G},{type:q,example_id:"sell_available"}],sell_at_market:[{type:G},{type:Y},{type:G},{type:q,example_id:"sell_available"}],after_purchase:[{type:G},{type:Y},{type:G}],trade_again:[{type:G},{type:Y},{type:G},{type:q,example_id:"trade_again"}],contract_check_result:[{type:G},{type:Y},{type:G},{type:G},{type:q,example_id:"check_result"}],sell_price:[{type:G},{type:Y},{type:G},{type:q,example_id:"sell_pl"}],controls_if:[{type:G},{type:Y},{type:G},{type:q,example_id:"controls_if"},{type:G},{type:q,example_id:"compare_logic"},{type:q,example_id:"compare_logic_1"}],logic_operation:[{type:G},{type:Y},{type:G},{type:G},{type:W,width:"40%",url:"".concat(o.p,"media/logic.png")}],controls_whileUntil:[{type:G},{type:Y},{type:G},{type:G},{type:q,example_id:"repeat_while"},{type:G},{type:q,example_id:"repeat_until"}],controls_for:[{type:G},{type:Y},{type:G},{type:q,example_id:"controls_for"},{type:G},{type:G}],controls_forEach:[{type:G},{type:Y},{type:G},{type:q,example_id:"controls_forEach"},{type:G},{type:G},{type:G}],controls_flow_statements:[{type:G},{type:Y},{type:G},{type:G},{type:q,example_id:"break_out"},{type:G},{type:q,example_id:"continue"}]}},X=function(e){var t=e.initBlockWorkspace,o=e.block_node,n=e.should_center_block,r=e.should_hide_display_name,i=l.useRef();return l.useEffect((function(){t(i,o,n)}),[]),l.createElement("div",{ref:function(e){return i=e},className:T()({"flyout__block-workspace--center":r,"flyout__block-workspace--top":!r})})};X.propTypes={block_node:d().any,initBlockWorkspace:d().func,should_center_block:d().bool,should_hide_display_name:d().bool};const Z=b((function(e){return{initBlockWorkspace:e.flyout.initBlockWorkspace}}))(X);var Q=function(e){var t=e.onInfoClick,o=e.block_node,n=e.is_active,r=e.should_hide_display_name,i=o.getAttribute("type"),a=Blockly.Blocks[i].meta(),s="variables_get"===i,u="variables_set"===i,p=a.display_name,d=a.description,y=function(){return l.createElement("div",{className:"flyout__item-buttons"},l.createElement(c.Button,{id:"db-flyout__add--".concat(i),className:"flyout__button-add flyout__button-add--hide",has_effect:!0,is_plus:!0,onClick:function(){return Blockly.derivWorkspace.addBlockNode(o)},type:"button"}))};return l.createElement(l.Fragment,null,u&&l.createElement("div",{className:"flyout__hr"}),l.createElement("div",{className:T()("flyout__item",{"flyout__item--active":n})},!r&&l.createElement(l.Fragment,null,l.createElement("div",{className:"flyout__item-header"},l.createElement(c.Text,{size:s?"xs":"xsm",line_height:s?void 0:"xl",weight:s?void 0:"bold"},p),!s&&l.createElement(y,null)),l.createElement("div",{className:"flyout__item-description"},d,t&&l.createElement("a",{id:p.replace(/\s/gi,"-"),className:"flyout__item-info",onClick:t},l.createElement(B.Localize,{i18n_default_text:"Learn more"})))),l.createElement("div",{className:"flyout__block-workspace__header"},l.createElement(Z,{should_center_block:!0,block_node:o,should_hide_display_name:!0}),s&&l.createElement(y,null))))};Q.propTypes={block_nodes:p.PropTypes.array,onInfoClick:p.PropTypes.func};const $=Q;var ee=function(e){return l.createElement("div",{className:"flyout__item"},l.createElement("iframe",{className:"flyout__video",src:e.url,frameBorder:"0",allow:"accelerometer; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,width:"100%"}))};ee.propTypes={url:p.PropTypes.string};const te=ee;var oe=function(e){var t=e.text;return l.createElement(c.Text,{as:"p",size:"xs",styles:{lineHeight:"1.3em"}},t)};oe.propTypes={text:p.PropTypes.oneOfType(p.PropTypes.string,p.PropTypes.object)};const ne=oe;var re=function(e){var t=e.width,o=e.url,n={width:t};return l.createElement("div",{className:"flyout__item"},l.createElement("img",{src:o,className:"flyout__image",style:n}))};re.propTypes={url:p.PropTypes.string};const ie=re;var ae=function(e){var t=e.block_node,n=e.block_type,r=e.examples,i=e.help_string,a=e.is_search_flyout,s=e.onBackClick,u=e.onSequenceClick,p=e.should_next_disable,d=e.should_previous_disable,y=e.title,m=i&&K(o.p)[n],f=0;return l.createElement(l.Fragment,null,l.createElement("div",{className:"flyout__help-header"},l.createElement("button",{className:"dc-btn flyout__button-back",onClick:s},l.createElement(c.Icon,{icon:"IcArrowLeft"})),l.createElement(c.Text,{weight:"bold",className:"flyout__help-title"},y),l.createElement("div",{className:"flyout__item-buttons"},l.createElement(c.Button,{className:"flyout__button-add",has_effect:!0,id:"db-flyout-help__add--".concat(n),onClick:function(){return Blockly.derivWorkspace.addBlockNode(t)},primary:!0,text:(0,B.localize)("Add"),type:"button"}))),l.createElement("div",{className:"flyout__help-content"},m&&m.map((function(e,o){var a=e.type,c=e.width,s=e.url,u=e.example_id,p=i.text,d=r.find((function(e){return e.id===u}));switch(a){case j:return f<p.length?l.createElement(ne,{key:"".concat(n,"_").concat(o),text:p[f++]}):null;case"video":return l.createElement(te,{key:"".concat(n,"_").concat(o),url:s});case V:return l.createElement(ie,{key:"".concat(n,"_").concat(o),width:c,url:s});case H:return l.createElement(Z,{key:"".concat(n,"_").concat(o),should_center_block:!0,block_node:t});case J:return d?l.createElement(Z,{key:"".concat(n,"_").concat(o),should_center_block:!0,block_node:d.childNodes[0]}):null;default:return null}}))),!a&&!(d&&p)&&l.createElement("div",{className:"flyout__help-footer"},l.createElement(c.Button,{className:"flyout__button-previous",secondary:!0,onClick:function(){return u(!1)},text:(0,B.localize)("Previous"),type:"button",is_disabled:d,renderText:function(e){return d&&l.createElement(c.Text,{size:"xs",weight:"bold",align:"center",color:"disabled"},e)}}),l.createElement(c.Button,{className:"flyout__button-next",secondary:!0,onClick:function(){return u(!0)},text:(0,B.localize)("Next"),type:"button",is_disabled:p,renderText:function(e){return p&&l.createElement(c.Text,{size:"xs",weight:"bold",align:"center",color:"disabled"},e)}})))};ae.propTypes={block_node:d().object,block_type:d().string,examples:d().array,help_string:d().object,is_search_flyout:d().bool,onBackClick:d().func,onSequenceClick:d().func,should_next_disable:d().bool,should_previous_disable:d().bool,title:d().string};const le=b((function(e){var t=e.flyout,o=e.flyout_help;return{block_node:o.block_node,block_type:o.block_type,examples:o.examples,help_string:o.help_string,is_search_flyout:t.is_search_flyout,onBackClick:o.onBackClick,onSequenceClick:o.onSequenceClick,should_next_disable:o.should_next_disable,should_previous_disable:o.should_previous_disable,title:o.title}}))(ae),ce=le;function se(){return se=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},se.apply(this,arguments)}var ue=function(e){var t=e.search_term,o=e.total_result;return l.createElement("div",{className:"flyout__search-header"},l.createElement(c.Text,{weight:"bold",className:"flyout__search-header-text"},(0,B.localize)('Results for "{{ search_term }}"',{search_term:t,interpolation:{escapeValue:!1}})),l.createElement(c.Text,{weight:"bold",color:"profit-success",className:"flyout__search-header-text"},"".concat(o," ").concat(o>1?(0,B.localize)("results"):(0,B.localize)("result"))))},pe=function(e){var t=l.useRef(),n=e.flyout_content,r=e.active_helper,i=e.setHelpContent,a=e.initFlyoutHelp,s=e.is_empty,u=e.is_search_flyout,p=e.selected_category,d=e.first_get_variable_block_index;return l.useEffect((function(){t.current.scrollTop=0}),[p]),l.useEffect((function(){var e=t.current.querySelector(".flyout__item--active");e&&e.scrollIntoView({behavior:"smooth",block:"start"})}),[r]),l.createElement("div",{ref:t,className:T()("flyout__content",{"flyout__normal-content":!u})},l.createElement(c.ThemedScrollbars,{className:"flyout__content-scrollbar"},"indicators"===(null==p?void 0:p.getAttribute("id"))&&l.createElement("div",{className:"flyout__content-disclaimer"},l.createElement("span",{className:"flyout__content-disclaimer-icon"},l.createElement(c.Icon,{icon:"IcBlackWarning",custom_color:"#000000",className:"flyout__content-disclaimer__warning-icon"})),l.createElement("span",{className:"flyout__content-disclaimer-text"},(0,B.localize)("Indicators on the chart tab are for indicative purposes only and may vary slightly from the ones on the DBot workspace."))),s?l.createElement("div",{className:"flyout__search-empty"},l.createElement(c.Text,{as:"h2",weight:"bold",line_height:"xxs"},(0,B.localize)("No results found"))):n.map((function(e,t){switch(e.tagName.toUpperCase()){case Blockly.Xml.NODE_BLOCK:var n=e.getAttribute("type");return l.createElement($,{key:"".concat(e.getAttribute("type")).concat(Blockly.utils.genUid()),id:"flyout__item-workspace--".concat(t),block_node:e,should_hide_display_name:"variables_get"===n&&t!==d,onInfoClick:K(o.p)[n]&&(u?function(){return i(e)}:function(){return a(e,n)}),is_active:r===n});case Blockly.Xml.NODE_LABEL:return l.createElement("div",{key:"".concat(e.getAttribute("text")).concat(t),className:"flyout__item-label-bold"},e.getAttribute("text"));case Blockly.Xml.NODE_INPUT:return l.createElement(c.Input,{key:"".concat(e.getAttribute("name")).concat(t),className:"".concat(e.getAttribute("className")),type:"".concat(e.getAttribute("type")),name:"".concat(e.getAttribute("name")),placeholder:"".concat(e.getAttribute("placeholder")),autoComplete:"off"});case Blockly.Xml.NODE_BUTTON:var s=e.getAttribute("callbackKey"),p=e.getAttribute("id");return l.createElement("button",{id:p,key:"".concat(s).concat(t),className:T()("dc-btn","dc-btn-effect","dc-btn--primary","".concat(e.getAttribute("className"))),onClick:function(e){var t=Blockly.derivWorkspace,o=t.getButtonCallback(s)||function(){};e.targetWorkspace_=t,e.getTargetWorkspace=function(){return e.targetWorkspace_},o(e)}},e.getAttribute("text"));default:return null}}))))},de=function(e){var t=e.flyout_content,o=e.flyout_width,n=e.is_help_content,r=e.is_search_flyout,i=e.is_visible,a=e.onMount,c=e.onUnmount,s=e.pushDataLayer,u=e.search_term;l.useEffect((function(){return a(),function(){return c()}}),[a,c]),i&&r&&s({event:"dbot_search_results",value:!0});var p=Object.keys(t).length,d=0===p;return i&&l.createElement("div",{id:"gtm-search-results","gtm-search-term":u,className:T()("flyout",{flyout__search:r,flyout__help:n,flyout__normal:!n&&!r}),style:{width:"".concat(o,"px")}},r&&!n&&l.createElement(ue,{search_term:u,total_result:p}),n?l.createElement(ce,null):l.createElement(pe,se({is_empty:d},e)))};de.propTypes={active_helper:d().string,flyout_content:d().any,flyout_width:d().number,initFlyoutHelp:d().func,is_help_content:d().bool,is_search_flyout:d().bool,is_visible:d().bool,onMount:d().func,onUnmount:d().func,setActiveHelper:d().func,search_term:d().string,setHelpContent:d().func,selected_category:d().object,first_get_variable_block_index:d().number};const ye=b((function(e){var t=e.flyout,o=e.flyout_help,n=e.gtm;return{active_helper:o.active_helper,pushDataLayer:n.pushDataLayer,flyout_content:t.flyout_content,flyout_width:t.flyout_width,initFlyoutHelp:o.initFlyoutHelp,is_help_content:t.is_help_content,is_search_flyout:t.is_search_flyout,is_visible:t.is_visible,onMount:t.onMount,onUnmount:t.onUnmount,setActiveHelper:o.setActiveHelper,search_term:t.search_term,setHelpContent:o.setHelpContent,selected_category:t.selected_category,first_get_variable_block_index:t.first_get_variable_block_index}}))(de),me=ye;var fe=o(1285),_e=o(5770),he=o(7103),ge=Object.freeze({NOT_RUNNING:0,STARTING:1,PURCHASE_SENT:2,PURCHASE_RECEIVED:3,IS_STOPPING:4,CONTRACT_CLOSED:5}),be=["contract_stage","filtered_messages","is_drawer_open","is_mobile","is_stop_button_visible","unfiltered_messages"],ve=function(e){var t=e.logType,o=e.className,n=e.extra;return l.createElement("div",{className:T()("journal__text",o)},function(){switch(t){case he.F$.LOAD_BLOCK:return(0,B.localize)("Blocks are loaded successfully");case he.F$.NOT_OFFERED:return(0,B.localize)("Resale of this contract is not offered.");case he.F$.PURCHASE:var e=n.longcode,o=n.transaction_id;return l.createElement(B.Localize,{i18n_default_text:"<0>Bought</0>: {{longcode}} (ID: {{transaction_id}})",values:{longcode:e,transaction_id:o},components:[l.createElement(c.Text,{key:0,size:"xxs",styles:{color:"var(--status-info)"}})],options:{interpolation:{escapeValue:!1}}});case he.F$.SELL:var r=n.sold_for;return l.createElement(B.Localize,{i18n_default_text:"<0>Sold for</0>: {{sold_for}}",values:{sold_for:r},components:[l.createElement(c.Text,{key:0,size:"xxs",styles:{color:"var(--status-warning)"}})]});case he.F$.PROFIT:var i=n.currency,a=n.profit;return l.createElement(B.Localize,{i18n_default_text:"Profit amount: <0>{{profit}}</0>",values:{profit:"".concat((0,_e.formatMoney)(i,a,!0)," ").concat((0,_e.getCurrencyDisplayCode)(i))},components:[l.createElement(c.Text,{key:0,size:"xxs",styles:{color:"var(--status-success)"}})]});case he.F$.LOST:var s=n.currency,u=n.profit;return l.createElement(B.Localize,{i18n_default_text:"Loss amount: <0>{{profit}}</0>",values:{profit:"".concat((0,_e.formatMoney)(s,u,!0)," ").concat((0,_e.getCurrencyDisplayCode)(s))},components:[l.createElement(c.Text,{key:0,size:"xxs",styles:{color:"var(--status-danger)"}})]});case he.F$.WELCOME_BACK:return l.createElement(B.Localize,{i18n_default_text:"Welcome back! Your messages have been restored."});default:return null}}())},ke=function(e){var t=e.wrapper_ref,o=e.checked_filters,n=e.filters,r=e.filterMessage,i=e.className,a=e.classNameLabel;return l.createElement("div",{ref:t,className:i},n.map((function(e){return l.createElement(c.Checkbox,{key:e.id,classNameLabel:a,value:o.includes(e.id),defaultChecked:o.includes(e.id),label:e.label,onChange:function(){return r(!o.includes(e.id),e.id)}})})))},Ee=function(e){var t=e.toggle_ref,o=e.checked_filters,n=e.filters,r=e.filterMessage,i=e.is_filter_dialog_visible,a=e.toggleFilterDialog,s=l.useRef();return(0,c.useOnClickOutside)(s,a,(function(e){return i&&!t.current.contains(e.target)})),l.createElement(ke,{wrapper_ref:s,checked_filters:o,filters:n,filterMessage:r,className:"filter-dialog"})},Te=function(e){var t=e.checked_filters,o=e.filters,n=e.filterMessage,r=e.is_filter_dialog_visible,i=e.toggleFilterDialog,a=l.useRef();return l.createElement(l.Fragment,null,l.createElement("div",{className:"journal-tools__container"},l.createElement(c.DesktopWrapper,null,l.createElement(U,{tab:"journal"})),l.createElement("div",{ref:a,className:"journal-tools__container-filter",onClick:i},l.createElement(c.Text,{size:"xs",className:"journal-tools__container-filter--label"},l.createElement(B.Localize,{i18n_default_text:"Filters"})),l.createElement(c.Icon,{icon:"IcFilter",size:16}))),l.createElement(fe.Z,{in:r,classNames:{enter:"filter-dialog--enter",enterDone:"filter-dialog--enter-done",exit:"filter-dialog--exit"},timeout:150,unmountOnExit:!0},l.createElement(Ee,{toggle_ref:a,checked_filters:t,filters:o,filterMessage:n,is_filter_dialog_visible:r,toggleFilterDialog:i})))},Be=function(e){var t=e.is_mobile;return l.createElement(N.ZP,{className:T()("journal__loader",{"journal__loader--mobile":t}),speed:3,width:350,height:92,primaryColor:"var(--general-section-1)",secondaryColor:"var(--general-hover)"},l.createElement("rect",{x:"15",y:"15",rx:"5",ry:"5",width:"320",height:"40"}),l.createElement("rect",{x:"15",y:"60",rx:"5",ry:"5",width:"180",height:"7"}))},Se=function(e){var t=e.row,o=e.is_new_row,n=e.measure,r=(0,_e.useNewRowTransition)(o).in_prop,i=t.date,a=t.time,c=t.message,u=t.message_type,p=t.className,d=t.extra,y=function(e){var t=e.date,o=e.time;return l.createElement(l.Fragment,null,l.createElement("span",{className:"journal__text-date"},t)," | ",l.createElement("span",{className:"journal__text-time"},o))}({date:i,time:a});return l.createElement(fe.Z,{in:r,timeout:500,classNames:"list__animation"},l.createElement("div",{className:"journal__item"},l.createElement("div",{className:"journal__item-content"},function(e,t,o,n,r){switch(t){case s.message_types.SUCCESS:return l.createElement(ve,{logType:e,extra:n,className:o});case s.message_types.NOTIFY:return"function"==typeof e?l.createElement("div",{className:T()("journal__text",o)},e(r)):l.createElement("div",{className:T()("journal__text",o)},e);case s.message_types.ERROR:return l.createElement("div",{className:"journal__text--error journal__text"},e);default:return null}}(c,u,p,d,n)),l.createElement("div",{className:"journal__text-datetime"},y)))},Oe=function(e){var t=e.contract_stage,o=e.filtered_messages,n=(e.is_drawer_open,e.is_mobile),r=e.is_stop_button_visible,i=e.unfiltered_messages,a=function(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}(e,be);return l.createElement("div",{className:T()("journal run-panel-tab__content--no-stat",{"run-panel-tab__content":!n})},l.createElement(Te,a),l.createElement("div",{className:"journal__item-list"},o.length?l.createElement(c.DataList,{className:"journal",data_source:o,rowRenderer:function(e){return l.createElement(Se,e)},keyMapper:function(e){return e.unique_id}}):l.createElement(l.Fragment,null,t>=ge.STARTING&&a.checked_filters.length&&!i.length&&r?l.createElement(Be,{is_mobile:n}):l.createElement("div",{className:"journal-empty"},l.createElement(c.Icon,{icon:"IcBox",className:"journal-empty__icon",size:64,color:"secondary"}),l.createElement(c.Text,{as:"h4",size:"xs",weight:"bold",align:"center",color:"less-prominent",line_height:"xxs",className:"journal-empty__header"},(0,B.localize)("There are no messages to display")),l.createElement("div",{className:"journal-empty__message"},l.createElement(c.Text,{size:"xxs",color:"less-prominent"},(0,B.localize)("Here are the possible reasons:")),l.createElement("ul",{className:"journal-empty__list"},l.createElement("li",null,l.createElement(c.Text,{size:"xxs",color:"less-prominent"},(0,B.localize)("The bot is not running"))),l.createElement("li",null,l.createElement(c.Text,{size:"xxs",color:"less-prominent"},(0,B.localize)("The stats are cleared"))),l.createElement("li",null,l.createElement(c.Text,{size:"xxs",color:"less-prominent"},(0,B.localize)("All messages are filtered out")))))))))};Oe.propTypes={checked_filters:d().array,contract_stage:d().object,filtered_messages:d().array,filterMessage:d().func,filters:d().array,is_mobile:d().bool,is_stop_button_visible:d().bool,is_filter_dialog_visible:d().bool,toggleFilterDialog:d().func,unfiltered_messages:d().array};const we=b((function(e){var t=e.journal,o=e.run_panel,n=e.ui;return{checked_filters:t.checked_filters,contract_stage:o.contract_stage,filterMessage:t.filterMessage,filters:t.filters,filtered_messages:t.filtered_messages,is_mobile:n.is_mobile,is_filter_dialog_visible:t.is_filter_dialog_visible,is_stop_button_visible:o.is_stop_button_visible,toggleFilterDialog:t.toggleFilterDialog,unfiltered_messages:t.unfiltered_messages}}))(Oe);var Ce=Object.freeze({TAB_LOCAL:"local_tab",TAB_GOOGLE:"google_tab",TAB_RECENT:"recent_tab"}),Ae=function(e){var t=e.is_authorised,o=e.is_open_button_loading,n=e.onDriveConnect,r=e.onDriveOpen,i=e.is_mobile;return l.createElement("div",{className:"load-strategy__container"},l.createElement("div",{className:"load-strategy__google-drive"},l.createElement(c.Icon,{icon:"IcGoogleDrive",className:T()("load-strategy__google-drive-icon",{"load-strategy__google-drive-icon--disabled":!t}),size:i?96:128}),l.createElement("div",{className:"load-strategy__google-drive-text"},t?l.createElement(B.Localize,{i18n_default_text:"You are connected to Google Drive"}):"Google Drive"),t?l.createElement(c.Button.Group,null,l.createElement(c.Button,{text:(0,B.localize)("Disconnect"),onClick:n,has_effect:!0,secondary:!0,large:!0}),l.createElement(c.Button,{text:(0,B.localize)("Open"),onClick:r,is_loading:o,has_effect:!0,primary:!0,large:!0})):l.createElement(l.Fragment,null,l.createElement(c.Button,{text:(0,B.localize)("Connect"),onClick:n,has_effect:!0,primary:!0,large:!0}),l.createElement("div",{className:"load-strategy__google-drive-terms"},l.createElement(B.Localize,{i18n_default_text:"Find out how this app handles your data by reviewing Deriv's <0>Privacy policy</0>, which is part of Deriv's <1>Terms and conditions</2>.",components:[l.createElement(c.StaticUrl,{key:0,className:"link",href:"tnc/security-and-privacy.pdf",is_document:!0}),l.createElement(c.StaticUrl,{key:1,className:"link",href:"terms-and-conditions"})]})))))};Ae.propTypes={is_authorised:p.PropTypes.bool,is_mobile:p.PropTypes.bool,is_open_button_loading:p.PropTypes.bool,onDriveConnect:p.PropTypes.func,onDriveOpen:p.PropTypes.func};const Ie=b((function(e){var t=e.load_modal,o=e.ui;return{is_authorised:e.google_drive.is_authorised,is_mobile:o.is_mobile,is_open_button_loading:t.is_open_button_loading,onDriveConnect:t.onDriveConnect,onDriveOpen:t.onDriveOpen}}))(Ae);var Re=function(e){var t=e.is_mobile,o=e.is_open_button_loading,n=e.loadFileFromLocal,r=e.setLoadedLocalFile,i=t?c.Button.Group:l.Fragment;return l.createElement(i,null,t&&l.createElement(c.Button,{text:(0,B.localize)("Cancel"),onClick:function(){return r(null)},has_effect:!0,secondary:!0,large:!0}),l.createElement(c.Button,{text:(0,B.localize)("Open"),onClick:n,is_loading:o,has_effect:!0,primary:!0,large:!0}))};Re.propTypes={is_mobile:p.PropTypes.bool,is_open_button_loading:p.PropTypes.bool,loadFileFromLocal:p.PropTypes.func,setLoadedLocalFile:p.PropTypes.bool};const De=b((function(e){var t=e.load_modal;return{is_mobile:e.ui.is_mobile,is_open_button_loading:t.is_open_button_loading,loadFileFromLocal:t.loadFileFromLocal,setLoadedLocalFile:t.setLoadedLocalFile}}))(Re);var xe=function(e){var t=e.onZoomInOutClick;return l.createElement("div",{className:"load-strategy__preview-workspace-controls"},l.createElement(c.Icon,{icon:"IcAddRounded",className:"load-strategy__preview-workspace-icon",onClick:function(){return t(!0)}}),l.createElement(c.Icon,{icon:"IcMinusRounded",className:"load-strategy__preview-workspace-icon",onClick:function(){return t(!1)}}))};xe.propTypes={onZoomInOutClick:p.PropTypes.func};const Pe=b((function(e){return{onZoomInOutClick:e.load_modal.onZoomInOutClick}}))(xe);function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var ze=function(e){var t,o=e.handleFileChange,n=e.is_mobile,r=e.loaded_local_file,i=e.setLoadedLocalFile,a=l.useRef(null),s=(2,function(e){if(Array.isArray(e))return e}(t=l.useState(!0))||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(t)||function(e,t){if(e){if("string"==typeof e)return Ne(e,2);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Ne(e,2):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=s[0],p=s[1];return r&&u?l.createElement("div",{className:"load-strategy__container load-strategy__container--has-footer"},l.createElement("div",{className:"load-strategy__local-preview"},l.createElement("div",{className:"load-strategy__title"},l.createElement(B.Localize,{i18n_default_text:"Preview"})),l.createElement("div",{className:"load-strategy__preview-workspace"},l.createElement("div",{id:"load-strategy__blockly-container",style:{height:"100%"}},!n&&l.createElement("div",{className:"load-strategy__local-preview-close"},l.createElement(c.Icon,{icon:"IcCross",onClick:function(){return i(null)}})),l.createElement(Pe,null)))),n&&l.createElement("div",{className:"load-strategy__local-footer"},l.createElement(De,null))):l.createElement("div",{className:"load-strategy__container"},l.createElement("div",{className:"load-strategy__local-dropzone"},l.createElement("input",{type:"file",ref:a,accept:".xml",style:{display:"none"},onChange:function(e){return p(o(e,!1))}}),l.createElement("div",{className:"load-strategy__local-dropzone-area",onDrop:function(e){o(e,!1)}},n?l.createElement(c.Icon,{icon:"IcMobile",className:"load-strategy__local-icon",size:n?96:128}):l.createElement(l.Fragment,null,l.createElement(c.Icon,{icon:"IcPc",className:"load-strategy__local-icon",size:n?96:128}),l.createElement("div",{className:"load-strategy__local-title"},l.createElement(B.Localize,{i18n_default_text:"Drag your XML file here"})),l.createElement("div",{className:"load-strategy__local-description"},l.createElement(B.Localize,{i18n_default_text:"or, if you prefer..."}))),l.createElement(c.Button,{text:u?(0,B.localize)("Select an XML file from your device"):(0,B.localize)("Please upload an XML file"),onClick:function(){return a.current.click()},has_effect:!0,primary:!0,large:!0}))))};ze.propTypes={handleFileChange:p.PropTypes.func,is_mobile:p.PropTypes.bool,is_open_button_loading:p.PropTypes.bool,loaded_local_file:p.PropTypes.string,setLoadedLocalFile:p.PropTypes.func};var Le=b((function(e){var t=e.load_modal,o=e.ui;return{handleFileChange:t.handleFileChange,is_mobile:o.is_mobile,is_open_button_loading:t.is_open_button_loading,loaded_local_file:t.loaded_local_file,setLoadedLocalFile:t.setLoadedLocalFile}}))(ze);Le.Footer=De;const Me=Le;var Fe=function(e){var t=e.is_open_button_loading,o=e.loadFileFromRecent;return l.createElement(c.Button,{text:(0,B.localize)("Open"),onClick:o,is_loading:t,has_effect:!0,primary:!0,large:!0})};Fe.propTypes={is_open_button_loading:y.PropTypes.bool,loadFileFromRecent:y.PropTypes.func};const Ue=b((function(e){var t=e.load_modal;return{is_open_button_loading:t.is_open_button_loading,loadFileFromRecent:t.loadFileFromRecent}}))(Fe);var je=o(7929),Ve=function(e){var t=e.getRecentFileIcon,o=e.getSaveType,n=e.previewRecentStrategy,r=e.selected_strategy_id,i=e.workspace;return l.createElement("div",{className:T()("load-strategy__recent-item",{"load-strategy__recent-item--selected":r===i.id}),key:i.id,onClick:r===i.id?void 0:function(){return n(i.id)}},l.createElement("div",{className:"load-strategy__recent-item-text"},l.createElement("div",{className:"load-strategy__recent-item-title"},i.name),l.createElement("div",{className:"load-strategy__recent-item-time"},(0,s.timeSince)(i.timestamp))),l.createElement("div",{className:"load-strategy__recent-item-location"},l.createElement(c.Icon,{icon:t(i.save_type),className:T()({"load-strategy__recent-icon--active":!0})}),l.createElement("div",{className:"load-strategy__recent-item-saved"},o(i.save_type))))};Ve.propTypes={getRecentFileIcon:p.PropTypes.func,getSaveType:p.PropTypes.func,previewRecentStrategy:p.PropTypes.func,selected_strategy_id:p.PropTypes.string};const He=b((function(e){var t=e.load_modal;return{getRecentFileIcon:t.getRecentFileIcon,getSaveType:t.getSaveType,previewRecentStrategy:t.previewRecentStrategy,selected_strategy_id:t.selected_strategy_id}}))(Ve);var Je=function(e){var t=e.is_explanation_expand,o=e.recent_strategies,n=e.toggleExplanationExpand;return o.length?l.createElement("div",{className:"load-strategy__container load-strategy__container--has-footer"},l.createElement("div",{className:"load-strategy__recent"},l.createElement("div",{className:"load-strategy__recent-files"},l.createElement("div",{className:"load-strategy__title"},l.createElement(B.Localize,{i18n_default_text:"Recent"})),l.createElement("div",{className:"load-strategy__recent-files-list"},o.map((function(e){return l.createElement(He,{key:e.id,workspace:e})})))),l.createElement("div",{className:"load-strategy__recent-preview"},l.createElement("div",{className:"load-strategy__title load-strategy__recent-preview-title"},l.createElement(B.Localize,{i18n_default_text:"Preview"})),l.createElement("div",{className:"load-strategy__preview-workspace"},l.createElement("div",{id:"load-strategy__blockly-container",style:{height:"100%"}},l.createElement(Pe,null)))))):l.createElement("div",{className:"load-strategy__container"},l.createElement("div",{className:"load-strategy__recent-empty"},l.createElement(c.Icon,{icon:"IcEmptyFolder",className:"load-strategy__recent-empty-icon",size:128}),l.createElement("div",{className:"load-strategy__recent-empty-title"},l.createElement(B.Localize,{i18n_default_text:"You do not have any recent bots"})),l.createElement("div",{className:"load-strategy__recent-empty-description"},l.createElement(B.Localize,{i18n_default_text:"Create one or upload one from your local drive or Google Drive."})),l.createElement("div",{className:"load-strategy__recent-empty-expand",onClick:n},l.createElement(B.Localize,{i18n_default_text:"Why can't I see my recent bots?"})),l.createElement("div",{className:T()("load-strategy__recent-empty-explanation",{"load-strategy__recent-empty-explanation--show":t})},l.createElement("div",null,l.createElement(B.Localize,{i18n_default_text:"If you've recently used bots but don't see them in this list, it may be because you:"})),l.createElement("ol",{className:"load-strategy__recent-empty-explanation-list"},l.createElement("li",null,l.createElement(B.Localize,{i18n_default_text:"1. Logged in from a different device"})),l.createElement("li",null,l.createElement(B.Localize,{i18n_default_text:"2. Logged in from a different browser"})),l.createElement("li",null,l.createElement(B.Localize,{i18n_default_text:"3. Cleared your browser cache"}))))))};Je.propTypes={is_explanation_expand:p.PropTypes.bool,recent_strategies:p.PropTypes.array,toggleExplanationExpand:p.PropTypes.bool};var Ge=b((function(e){var t=e.load_modal;return{is_explanation_expand:t.is_explanation_expand,recent_strategies:t.recent_strategies,toggleExplanationExpand:t.toggleExplanationExpand}}))(Je);Ge.Footer=Ue,Ge.Workspace=He;const We=Ge;var Ye=function(e){var t=e.active_index,o=e.is_load_modal_open,n=e.is_mobile,r=e.loaded_local_file,i=e.onEntered,a=e.recent_strategies,s=e.setActiveTabIndex,u=e.tab_name,p=e.toggleLoadModal,d=(0,B.localize)("Load strategy");return n?l.createElement(c.MobileFullPageModal,{is_modal_open:o,className:"load-strategy__wrapper",header:(0,B.localize)("Load strategy"),onClickClose:p,height_offset:"80px",page_overlay:!0},l.createElement(c.Tabs,{active_index:t,onTabItemClick:s,top:!0},l.createElement("div",{label:(0,B.localize)("Local")},l.createElement(Me,null)),l.createElement("div",{label:"Google Drive"},l.createElement(Ie,null)))):l.createElement(c.Modal,{title:d,className:"load-strategy",width:"1000px",height:"80vh",is_open:o,toggleModal:p,onEntered:i,elements_to_ignore:[document.querySelector(".injectionDiv")]},l.createElement(c.Modal.Body,null,l.createElement(c.Tabs,{active_index:t,onTabItemClick:s,top:!0,header_fit_content:!0},l.createElement("div",{label:(0,B.localize)("Recent")},l.createElement(We,null)),l.createElement("div",{label:(0,B.localize)("Local")},l.createElement(Me,null)),l.createElement("div",{label:"Google Drive"},l.createElement(Ie,null)))),r&&u===Ce.TAB_LOCAL&&l.createElement(c.Modal.Footer,{has_separator:!0},l.createElement(Me.Footer,null)),a.length>0&&u===Ce.TAB_RECENT&&l.createElement(c.Modal.Footer,{has_separator:!0},l.createElement(We.Footer,null)))};Ye.propTypes={active_index:d().number,is_load_modal_open:d().bool,is_mobile:d().bool,loaded_local_file:d().string,onEntered:d().func,recent_strategies:d().array,setActiveTabIndex:d().func,toggleLoadModal:d().func};const qe=b((function(e){var t=e.load_modal,o=e.ui;return{active_index:t.active_index,is_load_modal_open:t.is_load_modal_open,is_mobile:o.is_mobile,loaded_local_file:t.loaded_local_file,onEntered:t.onEntered,recent_strategies:t.recent_strategies,setActiveTabIndex:t.setActiveTabIndex,tab_name:t.tab_name,toggleLoadModal:t.toggleLoadModal}}))(Ye);var Ke=o(7661),Xe=o(8090);function Ze(){return Ze=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Ze.apply(this,arguments)}var Qe=function(e){var t=Ze({},e);return l.createElement("block",t)},$e=function(e){var t=Ze({},e);return l.createElement("category",t)},et=function(e){var t=Ze({},e);return l.createElement("example",t)},tt=function(e){var t=Ze({},e);return l.createElement("field",t)},ot=function(e){var t=Ze({},e);return l.createElement("mutation",t)},nt=function(e){var t=Ze({},e);return l.createElement("next",t)},rt=function(e){var t=Ze({},e);return l.createElement("shadow",t)},it=function(e){var t=Ze({},e);return l.createElement("statement",t)},at=function(e){var t=Ze({},e);return l.createElement("value",t)},lt=o.n(Xe)().renderToStaticMarkup(l.createElement((function(e){var t=Ze({},e);return l.createElement("xml",t)}),{xmlns:"http://www.w3.org/1999/xhtml",id:"toolbox"},l.createElement($e,{id:"trade_parameters",name:(0,B.localize)("Set up your trade")},l.createElement(Qe,{type:"trade_definition"},l.createElement(it,{name:"TRADE_OPTIONS"},l.createElement(Qe,{type:"trade_definition_market",deletable:"false",movable:"false"},l.createElement(tt,{name:"MARKET_LIST"}),l.createElement(tt,{name:"SUBMARKET_LIST"}),l.createElement(tt,{name:"SYMBOL_LIST"}),l.createElement(nt,null,l.createElement(Qe,{type:"trade_definition_tradetype",deletable:"false",movable:"false"},l.createElement(tt,{name:"TRADETYPECAT_LIST"}),l.createElement(tt,{name:"TRADETYPE_LIST"}),l.createElement(nt,null,l.createElement(Qe,{type:"trade_definition_contracttype",deletable:"false",movable:"false"},l.createElement(tt,{name:"TYPE_LIST"}),l.createElement(nt,null,l.createElement(Qe,{type:"trade_definition_candleinterval",deletable:"false",movable:"false"},l.createElement(tt,{name:"CANDLEINTERVAL_LIST"},"60"),l.createElement(nt,null,l.createElement(Qe,{type:"trade_definition_restartbuysell",deletable:"false",movable:"false"},l.createElement(tt,{name:"TIME_MACHINE_ENABLED"},"FALSE"),l.createElement(nt,null,l.createElement(Qe,{type:"trade_definition_restartonerror",deletable:"false",movable:"false"},l.createElement(tt,{name:"RESTARTONERROR"},"TRUE")))))))))))))),l.createElement(Qe,{type:"trade_definition_tradeoptions"},l.createElement(ot,{has_first_barrier:"false",has_second_barrier:"false",has_prediction:"false"}),l.createElement(tt,{name:"DURATIONTYPE_LIST"}),l.createElement(tt,{name:"CURRENCY_LIST"},"USD"),l.createElement(at,{name:"DURATION"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1"))),l.createElement(at,{name:"AMOUNT"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1"))),l.createElement(tt,{name:"AMOUNT_LIMITS"})),l.createElement(Qe,{type:"trade_definition_multiplier"},l.createElement(tt,{name:"MULTIPLIERTYPE_LIST"}),l.createElement(tt,{name:"CURRENCY_LIST"},"USD"),l.createElement(at,{name:"AMOUNT"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1"))),l.createElement(tt,{name:"AMOUNT_LIMITS"})),l.createElement(Qe,{type:"multiplier_take_profit"},l.createElement(at,{name:"AMOUNT"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"0")))),l.createElement(Qe,{type:"multiplier_stop_loss"},l.createElement(at,{name:"AMOUNT"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"0"))))),l.createElement($e,{id:"purchase_conditions",name:(0,B.localize)("Purchase contract")},l.createElement(Qe,{type:"before_purchase"}),l.createElement(Qe,{type:"purchase"})),l.createElement($e,{id:"sell_conditions",name:(0,B.localize)("Sell contract (optional)")},l.createElement(Qe,{type:"during_purchase"}),l.createElement(Qe,{type:"sell_at_market"})),l.createElement($e,{id:"trade_results",name:(0,B.localize)("Trade again")},l.createElement(Qe,{type:"after_purchase"}),l.createElement(Qe,{type:"trade_again"})),l.createElement($e,{id:"analysis",name:(0,B.localize)("Analysis")},l.createElement($e,{id:"indicators",name:(0,B.localize)("Indicators")},l.createElement(Qe,{type:"sma_statement"},l.createElement(it,{name:"STATEMENT"},l.createElement(Qe,{type:"input_list",deletable:"false",movable:"false"},l.createElement(at,{name:"INPUT_LIST"}),l.createElement(nt,null,l.createElement(Qe,{type:"period",deletable:"false",movable:"false"},l.createElement(at,{name:"PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10")))))))),l.createElement(Qe,{type:"smaa_statement"},l.createElement(it,{name:"STATEMENT"},l.createElement(Qe,{type:"input_list",deletable:"false",movable:"false"},l.createElement(at,{name:"INPUT_LIST"}),l.createElement(nt,null,l.createElement(Qe,{type:"period",deletable:"false",movable:"false"},l.createElement(at,{name:"PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10")))))))),l.createElement(Qe,{type:"bb_statement"},l.createElement(tt,{name:"BBRESULT_LIST"},"0"),l.createElement(it,{name:"STATEMENT"},l.createElement(Qe,{type:"input_list",deletable:"false",movable:"false"},l.createElement(at,{name:"INPUT_LIST"}),l.createElement(nt,null,l.createElement(Qe,{type:"period",deletable:"false",movable:"false"},l.createElement(at,{name:"PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10"))),l.createElement(nt,null,l.createElement(Qe,{type:"std_dev_multiplier_up",deletable:"false",movable:"false"},l.createElement(at,{name:"UPMULTIPLIER"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"5"))),l.createElement(nt,null,l.createElement(Qe,{type:"std_dev_multiplier_down"},l.createElement(at,{name:"DOWNMULTIPLIER"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"5")))))))))))),l.createElement(Qe,{type:"bba_statement"},l.createElement(tt,{name:"BBRESULT_LIST"},"0"),l.createElement(it,{name:"STATEMENT"},l.createElement(Qe,{type:"input_list",deletable:"false",movable:"false"},l.createElement(at,{name:"INPUT_LIST"}),l.createElement(nt,null,l.createElement(Qe,{type:"period",deletable:"false",movable:"false"},l.createElement(at,{name:"PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10"))),l.createElement(nt,null,l.createElement(Qe,{type:"std_dev_multiplier_up",deletable:"false",movable:"false"},l.createElement(at,{name:"UPMULTIPLIER"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"5"))),l.createElement(nt,null,l.createElement(Qe,{type:"std_dev_multiplier_down"},l.createElement(at,{name:"DOWNMULTIPLIER"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"5")))))))))))),l.createElement(Qe,{type:"ema_statement"},l.createElement(it,{name:"STATEMENT"},l.createElement(Qe,{type:"input_list",deletable:"false",movable:"false"},l.createElement(at,{name:"INPUT_LIST"}),l.createElement(nt,null,l.createElement(Qe,{type:"period",deletable:"false",movable:"false"},l.createElement(at,{name:"PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10")))))))),l.createElement(Qe,{type:"emaa_statement"},l.createElement(it,{name:"STATEMENT"},l.createElement(Qe,{type:"input_list",deletable:"false",movable:"false"},l.createElement(at,{name:"INPUT_LIST"}),l.createElement(nt,null,l.createElement(Qe,{type:"period",deletable:"false",movable:"false"},l.createElement(at,{name:"PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10")))))))),l.createElement(Qe,{type:"rsi_statement"},l.createElement(it,{name:"STATEMENT"},l.createElement(Qe,{type:"input_list",deletable:"false",movable:"false"},l.createElement(nt,null,l.createElement(Qe,{type:"period",deletable:"false",movable:"false"},l.createElement(at,{name:"PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10")))))))),l.createElement(Qe,{type:"rsia_statement"},l.createElement(it,{name:"STATEMENT"},l.createElement(Qe,{type:"input_list",deletable:"false",movable:"false"},l.createElement(at,{name:"INPUT_LIST"}),l.createElement(nt,null,l.createElement(Qe,{type:"period",deletable:"false",movable:"false"},l.createElement(at,{name:"PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10")))))))),l.createElement(Qe,{type:"macda_statement"},l.createElement(tt,{name:"MACDFIELDS_LIST"},"1"),l.createElement(it,{name:"STATEMENT"},l.createElement(Qe,{type:"input_list",deletable:"false",movable:"false"},l.createElement(at,{name:"INPUT_LIST"}),l.createElement(nt,null,l.createElement(Qe,{type:"fast_ema_period",deletable:"false",movable:"false"},l.createElement(at,{name:"FAST_EMA_PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"12"))),l.createElement(nt,null,l.createElement(Qe,{type:"slow_ema_period",deletable:"false",movable:"false"},l.createElement(at,{name:"SLOW_EMA_PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"26"))),l.createElement(nt,null,l.createElement(Qe,{type:"signal_ema_period",deletable:"false",movable:"false"},l.createElement(at,{name:"SIGNAL_EMA_PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"9"))))))))))))),l.createElement($e,{name:(0,B.localize)("Tick and candle analysis"),id:"tick_analysis"},l.createElement(Qe,{type:"tick_analysis"}),l.createElement(Qe,{type:"tick"}),l.createElement(Qe,{type:"last_digit"}),l.createElement(Qe,{type:"ticks"}),l.createElement(Qe,{type:"lastDigitList"}),l.createElement(Qe,{type:"check_direction"}),l.createElement(Qe,{type:"is_candle_black"}),l.createElement(Qe,{type:"read_ohlc"},l.createElement(tt,{name:"OHLCFIELD_LIST"},"open"),l.createElement(tt,{name:"CANDLEINTERVAL_LIST"},"default"),l.createElement(at,{name:"CANDLEINDEX"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1")))),l.createElement(Qe,{type:"read_ohlc_obj"}),l.createElement(Qe,{type:"ohlc_values"}),l.createElement(Qe,{type:"ohlc_values_in_list"}),l.createElement(Qe,{type:"get_ohlc"},l.createElement(tt,{name:"CANDLEINTERVAL_LIST"},"default"),l.createElement(at,{name:"CANDLEINDEX"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1")))),l.createElement(Qe,{type:"ohlc"})),l.createElement($e,{name:(0,B.localize)("Contract"),id:"contract_details"},l.createElement(Qe,{type:"contract_check_result"}),l.createElement(Qe,{type:"read_details"}),l.createElement(Qe,{type:"sell_price"}),l.createElement(Qe,{type:"check_sell"}),l.createElement(Qe,{type:"payout"}),l.createElement(Qe,{type:"ask_price"})),l.createElement($e,{name:(0,B.localize)("Stats"),id:"stats"},l.createElement(Qe,{type:"balance"}),l.createElement(Qe,{type:"total_profit"}),l.createElement(Qe,{type:"total_runs"}))),l.createElement($e,{id:"utility",name:(0,B.localize)("Utility")},l.createElement($e,{name:(0,B.localize)("Custom functions"),id:"custom_functions",dynamic:"PROCEDURE"}),l.createElement($e,{name:(0,B.localize)("Variables"),id:"variables",dynamic:"VARIABLE"}),l.createElement($e,{name:(0,B.localize)("Notifications"),id:"notifications"},l.createElement(Qe,{type:"text_print"},l.createElement(at,{name:"TEXT"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")))),l.createElement(Qe,{type:"text_prompt_ext"},l.createElement(tt,{name:"TYPE"},"TEXT"),l.createElement(at,{name:"TEXT"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")))),l.createElement(Qe,{type:"notify"},l.createElement(tt,{name:"NOTIFICATION_TYPE"},"success"),l.createElement(at,{name:"MESSAGE"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")))),l.createElement(Qe,{type:"notify_telegram"},l.createElement(at,{name:"TELEGRAM_ACCESS_TOKEN"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"}))),l.createElement(at,{name:"TELEGRAM_CHAT_ID"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"}))),l.createElement(at,{name:"TELEGRAM_MESSAGE"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc"))))),l.createElement($e,{name:(0,B.localize)("Time"),id:"time"},l.createElement(Qe,{type:"epoch"}),l.createElement(Qe,{type:"timeout"}),l.createElement(Qe,{type:"totimestamp"},l.createElement(at,{name:"DATETIME"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"yyyy-mm-dd hh:mm:ss")))),l.createElement(Qe,{type:"todatetime"},l.createElement(at,{name:"TIMESTAMP"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"0"))))),l.createElement($e,{name:(0,B.localize)("Math"),id:"math"},l.createElement(Qe,{type:"math_number"}),l.createElement(Qe,{type:"math_arithmetic"},l.createElement(tt,{name:"OP"},"ADD"),l.createElement(at,{name:"A"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1"))),l.createElement(at,{name:"B"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1")))),l.createElement(Qe,{type:"math_single"},l.createElement(tt,{name:"OP"},"ROOT"),l.createElement(at,{name:"NUM"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"9")))),l.createElement(Qe,{type:"math_trig"},l.createElement(tt,{name:"OP"},"SIN"),l.createElement(at,{name:"NUM"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"45")))),l.createElement(Qe,{type:"math_constant"}),l.createElement(Qe,{type:"math_number_property"},l.createElement(ot,{divisor_input:"false"}),l.createElement(tt,{name:"PROPERTY"},"EVEN"),l.createElement(at,{name:"NUMBER_TO_CHECK"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"0")))),l.createElement(Qe,{type:"math_change"},l.createElement(tt,{name:"VAR",variabletype:""},"item"),l.createElement(at,{name:"DELTA"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1")))),l.createElement(Qe,{type:"math_on_list"}),l.createElement(Qe,{type:"math_round"},l.createElement(tt,{name:"OP"},"ROUND"),l.createElement(at,{name:"NUM"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"3.1")))),l.createElement(Qe,{type:"math_modulo"},l.createElement(at,{name:"DIVIDEND"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"64"))),l.createElement(at,{name:"DIVISOR"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10")))),l.createElement(Qe,{type:"math_constrain"},l.createElement(at,{name:"Value"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"50"))),l.createElement(at,{name:"LOW"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1"))),l.createElement(at,{name:"HIGH"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"100")))),l.createElement(Qe,{type:"math_random_int"},l.createElement(at,{name:"FROM"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1"))),l.createElement(at,{name:"TO"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"100")))),l.createElement(Qe,{type:"math_random_float"})),l.createElement($e,{name:(0,B.localize)("Text"),id:"text"},l.createElement(Qe,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")),l.createElement(Qe,{type:"text_join"},l.createElement(tt,{name:"VARIABLE",variabletype:""},"text"),l.createElement(it,{name:"STACK"},l.createElement(Qe,{type:"text_statement",movable:"false"},l.createElement(at,{name:"TEXT"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")))))),l.createElement(Qe,{type:"text_append"},l.createElement(tt,{name:"VAR",variabletype:""},"text"),l.createElement(at,{name:"TEXT"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")))),l.createElement(Qe,{type:"text_length"},l.createElement(at,{name:"Value"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")))),l.createElement(Qe,{type:"text_isEmpty"},l.createElement(at,{name:"Value"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"})))),l.createElement(Qe,{type:"text_indexOf"},l.createElement(tt,{name:"END"},"FIRST"),l.createElement(at,{name:"Value"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"text"))),l.createElement(at,{name:"FIND"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")))),l.createElement(Qe,{type:"text_charAt"},l.createElement(ot,{at:"true"}),l.createElement(tt,{name:"WHERE"},"FROM_START"),l.createElement(at,{name:"Value"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"item"))),l.createElement(at,{name:"AT"},l.createElement(rt,{type:"math_number_positive"},l.createElement(tt,{name:"NUM"},"1")))),l.createElement(Qe,{type:"text_getSubstring"},l.createElement(ot,{at1:"true",at2:"true"}),l.createElement(tt,{name:"WHERE1"},"FROM_START"),l.createElement(tt,{name:"WHERE2"},"FROM_START"),l.createElement(at,{name:"STRING"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"text"))),l.createElement(at,{name:"AT1"},l.createElement(rt,{type:"math_number_positive"},l.createElement(tt,{name:"NUM"},"0"))),l.createElement(at,{name:"AT2"},l.createElement(rt,{type:"math_number_positive"},l.createElement(tt,{name:"NUM"},"2")))),l.createElement(Qe,{type:"text_changeCase"},l.createElement(tt,{name:"CASE"},"UPPERCASE"),l.createElement(at,{name:"TEXT"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")))),l.createElement(Qe,{type:"text_trim"},l.createElement(tt,{name:"MODE"},"BOTH"),l.createElement(at,{name:"TEXT"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc"))))),l.createElement($e,{name:(0,B.localize)("Logic"),id:"logic"},l.createElement(Qe,{type:"controls_if"}),l.createElement(Qe,{type:"logic_compare"}),l.createElement(Qe,{type:"logic_operation"}),l.createElement(Qe,{type:"logic_negate"}),l.createElement(Qe,{type:"logic_boolean"}),l.createElement(Qe,{type:"logic_null"}),l.createElement(Qe,{type:"logic_ternary"})),l.createElement($e,{name:(0,B.localize)("Lists"),id:"lists"},l.createElement(Qe,{type:"lists_create_with"},l.createElement(tt,{name:"VARIABLE",variabletype:""},"list"),l.createElement(it,{name:"STACK"},l.createElement(Qe,{type:"lists_statement",movable:"false"},l.createElement(nt,null,l.createElement(Qe,{type:"lists_statement",movable:"false"}))))),l.createElement(Qe,{type:"lists_repeat"},l.createElement(at,{name:"NUM"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"5")))),l.createElement(Qe,{type:"lists_length"}),l.createElement(Qe,{type:"lists_isEmpty"}),l.createElement(Qe,{type:"lists_indexOf"}),l.createElement(Qe,{type:"lists_getIndex"}),l.createElement(Qe,{type:"lists_setIndex"}),l.createElement(Qe,{type:"lists_getSublist"}),l.createElement(Qe,{type:"lists_split"},l.createElement(ot,{mode:"SPLIT"}),l.createElement(tt,{name:"MODE"},"SPLIT"),l.createElement(at,{name:"DELIM"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},",")))),l.createElement(Qe,{type:"lists_sort"})),l.createElement($e,{name:(0,B.localize)("Loops"),id:"loops"},l.createElement(Qe,{type:"controls_repeat"}),l.createElement(Qe,{type:"controls_repeat_ext"}),l.createElement(Qe,{type:"controls_whileUntil"}),l.createElement(Qe,{type:"controls_for"}),l.createElement(Qe,{type:"controls_forEach"}),l.createElement(Qe,{type:"controls_flow_statements"})),l.createElement($e,{name:(0,B.localize)("Miscellaneous"),id:"misc"},l.createElement(Qe,{type:"loader"}),l.createElement(Qe,{type:"block_holder"}),l.createElement(Qe,{type:"console"},l.createElement(at,{name:"MESSAGE"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")))))),l.createElement((function(e){var t=Ze({},e);return l.createElement("examples",t)}),{id:"examples"},l.createElement(et,{id:"sell_available"},l.createElement(Qe,{type:"during_purchase"},l.createElement(it,{name:"DURING_PURCHASE_STACK"},l.createElement(Qe,{type:"controls_if"},l.createElement(at,{name:"IF0"},l.createElement(Qe,{type:"check_sell"})),l.createElement(it,{name:"DO0"},l.createElement(Qe,{type:"sell_at_market"})))))),l.createElement(et,{id:"trade_again"},l.createElement(Qe,{type:"after_purchase"},l.createElement(it,{name:"AFTERPURCHASE_STACK"},l.createElement(Qe,{type:"controls_if"},l.createElement(at,{name:"IF0"},l.createElement(Qe,{type:"logic_compare"},l.createElement(tt,{name:"OP"},"EQ"),l.createElement(at,{name:"A"},l.createElement(Qe,{type:"total_profit"})),l.createElement(at,{name:"B"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"target_profit"))))))))),l.createElement(et,{id:"sma_block_example"},l.createElement(Qe,{type:"sma_statement"},l.createElement(tt,{name:"VARIABLE",variabletype:""},"sma"),l.createElement(it,{name:"STATEMENT"},l.createElement(Qe,{type:"input_list",deletable:"false",movable:"false"},l.createElement(at,{name:"INPUT_LIST"},l.createElement(Qe,{type:"ohlc_values"},l.createElement(tt,{name:"OHLCFIELD_LIST"},"open"),l.createElement(tt,{name:"CANDLEINTERVAL_LIST"},"default"))),l.createElement(nt,null,l.createElement(Qe,{type:"period",deletable:"false",movable:"false"},l.createElement(at,{name:"PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10"))))))))),l.createElement(et,{id:"sma_array"},l.createElement(Qe,{type:"smaa_statement"},l.createElement(tt,{name:"VARIABLE",variabletype:""},"smaa"),l.createElement(it,{name:"STATEMENT"},l.createElement(Qe,{type:"input_list",deletable:"false",movable:"false"},l.createElement(nt,null,l.createElement(Qe,{type:"period",deletable:"false",movable:"false"},l.createElement(at,{name:"PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10"))))))))),l.createElement(et,{id:"sma_block_example_1"},l.createElement(Qe,{type:"sma_statement"},l.createElement(tt,{name:"VARIABLE",variabletype:""},"sma"),l.createElement(it,{name:"STATEMENT"},l.createElement(Qe,{type:"input_list",deletable:"false",movable:"false"},l.createElement(at,{name:"INPUT_LIST"},l.createElement(Qe,{type:"ticks"})),l.createElement(nt,null,l.createElement(Qe,{type:"period",deletable:"false",movable:"false"},l.createElement(at,{name:"PERIOD"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10"))))))))),l.createElement(et,{id:"in_candle_list_read"},l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"op"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"read_ohlc"},l.createElement(tt,{name:"OHLCFIELD_LIST"},"open"),l.createElement(tt,{name:"CANDLEINTERVAL_LIST"},"default"),l.createElement(at,{name:"CANDLEINDEX"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1"))))))),l.createElement(et,{id:"read_candle_value"},l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"op"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"read_ohlc_obj"},l.createElement(tt,{name:"OHLCFIELD_LIST"},"open"),l.createElement(at,{name:"OHLCOBJ"},l.createElement(Qe,{type:"read_ohlc"},l.createElement(tt,{name:"OHLCFIELD_LIST"},"open"),l.createElement(tt,{name:"CANDLEINTERVAL_LIST"},"default"),l.createElement(at,{name:"CANDLEINDEX"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1"))))))))),l.createElement(et,{id:"candle_list"},l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"candle_list"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"ohlc_values"},l.createElement(tt,{name:"OHLCFIELD_LIST"},"open"),l.createElement(tt,{name:"CANDLEINTERVAL_LIST"},"default"))))),l.createElement(et,{id:"candle_list_1"},l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"cl"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"ohlc_values_in_list"},l.createElement(tt,{name:"OHLCFIELD_LIST"},"open"),l.createElement(at,{name:"OHLCLIST"},l.createElement(Qe,{type:"ohlc"},l.createElement(tt,{name:"CANDLEINTERVAL_LIST"},"default"))))))),l.createElement(et,{id:"get_candle"},l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"candle_open_price"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"read_ohlc_obj"},l.createElement(tt,{name:"OHLCFIELD_LIST"},"epoch"),l.createElement(at,{name:"OHLCOBJ"},l.createElement(Qe,{type:"get_ohlc"},l.createElement(tt,{name:"CANDLEINTERVAL_LIST"},"default"),l.createElement(at,{name:"CANDLEINDEX"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"2"))))))))),l.createElement(et,{id:"check_result"},l.createElement(Qe,{type:"after_purchase"},l.createElement(it,{name:"AFTERPURCHASE_STACK"},l.createElement(Qe,{type:"controls_if"},l.createElement(at,{name:"IF0"},l.createElement(Qe,{type:"contract_check_result"},l.createElement(tt,{name:"CHECK_RESULT"},"win"))),l.createElement(it,{name:"DO0"},l.createElement(Qe,{type:"trade_again"})))))),l.createElement(et,{id:"sell_pl"},l.createElement(Qe,{type:"during_purchase"},l.createElement(it,{name:"DURING_PURCHASE_STACK"},l.createElement(Qe,{type:"controls_if"},l.createElement(at,{name:"IF0"},l.createElement(Qe,{type:"check_sell"})),l.createElement(it,{name:"DO0"},l.createElement(Qe,{type:"controls_if"},l.createElement(at,{name:"IF0"},l.createElement(Qe,{type:"logic_compare"},l.createElement(tt,{name:"OP"},"EQ"),l.createElement(at,{name:"A"},l.createElement(Qe,{type:"sell_price"})),l.createElement(at,{name:"B"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"stake"))))),l.createElement(it,{name:"DO0"},l.createElement(Qe,{type:"sell_at_market"})))))))),l.createElement(et,{id:"if-return"},l.createElement(Qe,{type:"procedures_defreturn"},l.createElement(ot,null,l.createElement((function(e){var t=Ze({},e);return l.createElement("arg",t)}),{name:"x"})),l.createElement(tt,{name:"NAME"},"do something"),l.createElement(it,{name:"STACK"},l.createElement(Qe,{type:"procedures_ifreturn"},l.createElement(ot,{value:"1"}),l.createElement(at,{name:"CONDITION"},l.createElement(Qe,{type:"logic_compare"},l.createElement(tt,{name:"OP"},"EQ"),l.createElement(at,{name:"A"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"x"))),l.createElement(at,{name:"B"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"x"))))),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"text"},l.createElement(tt,{name:"TEXT"},"x must be positive or zero"))))),l.createElement(at,{name:"RETURN"},l.createElement(Qe,{type:"math_single"},l.createElement(tt,{name:"OP"},"ROOT"),l.createElement(at,{name:"NUM"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"9")),l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"x"))))))),l.createElement(et,{id:"notify_telegram"},l.createElement(Qe,{type:"notify_telegram"},l.createElement(at,{name:"TELEGRAM_ACCESS_TOKEN"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"})),l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"access_token"))),l.createElement(at,{name:"TELEGRAM_CHAT_ID"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"})),l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"chat_id"))),l.createElement(at,{name:"TELEGRAM_MESSAGE"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"Enjoy!"))))),l.createElement(et,{id:"epoch"},l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"candle"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"read_ohlc"},l.createElement(tt,{name:"OHLCFIELD_LIST"},"open"),l.createElement(tt,{name:"CANDLEINTERVAL_LIST"},"default"),l.createElement(at,{name:"CANDLEINDEX"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1"))))),l.createElement(nt,null,l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"Open Time"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"read_ohlc_obj"},l.createElement(tt,{name:"OHLCFIELD_LIST"},"epoch"),l.createElement(at,{name:"OHLCOBJ"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"candle"))))),l.createElement(nt,null,l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"Open Time"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"math_arithmetic"},l.createElement(tt,{name:"OP"},"MINUS"),l.createElement(at,{name:"A"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1")),l.createElement(Qe,{type:"epoch"})),l.createElement(at,{name:"B"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1")),l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"Open Time"))))),l.createElement(nt,null,l.createElement(Qe,{type:"controls_if"},l.createElement(at,{name:"IF0"},l.createElement(Qe,{type:"logic_compare"},l.createElement(tt,{name:"OP"},"GTE"),l.createElement(at,{name:"A"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"Time Since Candle Opened"))),l.createElement(at,{name:"B"},l.createElement(Qe,{type:"math_number"},l.createElement(tt,{name:"NUM"},"30"))))))))))))),l.createElement(et,{id:"totimestamp"},l.createElement(Qe,{type:"before_purchase"},l.createElement(it,{name:"BEFOREPURCHASE_STACK"},l.createElement(Qe,{type:"controls_if"},l.createElement(at,{name:"IF0"},l.createElement(Qe,{type:"logic_compare"},l.createElement(tt,{name:"OP"},"EQ"),l.createElement(at,{name:"A"},l.createElement(Qe,{type:"epoch"})),l.createElement(at,{name:"B"},l.createElement(Qe,{type:"totimestamp"},l.createElement(at,{name:"DATETIME"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"1957-08-31 00:00:00"))))))),l.createElement(it,{name:"DO0"},l.createElement(Qe,{type:"purchase"},l.createElement(tt,{name:"PURCHASE_LIST"},"CALL"))))))),l.createElement(et,{id:"todatetime"},l.createElement(Qe,{type:"notify"},l.createElement(tt,{name:"NOTIFICATION_TYPE"},"success"),l.createElement(tt,{name:"NOTIFICATION_SOUND"},"silent"),l.createElement(at,{name:"MESSAGE"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")),l.createElement(Qe,{type:"todatetime"},l.createElement(at,{name:"TIMESTAMP"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"0")),l.createElement(Qe,{type:"epoch"})))))),l.createElement(et,{id:"constrain"},l.createElement(Qe,{type:"math_constrain"},l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"math_number"},l.createElement(tt,{name:"NUM"},"5"))),l.createElement(at,{name:"LOW"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10"))),l.createElement(at,{name:"HIGH"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"20"))))),l.createElement(et,{id:"controls_if"},l.createElement(Qe,{type:"controls_if"},l.createElement(ot,{elseif:"1",else:"1"}),l.createElement(at,{name:"IF0"},l.createElement(Qe,{type:"logic_compare"},l.createElement(tt,{name:"OP"},"EQ"),l.createElement(at,{name:"A"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"var1"))),l.createElement(at,{name:"B"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"var2"))))),l.createElement(at,{name:"IF1"},l.createElement(Qe,{type:"logic_compare"},l.createElement(tt,{name:"OP"},"EQ"),l.createElement(at,{name:"A"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"var3"))),l.createElement(at,{name:"B"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"var4"))))))),l.createElement(et,{id:"compare_logic"},l.createElement(Qe,{type:"logic_compare"},l.createElement(tt,{name:"OP"},"EQ"))),l.createElement(et,{id:"compare_logic_1"},l.createElement(Qe,{type:"logic_operation"},l.createElement(tt,{name:"OP"},"AND"))),l.createElement(et,{id:"repeat_while"},l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"x"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"math_number"},l.createElement(tt,{name:"NUM"},"0"))),l.createElement(nt,null,l.createElement(Qe,{type:"controls_whileUntil"},l.createElement(tt,{name:"MODE"},"WHILE"),l.createElement(at,{name:"BOOL"},l.createElement(Qe,{type:"logic_compare"},l.createElement(tt,{name:"OP"},"LTE"),l.createElement(at,{name:"A"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"x"))),l.createElement(at,{name:"B"},l.createElement(Qe,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10"))))),l.createElement(it,{name:"DO"},l.createElement(Qe,{type:"math_change"},l.createElement(tt,{name:"VAR",variabletype:""},"x"),l.createElement(at,{name:"DELTA"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"1"))),l.createElement(nt,null,l.createElement(Qe,{type:"notify"},l.createElement(tt,{name:"NOTIFICATION_TYPE"},"success"),l.createElement(tt,{name:"NOTIFICATION_SOUND"},"silent"),l.createElement(at,{name:"MESSAGE"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")),l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"x"))))))))))),l.createElement(et,{id:"repeat_until"},l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"x"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"math_number"},l.createElement(tt,{name:"NUM"},"20"))),l.createElement(nt,null,l.createElement(Qe,{type:"controls_whileUntil"},l.createElement(tt,{name:"MODE"},"UNTIL"),l.createElement(at,{name:"BOOL"},l.createElement(Qe,{type:"logic_compare"},l.createElement(tt,{name:"OP"},"EQ"),l.createElement(at,{name:"A"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"x"))),l.createElement(at,{name:"B"},l.createElement(Qe,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10"))))),l.createElement(it,{name:"DO"},l.createElement(Qe,{type:"math_change"},l.createElement(tt,{name:"VAR",variabletype:""},"x"),l.createElement(at,{name:"DELTA"},l.createElement(rt,{type:"math_number"},l.createElement(tt,{name:"NUM"},"-1"))),l.createElement(nt,null,l.createElement(Qe,{type:"notify"},l.createElement(tt,{name:"NOTIFICATION_TYPE"},"success"),l.createElement(tt,{name:"NOTIFICATION_SOUND"},"silent"),l.createElement(at,{name:"MESSAGE"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")),l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"x"))))))))))),l.createElement(et,{id:"controls_for"},l.createElement(Qe,{type:"controls_for"},l.createElement(tt,{name:"VAR",variabletype:""},"i"),l.createElement(at,{name:"FROM"},l.createElement(Qe,{type:"math_number"},l.createElement(tt,{name:"NUM"},"0"))),l.createElement(at,{name:"TO"},l.createElement(Qe,{type:"math_number"},l.createElement(tt,{name:"NUM"},"10"))),l.createElement(at,{name:"BY"},l.createElement(Qe,{type:"math_number"},l.createElement(tt,{name:"NUM"},"2"))),l.createElement(it,{name:"DO"},l.createElement(Qe,{type:"notify"},l.createElement(tt,{name:"NOTIFICATION_TYPE"},"success"),l.createElement(tt,{name:"NOTIFICATION_SOUND"},"silent"),l.createElement(at,{name:"MESSAGE"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")),l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"i"))))))),l.createElement(et,{id:"controls_forEach"},l.createElement(Qe,{type:"lists_create_with"},l.createElement(tt,{name:"VARIABLE"},"list"),l.createElement(it,{name:"STACK"},l.createElement(Qe,{type:"lists_statement"},l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"item1"))),l.createElement(nt,null,l.createElement(Qe,{type:"lists_statement"},l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"item2"))),l.createElement(nt,null,l.createElement(Qe,{type:"lists_statement"},l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"item3"))))))))),l.createElement(nt,null,l.createElement(Qe,{type:"controls_forEach"},l.createElement(tt,{name:"VAR",variabletype:""},"i"),l.createElement(at,{name:"LIST"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"list"))),l.createElement(it,{name:"DO"},l.createElement(Qe,{type:"notify"},l.createElement(tt,{name:"NOTIFICATION_TYPE"},"success"),l.createElement(tt,{name:"NOTIFICATION_SOUND"},"silent"),l.createElement(at,{name:"MESSAGE"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")),l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"i"))))))))),l.createElement(et,{id:"break_out"},l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"x"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"logic_boolean"},l.createElement(tt,{name:"BOOL"},"TRUE"))),l.createElement(nt,null,l.createElement(Qe,{type:"controls_repeat"},l.createElement(tt,{name:"TIMES"},"10"),l.createElement(it,{name:"DO"},l.createElement(Qe,{type:"controls_if"},l.createElement(at,{name:"IF0"},l.createElement(Qe,{type:"logic_negate"},l.createElement(at,{name:"BOOL"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"x"))))),l.createElement(it,{name:"DO0"},l.createElement(Qe,{type:"controls_flow_statements"},l.createElement(tt,{name:"FLOW"},"BREAK"))),l.createElement(nt,null,l.createElement(Qe,{type:"notify"},l.createElement(tt,{name:"NOTIFICATION_TYPE"},"success"),l.createElement(tt,{name:"NOTIFICATION_SOUND"},"silent"),l.createElement(at,{name:"MESSAGE"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc"))))))))))),l.createElement(et,{id:"continue"},l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"x"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"logic_boolean"},l.createElement(tt,{name:"BOOL"},"FALSE"))),l.createElement(nt,null,l.createElement(Qe,{type:"controls_repeat"},l.createElement(tt,{name:"TIMES"},"10"),l.createElement(it,{name:"DO"},l.createElement(Qe,{type:"controls_if"},l.createElement(at,{name:"IF0"},l.createElement(Qe,{type:"logic_negate"},l.createElement(at,{name:"BOOL"},l.createElement(Qe,{type:"variables_get"},l.createElement(tt,{name:"VAR",variabletype:""},"x"))))),l.createElement(it,{name:"DO0"},l.createElement(Qe,{type:"variables_set"},l.createElement(tt,{name:"VAR",variabletype:""},"x"),l.createElement(at,{name:"VALUE"},l.createElement(Qe,{type:"logic_boolean"},l.createElement(tt,{name:"BOOL"},"TRUE"))),l.createElement(nt,null,l.createElement(Qe,{type:"controls_flow_statements"},l.createElement(tt,{name:"FLOW"},"CONTINUE"))))),l.createElement(nt,null,l.createElement(Qe,{type:"notify"},l.createElement(tt,{name:"NOTIFICATION_TYPE"},"success"),l.createElement(tt,{name:"NOTIFICATION_SOUND"},"silent"),l.createElement(at,{name:"MESSAGE"},l.createElement(rt,{type:"text"},l.createElement(tt,{name:"TEXT"},"abc")))))))))))))),ct=Object.freeze({QUICK_STRATEGY:99999,TOOLBAR:5,TRANSACTION:10,SUMMARY_TOOLTIPS:5,RUN_PANEL:1});function st(){return st=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},st.apply(this,arguments)}var ut=function(e){var t=e.is_search_loading,o=e.onSearch,n=e.onSearchBlur,r=e.onSearchClear,i=e.onSearchKeyUp;return l.createElement("div",{className:"db-toolbox__search"},l.createElement(Ke.Formik,{initialValues:{search:""},onSubmit:o},(function(e){var o=e.submitForm,a=e.values.search,s=e.setFieldValue;return l.createElement(Ke.Form,null,l.createElement(Ke.Field,{name:"search"},(function(e){var u=e.field;return l.createElement(c.Input,st({},u,{className:"db-toolbox__search-field",type:"text",name:"search",placeholder:(0,B.localize)("Search"),onKeyUp:function(){return i(o)},onFocus:o,onBlur:n,leading_icon:a&&(t?l.createElement("div",{className:"loader"}):l.createElement(c.Icon,{icon:"IcCloseCircle",onClick:function(){return r(s)},color:"secondary"}))||!a&&l.createElement(c.Icon,{icon:"IcSearch"})}))})))})))},pt=function(e){var t=e.onMount,o=e.onUnmount,n=e.hasSubCategory,r=e.is_mobile,i=e.is_search_loading,a=e.is_toolbox_open,s=e.onSearch,u=e.onSearchBlur,p=e.onSearchClear,d=e.onSearchKeyUp,y=e.onToolboxItemClick,m=e.onToolboxItemExpand,f=e.sub_category_index,_=e.toggleDrawer,h=e.toolbox_dom,g=l.useRef(lt);return l.useEffect((function(){return t(g),function(){return o()}}),[t,o]),r?null:l.createElement(c.Drawer,{anchor:"left",className:"db-toolbox",is_open:a,toggleDrawer:_,width:256,zIndex:ct.RUN_PANEL},l.createElement("div",{id:"gtm-toolbox",className:"db-toolbox__content"},l.createElement("div",{className:"db-toolbox__header"},l.createElement("div",{className:"db-toolbox__title"},(0,B.localize)("Blocks menu"))),l.createElement(ut,{is_search_loading:i,onSearch:s,onSearchBlur:u,onSearchClear:p,onSearchKeyUp:d}),l.createElement("div",{className:"db-toolbox__category-menu"},h&&Array.from(h.childNodes).map((function(e,t){if("CATEGORY"===e.tagName.toUpperCase()){var o=n(e.children),r=f.includes(t);return l.createElement("div",{key:"db-toolbox__row--".concat(e.getAttribute("id")),className:"db-toolbox__row"},l.createElement("div",{className:"db-toolbox__item",onClick:function(){o?m(t):y(e)}},l.createElement("div",{className:"db-toolbox__category-text"},l.createElement("div",{className:"db-toolbox__label"},(0,B.localize)(e.getAttribute("name"))),o&&l.createElement("div",{className:T()("db-toolbox__category-arrow",{"db-toolbox__category-arrow--active":r})},l.createElement(c.Icon,{icon:"IcChevronDownBold"})))),o&&r&&Array.from(e.childNodes).map((function(e){return l.createElement("div",{key:"db-toolbox__sub-category-row--".concat(e.getAttribute("id")),className:"db-toolbox__sub-category-row",onClick:function(){y(e)}},l.createElement(c.Text,{size:"xxs",line_height:"m"},(0,B.localize)(e.getAttribute("name"))))})))}})))))};pt.PropTypes={hasSubCategory:d().func,is_mobile:d().bool,is_search_loading:d().bool,is_toolbox_open:d().bool,onMount:d().func,onSearch:d().func,onSearchBlur:d().func,onSearchClear:d().func,onSearchKeyUp:d().func,onToolboxItemClick:d().func,onToolboxItemExpand:d().func,onUnmount:d().func,sub_category_index:d().array,toggleDrawer:d().func,toolbox_dom:d().arrayOf(NodeList)};const dt=b((function(e){var t=e.toolbox,o=e.ui;return{hasSubCategory:t.hasSubCategory,is_mobile:o.is_mobile,is_search_loading:t.is_search_loading,is_toolbox_open:t.is_toolbox_open,onMount:t.onMount,onSearch:t.onSearch,onSearchBlur:t.onSearchBlur,onSearchClear:t.onSearchClear,onSearchKeyUp:t.onSearchKeyUp,onToolboxItemClick:t.onToolboxItemClick,onToolboxItemExpand:t.onToolboxItemExpand,onUnmount:t.onUnmount,sub_category_index:t.sub_category_index,toggleDrawer:t.toggleDrawer,toolbox_dom:t.toolbox_dom}}))(pt);var yt=function(e){var t=e.active_tab;return e.is_loading?null:l.createElement(l.Fragment,null,Blockly.derivWorkspace&&l.createElement(l.Fragment,null,t===S.WORKSPACE&&l.createElement(l.Fragment,null,l.createElement(dt,null),l.createElement(me,null)),t===S.CHART&&l.createElement("div",{className:"bot__chart-container-wrapper"},l.createElement("div",{className:"bot__chart-container",style:{width:"var(--bot-content-width)",height:"var(--bot-content-height)"}},l.createElement(P,null)))))},mt=function(e){var t=e.active_tab,o=e.is_loading,n=e.onMount,r=e.onUnmount;return l.useEffect((function(){return n(),function(){return r()}}),[n,r]),l.createElement("div",{id:"scratch_div",style:{width:"100vw",height:"var(--bot-content-height)"}},l.createElement(yt,{active_tab:t,is_loading:o}))};mt.propTypes={active_tab:d().string,is_loading:d().bool,onMount:d().func,onUnmount:d().func};const ft=b((function(e){var t=e.blockly_store,o=e.main_content;return{active_tab:o.active_tab,is_loading:t.is_loading,onMount:o.onMount,onUnmount:o.onUnmount}}))(mt);var _t=function(e){switch(e){case"error":return"IcAlertDanger";case"warn":default:return"IcAlertWarning";case"info":return"IcAlertInfo"}};function ht(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function gt(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(o),!0).forEach((function(t){bt(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ht(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function bt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function vt(){return vt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},vt.apply(this,arguments)}var kt=function(e){var t=e.active_index,o=e.createStrategy,n=e.duration_unit_dropdown,r=e.getSizeDesc,i=e.getSizeText,a=e.initial_errors,s=e.initial_values,u=e.is_onscreen_keyboard_active,p=e.is_stop_button_visible,d=e.onChangeDropdownItem,y=e.onChangeInputValue,m=e.onHideDropdownList,f=e.onScrollStopDropdownList,_=e.symbol_dropdown,h=e.trade_type_dropdown,g=e.validateQuickStrategy,b=e.is_mobile,v=e.selected_symbol,k=e.selected_trade_type,E=e.selected_duration_unit,S=e.description,O=e.setCurrentFocus;return l.createElement(Ke.Formik,{initialValues:s,validate:g,onSubmit:o,enableReinitialize:!0},(function(e){var o=e.errors,s=e.handleChange,w=e.values,C=e.isSubmitting,A=e.setFieldValue,I=e.touched,R=e.submitForm,D=g(w),x=0===Object.keys(D).length,P=!C&&x;return l.createElement(Ke.Form,{className:T()("quick-strategy__form",{"quick-strategy__form--active-keyboard":u})},l.createElement(c.ThemedScrollbars,{height:"430px",autohide:!0,is_bypassed:b},l.createElement("div",{className:T()("quick-strategy__form-content",{"quick-strategy__form-content--active-keyboard":u,"quick-strategy__form-content--safari-fix":(0,_e.isSafari)()})},l.createElement("div",{className:"quick-strategy__description"},S),l.createElement("div",{className:"quick-strategy__form-row"},l.createElement(Ke.Field,{name:"quick-strategy__symbol"},(function(e){var t=e.field;return l.createElement(l.Fragment,null,b?l.createElement(c.SelectNative,{list_items:_,value:v.value,label:(0,B.localize)("Asset"),should_show_empty_option:!1,onChange:function(e){d("symbol",e.target.value,A)}}):l.createElement(c.Autocomplete,vt({},t,{autoComplete:"off",className:"quick-strategy__dropdown quick-strategy__leading",type:"text",label:(0,B.localize)("Asset"),list_items:_,onHideDropdownList:function(){m("symbol",w[t.name],A)},onItemSelection:function(e){var t=e.value;d("symbol",t,A)},onScrollStop:function(){return f("symbol")},leading_icon:v.value&&l.createElement(c.Icon,{icon:"IcUnderlying".concat(v.value),size:24})})))}))),l.createElement("div",{className:"quick-strategy__form-row"},l.createElement(Ke.Field,{name:"quick-strategy__trade-type"},(function(e){var t=e.field;return l.createElement(l.Fragment,null,b?l.createElement(c.SelectNative,{list_items:h,value:k.value,label:(0,B.localize)("Trade type"),should_show_empty_option:!1,onChange:function(e){d("trade-type",e.target.value,A)}}):l.createElement(c.Autocomplete,vt({},t,{autoComplete:"off",className:"quick-strategy__dropdown quick-strategy__leading",type:"text",label:(0,B.localize)("Trade type"),list_items:h,onHideDropdownList:function(){m("trade-type",w[t.name],A)},onItemSelection:function(e){var t=e.value;d("trade-type",t,A)},onScrollStop:function(){return f("trade-type")},leading_icon:k.icon&&l.createElement(c.Text,null,l.createElement(c.IconTradeTypes,{type:k.icon[0]}),l.createElement(c.IconTradeTypes,{type:k.icon[1]}))})))}))),l.createElement("div",{className:T()("quick-strategy__form-row",{"quick-strategy__form-row--multiple":!b})},l.createElement(Ke.Field,{name:"quick-strategy__duration-unit"},(function(e){var t=e.field;return l.createElement(l.Fragment,null,b?l.createElement(c.SelectNative,{list_items:n,value:E.value,label:(0,B.localize)("Duration unit"),should_show_empty_option:!1,onChange:function(e){d("duration-unit",e.target.value,A)}}):l.createElement(c.Autocomplete,vt({},t,{autoComplete:"off",type:"text",label:(0,B.localize)("Duration unit"),list_items:n,disabled:1===n.length,onHideDropdownList:function(){m("duration-unit",w[t.name],A)},onItemSelection:function(e){var t=e.value;d("duration-unit",t,A)},onScrollStop:function(){return f("duration-unit")}})))})),l.createElement(Ke.Field,{name:"quick-strategy__duration-value"},(function(e){var t=e.field;return l.createElement(c.Input,vt({},t,{className:"quick-strategy__input",label_className:"quick-strategy__input-label",field_className:"quick-strategy__input-field",type:"text",error:a[t.name]||I[t.name]&&o[t.name],label:(0,B.localize)("Duration value"),onChange:function(e){s(e),y("input_duration_value",e)},onFocus:function(e){return O(e.currentTarget.name)},onBlur:function(){return O(null)},placeholder:"5",trailing_icon:l.createElement(c.Popover,{alignment:b?"top":"bottom",message:(0,B.localize)("The trade length of your purchased contract."),zIndex:ct.QUICK_STRATEGY},l.createElement(c.Icon,{icon:"IcInfoOutline"}))}))}))),l.createElement("div",{className:T()("quick-strategy__form-row",{"quick-strategy__form-row--multiple":!b})},l.createElement(Ke.Field,{name:"quick-strategy__stake"},(function(e){var t=e.field;return l.createElement(c.Input,vt({},t,{className:"quick-strategy__input",label_className:"quick-strategy__input-label",field_className:"quick-strategy__input-field",type:"text",error:a[t.name]||I[t.name]&&o[t.name],label:(0,B.localize)("Initial stake"),onChange:function(e){s(e),y("input_stake",e)},onFocus:function(e){return O(e.currentTarget.name)},onBlur:function(){return O(null)},placeholder:"10",trailing_icon:l.createElement(c.Popover,{alignment:b?"top":"bottom",message:(0,B.localize)("The amount that you pay to enter a trade."),zIndex:ct.QUICK_STRATEGY},l.createElement(c.Icon,{icon:"IcInfoOutline"}))}))})),l.createElement(Ke.Field,{name:"quick-strategy__loss"},(function(e){var t=e.field;return l.createElement(c.Input,vt({},t,{className:"quick-strategy__input",label_className:"quick-strategy__input-label",field_className:"quick-strategy__input-field",type:"text",error:a[t.name]||I[t.name]&&o[t.name],label:(0,B.localize)("Loss threshold"),onChange:function(e){s(e),y("input_loss",e)},onFocus:function(e){return O(e.currentTarget.name)},onBlur:function(){return O(null)},placeholder:"5000",trailing_icon:l.createElement(c.Popover,{alignment:b?"top":"bottom",message:(0,B.localize)("The bot will stop trading if your total loss exceeds this amount."),zIndex:ct.QUICK_STRATEGY},l.createElement(c.Icon,{icon:"IcInfoOutline"}))}))}))),l.createElement("div",{className:T()("quick-strategy__form-row",{"quick-strategy__form-row--multiple":!b})},l.createElement(Ke.Field,{name:"quick-strategy__size"},(function(e){var n=e.field;return l.createElement(c.Input,vt({},n,{className:"quick-strategy__input",label_className:"quick-strategy__input-label",field_className:"quick-strategy__input-field",type:"text",error:a[n.name]||I[n.name]&&o[n.name],label:i(t),onChange:function(e){s(e),y("input_size",e)},onFocus:function(e){return O(e.currentTarget.name)},onBlur:function(){return O(null)},placeholder:"2",trailing_icon:l.createElement(c.Popover,{alignment:b?"top":"bottom",message:r(t),zIndex:ct.QUICK_STRATEGY},l.createElement(c.Icon,{icon:"IcInfoOutline"}))}))})),l.createElement(Ke.Field,{name:"quick-strategy__profit"},(function(e){var t=e.field;return l.createElement(c.Input,vt({},t,{className:"quick-strategy__input",label_className:"quick-strategy__input-label",field_className:"quick-strategy__input-field",type:"text",error:a[t.name]||I[t.name]&&o[t.name],label:(0,B.localize)("Profit threshold"),onChange:function(e){s(e),y("input_profit",e)},onFocus:function(e){return O(e.currentTarget.name)},onBlur:function(){return O(null)},placeholder:"5000",trailing_icon:l.createElement(c.Popover,{alignment:b?"top":"bottom",message:(0,B.localize)("The bot will stop trading if your total profit exceeds this amount."),zIndex:ct.QUICK_STRATEGY},l.createElement(c.Icon,{icon:"IcInfoOutline"}))}))}))))),l.createElement("div",{className:T()("quick-strategy__form-footer",{"quick-strategy__form-footer--active-keyboard":u})},l.createElement(c.Button.Group,null,!b&&l.createElement(c.Button,{type:"button",id:"db-quick-strategy__button-edit",text:(0,B.localize)("Create and edit"),is_disabled:!P,secondary:!0,large:!0,onClick:function(){A("button","edit"),R()}}),l.createElement(c.Button,{type:"button",id:"db-quick-strategy__button-run",text:(0,B.localize)("Run"),is_disabled:!P||p,primary:!0,large:!0,onClick:function(){A("button","run"),R()}}))))}))},Et=function(e){var t=e.symbol;return l.createElement("div",{key:t.value,className:"quick-strategy__option"},l.createElement(c.Icon,{icon:"IcUnderlying".concat(t.value),size:32}),l.createElement(c.Text,{className:"quick-strategy__symbol",size:"xs",color:"prominent"},t.text))},Tt=function(e){var t=e.trade_type;return l.createElement("div",{key:t.value,className:"quick-strategy__option"},l.createElement(c.IconTradeTypes,{type:t.icon[0],className:"quick-strategy__icon"}),l.createElement(c.IconTradeTypes,{type:t.icon[1],className:"quick-strategy__icon"}),l.createElement(c.Text,{className:"quick-strategy__symbol",size:"xs",color:"prominent"},t.text))},Bt=function(e){var t=s.config.strategies,o=e.setActiveTabIndex,n=e.symbol_dropdown,r=e.trade_type_dropdown,i=e.active_index,a=e.createStrategy,u=e.duration_unit_dropdown,p=e.getSizeDesc,d=e.getSizeText,y=e.initial_errors,m=e.initial_values,f=e.is_onscreen_keyboard_active,_=e.is_mobile,h=e.is_stop_button_visible,g=e.onChangeDropdownItem,b=e.onChangeInputValue,v=e.onHideDropdownList,k=e.onScrollStopDropdownList,E=e.validateQuickStrategy,T=e.selected_symbol,B=e.selected_trade_type,S=e.setCurrentFocus,O=e.selected_duration_unit,w=n.map((function(e){return gt({component:l.createElement(Et,{symbol:e})},e)})).filter((function(e){return"Cryptocurrencies"!==e.group})),C=r.map((function(e){return gt({component:l.createElement(Tt,{trade_type:e})},e)}));return l.createElement(c.Tabs,{active_index:i,onTabItemClick:o,top:!0},Object.keys(t).map((function(e){var o=t[e],n=o.index,r=o.label,c=o.description;return l.createElement("div",{key:n,label:r},l.createElement(kt,{active_index:i,createStrategy:a,duration_unit_dropdown:u,getSizeDesc:p,getSizeText:d,initial_errors:y,initial_values:m,is_onscreen_keyboard_active:f,is_stop_button_visible:h,onChangeDropdownItem:g,onChangeInputValue:b,onHideDropdownList:v,onScrollStopDropdownList:k,validateQuickStrategy:E,symbol_dropdown:w,trade_type_dropdown:C,is_mobile:_,selected_symbol:T,selected_trade_type:B,selected_duration_unit:O,description:c,setCurrentFocus:S}))})))},St=function(e){var t=e.is_strategy_modal_open,o=e.is_mobile,n=e.toggleStrategyModal;return l.createElement(l.Fragment,null,o?l.createElement(c.MobileFullPageModal,{is_modal_open:t,className:"quick-strategy__wrapper",header:(0,B.localize)("Quick Strategy"),onClickClose:n,height_offset:"80px",page_overlay:!0},l.createElement(Bt,e)):l.createElement(c.Modal,{title:(0,B.localize)("Quick strategy"),className:"modal--strategy",is_open:t,toggleModal:n,width:"540px"},l.createElement("div",{className:"modal__content"},l.createElement(Bt,e))))};St.propTypes={active_index:d().number,createStrategy:d().func,duration_unit_dropdown:d().array,getSizeDesc:d().func,getSizeText:d().func,initial_errors:d().object,initial_values:d().object,is_mobile:d().bool,is_stop_button_visible:d().bool,is_strategy_modal_open:d().bool,onChangeDropdownItem:d().func,onChangeInputValue:d().func,onChangeSymbolInput:d().func,onHideDropdownList:d().func,onScrollStopDropdownList:d().func,setActiveTabIndex:d().func,setCurrentFocus:d().func,selected_symbol:d().oneOfType([d().string,d().object]),selected_trade_type:d().oneOfType([d().string,d().object]),selected_duration_unit:d().oneOfType([d().string,d().object]),symbol_dropdown:d().array,toggleStrategyModal:d().func,trade_type_dropdown:d().array,validateQuickStrategy:d().func};const Ot=b((function(e){var t=e.run_panel,o=e.quick_strategy,n=e.ui;return{active_index:o.active_index,createStrategy:o.createStrategy,duration_unit_dropdown:o.duration_unit_dropdown,getSizeDesc:o.getSizeDesc,getSizeText:o.getSizeText,initial_errors:o.initial_errors,initial_values:o.initial_values,is_onscreen_keyboard_active:n.is_onscreen_keyboard_active,is_mobile:n.is_mobile,is_stop_button_visible:t.is_stop_button_visible,is_strategy_modal_open:o.is_strategy_modal_open,onChangeDropdownItem:o.onChangeDropdownItem,onChangeInputValue:o.onChangeInputValue,onChangeSymbolInput:o.onChangeSymbolInput,onHideDropdownList:o.onHideDropdownList,onScrollStopDropdownList:o.onScrollStopDropdownList,setActiveTabIndex:o.setActiveTabIndex,selected_symbol:o.selected_symbol,selected_trade_type:o.selected_trade_type,selected_duration_unit:o.selected_duration_unit,symbol_dropdown:o.symbol_dropdown,toggleStrategyModal:o.toggleStrategyModal,trade_type_dropdown:o.trade_type_dropdown,validateQuickStrategy:o.validateQuickStrategy,setCurrentFocus:n.setCurrentFocus}}))(St),wt=b((function(e){var t=e.route_prompt_dialog;return{continueRoute:t.continueRoute,should_show:t.should_show,is_confirmed:t.is_confirmed,last_location:t.last_location,onCancel:t.onCancel,onConfirm:t.onConfirm}}))((function(e){var t=e.continueRoute,o=e.is_confirmed,n=e.last_location,r=e.should_show,i=e.onCancel,a=e.onConfirm;return l.useEffect(t,[o,n,t]),l.createElement(c.Dialog,{title:(0,B.localize)("Leaving already?"),confirm_button_text:(0,B.localize)("Yes, I'll come back later"),cancel_button_text:(0,B.localize)("No, I'll stay"),onConfirm:a,onCancel:i,is_visible:r},l.createElement(B.Localize,{i18n_default_text:"If you leave, your current contract will be completed, but your bot will stop running immediately."}))}));var Ct=function(e){var t=e.contract_update,o=e.limit_order,n=(0,_e.getLimitOrderAmount)(o||t),r=n.stop_loss,i=n.take_profit;return{contract_update_stop_loss:r?Math.abs(r).toString():"",contract_update_take_profit:i?i.toString():"",has_contract_update_stop_loss:!!r,has_contract_update_take_profit:!!i}},At=b((function(e,t){!function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(e);var o=t.contract,n=void 0===o?{}:o;return{validation_errors:n.validation_errors,contract_update_take_profit:n.contract_update_take_profit,contract_update_stop_loss:n.contract_update_stop_loss,has_contract_update_take_profit:n.has_contract_update_take_profit,has_contract_update_stop_loss:n.has_contract_update_stop_loss}}));function It(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Rt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var Dt=function(){return{APPLY:(0,B.localize)("Apply"),STAKE:(0,B.localize)("Stake:"),CLOSE:(0,B.localize)("Close"),CANCEL:(0,B.localize)("Cancel"),CURRENT_STAKE:(0,B.localize)("Current stake:"),DEAL_CANCEL_FEE:(0,B.localize)("Deal cancel. fee:"),TAKE_PROFIT:(0,B.localize)("Take profit:"),BUY_PRICE:(0,B.localize)("Buy price:"),STOP_LOSS:(0,B.localize)("Stop loss:"),TOTAL_PROFIT_LOSS:(0,B.localize)("Total profit/loss:"),PROFIT_LOSS:(0,B.localize)("Profit/Loss:"),POTENTIAL_PROFIT_LOSS:(0,B.localize)("Potential profit/loss:"),INDICATIVE_PRICE:(0,B.localize)("Indicative price:"),PAYOUT:(0,B.localize)("Sell Price:"),PURCHASE_PRICE:(0,B.localize)("Buy price:"),POTENTIAL_PAYOUT:(0,B.localize)("Payout limit:"),TICK:(0,B.localize)("Tick "),WON:(0,B.localize)("Won"),LOST:(0,B.localize)("Lost"),DAYS:(0,B.localize)("Days"),DAY:(0,B.localize)("Day"),SELL:(0,B.localize)("Sell"),INCREMENT_VALUE:(0,B.localize)("Increment value"),DECREMENT_VALUE:(0,B.localize)("Decrement value"),TAKE_PROFIT_LOSS_NOT_AVAILABLE:(0,B.localize)("Take profit and/or stop loss are not available while deal cancellation is active."),DONT_SHOW_THIS_AGAIN:(0,B.localize)("Don't show this again"),RESALE_NOT_OFFERED:(0,B.localize)("Resale not offered"),NOT_AVAILABLE:(0,B.localize)("N/A")}},xt=function(e){return function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?It(Object(o),!0).forEach((function(t){Rt(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):It(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({},function(e){return{ASIANU:{name:(0,B.localize)("Asian Up"),position:"top"},ASIAND:{name:(0,B.localize)("Asian Down"),position:"bottom"},CALL:{name:e?(0,B.localize)("Higher"):(0,B.localize)("Rise"),position:"top"},PUT:{name:e?(0,B.localize)("Lower"):(0,B.localize)("Fall"),position:"bottom"},CALLE:{name:(0,B.localize)("Rise"),position:"top"},PUTE:{name:(0,B.localize)("Fall"),position:"bottom"},CALLSPREAD:{name:(0,B.localize)("Spread Up"),position:"top"},PUTSPREAD:{name:(0,B.localize)("Spread Down"),position:"bottom"},DIGITMATCH:{name:(0,B.localize)("Matches"),position:"top"},DIGITDIFF:{name:(0,B.localize)("Differs"),position:"bottom"},DIGITEVEN:{name:(0,B.localize)("Even"),position:"top"},DIGITODD:{name:(0,B.localize)("Odd"),position:"bottom"},DIGITOVER:{name:(0,B.localize)("Over"),position:"top"},DIGITUNDER:{name:(0,B.localize)("Under"),position:"bottom"},EXPIRYMISS:{name:(0,B.localize)("Ends Outside"),position:"top"},EXPIRYRANGE:{name:(0,B.localize)("Ends Between"),position:"bottom"},LBFLOATCALL:{name:(0,B.localize)("Close-to-Low"),position:"top"},LBFLOATPUT:{name:(0,B.localize)("High-to-Close"),position:"top"},LBHIGHLOW:{name:(0,B.localize)("High-to-Low"),position:"top"},MULTUP:{name:(0,B.localize)("Up"),position:"top"},MULTDOWN:{name:(0,B.localize)("Down"),position:"bottom"},ONETOUCH:{name:(0,B.localize)("Touch"),position:"top"},NOTOUCH:{name:(0,B.localize)("No Touch"),position:"bottom"},RANGE:{name:(0,B.localize)("Stays Between"),position:"top"},UPORDOWN:{name:(0,B.localize)("Goes Outside"),position:"bottom"},RESETCALL:{name:(0,B.localize)("Reset Call"),position:"top"},RESETPUT:{name:(0,B.localize)("Reset Put"),position:"bottom"},RUNHIGH:{name:(0,B.localize)("Only Ups"),position:"top"},RUNLOW:{name:(0,B.localize)("Only Downs"),position:"bottom"},TICKHIGH:{name:(0,B.localize)("High Tick"),position:"top"},TICKLOW:{name:(0,B.localize)("Low Tick"),position:"bottom"}}}(e))},Pt=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return xt(t)[e]?xt(t)[e.toUpperCase()].name:""},Nt=function(e){var t=e.addToast,o=e.contract_info,n=e.contract_store,r=e.current_focus,i=e.is_contract_completed,a=e.is_contract_loading,s=e.is_contract_inactive,u=e.is_mobile,p=e.is_multiplier,d=e.onClickSell,y=e.is_sell_requested,m=e.removeToast,f=e.server_time,_=e.setCurrentFocus,h=l.createElement(c.ContractCard.Header,{contract_info:o,getCardLabels:Dt,getContractTypeDisplay:Pt,has_progress_slider:!p,is_mobile:u,is_sold:i,server_time:f}),g=l.createElement(c.ContractCard.Body,{addToast:t,connectWithContractUpdate:At,contract_info:o,currency:o&&o.currency,current_focus:r,error_message_alignment:"left",getCardLabels:Dt,getContractById:function(){return n},is_mobile:u,is_multiplier:p,is_sold:i,removeToast:m,server_time:f,setCurrentFocus:_}),b=l.createElement(c.ContractCard.Footer,{contract_info:o,getCardLabels:Dt,is_multiplier:p,is_sell_requested:y,onClickSell:d}),v=l.createElement(l.Fragment,null,h,g,b);return l.createElement("div",{className:T()("db-summary-card",{"db-summary-card--mobile":u,"db-summary-card--inactive":s,"db-summary-card--is-loading":a,"db-summary-card--completed":i,"db-summary-card--completed-mobile":i&&u})},a&&l.createElement(z,{speed:2}),!a&&o&&l.createElement(c.ContractCard,{contract_info:o,getCardLabels:Dt,is_multiplier:p,profit_loss:o.profit,should_show_result_overlay:!0},l.createElement("div",{className:T()("dc-contract-card",{"dc-contract-card--green":o.profit>0,"dc-contract-card--red":o.profit<0})},v)),!a&&!o&&l.createElement(l.Fragment,null,(0,B.localize)("Build a bot from the start menu then hit the run button to run the bot.")))};Nt.propTypes={addToast:d().func,contract_info:d().object,contract_store:d().object,current_focus:d().object,is_contract_completed:d().bool,is_contract_inactive:d().bool,is_contract_loading:d().bool,is_mobile:d().bool,is_multiplier:d().bool,onClickSell:d().func,is_sell_requested:d().bool,removeToast:d().func,server_time:d().object,setCurrentFocus:d().func};const zt=b((function(e){var t=e.summary_card,o=e.common,n=e.run_panel,r=e.ui;return{addToast:r.addToast,contract_info:t.contract_info,contract_store:t,current_focus:r.current_focus,is_contract_completed:t.is_contract_completed,is_contract_inactive:t.is_contract_inactive,is_contract_loading:t.is_contract_loading,is_mobile:r.is_mobile,is_multiplier:t.is_multiplier,onClickSell:n.onClickSell,is_sell_requested:n.is_sell_requested,removeToast:r.removeToast,server_time:o.server_time,setCurrentFocus:r.setCurrentFocus}}))(Nt);var Lt=function(e){var t=e.is_mobile,o=e.is_drawer_open;return l.createElement("div",{className:T()({"run-panel-tab__content":!t,"run-panel-tab__content--mobile":t&&o})},l.createElement(c.ThemedScrollbars,{className:"summary"},l.createElement(zt,null)))};Lt.propTypes={is_mobile:d().bool,is_drawer_open:d().bool};const Mt=b((function(e){return{is_mobile:e.ui.is_mobile}}))(Lt);var Ft=Object.freeze({CONTRACT:"contract",DIVIDER:"divider"}),Ut=function(e){var t=e.icon,o=e.title,n=e.message,r=e.className;return l.createElement(l.Fragment,null,l.createElement(c.Popover,{className:T()(r,"transactions__icon"),alignment:"left",message:o,zIndex:ct.TRANSACTION},t),n)},jt=function(){return l.createElement(N.ZP,{className:"transactions__loader-text",height:10,width:80,speed:3,primaryColor:"var(--general-section-1)",secondaryColor:"var(--general-hover)"},l.createElement("rect",{x:"0",y:"0",rx:"0",ry:"0",width:"100",height:"12"}))},Vt=function(){return l.createElement(N.ZP,{className:"transactions__loader-icon",speed:3,width:24,height:24,primaryColor:"var(--general-section-1)",secondaryColor:"var(--general-hover)"},l.createElement("rect",{x:"0",y:"0",rx:"5",ry:"5",width:"24",height:"24"}))},Ht=function(e){var t=e.icon,o=e.title,n=e.children;return l.createElement("div",{className:"transactions__popover-item"},t&&l.createElement("div",{className:"transaction__popover-icon"},t),l.createElement("div",{className:"transactions__popover-details"},l.createElement("div",{className:"transactions__popover-title"},o),n))},Jt=function(e){var t=e.contract;return l.createElement("div",{className:"transactions__popover-content"},t.transaction_ids&&l.createElement(Ht,{title:(0,B.localize)("Reference IDs")},t.transaction_ids.buy&&l.createElement("div",{className:"transactions__popover-value"},"".concat(t.transaction_ids.buy," ").concat((0,B.localize)("(Buy)"))),t.transaction_ids.sell&&l.createElement("div",{className:"transactions__popover-value"},"".concat(t.transaction_ids.sell," ").concat((0,B.localize)("(Sell)")))),t.tick_count&&l.createElement(Ht,{title:(0,B.localize)("Duration")},l.createElement("div",{className:"transactions__popover-value"},"".concat(t.tick_count," ").concat((0,B.localize)("ticks")))),t.barrier&&l.createElement(Ht,{title:(0,B.localize)("Barrier")},l.createElement("div",{className:"transactions__popover-value"},t.barrier))||t.high_barrier&&t.low_barrier&&l.createElement(Ht,{title:(0,B.localize)("Barriers")},l.createElement("div",{className:"transactions__popover-value"},"".concat(t.high_barrier," ").concat((0,B.localize)("(High)"))),l.createElement("div",{className:"transactions__popover-value"},"".concat(t.low_barrier," ").concat((0,B.localize)("(Low)")))),t.date_start&&l.createElement(Ht,{title:(0,B.localize)("Start time")},l.createElement("div",{className:"transactions__popover-value"},(0,_e.convertDateFormat)(t.date_start,"YYYY-M-D HH:mm:ss [GMT]","YYYY-MM-DD HH:mm:ss [GMT]"))),t.entry_tick&&l.createElement(Ht,{title:(0,B.localize)("Entry spot")},l.createElement("div",{className:"transactions__popover-value"},t.entry_tick),t.entry_tick_time&&l.createElement("div",{className:"transactions__popover-value"},(0,_e.convertDateFormat)(t.entry_tick_time,"YYYY-M-D HH:mm:ss [GMT]","YYYY-MM-DD HH:mm:ss [GMT]"))),t.exit_tick&&t.exit_tick_time&&l.createElement(Ht,{title:(0,B.localize)("Exit spot")},l.createElement("div",{className:"transactions__popover-value"},t.exit_tick),l.createElement("div",{className:"transactions__popover-value"},(0,_e.convertDateFormat)(t.exit_tick_time,"YYYY-M-D HH:mm:ss [GMT]","YYYY-MM-DD HH:mm:ss [GMT]")))||t.exit_tick&&l.createElement(Ht,{title:(0,B.localize)("Exit time")},l.createElement("div",{className:"transactions__popover-value"},t.exit_tick)))},Gt=function(e){var t=e.active_transaction_id,o=e.contract,n=e.setActiveTransactionId;return l.createElement(c.Popover,{zIndex:ct.TRANSACTION,alignment:"left",className:"transactions__item-wrapper",is_open:o&&t===o.transaction_ids.buy,message:o&&l.createElement(Jt,{contract:o})},l.createElement("div",{className:"transactions__item",onClick:o&&function(){return n(o.transaction_ids.buy)}},l.createElement("div",{className:"transactions__cell transactions__trade-type"},l.createElement("div",{className:"transactions__loader-container"},o?l.createElement(Ut,{icon:l.createElement(c.Icon,{icon:"IcUnderlying".concat(o.underlying),size:16}),title:o.display_name}):l.createElement(Vt,null)),l.createElement("div",{className:"transactions__loader-container"},o?l.createElement(Ut,{icon:l.createElement(c.IconTradeTypes,{type:o.contract_type,size:16}),title:(0,s.getContractTypeName)(o)}):l.createElement(Vt,null))),l.createElement("div",{className:"transactions__cell transactions__entry-spot"},l.createElement(Ut,{icon:l.createElement(c.Icon,{icon:"IcContractEntrySpot"}),title:(0,B.localize)("Entry spot"),message:o&&o.entry_tick||l.createElement(jt,null)})),l.createElement("div",{className:"transactions__cell transactions__exit-spot"},l.createElement(Ut,{icon:l.createElement(c.Icon,{icon:"IcContractExitSpot"}),title:(0,B.localize)("Exit spot"),message:o&&o.exit_tick||l.createElement(jt,null)})),l.createElement("div",{className:"transactions__cell transactions__stake"},o?l.createElement(c.Money,{amount:o.buy_price,currency:o.currency,show_currency:!0}):l.createElement(jt,null)),l.createElement("div",{className:"transactions__cell transactions__profit"},null!=o&&o.is_completed?l.createElement("div",{className:T()({"transactions__profit--win":o.profit>=0,"transactions__profit--loss":o.profit<0})},l.createElement(c.Money,{amount:Math.abs(o.profit),currency:o.currency,show_currency:!0})):l.createElement(jt,null))))};Gt.propTypes={active_transaction_id:d().number,contract:d().object,setActiveTransactionId:d().func};const Wt=b((function(e){var t=e.transactions;return{active_transaction_id:t.active_transaction_id,setActiveTransactionId:t.setActiveTransactionId}}))(Gt);var Yt=function(e){var t=e.row,o=e.is_new_row,n=(0,_e.useNewRowTransition)(o).in_prop;switch(t.type){case Ft.CONTRACT:var r=t.data;return l.createElement(fe.Z,{in:n,timeout:500,classNames:"list__animation"},l.createElement(Wt,{contract:r}));case Ft.DIVIDER:return l.createElement("div",{className:"transactions__divider"},l.createElement("div",{className:"transactions__divider-line"}));default:return null}},qt=function(e){var t=e.contract_stage,o=e.elements,n=e.is_drawer_open,r=e.is_mobile,i=e.onMount,a=e.onUnmount;return l.useEffect((function(){return i(),function(){return a()}}),[i,a]),l.createElement("div",{className:T()("transactions",{"run-panel-tab__content":!r,"run-panel-tab__content--mobile":r&&n})},l.createElement(c.DesktopWrapper,null,l.createElement("div",{className:"download__container"},l.createElement(U,{tab:"transactions"}))),l.createElement("div",{className:"transactions__header"},l.createElement("span",{className:"transactions__header-column transactions__header-type"},(0,B.localize)("Type")),l.createElement("span",{className:"transactions__header-column transactions__header-spot"},(0,B.localize)("Entry/Exit spot")),l.createElement("span",{className:"transactions__header-column transactions__header-profit"},(0,B.localize)("Buy price and P/L"))),l.createElement("div",{className:T()({transactions__content:!r,"transactions__content--mobile":r})},l.createElement("div",{className:"transactions__scrollbar"},o.length?l.createElement(c.DataList,{className:"transactions",data_source:o,rowRenderer:function(e){return l.createElement(Yt,e)},keyMapper:function(e){switch(e.type){case Ft.CONTRACT:return e.data.transaction_ids.buy;case Ft.DIVIDER:return e.data;default:return null}},getRowSize:function(e){var t=e.index;switch(o[t].type){case Ft.CONTRACT:return 50;case Ft.DIVIDER:return 21;default:return 0}}}):l.createElement(l.Fragment,null,t>=ge.STARTING?l.createElement(Wt,{contract:null}):l.createElement(c.ThemedScrollbars,null,l.createElement("div",{className:"transactions-empty-box"},l.createElement("div",{className:"transactions-empty"},l.createElement("div",{className:"transactions-empty__icon-box"},l.createElement(c.Icon,{icon:"IcBox",className:"transactions-empty__icon",size:64,color:"secondary"})),l.createElement(c.Text,{as:"h4",size:"xs",weight:"bold",align:"center",color:"less-prominent",line_height:"xxs",className:"transactions-empty__header"},(0,B.localize)("There are no transactions to display")),l.createElement("div",{className:"transactions-empty__message"},l.createElement(c.Text,{size:"xxs",color:"less-prominent"},(0,B.localize)("Here are the possible reasons:")),l.createElement("ul",{className:"transactions-empty__list"},l.createElement("li",null,(0,B.localize)("The bot is not running")),l.createElement("li",null,(0,B.localize)("The stats are cleared")))))))))))};qt.propTypes={contract_stage:p.PropTypes.number,elements:p.PropTypes.array,is_drawer_open:p.PropTypes.bool,is_mobile:p.PropTypes.bool,onMount:p.PropTypes.func,onUnmount:p.PropTypes.func};const Kt=b((function(e){var t=e.transactions,o=e.run_panel,n=e.ui;return{contract_stage:o.contract_stage,elements:t.elements,is_mobile:n.is_mobile,onMount:t.onMount,onUnmount:t.onUnmount}}))(qt);function Xt(){return Xt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Xt.apply(this,arguments)}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var Qt=function(e){var t=e.className;return l.createElement("div",{className:T()("circular-wrapper",t)},l.createElement("span",{className:"static-circle"}),l.createElement("span",{className:"dynamic-circle"}))},$t=function(e){var t=e.toggleAnimationInfoModal;return l.createElement("div",{className:"animation__info",onClick:t},l.createElement(c.Icon,{icon:"IcInfoOutline",id:"db-animation__clear-stat"}))},eo=function(e){var t=e.is_mobile,o=e.is_animation_info_modal_open,n=e.toggleAnimationInfoModal;return l.createElement(c.Modal,{className:T()("animation__modal",{"animation__modal--mobile":t}),title:(0,B.localize)("Stopping the bot is risky"),is_open:o,toggleModal:n,width:"440px"},l.createElement(c.Modal.Body,null,l.createElement("div",{className:T()({"animation__modal-body--mobile":t})},l.createElement(c.Text,{as:"p"},(0,B.localize)("Stopping the bot will prevent further trades. Any ongoing trades will be completed by our system.")),l.createElement(c.Text,{as:"p",className:"animation__modal-body--content"},(0,B.localize)("Please be aware that some completed transactions may not be displayed in the transaction table if the bot is stopped while placing trades.")),l.createElement(c.Text,{as:"p",className:"animation__modal-body--content"},(0,B.localize)("You may refer to the statement page for details of all completed transactions.")))))},to=function(e){switch(e.contract_stage){case ge.NOT_RUNNING:default:return l.createElement(B.Localize,{i18n_default_text:"Bot is not running"});case ge.STARTING:return l.createElement(B.Localize,{i18n_default_text:"Bot is starting"});case ge.PURCHASE_SENT:return l.createElement(B.Localize,{i18n_default_text:"Buying contract"});case ge.PURCHASE_RECEIVED:return l.createElement(B.Localize,{i18n_default_text:"Contract bought"});case ge.IS_STOPPING:return l.createElement(B.Localize,{i18n_default_text:"Bot is stopping"});case ge.CONTRACT_CLOSED:return l.createElement(B.Localize,{i18n_default_text:"Contract closed"})}},oo=function(e){var t=e.className,o=e.contract_stage,n=e.is_animation_info_modal_open,r=e.is_contract_completed,i=e.is_mobile,a=e.is_stop_button_visible,s=e.is_stop_button_disabled,u=e.profit,p=e.should_show_overlay,d=e.onRunButtonClick,y=e.onStopButtonClick,m=e.info_direction,f=e.toggleAnimationInfoModal,_=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(e)||function(e,t){if(e){if("string"==typeof e)return Zt(e,2);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Zt(e,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(l.useState(!1)),h=_[0],g=_[1];l.useEffect((function(){h&&setTimeout((function(){g(!1)}),1e3)}),[h]);var b=["","",""],v=o-(o===ge.PURCHASE_SENT||o===ge.PURCHASE_RECEIVED?2:3);if(v>=0){v<b.length&&(b[v]="active"),r&&(v+=1);for(var k=0;k<v;k++)b[k]="completed"}return l.createElement("div",{className:T()("animation__wrapper",t)},"left"===m&&l.createElement($t,{toggleAnimationInfoModal:f}),l.createElement(c.Button,Xt({is_disabled:s||h,className:"animation__button",id:a?"db-animation__stop-button":"db-animation__run-button",text:a?(0,B.localize)("Stop"):(0,B.localize)("Run"),icon:l.createElement(c.Icon,{icon:a?"IcPause":"IcPlay",color:"active"}),onClick:function(){g(!0),a?y():d()},has_effect:!0},a?{primary:!0}:{green:!0})),l.createElement("div",{className:T()("animation__container",t,{"animation--running":o>0,"animation--completed":p&&r})},p&&r&&l.createElement(M,{profit:u}),l.createElement("span",{className:"animation__text"},l.createElement(to,{contract_stage:o})),l.createElement("div",{className:"animation__progress"},l.createElement("div",{className:"animation__progress-line"},l.createElement("div",{className:"animation__progress-bar animation__progress-".concat(o)})),b.map((function(e,t){return l.createElement(Qt,{key:t,className:e})})))),"right"===m&&l.createElement($t,{toggleAnimationInfoModal:f}),l.createElement(eo,{is_mobile:i,is_animation_info_modal_open:n,toggleAnimationInfoModal:f}))};oo.propTypes={className:d().string,contract_stage:d().number,is_animation_info_modal_open:d().bool,is_contract_completed:d().bool,is_stop_button_visible:d().bool,is_stop_button_disabled:d().bool,onRunButtonClick:d().func,onStopButtonClick:d().func,profit:d().number,should_show_overlay:d().bool};const no=b((function(e){var t=e.summary_card,o=e.run_panel,n=e.toolbar,r=e.ui;return{contract_stage:o.contract_stage,is_animation_info_modal_open:n.is_animation_info_modal_open,is_contract_completed:t.is_contract_completed,is_mobile:r.is_mobile,is_stop_button_visible:o.is_stop_button_visible,is_stop_button_disabled:o.is_stop_button_disabled,onRunButtonClick:o.onRunButtonClick,onStopButtonClick:o.onStopButtonClick,profit:t.profit,should_show_overlay:o.should_show_overlay,toggleAnimationInfoModal:n.toggleAnimationInfoModal}}))(oo),ro=no;function io(){return io=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},io.apply(this,arguments)}function ao(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function lo(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var co=function(e){var t,o=(2,function(e){if(Array.isArray(e))return e}(t=l.useState(""))||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(t)||function(e,t){if(e){if("string"==typeof e)return lo(e,2);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?lo(e,2):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=o[0],r=o[1],i=e.is_mobile,a=e.is_onscreen_keyboard_active,s=e.is_logged_in,u=e.initial_values,p=e.api_max_losses,d=e.onRunButtonClick,y=e.resetSelfExclusion,m=e.updateSelfExclusion,f=e.setRunLimit,_=e.reality_check_is_visible;l.useEffect((function(){!_&&s||y()}));var h=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.form_max_losses===p){e.next=7;break}return e.next=3,m({max_losses:t.form_max_losses});case 3:if(null==(o=e.sent)||!o.error){e.next=7;break}return r((0,B.localize)(o.error.message)),e.abrupt("return");case 7:f(t.run_limit),d();case 9:case"end":return e.stop()}}),e)})),function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){ao(i,n,r,a,l,"next",e)}function l(e){ao(i,n,r,a,l,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();return l.createElement("div",{className:"db-self-exclusion"},l.createElement("div",{className:"db-self-exclusion__content"},l.createElement("div",{className:"db-self-exclusion__info"},(0,B.localize)("Enter limits to stop your bot from trading when any of these conditions are met.")),l.createElement(Ke.Formik,{initialValues:u,validate:function(e){var t={},o=/^\d+(\.\d+)?$/,n=/^\d+$/,i=(0,B.localize)("This field is required."),a=(0,B.localize)("Should be a valid number"),l=(0,B.localize)("Reached maximum number of digits"),c=(0,B.localize)("Reached maximum number of decimals"),s=(0,B.localize)("Please enter a number between 0 and {{api_max_losses}}.",{api_max_losses:p});return["run_limit","form_max_losses"].forEach((function(o){e[o]||(t[o]=i)})),["run_limit","form_max_losses"].forEach((function(n){e[n]&&(o.test(e[n])?+e[n]>9999999999999&&(t[n]=l):t[n]=a)})),["run_limit"].forEach((function(o){e[o]&&(n.test(e[o])||(t[o]=a))})),["form_max_losses"].forEach((function(o){var n=e[o].toString().split(".")[1];(n&&n.length||0)>2&&(t[o]=c)})),["form_max_losses"].forEach((function(o){0!==p&&p!==e[o]&&p<e[o]?t[o]=s:r("")})),t},onSubmit:h},(function(e){var t=e.values,o=e.touched,r=e.errors,s=e.isValid,u=e.handleChange;return l.createElement(Ke.Form,null,l.createElement("div",{className:"db-self-exclusion__form-group"},l.createElement(Ke.Field,{name:"form_max_losses"},(function(e){var i=e.field;return l.createElement(c.Input,io({},i,{className:"db-self-exclusion__input",type:"text",label:(0,B.localize)("Daily loss limit"),value:t.form_max_losses,onChange:u,error:n||o[i.name]&&r[i.name],hint:(0,B.localize)("Limits your potential losses for the day across all Deriv platforms.")}))}))),l.createElement("div",{className:"db-self-exclusion__form-group"},l.createElement(Ke.Field,{name:"run_limit"},(function(e){var n=e.field;return l.createElement(c.Input,io({},n,{className:"db-self-exclusion__input",type:"text",label:(0,B.localize)("Maximum consecutive trades"),value:t.run_limit,onChange:u,error:o[n.name]&&r.run_limit,hint:(0,B.localize)("Maximum number of trades your bot will execute for this run.")}))}))),l.createElement("div",{className:T()("db-self-exclusion__footer",{"db-self-exclusion__footer--relative":i&&a})},l.createElement("div",{className:"db-self-exclusion__footer-btn-group"},l.createElement(c.Button,{large:!0,text:(0,B.localize)("Cancel"),onClick:y,secondary:!0,type:"button"}),l.createElement(c.Button,{type:"submit",large:!0,text:(0,B.localize)("Apply and run"),is_disabled:!s||!t.run_limit||!t.form_max_losses||""!==n,primary:!0}))))}))))},so=function(e){var t=e.is_restricted,o=e.resetSelfExclusion,n=e.is_mobile;return l.createElement(l.Fragment,null,n?l.createElement(c.FadeWrapper,{is_visible:t,className:"limits__wrapper",keyname:"limitis__wrapper"},l.createElement(c.PageOverlay,{header:(0,B.localize)("Limits"),onClickClose:o},l.createElement(c.MobileWrapper,null,l.createElement(c.Div100vhContainer,{className:"limits__wrapper--is-mobile"},l.createElement(co,e))))):l.createElement(c.Modal,{is_open:t,has_close_icon:!0,width:"440px",height:"374px",toggleModal:o,className:"db-self-exclusion__modal",title:(0,B.localize)("Limits")},l.createElement(co,e)))};so.propTypes={is_onscreen_keyboard_active:d().bool,is_mobile:d().bool,is_logged_in:d().bool,is_restricted:d().bool,initial_values:d().object,api_max_losses:d().number,run_limit:d().PropTypes.number,resetSelfExclusion:d().func,reality_check_is_visible:d().bool,setRunLimit:d().func,updateSelfExclusion:d().func,virtual_account_loginid:d().string};const uo=b((function(e){var t=e.client,o=e.self_exclusion,n=e.ui;return{initial_values:o.initial_values,is_onscreen_keyboard_active:n.is_onscreen_keyboard_active,is_mobile:n.is_mobile,is_logged_in:t.is_logged_in,is_restricted:o.is_restricted,api_max_losses:o.api_max_losses,run_limit:o.run_limit,resetSelfExclusion:o.resetSelfExclusion,reality_check_is_visible:t.is_reality_check_visible,setRunLimit:o.setRunLimit,updateSelfExclusion:t.updateSelfExclusion,virtual_account_loginid:t.virtual_account_loginid}}))(so);var po=["active_index","is_drawer_open","setActiveTabIndex"],yo=function(e){var t=e.content,o=e.contentClassName,n=e.title;return l.createElement("div",{className:"run-panel__tile"},l.createElement("div",{className:"run-panel__tile-title"},n),l.createElement("div",{className:T()("run-panel__tile-content",o)},t))},mo=function(e){var t=e.currency,o=e.is_mobile,n=e.lost_contracts,r=e.number_of_runs,i=e.total_stake,a=e.total_payout,s=e.toggleStatisticsInfoModal,u=e.total_profit,p=e.won_contracts;return l.createElement("div",{className:T()("run-panel__stat",{"run-panel__stat--mobile":o})},l.createElement("div",{className:"run-panel__stat--info",onClick:s},l.createElement("div",{className:"run-panel__stat--info-item"},l.createElement(B.Localize,{i18n_default_text:"What's this?"}))),l.createElement("div",{className:"run-panel__stat--tiles"},l.createElement(yo,{title:(0,B.localize)("Total stake"),alignment:"top",content:l.createElement(c.Money,{amount:i,currency:t,show_currency:!0})}),l.createElement(yo,{title:(0,B.localize)("Total payout"),alignment:"top",content:l.createElement(c.Money,{amount:a,currency:t,show_currency:!0})}),l.createElement(yo,{title:(0,B.localize)("No. of runs"),alignment:"top",content:r}),l.createElement(yo,{title:(0,B.localize)("Contracts lost"),alignment:"bottom",content:n}),l.createElement(yo,{title:(0,B.localize)("Contracts won"),alignment:"bottom",content:p}),l.createElement(yo,{title:(0,B.localize)("Total profit/loss"),content:l.createElement(c.Money,{amount:u,currency:t,has_sign:!0,show_currency:!0}),alignment:"bottom",contentClassName:T()("run-panel__stat-amount",{"run-panel__stat-amount--positive":u>0,"run-panel__stat-amount--negative":u<0})})))},fo=function(e){var t=e.is_clear_stat_disabled,o=e.is_mobile,n=e.is_drawer_open,r=e.onClearStatClick;return o&&n&&l.createElement(c.Button,{id:"db-run-panel__clear-button",className:"run-panel__clear-button",is_disabled:t,text:(0,B.localize)("Reset"),onClick:r,secondary:!0})},_o=function(e){var t=e.active_index,o=e.is_drawer_open,n=e.setActiveTabIndex,r=function(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}(e,po);return l.createElement(l.Fragment,null,l.createElement(c.Tabs,{active_index:t,onTabItemClick:n,top:!0},l.createElement("div",{id:"db-run-panel-tab__summary",label:(0,B.localize)("Summary")},l.createElement(Mt,{is_drawer_open:o})),l.createElement("div",{id:"db-run-panel-tab__transactions",label:(0,B.localize)("Transactions")},l.createElement(Kt,{is_drawer_open:o})),l.createElement("div",{id:"db-run-panel-tab__journal",label:(0,B.localize)("Journal")},l.createElement(we,{is_drawer_open:o}))),o&&2!==t&&l.createElement(mo,r))},ho=function(e){var t=e.is_clear_stat_disabled,o=e.onClearStatClick;return l.createElement("div",{className:"run-panel__footer"},l.createElement(c.Button,{id:"db-run-panel__clear-button",className:"run-panel__footer-button",is_disabled:t,text:(0,B.localize)("Reset"),onClick:o,has_effect:!0,secondary:!0}))},go=function(){return l.createElement("div",{className:"controls__section"},l.createElement("div",{className:"controls__buttons"},l.createElement(ro,{className:"controls__animation",should_show_overlay:!0,info_direction:"right"})))},bo=function(e){var t=e.is_mobile,o=e.is_statistics_info_modal_open,n=e.toggleStatisticsInfoModal;return l.createElement(c.Modal,{className:T()("statistics__modal",{"statistics__modal--mobile":t}),title:(0,B.localize)("What's this?"),is_open:o,toggleModal:n,width:"440px"},l.createElement(c.Modal.Body,null,l.createElement("div",{className:T()("statistics__modal-body",{"statistics__modal-body--mobile":t})},l.createElement(c.ThemedScrollbars,{className:"statistics__modal-scrollbar"},l.createElement(c.Text,{as:"p",weight:"bold",className:"statistics__modal-body--content no-margin"},(0,B.localize)("Total stake")),l.createElement(c.Text,{as:"p"},(0,B.localize)("Total stake since you last cleared your stats.")),l.createElement(c.Text,{as:"p",weight:"bold",className:"statistics__modal-body--content"},(0,B.localize)("Total payout")),l.createElement(c.Text,{as:"p"},(0,B.localize)("Total payout since you last cleared your stats.")),l.createElement(c.Text,{as:"p",weight:"bold",className:"statistics__modal-body--content"},(0,B.localize)("No. of runs")),l.createElement(c.Text,{as:"p"},(0,B.localize)("The number of times your bot has run since you last cleared your stats. Each run includes the execution of all the root blocks.")),l.createElement(c.Text,{as:"p",weight:"bold",className:"statistics__modal-body--content"},(0,B.localize)("Contracts lost")),l.createElement(c.Text,{as:"p"},(0,B.localize)("The number of contracts you have lost since you last cleared your stats.")),l.createElement(c.Text,{as:"p",weight:"bold",className:"statistics__modal-body--content"},(0,B.localize)("Contracts won")),l.createElement(c.Text,{as:"p"},(0,B.localize)("The number of contracts you have won since you last cleared your stats.")),l.createElement(c.Text,{as:"p",weight:"bold",className:"statistics__modal-body--content"},(0,B.localize)("Total profit/loss")),l.createElement(c.Text,{as:"p"},(0,B.localize)("Your total profit/loss since you last cleared your stats. It is the difference between your total payout and your total stake."))))))},vo=function(e){var t=e.active_index,o=e.currency,n=e.dialog_options,r=e.is_clear_stat_disabled,i=e.is_dialog_open,a=e.is_drawer_open,s=e.is_mobile,u=e.is_statistics_info_modal_open,p=e.lost_contracts,d=e.number_of_runs,y=e.onCancelButtonClick,m=e.onClearStatClick,f=e.onCloseDialog,_=e.onMount,h=e.onOkButtonClick,g=e.onRunButtonClick,b=e.onUnmount,v=e.setActiveTabIndex,k=e.toggleDrawer,E=e.toggleStatisticsInfoModal,T=e.total_payout,S=e.total_profit,O=e.total_stake,w=e.won_contracts;l.useEffect((function(){return _(),function(){return b()}}),[_,b]);var C=l.createElement(_o,{active_index:t,currency:o,is_drawer_open:a,is_mobile:s,lost_contracts:p,number_of_runs:d,setActiveTabIndex:v,toggleStatisticsInfoModal:E,total_payout:T,total_profit:S,total_stake:O,won_contracts:w}),A=l.createElement(ho,{is_clear_stat_disabled:r,onClearStatClick:m}),I=l.createElement(fo,{is_clear_stat_disabled:r,is_mobile:s,is_drawer_open:a,onClearStatClick:m});return l.createElement(l.Fragment,null,l.createElement("div",{className:s&&a?"run-panel__container--mobile":void 0},l.createElement(c.Drawer,{anchor:"right",className:s?void 0:"run-panel__container",contentClassName:"run-panel__content",header:I,footer:!s&&A,is_open:a,toggleDrawer:k,width:366,zIndex:ct.RUN_PANEL},C),s&&l.createElement(go,null)),l.createElement(c.Dialog,{title:n.title,is_visible:i,cancel_button_text:n.cancel_button_text||(0,B.localize)("Cancel"),onCancel:y,confirm_button_text:n.ok_button_text||(0,B.localize)("OK"),onConfirm:h||f,is_mobile_full_width:!1,className:"dc-dialog__wrapper--fixed",has_close_icon:!0,onClose:f},n.message),l.createElement(uo,{onRunButtonClick:g}),l.createElement(bo,{is_mobile:s,is_statistics_info_modal_open:u,toggleStatisticsInfoModal:E}))};vo.propTypes={active_index:d().number,currency:d().string,dialog_options:d().object,is_clear_stat_disabled:d().bool,is_dialog_open:d().bool,is_drawer_open:d().bool,is_mobile:d().bool,is_statistics_info_modal_open:d().bool,lost_contracts:d().number,number_of_runs:d().number,onCancelButtonClick:d().func,onClearStatClick:d().func,onCloseDialog:d().func,onMount:d().func,onOkButtonClick:d().func,onRunButtonClick:d().func,onUnmount:d().func,setActiveTabIndex:d().func,toggleDrawer:d().func,toggleStatisticsInfoModal:d().func,total_payout:d().number,total_profit:d().number,total_stake:d().number,won_contracts:d().number};const ko=b((function(e){var t=e.run_panel,o=e.core,n=e.ui;return{active_index:t.active_index,currency:o.client.currency,dialog_options:t.dialog_options,is_clear_stat_disabled:t.is_clear_stat_disabled,is_dialog_open:t.is_dialog_open,is_drawer_open:t.is_drawer_open,is_mobile:n.is_mobile,is_statistics_info_modal_open:t.is_statistics_info_modal_open,lost_contracts:t.statistics.lost_contracts,number_of_runs:t.statistics.number_of_runs,onCancelButtonClick:t.onCancelButtonClick,onClearStatClick:t.onClearStatClick,onCloseDialog:t.onCloseDialog,onMount:t.onMount,onOkButtonClick:t.onOkButtonClick,onRunButtonClick:t.onRunButtonClick,onUnmount:t.onUnmount,setActiveTabIndex:t.setActiveTabIndex,toggleDrawer:t.toggleDrawer,toggleStatisticsInfoModal:t.toggleStatisticsInfoModal,total_payout:t.statistics.total_payout,total_profit:t.statistics.total_profit,total_stake:t.statistics.total_stake,won_contracts:t.statistics.won_contracts}}))(vo);function Eo(){return Eo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Eo.apply(this,arguments)}var To=function(e){var t=e.bot_name,o=e.button_status,n=e.is_authorised,r=e.onConfirmSave,i=e.onDriveConnect,a=e.validateBotName,u=e.toggleSaveModal,p=e.is_mobile,d=e.is_onscreen_keyboard_active,y=e.setCurrentFocus;return l.createElement(Ke.Formik,{initialValues:{is_local:!0,save_as_collection:!1,bot_name:t===s.config.default_file_name?"":t},validate:a,onSubmit:r},(function(e){var t=e.values,r=t.is_local,a=t.save_as_collection,m=e.setFieldValue,f=e.touched,_=e.errors,h=p?"calc(100%)":"500px";return l.createElement(c.ThemedScrollbars,{height:h,autohide:!0},l.createElement(Ke.Form,{className:T()({"form--active-keyboard":d})},l.createElement("div",{className:"modal__content"},l.createElement("div",{className:"modal__content-row"},l.createElement(Ke.Field,{name:"bot_name"},(function(e){var t=e.field;return l.createElement(c.Input,Eo({},t,{className:"save-type__input",type:"text",placeholder:(0,B.localize)("Untitled Strategy"),error:f[t.name]&&_[t.name],label:(0,B.localize)("Strategy name"),onFocus:function(e){return y(e.currentTarget.name)},onBlur:function(){return y(null)}}))}))),l.createElement("div",{className:"modal__content-row"},l.createElement(c.RadioGroup,{className:"radio-group__save-type",name:"is_local",selected:n?r?s.save_types.LOCAL:s.save_types.GOOGLE_DRIVE:s.save_types.LOCAL,onToggle:function(){return m("is_local",!r)}},l.createElement(c.RadioGroup.Item,{id:"local",label:l.createElement(So,{text:(0,B.localize)("Local"),icon:l.createElement(c.Icon,{icon:p?"IcMobile":"IcDesktop",size:48})}),value:s.save_types.LOCAL}),l.createElement(c.RadioGroup.Item,{id:"drive",label:l.createElement(So,{text:"Google Drive",icon:l.createElement(c.Icon,{icon:"IcGoogleDrive",size:48}),google_drive_connected:n,onDriveConnect:i}),value:s.save_types.GOOGLE_DRIVE,disabled:!n,className:T()({"dc-radio-group__item-disabled":!n})}))),l.createElement(l.Fragment,null,l.createElement(Ke.Field,{name:"save_as_collection"},(function(e){var t=e.field;return l.createElement(c.Checkbox,Eo({},t,{onChange:function(){return m("save_as_collection",!a)},defaultChecked:a,label:l.createElement(c.Text,{color:"general",size:"xs",line_height:"s",weight:"bold"},l.createElement(B.Localize,{i18n_default_text:"Save as collection"})),classNameLabel:"save-type__checkbox-text"}))})),l.createElement("div",{className:"save-type__checkbox-description"},(0,B.localize)("Enabling this allows you to save your blocks as one collection which can be easily integrated into other bots.")))),l.createElement("div",{className:T()("modal__footer",{"modal__footer--active-keyboard":d})},l.createElement(c.Button,{type:"button",className:"modal__footer--button",text:(0,B.localize)("Cancel"),onClick:u,secondary:!0}),l.createElement(c.Button,{className:"modal__footer--button",type:"submit",is_loading:1===o,is_submit_success:2===o,text:(0,B.localize)("Continue"),primary:!0}))))}))},Bo=function(e){var t=e.bot_name,o=e.button_status,n=e.is_authorised,r=e.is_save_modal_open,i=e.onConfirmSave,a=e.onDriveConnect,s=e.toggleSaveModal,u=e.validateBotName,p=e.is_mobile,d=e.setCurrentFocus,y=e.is_onscreen_keyboard_active;return p?l.createElement(c.MobileFullPageModal,{is_modal_open:r,className:"save-modal__wrapper",header:(0,B.localize)("Save strategy"),onClickClose:s,height_offset:"80px",page_overlay:!0},l.createElement(To,{bot_name:t,button_status:o,is_authorised:n,onConfirmSave:i,onDriveConnect:a,validateBotName:u,toggleSaveModal:s,is_mobile:p,is_onscreen_keyboard_active:y,setCurrentFocus:d})):l.createElement(c.Modal,{title:(0,B.localize)("Save Strategy"),className:"modal--save",width:"328px",height:"500px",is_open:r,toggleModal:s},l.createElement(To,{bot_name:t,button_status:o,is_authorised:n,onConfirmSave:i,onDriveConnect:a,validateBotName:u,toggleSaveModal:s,setCurrentFocus:d}))},So=function(e){var t=e.icon,o=e.text,n=e.google_drive_connected,r=e.onDriveConnect,i="Google Drive"===o;return l.createElement("div",{className:"save-type__container"},l.createElement("div",{className:"save-type__radio"},t&&l.cloneElement(t,{className:T()("save-type__icon",{"save-type__icon--active":i&&n,"save-type__icon--disabled":i&&!n},t.props.className)}),l.createElement(c.Text,{as:"p",align:"center",size:"xxs",color:i&&!n?"disabled":"prominent",line_height:"s",className:"save-type__radio-text"},(0,B.localize)(o))),i&&l.createElement(c.Text,{as:"p",align:"center",size:"xs",weight:"bold",styles:{color:"var(--brand-red-coral)"},className:"save-type__drive-status",onClick:r},(0,B.localize)(n?(0,B.localize)("Disconnect"):(0,B.localize)("Connect"))))};Bo.propTypes={button_status:d().number,is_authorised:d().bool,is_mobile:d().bool,is_save_modal_open:d().bool,onConfirmSave:d().func,onDriveConnect:d().func,toggleSaveModal:d().func,bot_name:d().string,setCurrentFocus:d().func};const Oo=b((function(e){var t=e.save_modal,o=e.google_drive,n=e.ui;return{button_status:t.button_status,is_authorised:o.is_authorised,is_mobile:n.is_mobile,is_save_modal_open:t.is_save_modal_open,is_onscreen_keyboard_active:n.is_onscreen_keyboard_active,onConfirmSave:t.onConfirmSave,onDriveConnect:t.onDriveConnect,toggleSaveModal:t.toggleSaveModal,validateBotName:t.validateBotName,bot_name:t.bot_name,setCurrentFocus:n.setCurrentFocus}}))(Bo),wo=Oo;var Co=["onMount","onUnmount"];function Ao(){return Ao=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Ao.apply(this,arguments)}var Io=function(e){var t=e.popover_message,o=e.icon,n=e.icon_id,r=e.icon_color,i=e.iconOnClick;return l.createElement(c.Popover,{alignment:"bottom",message:t,zIndex:ct.TOOLBAR,should_disable_pointer_events:!0},l.createElement(c.Icon,Ao({icon:o,id:n,className:"toolbar__icon",onClick:i},r?{color:r}:null)))},Ro=function(e){var t=e.popover_message,o=e.button_id,n=e.button_classname,r=e.buttonOnClick,i=e.icon,a=e.button_text;return l.createElement(c.Popover,{alignment:"bottom",message:t,should_disable_pointer_events:!0},l.createElement(c.Button,{id:o,className:n,has_effect:!0,onClick:r,icon:i,green:!0},a))},Do=function(e){var t=e.has_redo_stack,o=e.has_undo_stack,n=e.onResetClick,r=e.onSortClick,i=e.onUndoClick,a=e.onZoomInOutClick,c=e.toggleLoadModal,s=e.toggleSaveModal;return l.createElement("div",{className:"toolbar__group toolbar__group-btn"},l.createElement(Io,{popover_message:(0,B.localize)("Reset"),icon:"IcReset",icon_id:"db-toolbar__reset-button",iconOnClick:n}),l.createElement(Io,{popover_message:(0,B.localize)("Import"),icon:"IcFolderOpen",icon_id:"db-toolbar__import-button",iconOnClick:c}),l.createElement(Io,{popover_message:(0,B.localize)("Save"),icon:"IcSave",icon_id:"db-toolbar__save-button",iconOnClick:s}),l.createElement("div",{className:"vertical-divider"}),l.createElement(Io,{popover_message:(0,B.localize)("Undo"),icon:"IcUndo",icon_id:"db-toolbar__undo-button",icon_color:o?void 0:"disabled",iconOnClick:function(){return i(!1)}}),l.createElement(Io,{popover_message:(0,B.localize)("Redo"),icon:"IcRedo",icon_id:"db-toolbar__redo-button",icon_color:t?void 0:"disabled",iconOnClick:function(){return i(!0)}}),l.createElement(Io,{popover_message:(0,B.localize)("Sort"),icon:"IcSort",icon_id:"db-toolbar__sort-button",iconOnClick:r}),l.createElement(Io,{popover_message:(0,B.localize)("Zoom in"),icon:"IcZoomIn",icon_id:"db-toolbar__zoom-in-button",iconOnClick:function(){return a(!0)}}),l.createElement(Io,{popover_message:(0,B.localize)("Zoom out"),icon:"IcZoomOut",icon_id:"db-toolbar__zoom-out",iconOnClick:function(){return a(!1)}}))},xo=function(e){e.onMount,e.onUnmount;var t=function(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}(e,Co),o=t.is_mobile,n=t.is_running,r=t.active_tab,i=t.is_dialog_open,a=t.onOkButtonClick,s=t.closeResetDialog,u=t.toggleStrategyModal,p=t.toggleLoadModal,d=t.toggleSaveModal;return l.createElement(l.Fragment,null,o?l.createElement("div",{className:"toolbar"},l.createElement("div",{className:"toolbar__section"},l.createElement(Ro,{button_id:"db-toolbar__import-button--mobile",button_classname:"toolbar__btn--icon",buttonOnClick:p,icon:l.createElement(c.Icon,{icon:"IcFolderOpenFilled",color:"active",size:16}),button_text:(0,B.localize)("Load")}),l.createElement(Ro,{button_id:"db-toolbar__quick-strategy-button--mobile",button_classname:"toolbar__btn--icon",buttonOnClick:u,icon:l.createElement(c.Icon,{icon:"IcPuzzle",color:"active",size:16}),button_text:(0,B.localize)("Quick")}),l.createElement(Ro,{button_id:"db-toolbar__save-button--mobile",button_classname:"toolbar__btn--icon",buttonOnClick:d,icon:l.createElement(c.Icon,{icon:"IcSaveFilled",color:"active",size:16}),button_text:(0,B.localize)("Save")}))):l.createElement(c.ThemedScrollbars,{height:"56px",is_only_horizontal:!0,width:"100%"},l.createElement("div",{className:"toolbar"},l.createElement("div",{className:"toolbar__section"},l.createElement(Ro,{popover_message:(0,B.localize)("Click here to start building your DBot."),button_id:"db-toolbar__get-started-button",button_classname:"toolbar__btn toolbar__btn--icon toolbar__btn--start",buttonOnClick:u,icon:l.createElement(c.Icon,{icon:"IcPuzzle",color:"active"}),button_text:(0,B.localize)("Quick strategy")}),r===S.WORKSPACE&&l.createElement(Do,t)),l.createElement("div",{className:"toolbar__section"},l.createElement(ro,{className:"toolbar__animation",should_show_overlay:!0,info_direction:"left"})))),l.createElement(wo,null),l.createElement(qe,null),l.createElement(c.Dialog,{title:(0,B.localize)("Are you sure?"),is_visible:i,confirm_button_text:n?(0,B.localize)("Yes"):(0,B.localize)("OK"),onConfirm:a,cancel_button_text:n?(0,B.localize)("No"):(0,B.localize)("Cancel"),onCancel:s,is_mobile_full_width:!1,className:"toolbar__dialog dc-dialog__wrapper--fixed",has_close_icon:!0},n?l.createElement(B.Localize,{i18n_default_text:"DBot will not proceed with any new trades. Any ongoing trades will be completed by our system. Any unsaved changes will be lost.<0>Note: Please check your statement to view completed transactions.</0>",components:[l.createElement("div",{key:0,className:"toolbar__dialog-text--second"})]}):(0,B.localize)("Any unsaved changes will be lost.")))};xo.propTypes={active_tab:d().string,file_name:d().string,has_redo_stack:d().bool,has_undo_stack:d().bool,is_dialog_open:d().bool,is_drawer_open:d().bool,is_running:d().bool,is_search_loading:d().bool,is_stop_button_disabled:d().bool,is_stop_button_visible:d().bool,closeResetDialog:d().func,onGoogleDriveClick:d().func,onMount:d().func,onOkButtonClick:d().func,onResetClick:d().func,onRunButtonClick:d().func,onSortClick:d().func,onUndoClick:d().func,onUnmount:d().func,onZoomInOutClick:d().func,toggleSaveLoadModal:d().func};const Po=b((function(e){var t=e.main_content,o=e.run_panel,n=e.save_modal,r=e.load_modal,i=e.toolbar,a=e.ui,l=e.quick_strategy;return{active_tab:t.active_tab,file_name:i.file_name,has_redo_stack:i.has_redo_stack,has_undo_stack:i.has_undo_stack,is_dialog_open:i.is_dialog_open,is_drawer_open:o.is_drawer_open,is_mobile:a.is_mobile,is_running:o.is_running,is_search_loading:i.is_search_loading,is_stop_button_disabled:o.is_stop_button_disabled,is_stop_button_visible:o.is_stop_button_visible,closeResetDialog:i.closeResetDialog,onGoogleDriveClick:i.onGoogleDriveClick,onMount:i.onMount,onOkButtonClick:i.onResetOkButtonClick,onResetClick:i.onResetClick,onRunButtonClick:o.onRunButtonClick,onSortClick:i.onSortClick,onUndoClick:i.onUndoClick,onUnmount:i.onUnmount,onZoomInOutClick:i.onZoomInOutClick,toggleLoadModal:r.toggleLoadModal,toggleSaveModal:n.toggleSaveModal,toggleStrategyModal:l.toggleStrategyModal}}))(xo),No=Po;var zo,Lo,Mo,Fo,Uo,jo,Vo,Ho,Jo,Go,Wo,Yo,qo=o(259);function Ko(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function Xo(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Zo,Qo,$o,en,tn,on,nn={},rn=(zo=qo.action.bound,Lo=qo.action.bound,Mo=qo.action.bound,Fo=qo.action.bound,Uo=qo.action.bound,jo=qo.action.bound,Vo=qo.action.bound,Ho=function(){function e(t){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ko(this,"symbol",Jo,this),Ko(this,"is_chart_loading",Go,this),Ko(this,"chart_type",Wo,this),Ko(this,"granularity",Yo,this),this.wsSubscribe=function(e,t){if(1===e.subscribe){var o=JSON.stringify(e),n=Zo.subscribeTicksHistory(e,t);nn[o]=n}},this.wsForget=function(e){var t=JSON.stringify(e);nn[t]&&(nn[t].unsubscribe(),delete nn[t])},this.wsForgetStream=function(e){Zo.forgetStream(e)},this.wsSendRequest=function(e){return e.time?s.ServerTime.timePromise().then((function(){return{msg_type:"time",time:s.ServerTime.get().unix()}})):e.active_symbols?Zo.activeSymbols():Zo.storage.send(e)},this.getMarketsOrder=function(e){var t="synthetic_index",o=!!e.find((function(e){return e.market===t}));return e.slice().sort((function(e,t){return e.display_name<t.display_name?-1:1})).map((function(e){return e.market})).reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),o?[t]:[])},this.root_store=t,Zo=t.ws;var n=t.run_panel;(0,qo.reaction)((function(){return n.is_running}),(function(){return n.is_running?o.onStartBot():o.onStopBot()}))}var t,o;return t=e,o=[{key:"is_contract_ended",get:function(){var e=this.root_store.transactions;return e.contracts.length>0&&e.contracts[0].is_ended}},{key:"onStartBot",value:function(){this.updateSymbol()}},{key:"onStopBot",value:function(){}},{key:"updateSymbol",value:function(){var e=Blockly.derivWorkspace.getAllBlocks().find((function(e){return"trade_definition_market"===e.type}));if(e&&"na"!==e){var t=e.getFieldValue("SYMBOL_LIST");this.symbol=t}}},{key:"onSymbolChange",value:function(e){this.symbol=e}},{key:"updateGranularity",value:function(e){this.granularity=e}},{key:"updateChartType",value:function(e){this.chart_type=e}},{key:"setChartStatus",value:function(e){this.is_chart_loading=e}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Jo=Xo(Ho.prototype,"symbol",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Go=Xo(Ho.prototype,"is_chart_loading",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wo=Xo(Ho.prototype,"chart_type",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yo=Xo(Ho.prototype,"granularity",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xo(Ho.prototype,"is_contract_ended",[qo.computed],Object.getOwnPropertyDescriptor(Ho.prototype,"is_contract_ended"),Ho.prototype),Xo(Ho.prototype,"onStartBot",[zo],Object.getOwnPropertyDescriptor(Ho.prototype,"onStartBot"),Ho.prototype),Xo(Ho.prototype,"onStopBot",[Lo],Object.getOwnPropertyDescriptor(Ho.prototype,"onStopBot"),Ho.prototype),Xo(Ho.prototype,"updateSymbol",[Mo],Object.getOwnPropertyDescriptor(Ho.prototype,"updateSymbol"),Ho.prototype),Xo(Ho.prototype,"onSymbolChange",[Fo],Object.getOwnPropertyDescriptor(Ho.prototype,"onSymbolChange"),Ho.prototype),Xo(Ho.prototype,"updateGranularity",[Uo],Object.getOwnPropertyDescriptor(Ho.prototype,"updateGranularity"),Ho.prototype),Xo(Ho.prototype,"updateChartType",[jo],Object.getOwnPropertyDescriptor(Ho.prototype,"updateChartType"),Ho.prototype),Xo(Ho.prototype,"setChartStatus",[Vo],Object.getOwnPropertyDescriptor(Ho.prototype,"setChartStatus"),Ho.prototype),Ho);function an(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function ln(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cn(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var sn,un,pn,dn,yn=(Qo=qo.action.bound,$o=qo.action.bound,en=function(e,t,o){return t&&ln(e.prototype,t),o&&ln(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getSuccessJournalMessage=function(e,t){var o=t.profit,n=t.sold_for,r=t.longcode,i=t.transaction_id;switch(e){case s.log_types.LOAD_BLOCK:return(0,B.localize)("Blocks are loaded successfully");case s.log_types.NOT_OFFERED:return(0,B.localize)("Resale of this contract is not offered.");case s.log_types.PURCHASE:return(0,B.localize)("Bought: {{longcode}} (ID: {{transaction_id}})",{longcode:r,transaction_id:i});case s.log_types.SELL:return(0,B.localize)("Sold for: {{sold_for}}",{sold_for:n});case s.log_types.PROFIT:return(0,B.localize)("Profit amount: {{profit}}",{profit:o});case s.log_types.LOST:return(0,B.localize)("Loss amount: {{profit}}",{profit:o});case s.log_types.WELCOME_BACK:return(0,B.localize)("Welcome back! Your messages have been restored.");default:return null}},an(this,"onClickDownloadTransaction",tn,this),an(this,"onClickDownloadJournal",on,this),this.root_store=t})),tn=cn(en.prototype,"onClickDownloadTransaction",[Qo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=[[(0,B.localize)("Market"),(0,B.localize)("Reference ID (buy)"),(0,B.localize)("Reference ID (sell)"),(0,B.localize)("Barrier"),(0,B.localize)("Start Time"),(0,B.localize)("Entry Spot"),(0,B.localize)("Entry Spot Time"),(0,B.localize)("Exit Spot"),(0,B.localize)("Exit Spot Time"),(0,B.localize)("Buy Price"),(0,B.localize)("Profit/Loss")]];e.root_store.transactions.transactions.forEach((function(e){return t.push([e.data.display_name,e.data.transaction_ids.buy,e.data.transaction_ids.sell,e.data.barrier,e.data.date_start,e.data.entry_tick,e.data.entry_tick_time,e.data.exit_tick,e.data.exit_tick_time,e.data.buy_price,e.data.profit])}));var o="data:text/csv;charset=utf-8, ".concat(t.map((function(e){return e.join(",")})).join("\n")),n=encodeURI(o),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",(0,B.localize)("Transactions.csv")),document.body.appendChild(r),r.click(),r.parentNode.removeChild(r)}}}),on=cn(en.prototype,"onClickDownloadJournal",[$o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=[[(0,B.localize)("Date"),(0,B.localize)("Time"),(0,B.localize)("Message")]];e.root_store.journal.filtered_messages.map((function(o){var n;n="success"!==o.message_type?JSON.stringify(o.message):e.getSuccessJournalMessage(o.message.toString(),o.extra);var r=[o.date,o.time,n.replace("&#x2F;","/")];t.push(r)}));var o="data:text/csv;charset=utf-8, ".concat(t.map((function(e){return e.join(",")})).join("\n")),n=encodeURI(o),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",(0,B.localize)("Journal.csv")),document.body.appendChild(r),r.click(),r.parentNode.removeChild(r)}}}),en),mn=(pn=function(e){try{var t="".concat(sn.core.client.loginid,"-").concat(sn.server_time.unix()),o={counters:"tr:".concat(e.number_of_runs,",                ts:").concat(e.total_stake,",                py:").concat(e.total_payout,",                lc:").concat(e.lost_contracts,",                wc:").concat(e.won_contracts,",                pr:").concat(e.total_profit).replace(/\s/g,""),event:"dbot_run",run_id:t};un(o)}catch(e){console.warn("Error pushing run data to datalayer",e)}},dn=function(e){try{var t=e.length>0&&e[0];if(t&&t.is_completed){var o={event:"dbot_run_transaction",reference_id:t.refrence_id};un(o)}}catch(e){console.warn("Error pushing transaction to datalayer",e)}},{init:function(e){try{var t=sn=e,o=t.run_panel,n=t.transactions,r=o.statistics;(0,qo.reaction)((function(){return o.is_running}),(function(){return o.is_running&&pn(r)})),(0,qo.reaction)((function(){return n.contracts}),(function(){return dn(n.contracts)}))}catch(e){console.warn("Error initializing GTM reactions ",e)}},pushDataLayer:un=function(e){return sn.core.gtm.pushDataLayer(e)}});const fn=mn;var _n,hn,gn,bn,vn,kn,En,Tn,Bn,Sn,On,wn,Cn,An,In,Rn,Dn,xn,Pn,Nn,zn,Ln;function Mn(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function Fn(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Un=(_n=qo.action.bound,hn=qo.action.bound,gn=qo.action.bound,bn=qo.action.bound,vn=qo.action.bound,kn=qo.action.bound,En=qo.action.bound,Tn=qo.action.bound,Bn=qo.action.bound,Sn=qo.action.bound,On=qo.action.bound,wn=qo.action.bound,Cn=qo.action.bound,An=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.block_listeners=[],this.block_workspaces=[],this.flyout_min_width=440,this.options={css:!1,media:"".concat(o.p,"media/"),move:{scrollbars:!1,drag:!0,wheel:!1},zoom:{startScale:s.config.workspaces.flyoutWorkspacesStartScale},sounds:!1},Mn(this,"is_help_content",In,this),Mn(this,"flyout_content",Rn,this),Mn(this,"flyout_width",Dn,this),Mn(this,"is_visible",xn,this),Mn(this,"is_search_flyout",Pn,this),Mn(this,"is_loading",Nn,this),Mn(this,"search_term",zn,this),Mn(this,"selected_category",Ln,this),this.root_store=t}var t,n;return t=e,n=[{key:"onMount",value:function(){this.initFlyout(),window.addEventListener("click",this.onClickOutsideFlyout)}},{key:"onUnmount",value:function(){window.removeEventListener("click",this.onClickOutsideFlyout)}},{key:"initFlyout",value:function(){var e=Blockly.derivWorkspace,t={parentWorkspace:e,RTL:e.RTL,horizontalLayout:e.horizontalLayout};e.horizontalLayout?this.flyout=new Blockly.HorizontalFlyout(t):this.flyout=new Blockly.VerticalFlyout(t),this.flyout.targetWorkspace_=e,this.flyout.workspace_.targetWorkspace=e,this.flyout.workspace_.getGesture=this.flyout.targetWorkspace_.getGesture.bind(this.flyout.targetWorkspace_),e.variableMap_=this.flyout.targetWorkspace_.getVariableMap(),this.flyout.workspace_.createPotentialVariableMap(),e.flyout_=this.flyout}},{key:"initBlockWorkspace",value:function(e,t){var o=this,n=Blockly.inject(e,this.options);n.isFlyout=!0,n.targetWorkspace=Blockly.derivWorkspace;var r=Blockly.Xml.domToBlock(t,n),i=r.getHeightWidth();r.isInFlyout=!0,e.style.height="".concat(Math.ceil(i.height*this.options.zoom.startScale)+1,"px"),e.style.width="".concat(Math.ceil(i.width*this.options.zoom.startScale)+1,"px"),r.moveBy(1,1);var a=r.getSvgRoot();this.block_listeners.push(Blockly.bindEventWithChecks_(a,"mousedown",null,(function(e){fn.pushDataLayer({event:"dbot_drag_block",block_type:r.type}),o.flyout.blockMouseDown_(r)(e)})),Blockly.bindEvent_(a,"mouseout",r,r.removeSelect),Blockly.bindEvent_(a,"mouseover",r,r.addSelect)),this.block_workspaces.push(n),Blockly.svgResize(n)}},{key:"getFlyout",value:function(){return this.flyout}},{key:"setContents",value:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=20,r=e;this.block_listeners.forEach((function(e){return Blockly.unbindEvent_(e)})),this.block_workspaces.forEach((function(e){return e.dispose()})),this.block_listeners=[],this.block_workspaces=[],this.is_help_content=!1,this.search_term=o.length>n?"".concat(o.substring(0,n),"..."):o,this.flyout_content=e,this.setFlyoutWidth(r),this.setVisibility(!0),setTimeout((function(){return t.setFlyoutWidth(r)}),50)}},{key:"setFlyoutWidth",value:function(e){var t=this,o=0;e.forEach((function(e){if(e.tagName.toUpperCase()===Blockly.Xml.NODE_BLOCK){var n=Blockly.Block.getDimensions(e);e.setAttribute("width",Math.ceil(n.width*t.options.zoom.startScale)),e.setAttribute("height",Math.ceil(n.height*t.options.zoom.startScale)),o=Math.max(o,Math.ceil(n.width*t.options.zoom.startScale))}})),this.flyout_width=Math.max(this.flyout_min_width,o+65)}},{key:"setVisibility",value:function(e){this.is_visible=e,e||(this.setSelectedCategory(null),this.flyout_content=[])}},{key:"setIsSearchFlyout",value:function(e){this.is_search_flyout=e}},{key:"setSelectedCategory",value:function(e){this.selected_category=e}},{key:"getSelectedCategory",value:function(){return this.selected_category}},{key:"onClickOutsideFlyout",value:function(e){if(this.is_visible&&Blockly.derivWorkspace){var t=document.getElementById("gtm-toolbox"),o=(e.path||e.composedPath&&e.composedPath()).some((function(e){return e.classList&&e.classList.contains("flyout")})),n=this.root_store.toolbox.is_search_focus;o||t.contains(e.target)||n||(this.setVisibility(!1),this.setSelectedCategory(null))}}},{key:"refreshCategory",value:function(){var e=this.getSelectedCategory(),t=this.root_store.toolbox.getCategoryContents(e);this.setContents(t)}},{key:"variables_blocks_count",get:function(){return this.flyout_content.filter((function(e){return"variables_get"===e.getAttribute("type")})).length}},{key:"first_get_variable_block_index",get:function(){return this.flyout_content.length-this.variables_blocks_count}}],n&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),In=Fn(An.prototype,"is_help_content",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Rn=Fn(An.prototype,"flyout_content",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Dn=Fn(An.prototype,"flyout_width",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.flyout_min_width}}),xn=Fn(An.prototype,"is_visible",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Pn=Fn(An.prototype,"is_search_flyout",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Nn=Fn(An.prototype,"is_loading",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),zn=Fn(An.prototype,"search_term",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ln=Fn(An.prototype,"selected_category",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Fn(An.prototype,"onMount",[_n],Object.getOwnPropertyDescriptor(An.prototype,"onMount"),An.prototype),Fn(An.prototype,"onUnmount",[hn],Object.getOwnPropertyDescriptor(An.prototype,"onUnmount"),An.prototype),Fn(An.prototype,"initFlyout",[gn],Object.getOwnPropertyDescriptor(An.prototype,"initFlyout"),An.prototype),Fn(An.prototype,"initBlockWorkspace",[bn],Object.getOwnPropertyDescriptor(An.prototype,"initBlockWorkspace"),An.prototype),Fn(An.prototype,"getFlyout",[vn],Object.getOwnPropertyDescriptor(An.prototype,"getFlyout"),An.prototype),Fn(An.prototype,"setContents",[kn],Object.getOwnPropertyDescriptor(An.prototype,"setContents"),An.prototype),Fn(An.prototype,"setFlyoutWidth",[En],Object.getOwnPropertyDescriptor(An.prototype,"setFlyoutWidth"),An.prototype),Fn(An.prototype,"setVisibility",[Tn],Object.getOwnPropertyDescriptor(An.prototype,"setVisibility"),An.prototype),Fn(An.prototype,"setIsSearchFlyout",[Bn],Object.getOwnPropertyDescriptor(An.prototype,"setIsSearchFlyout"),An.prototype),Fn(An.prototype,"setSelectedCategory",[Sn],Object.getOwnPropertyDescriptor(An.prototype,"setSelectedCategory"),An.prototype),Fn(An.prototype,"getSelectedCategory",[On],Object.getOwnPropertyDescriptor(An.prototype,"getSelectedCategory"),An.prototype),Fn(An.prototype,"onClickOutsideFlyout",[wn],Object.getOwnPropertyDescriptor(An.prototype,"onClickOutsideFlyout"),An.prototype),Fn(An.prototype,"refreshCategory",[Cn],Object.getOwnPropertyDescriptor(An.prototype,"refreshCategory"),An.prototype),Fn(An.prototype,"variables_blocks_count",[qo.computed],Object.getOwnPropertyDescriptor(An.prototype,"variables_blocks_count"),An.prototype),Fn(An.prototype,"first_get_variable_block_index",[qo.computed],Object.getOwnPropertyDescriptor(An.prototype,"first_get_variable_block_index"),An.prototype),An);const jn={text:[(0,B.localize)("This block is mandatory. Here is where you can decide if your bot should continue trading. Only one copy of this block is allowed."),(0,B.localize)("This block is commonly used to adjust the parameters of your next trade and to implement stop loss/take profit logic.")]},Vn={text:[(0,B.localize)("This block returns current account balance."),(0,B.localize)('The only input parameter determines how block output is going to be formatted. In case if the input parameter is "string" then the account currency will be added.'),(0,B.localize)("Example output of the below example will be:"),(0,B.localize)('1. for "string": 1325.68 USD'),(0,B.localize)('2. for "number": 1325.68')]},Hn={text:[(0,B.localize)("This block is mandatory. Only one copy of this block is allowed. It is added to the canvas by default when you open DBot."),(0,B.localize)("After defining trade parameters and trade options, you may want to instruct your bot to purchase contracts when specific conditions are met. To do that you can use conditional blocks and indicators blocks to help your bot to make decisions.")]},Jn={text:[(0,B.localize)('This block is used to determine if the market price moves in the selected direction or not. It gives you a value of "True" or "False".'),(0,B.localize)("Examples:"),(0,B.localize)('1. If the selected direction is "Rise", and the previous tick value is less than the current tick value, the output will be "True". Otherwise, the output will be an empty string.'),(0,B.localize)('2. If the selected direction is "Fall", and the previous tick value is more than the current tick value, the output will be "True". Otherwise, the output will be an empty string.')]},Gn={text:[(0,B.localize)("This block displays messages in the developer’s console with an input that can be either a string of text, a number, boolean, or an array of data."),(0,B.localize)("There are 4 message types:"),(0,B.localize)("1. 'Log' displays a regular message."),(0,B.localize)("2. 'Warn' displays a message in yellow to highlight something that needs attention."),(0,B.localize)("3. 'Error' displays a message in red to highlight something that needs to be resolved immediately."),(0,B.localize)("4. 'Table' takes an array of data, such as a list of candles, and displays it in a table format.")]},Wn={text:[(0,B.localize)('You can check the result of the last trade with this block. It can only be placed within the "Restart trading conditions" root block.'),(0,B.localize)('If "Win" is selected, it will return "True" if your last trade was successful. Otherwise, it will return an empty string.'),(0,B.localize)('If "Loss" is selected, it will return "True" if your last trade was unsuccessful. Otherwise, it will return an empty string.'),(0,B.localize)("Example:")]},Yn={text:[(0,B.localize)("This block is used to either terminate or continue a loop, and can be placed anywhere within a loop block."),(0,B.localize)("Examples:"),(0,B.localize)('1. In the below example the loop is terminated in case "x" is "False" even though only one iteration is complete'),(0,B.localize)('2. In the below example the loop jumps to the next iteration without executing below block in case if "x" is "False"')]},qn={text:[(0,B.localize)('This block uses the variable "i" to control the iterations. With each iteration, the value of "i" is determined by the items in a given list.'),(0,B.localize)("Example:"),(0,B.localize)('"i" starts with the value of 1, and it will be increased by 2 at every iteration. The loop will repeat until "i" reaches the value of 12, and then the loop is terminated.'),(0,B.localize)('You can use "i" inside the loop, for example to access list items')]},Kn={text:[(0,B.localize)('This block uses the variable "i" to control the iterations. With each iteration, the value of "i" is determined by the items in a given list.'),(0,B.localize)("Example:"),(0,B.localize)('In this example, the loop will repeat three times, as that is the number of items in the given list. During each iteration, the variable "i" will be assigned a value from the list. '),(0,B.localize)('Please note that changing the value of "i" won\'t change the value of the original item in the list')]},Xn={text:[(0,B.localize)("This block evaluates a statement and will perform an action only when the statement is true."),(0,B.localize)("Click the plus icon to extend the functionality of this block."),(0,B.localize)('You can also use "Compare" and "Logic operation" blocks to make test variables.')]},Zn={text:[(0,B.localize)("This block repeats instructions as long as a given condition is true."),(0,B.localize)("Examples:"),(0,B.localize)("1. In the example below, the instructions are repeated as long as the value of x is less than or equal to 10. Once the value of x exceeds 10, the loop is terminated."),(0,B.localize)("2. In this example, the instructions are repeated as long as the value of x is greater than or equal to 10. Once the value of x drops below 10, the loop is terminated.")]},Qn={text:[(0,B.localize)("Here is where you can decide to sell your contract before it expires. Only one copy of this block is allowed."),(0,B.localize)("Example:")]},$n={text:[(0,B.localize)('"Seconds Since Epoch" block returns the number of seconds since January 1st, 1970.'),(0,B.localize)("Example:"),(0,B.localize)("1551661986 seconds since Jan 01 1970 (UTC) translates to 03/04/2019 @ 1:13am (UTC)."),(0,B.localize)("You might need it when you want to repeat an actions after certain amount of time."),(0,B.localize)("The example below restarts trading after 30 or more seconds after 1 minute candle was started.")]},er={text:[(0,B.localize)("This block gives you a specific candle from within the selected time interval."),(0,B.localize)('In this example, the open price of a candle is assigned to the variable "candle_open_price".'),(0,B.localize)("In the above example it is assumed that variable candle_open_price is processed somewhere within other blocks.")]},tr={text:[(0,B.localize)('This block returns "True" if the last candle is black. It can be placed anywhere on the canvas except within the Trade parameters root block.'),(0,B.localize)('The term "candle" refers to each bar on the candlestick chart. Each candle represents four market prices for the selected time interval:'),(0,B.localize)("Each candlestick on the chart represents 4 market prices for the selected time interval:"),(0,B.localize)("- Open price: the opening price"),(0,B.localize)("- High price: the highest price"),(0,B.localize)("- Low price: the lowest price"),(0,B.localize)("- Close price: the closing price"),(0,B.localize)("A black (or red) candle indicates that the open price is higher than the close price. This represents a downward movement of the market price."),(0,B.localize)("A white (or green) candle indicates that the open price is lower than the close price. This represents an upward movement of the market price."),(0,B.localize)("The time interval for each candle can be set from one minute to one day.")]},or={text:[(0,B.localize)("This block gives you the last digit of the latest tick value of the selected market. If the latest tick value is 1410.90, this block will return 0. It’s useful for digit-based contracts such as Even/Odd, Matches/Differs, or Higher/Lower.")]},nr={text:[(0,B.localize)('This block performs the "AND" or the "OR" logic operation with the given values.'),(0,B.localize)('In case if the "AND" operation is selected, the block returns "True" only if both given values are "True"'),(0,B.localize)('In case if the "OR" operation is selected, the block returns "True" in case if one or both given values are "True"')]},rr={text:[(0,B.localize)("This block performs arithmetic operations between two numbers."),(0,B.localize)("Available operations:"),(0,B.localize)("- Addition"),(0,B.localize)("- Subtraction"),(0,B.localize)("- Multiplication"),(0,B.localize)("- Division"),(0,B.localize)("- Raise the first number to the power of the second number")]},ir={text:[(0,B.localize)("This block constrains a given number within a set range."),(0,B.localize)("In case if the given number is less than the lower boundary of the range, the block returns the lower boundary value. Similarly, if the given number is greater than the higher boundary, the block will return the higher boundary value. In case if the given value is between boundaries, the block will return the given value unchanged."),(0,B.localize)("In the below example the block returns the value of 10 as the given value (5) is less than the lower boundary (10)")]},ar={text:[(0,B.localize)("This block performs the following operations to a given number"),(0,B.localize)("Available operations are:"),(0,B.localize)("- Square root"),(0,B.localize)("- Absolute"),(0,B.localize)("- Negation"),(0,B.localize)("- Natural log"),(0,B.localize)("- Euler’s number (2.71) to the power of a given number"),(0,B.localize)("- 10 to the power of a given number")]},lr={text:[(0,B.localize)("This block sends a message to a Telegram channel. You will need to create your own Telegram bot to use this block."),(0,B.localize)("Here’s how:"),(0,B.localize)("1. Create a Telegram bot and get your Telegram API token. Read more on how to create bots in Telegram here: https://core.telegram.org/bots#6-botfather"),(0,B.localize)("2. Start a chat with your newly created Telegram bot and make sure to send it some messages before proceeding to the next step. (e.g. Hello Bot!)"),(0,B.localize)("3. Get the chat ID using the Telegram REST API (read more: https://core.telegram.org/bots/api#getupdates)"),(0,B.localize)("- Visit the following URL, make sure to replace <access_token> with the Telegram API token you created in Step 1: https://api.telegram.org/bot<access_token>/getUpdates"),(0,B.localize)("- Find the chat ID property in the response, and copy the value of the id property"),(0,B.localize)("4. Come back to DBot and add the Notify Telegram block to the workspace. Paste the Telegram API token and chat ID into the block fields accordingly.")]},cr={text:[(0,B.localize)("This block gives you a list of candles within a selected time interval."),(0,B.localize)('In this example, this block is used with another block to get the open prices from a list of candles. The open prices are then assigned to the variable called "cl".')]},sr={text:[(0,B.localize)("This block gives you the selected candle value from a list of candles within the selected time interval. You can choose from open price, close price, high price, low price, and open time."),(0,B.localize)('In this example, the open prices from a list of candles are assigned to a variable called "candle_list".')]},ur={text:[(0,B.localize)("This block gives you the selected candle value from a list of candles. You can choose from open price, close price, high price, low price, and open time."),(0,B.localize)("This block requires a list of candles as an input parameter."),(0,B.localize)('In this example, the open prices from a list of candles are assigned to a variable called "cl".')]},pr={text:[(0,B.localize)("Used within a function block, this block returns a value when a specific condition is true."),(0,B.localize)("Example:")]},dr={text:[(0,B.localize)("This block gives you information about your last contract."),(0,B.localize)("You can choose to see one of the following:"),(0,B.localize)("- Deal reference ID: the reference ID of the contract"),(0,B.localize)("- Purchase price: the purchase price (stake) of the contract"),(0,B.localize)("- Payout: the payout of the contract"),(0,B.localize)("- Profit: the profit you’ve earned"),(0,B.localize)("- Contract type: the name of the contract type such as Rise, Fall, Touch, No Touch, etс."),(0,B.localize)("- Entry time: the starting time of the contract"),(0,B.localize)("- Entry value: the value of the first tick of the contract"),(0,B.localize)("- Exit time: the contract expiration time"),(0,B.localize)("- Exit value: the value of the last tick of the contract"),(0,B.localize)("- Barrier: the barrier value of the contract (applicable to barrier-based trade types such as stays in/out, touch/no touch, etc.)"),(0,B.localize)('- Result: the result of the last contract: "win" or "loss"')]},yr={text:[(0,B.localize)("This block gives you the specified candle value for a selected time interval. You can choose which value you want:"),(0,B.localize)("- Open: the opening price"),(0,B.localize)("- High: the highest price"),(0,B.localize)("- Low: the lowest price"),(0,B.localize)("- Close: the closing price"),(0,B.localize)("- Open time: the opening time stamp"),(0,B.localize)('In the example below, the opening price is selected, which is then assigned to a variable called "op".')]},mr={text:[(0,B.localize)("This block gives you the selected candle value such as open price, close price, high price, low price, and open time. It requires a candle as an input parameter."),(0,B.localize)('In the example below, the open price is assigned to the variable "op".')]},fr={text:[(0,B.localize)("Use this block to sell your contract at the market price. Selling your contract is optional. You may choose to sell if the market trend is unfavourable."),(0,B.localize)("Example:")]},_r={text:[(0,B.localize)('This block gives you the potential profit or loss if you decide to sell your contract. It can only be used within the "Sell conditions" root block.'),(0,B.localize)("In the example below, the contract will only be sold if the potential profit or loss is more than the stake.")]},hr={text:[(0,B.localize)("SMA adds the market price in a list of ticks or candles for a number of time periods, and divides the sum by that number of time periods."),(0,B.localize)("The formula for SMA is:"),(0,B.localize)("where n is the number of periods."),"",(0,B.localize)("What SMA tells you"),(0,B.localize)("SMA serves as an indicator of the trend. If the SMA points up then the market price is increasing and vice versa. The larger the period number, the smoother SMA line is."),(0,B.localize)("In this example, each point of the SMA line is an arithmetic average of close prices for the last 10 days."),(0,B.localize)("In this example, each point of the SMA line is an arithmetic average of close prices for the last 50 days."),"",(0,B.localize)("How to use the SMA block"),(0,B.localize)("Input list accepts a list of ticks or candles, while period is the specified time period."),(0,B.localize)("Example:"),(0,B.localize)("This will display the SMA for the specified period, using a candle list."),(0,B.localize)("SMA places equal weight to the entire distribution of values."),(0,B.localize)("This is the same as the above example, using a tick list."),(0,B.localize)("You may compare SMA values calculated on every bot run to identify the market trend direction. Alternatively, you may also use a variation of the SMA block, the Simple Moving Average Array block. "),(0,B.localize)("This block returns the entire SMA line, containing a list of all values for a given period."),(0,B.localize)("If a period of 10 is entered, the Simple Moving Average Array block will return a list of SMA values calculated based on period of 10."),(0,B.localize)("The below image illustrates how Simple Moving Average Array block works:")]},gr={text:[(0,B.localize)('This block displays a dialog box with a customised message. When the dialog box is displayed, your strategy is paused and will only resume after you click "OK".')]},br={text:[(0,B.localize)('This block displays a dialog box that uses a customised message to prompt for an input. The input can be either a string of text or a number and can be assigned to a variable. When the dialog box is displayed, your strategy is paused and will only resume after you enter a response and click "OK".')]},vr={text:[(0,B.localize)("Any blocks placed within this block will be executed at every tick. If the default candle interval is set to 1 minute in the Trade Parameters root block, the instructions in this block will be executed once every minute. Place this block outside of any root block.")]},kr={text:[(0,B.localize)("This block converts the number of seconds since the Unix Epoch to a date and time format such as 2019-08-01 00:00:00."),(0,B.localize)("Example:"),(0,B.localize)("In this example, the date and time will be displayed in a green notification box.")]},Er={text:[(0,B.localize)("This block converts the date and time to the number of seconds since the Unix Epoch (1970-01-01 00:00:00)."),(0,B.localize)("Example:"),(0,B.localize)("In this example, a Rise contract will be purchased at midnight on 1 August 2019.")]},Tr={text:[(0,B.localize)("This block will transfer the control back to the Purchase conditions block, enabling you to purchase another contract without manually stopping and restarting your bot."),(0,B.localize)("Example:")]},Br={text:[(0,B.localize)("This block is mandatory. It's added to your strategy by default when you create new strategy. You can not add more than one copy of this block to the canvas."),(0,B.localize)("1. Market"),(0,B.localize)("Select your desired market and asset type. For example, Forex > Major pairs > AUD/JPY"),(0,B.localize)("2. Trade Type"),(0,B.localize)("Select your desired trade type. For example, Up/Down > Rise/Fall"),(0,B.localize)("3. Contract Type"),(0,B.localize)("Choose what type of contract you want to trade. For example, for the Rise/Fall trade type you can choose one of three options: Rise, Fall, or Both. Selected option will determine available options for the Purchase block."),(0,B.localize)("4. Default Candle Interval"),(0,B.localize)("Sets the default time interval for blocks that read list of candles."),(0,B.localize)("5. Restart buy/sell on error"),(0,B.localize)("Restarts the bot when an error is encountered."),(0,B.localize)("6. Restart last trade on error"),(0,B.localize)("Repeats the previous trade when an error is encountered."),(0,B.localize)("7. Run Once at Start"),(0,B.localize)("Place blocks here to perform tasks once when your bot starts running."),(0,B.localize)("8. Trade Options"),(0,B.localize)("The desired duration, stake, prediction, and/or barrier(s) for the contract is defined here.")]},Sr={text:[(0,B.localize)("This block is used to define trade options within the Trade parameters root block. Some options are only applicable for certain trade types. Parameters such as duration and stake are common among most trade types. Prediction is used for trade types such as Digits, while barrier offsets are for trade types that involve barriers such as Touch/No Touch, Ends In/Out, etc."),(0,B.localize)("Example:")]},Or={text:[(0,B.localize)("Use this block when you want to use multipliers as your trade type."),(0,B.localize)("Click the multiplier drop-down menu and choose the multiplier value you want to trade with."),(0,B.localize)("Your potential profit will be multiplied by the multiplier value you’ve chosen."),l.createElement(B.Localize,{key:0,i18n_default_text:"To learn more about multipliers, please go to the <0>Multipliers</0> page.",components:[l.createElement(c.StaticUrl,{key:0,className:"link",href:"trade-types/multiplier"})]})]},wr={text:[(0,B.localize)("This block assigns a given value to a variable, creating the variable if it doesn't already exist."),(0,B.localize)("A variable is among the most important and powerful components in creating a bot. It is a way to store information, either as text or numbers. The information stored as a variable can be used and changed according to the given instructions. Variables can be given any name, but usually they are given useful, symbolic names so that it is easier to call them during the execution of instructions."),(0,B.localize)("Creating a variable"),(0,B.localize)("1. From the block library, enter a name for the new variable and click Create."),(0,B.localize)("2. The new variable will appear as a block under Set variable.")]};var Cr,Ar,Ir,Rr,Dr,xr,Pr,Nr,zr,Lr,Mr,Fr,Ur,jr,Vr,Hr,Jr;function Gr(e){return function(e){if(Array.isArray(e))return Wr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Wr(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Wr(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function Yr(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function qr(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){Yr(i,n,r,a,l,"next",e)}function l(e){Yr(i,n,r,a,l,"throw",e)}a(void 0)}))}}function Kr(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function Xr(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Zr,Qr,$r,ei,ti,oi=(Cr=qo.action.bound,Ar=qo.action.bound,Ir=qo.action.bound,Rr=qo.action.bound,Dr=qo.action.bound,xr=qo.action.bound,Pr=qo.action.bound,Nr=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={css:!1,media:"".concat(o.p,"media/"),move:{scrollbars:!1,drag:!0,wheel:!1},zoom:{startScale:s.config.workspaces.flyoutWorkspacesStartScale},sounds:!1},Kr(this,"block_node",zr,this),Kr(this,"block_type",Lr,this),Kr(this,"examples",Mr,this),Kr(this,"help_string",Fr,this),Kr(this,"title",Ur,this),Kr(this,"should_next_disable",jr,this),Kr(this,"should_previous_disable",Vr,this),Kr(this,"active_helper",Hr,this),Kr(this,"setHelpContent",Jr,this),this.getHelpContent=function(){var e=qr(regeneratorRuntime.mark((function e(t){var o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&(i=r.xml_list_group[t],a=i[0].getAttribute("type"),o=n[a]),e.abrupt("return",o);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getFilledBlocksIndex=function(){var e=qr(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e){return r.getHelpContent(e)})));case 2:return o=e.sent,e.abrupt("return",o.map((function(e,t){return e?t:null})).filter((function(e){return null!==e})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getNextHelpContentIndex=function(){var e=qr(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getFilledBlocksIndex(Object.keys(r.xml_list_group));case 2:return o=e.sent,e.abrupt("return",t?o[o.length-1]:o[0]);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.root_store=t}var t,r,i,a;return t=e,r=[{key:"setActiveHelper",value:function(e){this.active_helper=e}},{key:"onBackClick",value:function(){var e=this.root_store,t=e.toolbox,o=e.flyout;if(o.is_search_flyout){var n=document.getElementsByName("search")[0].value;t.onSearch({search:n})}else o.refreshCategory()}},{key:"onSequenceClick",value:(a=qr(regeneratorRuntime.mark((function e(t){var n,r,i,a,l,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Array.from(this.xml_list).find((function(e){return e.getAttribute("type")===c.block_type})),Object.keys(this.xml_list_group).forEach((function(e,t){n.getAttribute("type")===e&&(r=t)})),i=function(){var e=qr(regeneratorRuntime.mark((function e(t,n,r){var a,l,s,u,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n+(r?1:-1),l=Object.keys(t).filter((function(e,t){return r?a<=t:a>=t})),e.next=4,c.getFilledBlocksIndex(l);case 4:if(s=e.sent,u=r?s[0]:s[s.length-1],p=l[u]){e.next=9;break}return e.abrupt("return",!1);case 9:return e.prev=9,e.next=12,Promise.resolve().then(o.bind(o,2330));case 12:return e.abrupt("return",p);case 15:return e.prev=15,e.t0=e.catch(9),e.abrupt("return",i(t,a,r));case 18:case"end":return e.stop()}}),e,null,[[9,15]])})));return function(t,o,n){return e.apply(this,arguments)}}(),e.next=5,i(this.xml_list_group,r,t);case 5:(a=e.sent)&&(l=this.xml_list_group[a],this.setHelpContent(l[0]));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"initFlyoutHelp",value:function(e){var t=this.root_store,o=t.flyout,n=t.toolbox;this.xml_list=n.getCategoryContents(o.selected_category),this.xml_list_group=this.groupBy(this.xml_list,!0),this.setHelpContent(e)}},{key:"updateSequenceButtons",value:(i=qr(regeneratorRuntime.mark((function e(){var t,o,n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.xml_list).find((function(e){return e.getAttribute("type")===i.block_type})),o=Object.keys(this.xml_list_group).findIndex((function(e){return t.getAttribute("type")===e})),e.next=4,this.getNextHelpContentIndex(!0);case 4:return n=e.sent,e.next=7,this.getNextHelpContentIndex(!1);case 7:r=e.sent,(0,qo.runInAction)((function(){i.should_previous_disable=0===o||o===r,i.should_next_disable=o===Object.keys(i.xml_list_group).length-1||o===n}));case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"groupBy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Array.from(e).reduce((function(e,o){var n=o.getAttribute("type");return t&&null===n||(e[n]||(e[n]=[]),(!t||t&&null!==n)&&e[n].push(o)),e}),{})}},{key:"setExamples",value:function(e){var t=Gr(this.root_store.toolbox.toolbox_examples.childNodes),n=K(o.p)[e].filter((function(e){return"example"===e.type})).map((function(e){return e.example_id})).map((function(e){return t.find((function(t){return t.id===e}))}));this.examples=n}}],r&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),zr=Xr(Nr.prototype,"block_node",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Lr=Xr(Nr.prototype,"block_type",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Mr=Xr(Nr.prototype,"examples",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Fr=Xr(Nr.prototype,"help_string",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Ur=Xr(Nr.prototype,"title",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),jr=Xr(Nr.prototype,"should_next_disable",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Vr=Xr(Nr.prototype,"should_previous_disable",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Hr=Xr(Nr.prototype,"active_helper",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Jr=Xr(Nr.prototype,"setHelpContent",[Cr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=qr(regeneratorRuntime.mark((function t(o){var r,i,a,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=o.getAttribute("type"),i=Blockly.Blocks[r].meta().display_name,""!==r&&(e.active_helper=r),a=e.root_store.flyout,e.setExamples(r),l=e.examples.map((function(e){return e.childNodes[0]})),setTimeout((function(){return a.setFlyoutWidth([o].concat(Gr(l)))}),50),(0,qo.runInAction)((function(){a.is_help_content=!0,e.block_node=o,e.block_type=r,e.title=i,e.help_string=n[r]})),a.is_search_flyout||e.updateSequenceButtons();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),Xr(Nr.prototype,"setActiveHelper",[Ar],Object.getOwnPropertyDescriptor(Nr.prototype,"setActiveHelper"),Nr.prototype),Xr(Nr.prototype,"onBackClick",[Ir],Object.getOwnPropertyDescriptor(Nr.prototype,"onBackClick"),Nr.prototype),Xr(Nr.prototype,"onSequenceClick",[Rr],Object.getOwnPropertyDescriptor(Nr.prototype,"onSequenceClick"),Nr.prototype),Xr(Nr.prototype,"initFlyoutHelp",[Dr],Object.getOwnPropertyDescriptor(Nr.prototype,"initFlyoutHelp"),Nr.prototype),Xr(Nr.prototype,"updateSequenceButtons",[xr],Object.getOwnPropertyDescriptor(Nr.prototype,"updateSequenceButtons"),Nr.prototype),Xr(Nr.prototype,"setExamples",[Pr],Object.getOwnPropertyDescriptor(Nr.prototype,"setExamples"),Nr.prototype),Nr),ni=Object.freeze({NORMAL:0,LOADING:1,COMPLETED:2});function ri(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function ii(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){ri(i,n,r,a,l,"next",e)}function l(e){ri(i,n,r,a,l,"throw",e)}a(void 0)}))}}function ai(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var li,ci,si,ui,pi,di,yi,mi,fi,_i,hi,gi,bi,vi=(Zr=qo.action.bound,Qr=qo.action.bound,$r=qo.action.bound,ei=function(){function e(t){var o,n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(o=ti)&&Object.defineProperty(this,"is_authorised",{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(this):void 0}),this.setKey=function(){var e=s.config.gd,t=e.aid,o=e.cid,r=e.api;n.client_id=o,n.app_id=t,n.api_key=r},this.root_store=t,this.bot_folder_name="Binary Bot - ".concat((0,B.localize)("Strategies")),this.google_auth=null,this.setKey(),(0,s.importExternal)("https://apis.google.com/js/api.js").then((function(){return n.initialise()}))}var t,o,n,r,i;return t=e,o=[{key:"initialise",value:function(){var e=this;gapi.load("client:auth2:picker",{callback:function(){gapi.client.init({apiKey:e.api_key,clientId:e.client_id,scope:"https://www.googleapis.com/auth/drive.file",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]}).then((function(){e.google_auth=gapi.auth2.getAuthInstance(),e.google_auth.isSignedIn.listen((function(t){return e.updateSigninStatus(t)})),e.updateSigninStatus(e.google_auth.isSignedIn.get())}),(function(e){console.warn(e)}))},onerror:console.warn})}},{key:"updateSigninStatus",value:function(e){this.is_authorised=e}},{key:"signIn",value:function(){return this.is_authorised?Promise.resolve():this.google_auth.signIn({prompt:"select_account"}).catch((function(e){"access_denied"===e.error&&console.error("Please grant permission to view and manage Google Drive folders created with Deriv Bot")}))}},{key:"signOut",value:function(){return this.is_authorised?this.google_auth.signOut():Promise.resolve()}},{key:"getPickerLanguage",value:function(){var e=(0,B.getLanguage)();return"zhTw"===e?"zh-TW":"zhCn"===e?"zh-CN":e}},{key:"saveFile",value:(i=ii(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signIn();case 2:return e.next=4,this.checkFolderExists();case 4:return e.next=6,this.createSaveFilePicker("application/vnd.google-apps.folder",(0,B.localize)("Select a folder"),t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"loadFile",value:(r=ii(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signIn();case 2:return e.next=4,this.createLoadFilePicker(["text/xml","application/xml"],(0,B.localize)("Select a Deriv Bot Strategy"));case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"checkFolderExists",value:(n=ii(regeneratorRuntime.mark((function e(){var t,o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=gapi.client.drive.files,e.next=3,t.list({q:"trashed=false"});case 3:if(o=e.sent,n="application/vnd.google-apps.folder",!o.result.files.find((function(e){return e.mimeType===n}))){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,t.create({resource:{name:this.bot_folder_name,mimeType:n,fields:"id"}});case 10:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"createSaveFilePicker",value:function(e,t,o){var n=this,r=this.root_store.save_modal.setButtonStatus;return new Promise((function(i){n.showGoogleDriveFilePicker(!0,e,t,(function(e){if(e.action===google.picker.Action.PICKED){var t=e.docs[0].id,a=new Blob([o.content],{type:o.mimeType}),l=JSON.stringify({name:o.name,mimeType:o.mimeType,parents:[t]}),c=new FormData;c.append("metadata",new Blob([l],{type:"application/json"})),c.append("file",a);var s=new XMLHttpRequest;s.responseType="json",s.open("POST","https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart"),s.setRequestHeader("Authorization","Bearer ".concat(gapi.auth.getToken().access_token)),s.onload=function(){401===s.status&&n.signOut(),r(ni.NORMAL),i()},s.send(c)}else e.action===google.picker.Action.CANCEL&&r(ni.NORMAL)}))}))}},{key:"createLoadFilePicker",value:function(e,t){var o=this;return new Promise((function(n){var r=function(){var e=ii(regeneratorRuntime.mark((function e(t){var o,r,i,a,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.action!==google.picker.Action.PICKED){e.next=9;break}return o=t.docs[0],r=o.name,i=o.id,a=gapi.client.drive.files,e.next=7,a.get({alt:"media",fileId:i,mimeType:"text/plain"});case 7:l=e.sent,n({xml_doc:l.body,file_name:r});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();o.showGoogleDriveFilePicker(!1,e,t,r)}))}},{key:"showGoogleDriveFilePicker",value:function(e,t,o,n){var r=new google.picker.DocsView;r.setIncludeFolders(!0),r.setMimeTypes(t),e&&r.setSelectFolderEnabled(!0),(new google.picker.PickerBuilder).setOrigin("".concat(window.location.protocol,"//").concat(window.location.host)).setTitle((0,B.localize)(o)).setLocale(this.getPickerLanguage()).setAppId(this.app_id).setOAuthToken(gapi.auth.getToken().access_token).addView(r).setDeveloperKey(this.api_key).setSize(1051,650).setCallback(n).build().setVisible(!0)}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ti=ai(ei.prototype,"is_authorised",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ai(ei.prototype,"updateSigninStatus",[Zr],Object.getOwnPropertyDescriptor(ei.prototype,"updateSigninStatus"),ei.prototype),ai(ei.prototype,"saveFile",[Qr],Object.getOwnPropertyDescriptor(ei.prototype,"saveFile"),ei.prototype),ai(ei.prototype,"loadFile",[$r],Object.getOwnPropertyDescriptor(ei.prototype,"loadFile"),ei.prototype),ei),ki=o(9789),Ei=function(){return JSON.parse(localStorage.getItem("dbot_settings"))},Ti=function(e){var t=Ei();return t?t[e]:null},Bi=function(e,t){var o=Ei()||{};o[e]=t,localStorage.setItem("dbot_settings",JSON.stringify(o))},Si=function(e,t,o,n){o(function(e){var t=e.unique_id,o=e.type,n=e.message,r=e.btn_text,i=e.onClick;return l.createElement(l.Fragment,null,l.createElement("div",{key:"".concat(t,"_message"),className:"notify__item-container"},l.createElement(c.Icon,{key:"".concat(t,"_icon"),icon:_t(o),size:"22"}),l.createElement("div",{key:"".concat(t,"_text"),className:"notify__item-message"},n)),l.createElement(c.Button,{key:"".concat(t,"_btn"),className:"notify__item-button",text:r,onClick:i,has_effect:!0,secondary:!0}))}({unique_id:t,type:"error",message:e,btn_text:(0,B.localize)("Go to block"),onClick:function(){n()}}))},Oi=function e(t){return t.map((function(t){return{id:(new Date).getTime()*Math.random(),value:t&&Array.isArray(t)?e(t):t}}))},wi=o(6954),Ci=o.n(wi),Ai=function(e,t,o){return t&&Ii(e,o)[t]||o},Ii=function(e,t){try{var o=sessionStorage.getItem(e),n=Ci().decompress(o),r=JSON.parse(n);if(r)return r}catch(e){}return t},Ri=function(e,t){try{var o=Ci().compress(JSON.stringify(t));sessionStorage.setItem(e,o)}catch(e){console.warn("Could not write to storage.")}};function Di(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function xi(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Pi,Ni,zi,Li,Mi,Fi,Ui,ji,Vi,Hi,Ji,Gi,Wi,Yi,qi,Ki,Xi,Zi,Qi,$i,ea,ta,oa,na,ra=(li=qo.observable.shallow,ci=qo.observable.shallow,si=qo.action.bound,ui=qo.action.bound,pi=qo.action.bound,di=qo.action.bound,yi=qo.action.bound,mi=qo.action.bound,fi=qo.action.bound,_i=function(){function e(t){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.JOURNAL_CACHE="journal_cache",Di(this,"is_filter_dialog_visible",hi,this),Di(this,"journal_filters",gi,this),Di(this,"unfiltered_messages",bi,this),this.playAudio=function(e){e!==ki.v.lists.NOTIFICATION_SOUND[0][1]&&document.getElementById(e).play()},this.filters=[{id:s.message_types.ERROR,label:(0,B.localize)("Errors")},{id:s.message_types.NOTIFY,label:(0,B.localize)("Notifications")},{id:s.message_types.SUCCESS,label:(0,B.localize)("System")}],this.root_store=t,this.disposeReactionsFn=this.registerReactions(),(0,qo.when)((function(){return o.unfiltered_messages}),(function(){o.unfiltered_messages.length>0&&o.welcomeBackUser()}))}var t,o;return t=e,o=[{key:"getServerTime",value:function(){return this.root_store.core.common.server_time.get()}},{key:"toggleFilterDialog",value:function(){this.is_filter_dialog_visible=!this.is_filter_dialog_visible}},{key:"onLogSuccess",value:function(e){var t=e.log_type,o=e.extra;this.pushMessage(t,s.message_types.SUCCESS,"",o)}},{key:"onError",value:function(e){this.pushMessage(e,s.message_types.ERROR)}},{key:"onNotify",value:function(e){var t=this,o=this.root_store,n=o.run_panel,r=o.dbot,i=e.message,a=e.className,u=e.message_type,p=e.sound,d=e.block_id,y=e.variable_name;(function(e,t,o,n){var r,i=e.message,a=e.block_id,s=e.variable_name;if(void 0===i&&null!=s)return Si((0,B.localize)("Variable '{{variable_name}}' has no value. Please set a value for variable '{{variable_name}}' to notify.",{variable_name:s}),a,t,o),!0;if(null===i)return n("NULL"),!0;if(Object.is(i,NaN))return Si((0,B.localize)("Tried to perform an invalid operation."),a,t,o),!0;if(Array.isArray(i)){var u=i.length;return n((r={header:"null"!==s?"".concat(s,": (").concat(u,")"):(0,B.localize)("List: ({{message_length}})",{message_length:u}),content:Oi(i)},function(e){return l.createElement(c.ExpansionPanel,{message:r,onResize:e})})),!0}return"boolean"==typeof i&&(n(i.toString()),!0)})({message:i,block_id:d,variable_name:y},n.showErrorMessage,(function(){return r.centerAndHighlightBlock(d,!0)}),(function(e){return t.pushMessage(e,u||s.message_types.NOTIFY,a)}))||this.pushMessage(i,u||s.message_types.NOTIFY,a),this.playAudio(p)}},{key:"pushMessage",value:function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=(0,_e.formatDate)(this.getServerTime()),i=(0,_e.formatDate)(this.getServerTime(),"HH:mm:ss [GMT]"),a=Blockly.utils.genUid();this.unfiltered_messages.unshift({date:r,time:i,message:e,message_type:t,className:o,unique_id:a,extra:n}),this.unfiltered_messages=this.unfiltered_messages.slice()}},{key:"filtered_messages",get:function(){var e=this;return this.unfiltered_messages.filter((function(t){return e.journal_filters.length&&e.journal_filters.some((function(e){return t.message_type===e}))}))}},{key:"checked_filters",get:function(){return this.journal_filters.filter((function(e){return null!=e}))}},{key:"filterMessage",value:function(e,t){e?this.journal_filters.push(t):this.journal_filters.splice(this.journal_filters.indexOf(t),1),Bi("journal_filter",this.journal_filters)}},{key:"clear",value:function(){this.unfiltered_messages=this.unfiltered_messages.slice(0,0)}},{key:"welcomeBackUser",value:function(){this.pushMessage(s.log_types.WELCOME_BACK,s.message_types.SUCCESS,"journal__text--info")}},{key:"registerReactions",value:function(){var e=this,t=this.root_store.core.client,o=(0,qo.reaction)((function(){return e.unfiltered_messages}),(function(o){var n=Ii(e.JOURNAL_CACHE,{});n[t.loginid]=o.slice(0,5e3).filter((function(e){return!(e.message_type===s.message_types.SUCCESS&&e.message===s.log_types.WELCOME_BACK)})),Ri(e.JOURNAL_CACHE,n)})),n=(0,qo.reaction)((function(){return t.loginid}),(function(){e.unfiltered_messages=Ai(e.JOURNAL_CACHE,t.loginid,[]),e.unfiltered_messages.length>0&&e.welcomeBackUser()}));return function(){o(),n()}}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),hi=xi(_i.prototype,"is_filter_dialog_visible",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),gi=xi(_i.prototype,"journal_filters",[li],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ti("journal_filter")||this.filters.map((function(e){return e.id}))}}),bi=xi(_i.prototype,"unfiltered_messages",[ci],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ai(this.JOURNAL_CACHE,this.root_store.core.client.loginid,[])}}),xi(_i.prototype,"toggleFilterDialog",[si],Object.getOwnPropertyDescriptor(_i.prototype,"toggleFilterDialog"),_i.prototype),xi(_i.prototype,"onLogSuccess",[ui],Object.getOwnPropertyDescriptor(_i.prototype,"onLogSuccess"),_i.prototype),xi(_i.prototype,"onError",[pi],Object.getOwnPropertyDescriptor(_i.prototype,"onError"),_i.prototype),xi(_i.prototype,"onNotify",[di],Object.getOwnPropertyDescriptor(_i.prototype,"onNotify"),_i.prototype),xi(_i.prototype,"pushMessage",[yi],Object.getOwnPropertyDescriptor(_i.prototype,"pushMessage"),_i.prototype),xi(_i.prototype,"filtered_messages",[qo.computed],Object.getOwnPropertyDescriptor(_i.prototype,"filtered_messages"),_i.prototype),xi(_i.prototype,"checked_filters",[qo.computed],Object.getOwnPropertyDescriptor(_i.prototype,"checked_filters"),_i.prototype),xi(_i.prototype,"filterMessage",[mi],Object.getOwnPropertyDescriptor(_i.prototype,"filterMessage"),_i.prototype),xi(_i.prototype,"clear",[fi],Object.getOwnPropertyDescriptor(_i.prototype,"clear"),_i.prototype),_i);function ia(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function aa(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){ia(i,n,r,a,l,"next",e)}function l(e){ia(i,n,r,a,l,"throw",e)}a(void 0)}))}}function la(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function ca(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var sa,ua,pa,da,ya,ma,fa,_a,ha,ga,ba,va,ka,Ea,Ta,Ba,Sa,Oa,wa,Ca,Aa,Ia,Ra,Da,xa,Pa,Na,za,La,Ma,Fa,Ua,ja,Va,Ha,Ja,Ga,Wa,Ya,qa,Ka,Xa=(Pi=qo.action.bound,Ni=qo.action.bound,zi=qo.action.bound,Li=qo.action.bound,Mi=qo.action.bound,Fi=qo.action.bound,Ui=qo.action.bound,ji=qo.action.bound,Vi=qo.action.bound,Hi=qo.action.bound,Ji=qo.action.bound,Gi=qo.action.bound,Wi=qo.action.bound,Yi=qo.action.bound,qi=qo.action.bound,Ki=qo.action.bound,Xi=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.recent_workspace=void 0,this.local_workspace=void 0,this.drop_zone=void 0,la(this,"active_index",Zi,this),la(this,"is_load_modal_open",Qi,this),la(this,"is_explanation_expand",$i,this),la(this,"is_open_button_loading",ea,this),la(this,"loaded_local_file",ta,this),la(this,"recent_strategies",oa,this),la(this,"selected_strategy_id",na,this),this.getRecentFileIcon=function(e){switch(e){case s.save_types.UNSAVED:return"IcReports";case s.save_types.LOCAL:return"IcDesktop";case s.save_types.GOOGLE_DRIVE:return"IcGoogleDrive";default:return"IcReports"}},this.getSaveType=function(e){switch(e){case s.save_types.UNSAVED:return(0,B.localize)("Unsaved");case s.save_types.LOCAL:return(0,B.localize)("Local");case s.save_types.GOOGLE_DRIVE:return(0,B.localize)("Google Drive");default:return(0,B.localize)("Unsaved")}},this.readFile=function(e,t,r){var i=r&&r.name.replace(/\.[^/.]+$/,""),a=new FileReader;a.onload=(0,qo.action)((function(r){var a={block_string:r.target.result,drop_event:t,from:s.save_types.LOCAL};if(e){var l=document.getElementById("load-strategy__blockly-container");n.local_workspace=Blockly.inject(l,{media:"".concat(o.p,"media/"),zoom:{wheel:!1,startScale:s.config.workspaces.previewWorkspaceStartScale},readOnly:!0,scrollbars:!0}),a.workspace=n.local_workspace}else a.workspace=Blockly.derivWorkspace,a.file_name=i;(0,s.load)(a)})),a.readAsText(r)},this.root_store=t,(0,qo.reaction)((function(){return n.active_index}),(function(){return n.onActiveIndexChange()})),(0,qo.reaction)((function(){return n.is_load_modal_open}),function(){var e=aa(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=11;break}return e.t0=n,e.next=4,(0,s.getSavedWorkspaces)();case 4:if(e.t1=e.sent,e.t1){e.next=7;break}e.t1=[];case 7:e.t2=e.t1,e.t0.setRecentStrategies.call(e.t0,e.t2),e.next=12;break;case 11:n.onLoadModalClose();case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var t,n,r,i;return t=e,n=[{key:"preview_workspace",get:function(){return this.tab_name===Ce.TAB_LOCAL?this.local_workspace:this.tab_name===Ce.TAB_RECENT?this.recent_workspace:null}},{key:"selected_strategy",get:function(){var e=this;return this.recent_strategies.length>0?this.recent_strategies.find((function(t){return t.id===e.selected_strategy_id}))||this.recent_strategies[0]:null}},{key:"tab_name",get:function(){if(this.root_store.ui.is_mobile){if(0===this.active_index)return Ce.TAB_LOCAL;if(1===this.active_index)return Ce.TAB_GOOGLE}return 0===this.active_index?Ce.TAB_RECENT:1===this.active_index?Ce.TAB_LOCAL:2===this.active_index?Ce.TAB_GOOGLE:""}},{key:"handleFileChange",value:function(e){var t,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("drop"===e.type?(e.stopPropagation(),e.preventDefault(),t=e.dataTransfer.files):t=e.target.files,t=Array.from(t),!o){if(!t[0].name.includes("xml"))return!1;this.setLoadedLocalFile(t[0])}return this.readFile(!o,e,t[0]),e.target.value="",!0}},{key:"loadFileFromRecent",value:function(){this.is_open_button_loading=!0,this.selected_strategy?((0,s.removeExistingWorkspace)(this.selected_strategy.id),(0,s.load)({block_string:this.selected_strategy.xml,strategy_id:this.selected_strategy.id,file_name:this.selected_strategy.name,workspace:Blockly.derivWorkspace}),this.is_open_button_loading=!1,this.toggleLoadModal()):this.is_open_button_loading=!1}},{key:"loadFileFromLocal",value:function(){this.is_open_button_loading=!0,this.readFile(!1,{},this.loaded_local_file),this.is_open_button_loading=!1,this.toggleLoadModal()}},{key:"onActiveIndexChange",value:function(){var e=this;this.tab_name===Ce.TAB_RECENT?this.selected_strategy&&this.previewRecentStrategy(this.selected_strategy_id):this.recent_workspace&&setTimeout((function(){e.recent_workspace.dispose(),e.recent_workspace=null})),this.tab_name===Ce.TAB_LOCAL?this.drop_zone||(this.drop_zone=document.querySelector("load-strategy__local-dropzone-area"),this.drop_zone&&this.drop_zone.addEventListener("drop",(function(t){return e.handleFileChange(t,!1)}))):this.local_workspace&&setTimeout((function(){e.local_workspace.dispose(),e.local_workspace=null,e.setLoadedLocalFile(null)})),this.tab_name!==Ce.TAB_LOCAL&&this.drop_zone&&this.drop_zone.removeEventListener("drop",(function(t){return e.handleFileChange(t,!1)}))}},{key:"onDriveConnect",value:(i=aa(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.root_store.google_drive).is_authorised?t.signOut():t.signIn();case 2:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"onDriveOpen",value:(r=aa(regeneratorRuntime.mark((function e(){var t,o,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.root_store.google_drive.loadFile,e.next=3,t();case 3:o=e.sent,n=o.xml_doc,r=o.file_name,(0,s.load)({block_string:n,file_name:r,workspace:Blockly.derivWorkspace,from:s.save_types.GOOGLE_DRIVE}),this.toggleLoadModal();case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"onEntered",value:function(){this.tab_name===Ce.TAB_RECENT&&this.selected_strategy&&this.previewRecentStrategy(this.selected_strategy.id)}},{key:"onLoadModalClose",value:function(){this.recent_workspace&&(this.recent_workspace.dispose(),this.recent_workspace=null),this.local_workspace&&(this.local_workspace.dispose(),this.local_workspace=null),this.setActiveTabIndex(0),this.setLoadedLocalFile(null)}},{key:"onZoomInOutClick",value:function(e){this.preview_workspace&&this.preview_workspace.zoomCenter(e?1:-1)}},{key:"previewRecentStrategy",value:function(e){if(this.setSelectedStrategyId(e),this.selected_strategy){if(!this.recent_workspace||!this.recent_workspace.rendered){var t=document.getElementById("load-strategy__blockly-container");if(!t)return void console.warn("Could not find preview workspace element.");this.recent_workspace=Blockly.inject(t,{media:"".concat(o.p,"media/"),zoom:{wheel:!0,startScale:s.config.workspaces.previewWorkspaceStartScale},readOnly:!0,scrollbars:!0})}(0,s.load)({block_string:this.selected_strategy.xml,drop_event:{},workspace:this.recent_workspace})}}},{key:"setActiveTabIndex",value:function(e){this.active_index=e}},{key:"setLoadedLocalFile",value:function(e){this.loaded_local_file=e}},{key:"setRecentStrategies",value:function(e){this.recent_strategies=e}},{key:"setSelectedStrategyId",value:function(e){this.selected_strategy_id=e}},{key:"toggleExplanationExpand",value:function(){this.is_explanation_expand=!this.is_explanation_expand}},{key:"toggleLoadModal",value:function(){this.is_load_modal_open=!this.is_load_modal_open}}],n&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Zi=ca(Xi.prototype,"active_index",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Qi=ca(Xi.prototype,"is_load_modal_open",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),$i=ca(Xi.prototype,"is_explanation_expand",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ea=ca(Xi.prototype,"is_open_button_loading",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ta=ca(Xi.prototype,"loaded_local_file",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oa=ca(Xi.prototype,"recent_strategies",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),na=ca(Xi.prototype,"selected_strategy_id",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),ca(Xi.prototype,"preview_workspace",[qo.computed],Object.getOwnPropertyDescriptor(Xi.prototype,"preview_workspace"),Xi.prototype),ca(Xi.prototype,"selected_strategy",[qo.computed],Object.getOwnPropertyDescriptor(Xi.prototype,"selected_strategy"),Xi.prototype),ca(Xi.prototype,"tab_name",[qo.computed],Object.getOwnPropertyDescriptor(Xi.prototype,"tab_name"),Xi.prototype),ca(Xi.prototype,"handleFileChange",[Pi],Object.getOwnPropertyDescriptor(Xi.prototype,"handleFileChange"),Xi.prototype),ca(Xi.prototype,"loadFileFromRecent",[Ni],Object.getOwnPropertyDescriptor(Xi.prototype,"loadFileFromRecent"),Xi.prototype),ca(Xi.prototype,"loadFileFromLocal",[zi],Object.getOwnPropertyDescriptor(Xi.prototype,"loadFileFromLocal"),Xi.prototype),ca(Xi.prototype,"onActiveIndexChange",[Li],Object.getOwnPropertyDescriptor(Xi.prototype,"onActiveIndexChange"),Xi.prototype),ca(Xi.prototype,"onDriveConnect",[Mi],Object.getOwnPropertyDescriptor(Xi.prototype,"onDriveConnect"),Xi.prototype),ca(Xi.prototype,"onDriveOpen",[Fi],Object.getOwnPropertyDescriptor(Xi.prototype,"onDriveOpen"),Xi.prototype),ca(Xi.prototype,"onEntered",[Ui],Object.getOwnPropertyDescriptor(Xi.prototype,"onEntered"),Xi.prototype),ca(Xi.prototype,"onLoadModalClose",[ji],Object.getOwnPropertyDescriptor(Xi.prototype,"onLoadModalClose"),Xi.prototype),ca(Xi.prototype,"onZoomInOutClick",[Vi],Object.getOwnPropertyDescriptor(Xi.prototype,"onZoomInOutClick"),Xi.prototype),ca(Xi.prototype,"previewRecentStrategy",[Hi],Object.getOwnPropertyDescriptor(Xi.prototype,"previewRecentStrategy"),Xi.prototype),ca(Xi.prototype,"setActiveTabIndex",[Ji],Object.getOwnPropertyDescriptor(Xi.prototype,"setActiveTabIndex"),Xi.prototype),ca(Xi.prototype,"setLoadedLocalFile",[Gi],Object.getOwnPropertyDescriptor(Xi.prototype,"setLoadedLocalFile"),Xi.prototype),ca(Xi.prototype,"setRecentStrategies",[Wi],Object.getOwnPropertyDescriptor(Xi.prototype,"setRecentStrategies"),Xi.prototype),ca(Xi.prototype,"setSelectedStrategyId",[Yi],Object.getOwnPropertyDescriptor(Xi.prototype,"setSelectedStrategyId"),Xi.prototype),ca(Xi.prototype,"toggleExplanationExpand",[qi],Object.getOwnPropertyDescriptor(Xi.prototype,"toggleExplanationExpand"),Xi.prototype),ca(Xi.prototype,"toggleLoadModal",[Ki],Object.getOwnPropertyDescriptor(Xi.prototype,"toggleLoadModal"),Xi.prototype),Xi),Za=Object.freeze({SUMMARY:0,TRANSACTIONS:1,JOURNAL:2}),Qa={key:"bot_switch_account",header:(0,B.localize)("You have switched accounts."),message:(0,B.localize)("Our system will finish any DBot trades that are running, and DBot will not place any new trades."),type:"warning",is_persistent:!0};function $a(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function el(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){$a(i,n,r,a,l,"next",e)}function l(e){$a(i,n,r,a,l,"throw",e)}a(void 0)}))}}function tl(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function ol(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var nl,rl,il,al,ll,cl,sl,ul,pl,dl=(sa=qo.action.bound,ua=qo.action.bound,pa=qo.action.bound,da=qo.action.bound,ya=qo.action.bound,ma=qo.action.bound,fa=qo.action.bound,_a=qo.action.bound,ha=qo.action.bound,ga=qo.action.bound,ba=qo.action.bound,va=qo.action.bound,ka=qo.action.bound,Ea=qo.action.bound,Ta=qo.action.bound,Ba=qo.action.bound,Sa=qo.action.bound,Oa=qo.action.bound,wa=qo.action.bound,Ca=qo.action.bound,Aa=qo.action.bound,Ia=qo.action.bound,Ra=qo.action.bound,Da=qo.action.bound,xa=qo.action.bound,Pa=qo.action.bound,Na=qo.action.bound,za=qo.action.bound,La=qo.action.bound,Ma=qo.action.bound,Fa=qo.action.bound,Ua=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),tl(this,"active_index",ja,this),tl(this,"contract_stage",Va,this),tl(this,"dialog_options",Ha,this),tl(this,"has_open_contract",Ja,this),tl(this,"is_running",Ga,this),tl(this,"is_statistics_info_modal_open",Wa,this),tl(this,"is_drawer_open",Ya,this),tl(this,"is_dialog_open",qa,this),tl(this,"is_sell_requested",Ka,this),this.run_id="",this.error_type=void 0,this.clear=function(){s.observer.emit("statistics.clear")},this.unregisterBotListeners=function(){s.observer.unregisterAll("bot.running"),s.observer.unregisterAll("bot.stop"),s.observer.unregisterAll("bot.trade_again"),s.observer.unregisterAll("contract.status"),s.observer.unregisterAll("bot.contract"),s.observer.unregisterAll("Error")},this.root_store=t,this.dbot=this.root_store.dbot,this.disposeReactionsFn=this.registerReactions()}var t,o,n,r;return t=e,o=[{key:"statistics",get:function(){var e=0,t=this.root_store.transactions.transactions.reduce((function(t,o){var n=o.data;return n.is_completed&&(n.profit>0?(t.won_contracts+=1,t.total_payout+=n.payout):t.lost_contracts+=1,t.total_profit+=n.profit,t.total_stake+=n.buy_price,e+=1),t}),{lost_contracts:0,number_of_runs:0,total_profit:0,total_payout:0,total_stake:0,won_contracts:0});return t.number_of_runs=e,t}},{key:"is_stop_button_visible",get:function(){return this.is_running||this.has_open_contract}},{key:"is_stop_button_disabled",get:function(){return[ge.PURCHASE_SENT,ge.IS_STOPPING].includes(this.contract_stage)}},{key:"is_clear_stat_disabled",get:function(){var e=this.root_store,t=e.journal,o=e.transactions;return this.is_running||this.has_open_contract||0===t.unfiltered_messages.length&&0===o.elements.length}},{key:"onRunButtonClick",value:(r=el(regeneratorRuntime.mark((function e(){var t,o,n,r,i,a,l,c,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.root_store,o=t.core,n=t.summary_card,r=t.route_prompt_dialog,i=t.self_exclusion,a=o.client,l=o.ui,c="iOS"===(0,_e.mobileOSDetect)(),this.dbot.unHighlightAllBlocks(),a.is_logged_in){e.next=7;break}return this.showLoginDialog(),e.abrupt("return");case 7:return(c||(0,_e.isSafari)())&&this.preloadAudio(),e.next=10,i.checkRestriction();case 10:if(i.should_bot_run){e.next=13;break}return i.setIsRestricted(!0),e.abrupt("return");case 13:if(i.setIsRestricted(!1),this.registerBotListeners(),this.dbot.shouldRunBot()){e.next=18;break}return this.unregisterBotListeners(),e.abrupt("return");case 18:l.setAccountSwitcherDisabledMessage((0,B.localize)("Account switching is disabled while your bot is running. Please stop your bot before switching accounts.")),(0,qo.runInAction)((function(){s.setIsRunning(!0),l.setPromptHandler(!0,r.shouldNavigateAfterPrompt),s.toggleDrawer(!0),s.run_id="run-".concat(Date.now()),n.clear(),s.setContractStage(ge.STARTING),s.dbot.runBot()}));case 20:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"onStopButtonClick",value:function(){this.root_store.summary_card.is_multiplier?this.showStopMultiplierContractDialog():this.stopBot()}},{key:"stopBot",value:function(){var e=this.root_store.core.ui;this.dbot.stopBot(),e.setPromptHandler(!1),this.error_type?(this.setContractStage(ge.NOT_RUNNING),e.setAccountSwitcherDisabledMessage(!1),this.setIsRunning(!1)):this.has_open_contract?this.setContractStage(ge.IS_STOPPING):(this.setContractStage(ge.NOT_RUNNING),this.unregisterBotListeners(),e.setAccountSwitcherDisabledMessage(!1),this.setIsRunning(!1)),this.error_type&&(this.error_type=void 0)}},{key:"onClearStatClick",value:function(){this.showClearStatDialog()}},{key:"clearStat",value:function(){var e=this.root_store,t=e.summary_card,o=e.journal,n=e.transactions;this.setIsRunning(!1),this.setHasOpenContract(!1),this.clear(),o.clear(),t.clear(),n.clear(),this.setContractStage(ge.NOT_RUNNING)}},{key:"toggleStatisticsInfoModal",value:function(){this.is_statistics_info_modal_open=!this.is_statistics_info_modal_open}},{key:"toggleDrawer",value:function(e){this.is_drawer_open=e}},{key:"setActiveTabIndex",value:function(e){this.active_index=e,1!==this.active_index&&this.root_store.transactions.setActiveTransactionId(null)}},{key:"onCloseDialog",value:function(){this.is_dialog_open=!1}},{key:"showStopMultiplierContractDialog",value:function(){var e=this,t=this.root_store,o=t.summary_card,n=t.core.ui;this.onOkButtonClick=function(){n.setPromptHandler(!1),e.dbot.terminateBot(),e.onCloseDialog(),o.clear()},this.onCancelButtonClick=function(){e.onClickSell(),e.stopBot(),e.onCloseDialog()},this.dialog_options={title:(0,B.localize)("Keep your current contract?"),message:l.createElement(B.Localize,{i18n_default_text:"Would you like to keep your current contract or close it? If you decide to keep it running, you can check and close it later on the <0>Reports</0> page.",components:[l.createElement("a",{key:0,className:"link",rel:"noopener noreferrer",target:"_blank",href:"/reports/positions"})]}),ok_button_text:(0,B.localize)("Keep my contract"),cancel_button_text:(0,B.localize)("Close my contract")},this.is_dialog_open=!0}},{key:"showLoginDialog",value:function(){this.onOkButtonClick=this.onCloseDialog,this.onCancelButtonClick=void 0,this.dialog_options={title:(0,B.localize)("Please log in"),message:(0,B.localize)("You need to log in to run the bot.")},this.is_dialog_open=!0}},{key:"showRealAccountDialog",value:function(){this.onOkButtonClick=this.onCloseDialog,this.onCancelButtonClick=void 0,this.dialog_options={title:(0,B.localize)("DBot isn't quite ready for real accounts"),message:(0,B.localize)("Please switch to your demo account to run your DBot.")},this.is_dialog_open=!0}},{key:"showClearStatDialog",value:function(){var e=this;this.onOkButtonClick=function(){e.clearStat(),e.onCloseDialog()},this.onCancelButtonClick=this.onCloseDialog,this.dialog_options={title:(0,B.localize)("Are you sure?"),message:(0,B.localize)("This will clear all data in the summary, transactions, and journal panels. All counters will be reset to zero.")},this.is_dialog_open=!0}},{key:"showIncompatibleStrategyDialog",value:function(){this.onOkButtonClick=this.onCloseDialog,this.onCancelButtonClick=void 0,this.dialog_options={title:(0,B.localize)("Import error"),message:(0,B.localize)("This strategy is currently not compatible with DBot.")},this.is_dialog_open=!0}},{key:"showContractUpdateErrorDialog",value:function(e){this.onOkButtonClick=this.onCloseDialog,this.onCancelButtonClick=void 0,this.dialog_options={title:(0,B.localize)("Contract Update Error"),message:(0,B.localize)(e)},this.is_dialog_open=!0}},{key:"registerBotListeners",value:function(){var e=this.root_store,t=e.summary_card,o=e.transactions;s.observer.register("bot.running",this.onBotRunningEvent),s.observer.register("bot.sell",this.onBotSellEvent),s.observer.register("bot.stop",this.onBotStopEvent),s.observer.register("bot.click_stop",this.onStopButtonClick),s.observer.register("bot.trade_again",this.onBotTradeAgain),s.observer.register("contract.status",this.onContractStatusEvent),s.observer.register("bot.contract",this.onBotContractEvent),s.observer.register("bot.contract",t.onBotContractEvent),s.observer.register("bot.contract",o.onBotContractEvent),s.observer.register("Error",this.onError)}},{key:"registerReactions",value:function(){var e=this,t=this.root_store.core,o=t.client,n=t.common,r=t.notifications,i=function(){n.is_socket_opened?e.disposeIsSocketOpenedListener=(0,qo.reaction)((function(){return o.loginid}),(function(t){t&&e.is_running&&r.addNotificationMessage(Qa),e.dbot.terminateBot(),e.unregisterBotListeners()})):"function"==typeof e.disposeLogoutListener&&e.disposeLogoutListener()};return i(),this.disposeLogoutListener=(0,qo.reaction)((function(){return n.is_socket_opened}),(function(){return i()})),this.disposeStopBotListener=(0,qo.reaction)((function(){return!e.is_running}),(function(){e.is_running||e.setContractStage(ge.NOT_RUNNING)})),function(){"function"==typeof e.disposeIsSocketOpenedListener&&e.disposeIsSocketOpenedListener(),"function"==typeof e.disposeLogoutListener&&e.disposeLogoutListener(),"function"==typeof e.disposeStopBotListener&&e.disposeStopBotListener()}}},{key:"onBotRunningEvent",value:function(){this.setHasOpenContract(!0);var e=new Event("IgnorePWAUpdate");document.dispatchEvent(e);var t=this.root_store.self_exclusion;t.should_bot_run&&-1!==t.run_limit&&(t.run_limit-=1,t.run_limit<0&&this.onStopButtonClick())}},{key:"onBotSellEvent",value:function(){this.is_sell_requested=!0}},{key:"onBotStopEvent",value:function(){var e=this,t=this.root_store,o=t.self_exclusion,n=t.summary_card,r=this.root_store.core.ui,i=function(){e.error_type=void 0,e.setIsRunning(!1),e.setContractStage(ge.NOT_RUNNING),r.setAccountSwitcherDisabledMessage(!1),e.unregisterBotListeners(),o.resetSelfExclusion()};if(this.error_type===s.error_types.RECOVERABLE_ERRORS){var a=this.dbot.interpreter.bot.tradeEngine.options,l=a.shouldRestartOnError,c=a.timeMachineEnabled;l||c?(this.error_type=void 0,this.setContractStage(ge.PURCHASE_SENT)):i()}else this.error_type===s.error_types.UNRECOVERABLE_ERRORS?i():this.has_open_contract&&(this.error_type=void 0,this.setIsRunning(!1),this.is_sell_requested=!1,this.setContractStage(ge.CONTRACT_CLOSED),r.setAccountSwitcherDisabledMessage(!1),this.unregisterBotListeners(),o.resetSelfExclusion());this.setHasOpenContract(!1),n.clearContractUpdateConfigValues();var u=new Event("ListenPWAUpdate");document.dispatchEvent(u)}},{key:"onBotTradeAgain",value:function(e){e||this.onStopButtonClick()}},{key:"onContractStatusEvent",value:function(e){switch(e.id){case"contract.purchase_sent":this.setContractStage(ge.PURCHASE_SENT);break;case"contract.purchase_received":this.setContractStage(ge.PURCHASE_RECEIVED),this.root_store.transactions.setActiveTransactionId(null);var t=e.buy;this.root_store.core.client.is_virtual||this.root_store.core.gtm.pushDataLayer({event:"dbot_purchase",buy_price:t.buy_price});break;case"contract.sold":this.is_sell_requested=!1,this.setContractStage(ge.CONTRACT_CLOSED)}}},{key:"onClickSell",value:function(){this.root_store.summary_card.is_multiplier&&this.setContractStage(ge.IS_STOPPING),this.dbot.interpreter.bot.getBotInterface().sellAtMarket()}},{key:"onBotContractEvent",value:function(e){null!=e&&e.is_sold&&(this.is_sell_requested=!1,this.setContractStage(ge.CONTRACT_CLOSED))}},{key:"onError",value:function(e){var t=e.error||e;s.unrecoverable_errors.includes(t.code)?(this.root_store.summary_card.clear(),this.error_type=s.error_types.UNRECOVERABLE_ERRORS):this.error_type=s.error_types.RECOVERABLE_ERRORS;var o=null==t?void 0:t.message;this.showErrorMessage(o)}},{key:"showErrorMessage",value:function(e){var t,o=this.root_store,n=o.journal,r=o.notifications;n.onError(e),n.journal_filters.some((function(e){return e===s.message_types.ERROR}))?(this.toggleDrawer(!0),this.setActiveTabIndex(Za.JOURNAL)):(r.addNotificationMessage((t=this.switchToJournal,{key:"bot_error",header:(0,B.localize)("The bot encountered an error while running."),action:{text:(0,B.localize)("View in Journal"),onClick:t},type:"danger",platform:[_e.platform_name.DBot],is_disposable:!0})),r.removeNotificationMessage({key:"bot_error"}))}},{key:"switchToJournal",value:function(){var e=this.root_store,t=e.journal,o=e.notifications;t.journal_filters.push(s.message_types.ERROR),this.setActiveTabIndex(Za.JOURNAL),this.toggleDrawer(!0),o.toggleNotificationsModal(),o.removeNotificationByKey({key:"bot_error"})}},{key:"setContractStage",value:function(e){this.contract_stage=e}},{key:"setHasOpenContract",value:function(e){this.has_open_contract=e}},{key:"setIsRunning",value:function(e){this.is_running=e}},{key:"onMount",value:function(){var e=this.root_store.journal;s.observer.register("ui.log.error",this.showErrorMessage),s.observer.register("ui.log.notify",e.onNotify),s.observer.register("ui.log.success",e.onLogSuccess),s.observer.register("client.invalid_token",this.handleInvalidToken)}},{key:"onUnmount",value:function(){var e=this.root_store,t=e.journal,o=e.summary_card,n=e.transactions;this.unregisterBotListeners(),this.disposeReactionsFn(),t.disposeReactionsFn(),o.disposeReactionsFn(),n.disposeReactionsFn(),s.observer.unregisterAll("ui.log.error"),s.observer.unregisterAll("ui.log.notify"),s.observer.unregisterAll("ui.log.success"),s.observer.unregisterAll("client.invalid_token")}},{key:"handleInvalidToken",value:(n=el(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.root_store.core.client,e.next=3,t.logout();case 3:this.setActiveTabIndex(Za.SUMMARY);case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"preloadAudio",value:function(){this.dbot.getStrategySounds().forEach((function(e){var t=document.getElementById(e);t.muted=!0,t.play().catch((function(){})),t.pause(),t.muted=!1}))}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ja=ol(Ua.prototype,"active_index",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Va=ol(Ua.prototype,"contract_stage",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ge.NOT_RUNNING}}),Ha=ol(Ua.prototype,"dialog_options",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Ja=ol(Ua.prototype,"has_open_contract",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ga=ol(Ua.prototype,"is_running",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Wa=ol(Ua.prototype,"is_statistics_info_modal_open",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ya=ol(Ua.prototype,"is_drawer_open",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),qa=ol(Ua.prototype,"is_dialog_open",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ka=ol(Ua.prototype,"is_sell_requested",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ol(Ua.prototype,"statistics",[qo.computed],Object.getOwnPropertyDescriptor(Ua.prototype,"statistics"),Ua.prototype),ol(Ua.prototype,"is_stop_button_visible",[qo.computed],Object.getOwnPropertyDescriptor(Ua.prototype,"is_stop_button_visible"),Ua.prototype),ol(Ua.prototype,"is_stop_button_disabled",[qo.computed],Object.getOwnPropertyDescriptor(Ua.prototype,"is_stop_button_disabled"),Ua.prototype),ol(Ua.prototype,"is_clear_stat_disabled",[qo.computed],Object.getOwnPropertyDescriptor(Ua.prototype,"is_clear_stat_disabled"),Ua.prototype),ol(Ua.prototype,"onRunButtonClick",[sa],Object.getOwnPropertyDescriptor(Ua.prototype,"onRunButtonClick"),Ua.prototype),ol(Ua.prototype,"onStopButtonClick",[ua],Object.getOwnPropertyDescriptor(Ua.prototype,"onStopButtonClick"),Ua.prototype),ol(Ua.prototype,"stopBot",[pa],Object.getOwnPropertyDescriptor(Ua.prototype,"stopBot"),Ua.prototype),ol(Ua.prototype,"onClearStatClick",[da],Object.getOwnPropertyDescriptor(Ua.prototype,"onClearStatClick"),Ua.prototype),ol(Ua.prototype,"clearStat",[ya],Object.getOwnPropertyDescriptor(Ua.prototype,"clearStat"),Ua.prototype),ol(Ua.prototype,"toggleStatisticsInfoModal",[ma],Object.getOwnPropertyDescriptor(Ua.prototype,"toggleStatisticsInfoModal"),Ua.prototype),ol(Ua.prototype,"toggleDrawer",[fa],Object.getOwnPropertyDescriptor(Ua.prototype,"toggleDrawer"),Ua.prototype),ol(Ua.prototype,"setActiveTabIndex",[_a],Object.getOwnPropertyDescriptor(Ua.prototype,"setActiveTabIndex"),Ua.prototype),ol(Ua.prototype,"onCloseDialog",[ha],Object.getOwnPropertyDescriptor(Ua.prototype,"onCloseDialog"),Ua.prototype),ol(Ua.prototype,"showStopMultiplierContractDialog",[ga],Object.getOwnPropertyDescriptor(Ua.prototype,"showStopMultiplierContractDialog"),Ua.prototype),ol(Ua.prototype,"showLoginDialog",[ba],Object.getOwnPropertyDescriptor(Ua.prototype,"showLoginDialog"),Ua.prototype),ol(Ua.prototype,"showRealAccountDialog",[va],Object.getOwnPropertyDescriptor(Ua.prototype,"showRealAccountDialog"),Ua.prototype),ol(Ua.prototype,"showClearStatDialog",[ka],Object.getOwnPropertyDescriptor(Ua.prototype,"showClearStatDialog"),Ua.prototype),ol(Ua.prototype,"showIncompatibleStrategyDialog",[Ea],Object.getOwnPropertyDescriptor(Ua.prototype,"showIncompatibleStrategyDialog"),Ua.prototype),ol(Ua.prototype,"showContractUpdateErrorDialog",[Ta],Object.getOwnPropertyDescriptor(Ua.prototype,"showContractUpdateErrorDialog"),Ua.prototype),ol(Ua.prototype,"onBotRunningEvent",[Ba],Object.getOwnPropertyDescriptor(Ua.prototype,"onBotRunningEvent"),Ua.prototype),ol(Ua.prototype,"onBotSellEvent",[Sa],Object.getOwnPropertyDescriptor(Ua.prototype,"onBotSellEvent"),Ua.prototype),ol(Ua.prototype,"onBotStopEvent",[Oa],Object.getOwnPropertyDescriptor(Ua.prototype,"onBotStopEvent"),Ua.prototype),ol(Ua.prototype,"onBotTradeAgain",[wa],Object.getOwnPropertyDescriptor(Ua.prototype,"onBotTradeAgain"),Ua.prototype),ol(Ua.prototype,"onContractStatusEvent",[Ca],Object.getOwnPropertyDescriptor(Ua.prototype,"onContractStatusEvent"),Ua.prototype),ol(Ua.prototype,"onClickSell",[Aa],Object.getOwnPropertyDescriptor(Ua.prototype,"onClickSell"),Ua.prototype),ol(Ua.prototype,"onBotContractEvent",[Ia],Object.getOwnPropertyDescriptor(Ua.prototype,"onBotContractEvent"),Ua.prototype),ol(Ua.prototype,"onError",[Ra],Object.getOwnPropertyDescriptor(Ua.prototype,"onError"),Ua.prototype),ol(Ua.prototype,"showErrorMessage",[Da],Object.getOwnPropertyDescriptor(Ua.prototype,"showErrorMessage"),Ua.prototype),ol(Ua.prototype,"switchToJournal",[xa],Object.getOwnPropertyDescriptor(Ua.prototype,"switchToJournal"),Ua.prototype),ol(Ua.prototype,"setContractStage",[Pa],Object.getOwnPropertyDescriptor(Ua.prototype,"setContractStage"),Ua.prototype),ol(Ua.prototype,"setHasOpenContract",[Na],Object.getOwnPropertyDescriptor(Ua.prototype,"setHasOpenContract"),Ua.prototype),ol(Ua.prototype,"setIsRunning",[za],Object.getOwnPropertyDescriptor(Ua.prototype,"setIsRunning"),Ua.prototype),ol(Ua.prototype,"onMount",[La],Object.getOwnPropertyDescriptor(Ua.prototype,"onMount"),Ua.prototype),ol(Ua.prototype,"onUnmount",[Ma],Object.getOwnPropertyDescriptor(Ua.prototype,"onUnmount"),Ua.prototype),ol(Ua.prototype,"handleInvalidToken",[Fa],Object.getOwnPropertyDescriptor(Ua.prototype,"handleInvalidToken"),Ua.prototype),Ua);function yl(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function ml(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){yl(i,n,r,a,l,"next",e)}function l(e){yl(i,n,r,a,l,"throw",e)}a(void 0)}))}}function fl(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function _l(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var hl=(nl=qo.action.bound,rl=qo.action.bound,il=qo.action.bound,al=qo.action.bound,ll=qo.action.bound,cl=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),fl(this,"is_save_modal_open",sl,this),fl(this,"button_status",ul,this),fl(this,"bot_name",pl,this),this.validateBotName=function(e){var t={};return""===e.bot_name.trim()&&(t.bot_name=(0,B.localize)("Strategy name cannot be empty")),t},this.root_store=t}var t,o,n,r;return t=e,o=[{key:"toggleSaveModal",value:function(){this.is_save_modal_open||this.setButtonStatus(ni.NORMAL),this.is_save_modal_open=!this.is_save_modal_open}},{key:"onConfirmSave",value:(r=ml(regeneratorRuntime.mark((function e(t){var o,n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.is_local,n=t.save_as_collection,r=t.bot_name,this.setButtonStatus(ni.LOADING),i=this.root_store.google_drive.saveFile,(a=Blockly.Xml.workspaceToDom(Blockly.derivWorkspace)).setAttribute("is_dbot","true"),a.setAttribute("collection",n?"true":"false"),!o){e.next=10;break}(0,s.save)(r,n,a),e.next=13;break;case 10:return e.next=12,i({name:r,content:Blockly.Xml.domToPrettyText(a),mimeType:"application/xml"});case 12:this.setButtonStatus(ni.COMPLETED);case 13:this.updateBotName(r),(0,s.saveWorkspaceToRecent)(a,o?s.save_types.LOCAL:s.save_types.GOOGLE_DRIVE),this.toggleSaveModal();case 16:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"updateBotName",value:function(e){this.bot_name=e,(0,s.updateWorkspaceName)()}},{key:"onDriveConnect",value:(n=ml(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.root_store.google_drive).is_authorised?t.signOut():t.signIn();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setButtonStatus",value:function(e){this.button_status=e}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),sl=_l(cl.prototype,"is_save_modal_open",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ul=_l(cl.prototype,"button_status",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ni.NORMAL}}),pl=_l(cl.prototype,"bot_name",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_l(cl.prototype,"toggleSaveModal",[nl],Object.getOwnPropertyDescriptor(cl.prototype,"toggleSaveModal"),cl.prototype),_l(cl.prototype,"onConfirmSave",[rl],Object.getOwnPropertyDescriptor(cl.prototype,"onConfirmSave"),cl.prototype),_l(cl.prototype,"updateBotName",[il],Object.getOwnPropertyDescriptor(cl.prototype,"updateBotName"),cl.prototype),_l(cl.prototype,"onDriveConnect",[al],Object.getOwnPropertyDescriptor(cl.prototype,"onDriveConnect"),cl.prototype),_l(cl.prototype,"setButtonStatus",[ll],Object.getOwnPropertyDescriptor(cl.prototype,"setButtonStatus"),cl.prototype),cl);function gl(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var bl=function(e,t,o){return t&&gl(e.prototype,t),o&&gl(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.root_store=t}));const vl=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errors={}}var t,o;return t=e,(o=[{key:"add",value:function(e,t){this.has(e)||(this.errors[e]=[]),-1===this.errors[e].indexOf(t)&&this.errors[e].push(t)}},{key:"all",value:function(){return this.errors}},{key:"first",value:function(e){return this.has(e)?this.errors[e][0]:null}},{key:"get",value:function(e){return this.has(e)?this.errors[e]:[]}},{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.errors,e)}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function kl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function El(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Tl=function(e,t){var o=t;return t&&!Array.isArray(t)&&(o=[t]),e.replace(/\[_(\d+)]/g,(function(e,t){return o[+t-1]}))};const Bl=function(){function e(t,o){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;kl(this,e),this.input=t,this.rules=o,this.store=n,this.errors=new vl,this.error_count=0}var t,o,n;return t=e,n=[{key:"getRuleObject",value:function(e){var t="string"==typeof e,o={name:t?e:e[0],options:t?{}:e[1]||{}};return o.validator="custom"===o.name?e[1].func:(0,_e.getPreBuildDVRs)()[o.name].func,o}}],(o=[{key:"addFailure",value:function(e,t,o){var n=o||t.options.message||(0,_e.getPreBuildDVRs)()[t.name].message();"length"===t.name?n=Tl(n,[t.options.min===t.options.max?t.options.min:"".concat(t.options.min,"-").concat(t.options.max)]):"min"===t.name?n=Tl(n,[t.options.min]):"not_equal"===t.name&&(n=Tl(n,[t.options.name1,t.options.name2])),this.errors.add(e,n),this.error_count++}},{key:"check",value:function(){var t=this;return Object.keys(this.input).forEach((function(o){Object.prototype.hasOwnProperty.call(t.rules,o)&&t.rules[o].forEach((function(n){var r=e.getRuleObject(n);if((r.validator||"function"==typeof r.validator)&&(!r.options.condition||r.options.condition(t.store))&&(""!==t.input[o]||"req"===r.name)){var i,a;if("number"===r.name){var l=r.validator(t.input[o],r.options,t.store,t.input);i=l.is_ok,a=l.message}else i=r.validator(t.input[o],r.options,t.store,t.input);i||t.addFailure(o,r,a)}}))})),!this.error_count}},{key:"isPassed",value:function(){return this.check()}}])&&El(t.prototype,o),n&&El(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();var Sl,Ol,wl,Cl,Al,Il,Rl,Dl,xl,Pl,Nl,zl,Ll,Ml,Fl,Ul,jl,Vl,Hl;function Jl(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function Gl(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function Wl(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Yl,ql,Kl,Xl,Zl,Ql,$l,ec,tc,oc,nc,rc,ic,ac=(Sl=qo.action.bound,Ol=qo.action.bound,wl=qo.action.bound,Cl=qo.action.bound,Al=qo.action.bound,Il=qo.action.bound,Rl=qo.action.bound,Dl=qo.action.bound,xl=qo.action.bound,Pl=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Gl(this,"contract_info",Nl,this),Gl(this,"indicative_movement",zl,this),Gl(this,"profit_movement",Ll,this),Gl(this,"validation_errors",Ml,this),Gl(this,"validation_rules",Fl,this),Gl(this,"contract_update_take_profit",Ul,this),Gl(this,"contract_update_stop_loss",jl,this),Gl(this,"has_contract_update_take_profit",Vl,this),Gl(this,"has_contract_update_stop_loss",Hl,this),this.contract_update_config={},this.contract_id=null,this.profit=0,this.indicative=0,this.root_store=t,this.disposeReactionsFn=this.registerReactions()}var t,o;return t=e,o=[{key:"is_contract_completed",get:function(){var e;return!(null===(e=this.contract_info)||void 0===e||!e.is_sold)&&this.root_store.run_panel.contract_stage!==ge.PURCHASE_RECEIVED}},{key:"is_contract_loading",get:function(){return this.root_store.run_panel.is_running&&null===this.contract_info||this.root_store.run_panel.contract_stage===ge.PURCHASE_SENT||this.root_store.run_panel.contract_stage===ge.STARTING}},{key:"is_contract_inactive",get:function(){return!this.contract_info&&!this.is_loading}},{key:"is_multiplier",get:function(){var e;return(0,_e.isMultiplierContract)(null===(e=this.contract_info)||void 0===e?void 0:e.contract_type)}},{key:"clear",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(this.contract_info=null),this.profit=0,this.profit_loss=0,this.indicative=0,this.indicative_movement="",this.profit_movement=""}},{key:"clearContractUpdateConfigValues",value:function(){this.contract_info&&Object.assign(this,Ct(this.contract_info))}},{key:"getLimitOrder",value:function(){var e={};return e.take_profit=this.has_contract_update_take_profit?+this.contract_update_take_profit:null,e.stop_loss=this.has_contract_update_stop_loss?+this.contract_update_stop_loss:null,e}},{key:"onBotContractEvent",value:function(e){var t=this,o=e.profit,n=(0,_e.getIndicativePrice)(e);this.contract_id!==e.id&&(this.clear(!1),this.contract_id=e.id,this.profit=o,this.indicative=n);var r={profit:o,indicative:n};Object.keys(r).forEach((function(e){r[e]!==t[e]?t["".concat(e,"_movement")]=r[e]>t[e]?"profit":"loss":""!==t["".concat(e,"_movement")]&&(t.indicative_movement=""),t[e]=r[e]})),this.contract_info=e}},{key:"onChange",value:function(e){var t=e.name,o=e.value;this[t]=o,this.validateProperty(t,this[t])}},{key:"populateConfig",value:function(e){this.contract_info=e,this.is_multiplier&&e.contract_id&&e.limit_order&&this.populateContractUpdateConfig(this.contract_info)}},{key:"populateContractUpdateConfig",value:function(e){var t=Ct(e);if(!(0,_e.isEqualObject)(this.contract_update_config,t)){Object.assign(this,t),this.contract_update_config=t;var o=e.contract_update,n=e.error;o&&!n&&(this.contract_info.limit_order=Object.assign(this.contract_info.limit_order||{},o))}}},{key:"setContractUpdateConfig",value:function(e,t){this.has_contract_update_take_profit=!!e,this.has_contract_update_stop_loss=!!t,this.contract_update_take_profit=this.has_contract_update_take_profit?+e:null,this.contract_update_stop_loss=this.has_contract_update_stop_loss?+t:null}},{key:"updateLimitOrder",value:function(){var e=this,t=this.getLimitOrder();this.root_store.ws.contractUpdate(this.contract_info.contract_id,t).then((function(t){t.error?e.root_store.run_panel.showContractUpdateErrorDialog(t.error.message):e.populateContractUpdateConfig(t)}))}},{key:"setValidationErrorMessages",value:function(e,t){var o=this;this.validation_errors[e]&&!o.validation_errors[e].filter((function(e){return!t.includes(e)})).concat(t.filter((function(t){return!o.validation_errors[e].includes(t)}))).length||(this.validation_errors[e]=t)}},{key:"validateProperty",value:function(e,t){var o=this,n=this.validation_rules[e].trigger,r=Jl({},e,void 0!==t?t:this[e]),i=Jl({},e,this.validation_rules[e].rules||[]);n&&Object.hasOwnProperty.call(this,n)&&(r[n]=this[n],i[n]=this.validation_rules[n].rules||[]);var a=new Bl(r,i,this);a.isPassed(),Object.keys(r).forEach((function(e){o.setValidationErrorMessages(e,a.errors.get(e))}))}},{key:"registerReactions",value:function(){var e=this,t=this.root_store.core.client;return this.disposeSwitchAcountListener=(0,qo.reaction)((function(){return t.loginid}),(function(){return e.clear()})),function(){"function"==typeof e.disposeSwitchAcountListener&&e.disposeSwitchAcountListener()}}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Nl=Wl(Pl.prototype,"contract_info",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),zl=Wl(Pl.prototype,"indicative_movement",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ll=Wl(Pl.prototype,"profit_movement",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ml=Wl(Pl.prototype,"validation_errors",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Fl=Wl(Pl.prototype,"validation_rules",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{has_contract_update_stop_loss:{trigger:"contract_update_stop_loss"},contract_update_stop_loss:{rules:[["req",{condition:function(e){return!e.contract_update_stop_loss},message:(0,B.localize)("Please enter a stop loss amount.")}],["custom",{func:function(e,t,o){var n=(0,_e.getTotalProfit)(o.contract_info);return!(n<0&&-e>n)},message:(0,B.localize)("Please enter a stop loss amount that's higher than the current potential loss.")}],["custom",{func:function(e,t,o){var n=function(e){return e.contract_info.buy_price}(o);return e<n+1},message:(0,B.localize)("Invalid stop loss. Stop loss cannot be more than stake.")}]]},has_contract_update_take_profit:{trigger:"contract_update_take_profit"},contract_update_take_profit:{rules:[["req",{condition:function(e){return!e.contract_update_take_profit},message:(0,B.localize)("Please enter a take profit amount.")}],["custom",{func:function(e,t,o){var n=(0,_e.getTotalProfit)(o.contract_info);return!(n>0&&+e<n)},message:(0,B.localize)("Please enter a take profit amount that's higher than the current potential profit.")}]]}}}}),Ul=Wl(Pl.prototype,"contract_update_take_profit",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),jl=Wl(Pl.prototype,"contract_update_stop_loss",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Vl=Wl(Pl.prototype,"has_contract_update_take_profit",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Hl=Wl(Pl.prototype,"has_contract_update_stop_loss",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Wl(Pl.prototype,"is_contract_completed",[qo.computed],Object.getOwnPropertyDescriptor(Pl.prototype,"is_contract_completed"),Pl.prototype),Wl(Pl.prototype,"is_contract_loading",[qo.computed],Object.getOwnPropertyDescriptor(Pl.prototype,"is_contract_loading"),Pl.prototype),Wl(Pl.prototype,"is_contract_inactive",[qo.computed],Object.getOwnPropertyDescriptor(Pl.prototype,"is_contract_inactive"),Pl.prototype),Wl(Pl.prototype,"is_multiplier",[qo.computed],Object.getOwnPropertyDescriptor(Pl.prototype,"is_multiplier"),Pl.prototype),Wl(Pl.prototype,"clear",[Sl],Object.getOwnPropertyDescriptor(Pl.prototype,"clear"),Pl.prototype),Wl(Pl.prototype,"clearContractUpdateConfigValues",[Ol],Object.getOwnPropertyDescriptor(Pl.prototype,"clearContractUpdateConfigValues"),Pl.prototype),Wl(Pl.prototype,"getLimitOrder",[wl],Object.getOwnPropertyDescriptor(Pl.prototype,"getLimitOrder"),Pl.prototype),Wl(Pl.prototype,"onBotContractEvent",[Cl],Object.getOwnPropertyDescriptor(Pl.prototype,"onBotContractEvent"),Pl.prototype),Wl(Pl.prototype,"onChange",[Al],Object.getOwnPropertyDescriptor(Pl.prototype,"onChange"),Pl.prototype),Wl(Pl.prototype,"populateConfig",[Il],Object.getOwnPropertyDescriptor(Pl.prototype,"populateConfig"),Pl.prototype),Wl(Pl.prototype,"populateContractUpdateConfig",[Rl],Object.getOwnPropertyDescriptor(Pl.prototype,"populateContractUpdateConfig"),Pl.prototype),Wl(Pl.prototype,"setContractUpdateConfig",[Dl],Object.getOwnPropertyDescriptor(Pl.prototype,"setContractUpdateConfig"),Pl.prototype),Wl(Pl.prototype,"updateLimitOrder",[xl],Object.getOwnPropertyDescriptor(Pl.prototype,"updateLimitOrder"),Pl.prototype),Wl(Pl.prototype,"setValidationErrorMessages",[qo.action],Object.getOwnPropertyDescriptor(Pl.prototype,"setValidationErrorMessages"),Pl.prototype),Wl(Pl.prototype,"validateProperty",[qo.action],Object.getOwnPropertyDescriptor(Pl.prototype,"validateProperty"),Pl.prototype),Pl);function lc(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function cc(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var sc,uc,pc,dc,yc,mc,fc,_c,hc,gc,bc=(Yl=qo.action.bound,ql=qo.action.bound,Kl=qo.action.bound,Xl=qo.action.bound,Zl=qo.action.bound,Ql=qo.action.bound,$l=qo.action.bound,ec=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),lc(this,"is_animation_info_modal_open",tc,this),lc(this,"is_dialog_open",oc,this),lc(this,"file_name",nc,this),lc(this,"has_undo_stack",rc,this),lc(this,"has_redo_stack",ic,this),this.onSortClick=function(){Blockly.derivWorkspace.cleanUp()},this.onZoomInOutClick=function(e){var t=Blockly.derivWorkspace,o=t.getMetrics(),n=e?1:-1;t.zoom(o.viewWidth/2,o.viewHeight/2,n)},this.root_store=t}var t,o;return t=e,(o=[{key:"toggleAnimationInfoModal",value:function(){this.is_animation_info_modal_open=!this.is_animation_info_modal_open}},{key:"onResetClick",value:function(){this.is_dialog_open=!0}},{key:"closeResetDialog",value:function(){this.is_dialog_open=!1}},{key:"onResetOkButtonClick",value:function(){(0,s.runGroupedEvents)(!1,(function(){var e=Blockly.derivWorkspace;e.current_strategy_id=Blockly.utils.genUid(),(0,s.load)({block_string:e.cached_xml.main,file_name:s.config.default_file_name,workspace:e})}),"reset"),this.is_dialog_open=!1,this.root_store.run_panel.is_running&&this.root_store.run_panel.stopBot()}},{key:"onUndoClick",value:function(e){Blockly.Events.setGroup("undo_clicked"),Blockly.derivWorkspace.undo(e),Blockly.svgResize(Blockly.derivWorkspace),this.setHasRedoStack(),this.setHasUndoStack(),Blockly.Events.setGroup(!1)}},{key:"setHasUndoStack",value:function(){this.has_undo_stack=Blockly.derivWorkspace.hasUndoStack()}},{key:"setHasRedoStack",value:function(){var e;this.has_redo_stack=null===(e=Blockly.derivWorkspace)||void 0===e?void 0:e.hasRedoStack()}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),tc=cc(ec.prototype,"is_animation_info_modal_open",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),oc=cc(ec.prototype,"is_dialog_open",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),nc=cc(ec.prototype,"file_name",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return s.config.default_file_name}}),rc=cc(ec.prototype,"has_undo_stack",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ic=cc(ec.prototype,"has_redo_stack",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),cc(ec.prototype,"toggleAnimationInfoModal",[Yl],Object.getOwnPropertyDescriptor(ec.prototype,"toggleAnimationInfoModal"),ec.prototype),cc(ec.prototype,"onResetClick",[ql],Object.getOwnPropertyDescriptor(ec.prototype,"onResetClick"),ec.prototype),cc(ec.prototype,"closeResetDialog",[Kl],Object.getOwnPropertyDescriptor(ec.prototype,"closeResetDialog"),ec.prototype),cc(ec.prototype,"onResetOkButtonClick",[Xl],Object.getOwnPropertyDescriptor(ec.prototype,"onResetOkButtonClick"),ec.prototype),cc(ec.prototype,"onUndoClick",[Zl],Object.getOwnPropertyDescriptor(ec.prototype,"onUndoClick"),ec.prototype),cc(ec.prototype,"setHasUndoStack",[Ql],Object.getOwnPropertyDescriptor(ec.prototype,"setHasUndoStack"),ec.prototype),cc(ec.prototype,"setHasRedoStack",[$l],Object.getOwnPropertyDescriptor(ec.prototype,"setHasRedoStack"),ec.prototype),ec);function vc(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function kc(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Ec,Tc,Bc,Sc,Oc,wc,Cc,Ac,Ic,Rc,Dc,xc,Pc,Nc,zc,Lc,Mc,Fc,Uc,jc,Vc,Hc,Jc,Gc,Wc,Yc,qc,Kc,Xc,Zc,Qc,$c,es=(sc=qo.action.bound,uc=qo.action.bound,pc=qo.action.bound,dc=qo.action.bound,yc=qo.action.bound,mc=qo.action.bound,fc=qo.action.bound,_c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TRANSACTION_CACHE="transaction_cache",vc(this,"elements",hc,this),vc(this,"active_transaction_id",gc,this),this.recovered_completed_transactions=[],this.recovered_transactions=[],this.root_store=t,this.disposeReactionsFn=this.registerReactions()}var t,o;return t=e,(o=[{key:"transactions",get:function(){return this.elements.filter((function(e){return e.type===Ft.CONTRACT}))}},{key:"onBotContractEvent",value:function(e){this.pushTransaction(e)}},{key:"pushTransaction",value:function(e){var t=(0,_e.isEnded)(e),o=this.root_store.run_panel.run_id,n={barrier:e.barrier,buy_price:e.buy_price,contract_id:e.contract_id,contract_type:e.contract_type,currency:e.currency,date_start:(0,_e.formatDate)(e.date_start,"YYYY-M-D HH:mm:ss [GMT]"),display_name:e.display_name,entry_tick:e.entry_tick_display_value,entry_tick_time:e.entry_tick_time&&(0,_e.formatDate)(e.entry_tick_time,"YYYY-M-D HH:mm:ss [GMT]"),exit_tick:e.exit_tick_display_value,exit_tick_time:e.exit_tick_time&&(0,_e.formatDate)(e.exit_tick_time,"YYYY-M-D HH:mm:ss [GMT]"),high_barrier:e.high_barrier,is_completed:t,low_barrier:e.low_barrier,payout:e.payout,profit:t&&e.profit,run_id:o,shortcode:e.shortcode,tick_count:e.tick_count,transaction_ids:e.transaction_ids,underlying:e.underlying},r=this.elements.findIndex((function(t){return t.type===Ft.CONTRACT&&t.data.transaction_ids&&t.data.transaction_ids.buy===e.transaction_ids.buy}));-1===r?(this.elements.length>0&&this.elements[0].type===Ft.CONTRACT&&n.run_id!==this.elements[0].data.run_id&&this.elements.unshift({type:Ft.DIVIDER,data:n.run_id}),this.elements.unshift({type:Ft.CONTRACT,data:n})):this.elements.splice(r,1,{type:Ft.CONTRACT,data:n}),this.elements=this.elements.slice()}},{key:"setActiveTransactionId",value:function(e){e&&this.active_transaction_id===e?this.active_transaction_id=null:this.active_transaction_id=e}},{key:"onClickOutsideTransaction",value:function(e){(e.path||e.composedPath&&e.composedPath()).some((function(e){return e.classList&&e.classList.contains("transactions__item-wrapper")}))||this.setActiveTransactionId(null)}},{key:"onMount",value:function(){window.addEventListener("click",this.onClickOutsideTransaction),this.recoverPendingContracts()}},{key:"onUnmount",value:function(){window.removeEventListener("click",this.onClickOutsideTransaction)}},{key:"clear",value:function(){this.elements=this.elements.slice(0,0),this.recovered_completed_transactions=this.recovered_completed_transactions.slice(0,0),this.recovered_transactions=this.recovered_transactions.slice(0,0)}},{key:"registerReactions",value:function(){var e=this,t=this.root_store.core.client,o=(0,qo.reaction)((function(){return e.elements}),(function(o){var n=Ii(e.TRANSACTION_CACHE,{});n[t.loginid]=o.slice(0,5e3),Ri(e.TRANSACTION_CACHE,n)})),n=(0,qo.reaction)((function(){return t.loginid}),(function(){return e.elements=Ai(e.TRANSACTION_CACHE,t.loginid,[])})),r=(0,qo.reaction)((function(){return e.transactions.length}),(function(){return e.recoverPendingContracts()}));return function(){o(),n(),r()}}},{key:"recoverPendingContracts",value:function(){var e=this;this.transactions.forEach((function(t){var o=t.data;o.is_completed||e.recovered_transactions.includes(o.contract_id)||e.recoverPendingContractsById(o.contract_id)}))}},{key:"recoverPendingContractsById",value:function(e){var t=this;this.root_store.ws.authorized.subscribeProposalOpenContract(e,(function(e){if(!e.error){var o=e.proposal_open_contract,n=t.root_store.summary_card.contract_info;if(o.contract_id===(null==n?void 0:n.contract_id))return;if(t.onBotContractEvent(o),t.recovered_transactions.includes(o.contract_id)||t.recovered_transactions.push(o.contract_id),!t.recovered_completed_transactions.includes(o.contract_id)&&(0,_e.isEnded)(o)){t.recovered_completed_transactions.push(o.contract_id);var r=o.currency,i=o.profit;t.root_store.journal.onLogSuccess({log_type:i>0?s.log_types.PROFIT:s.log_types.LOST,extra:{currency:r,profit:i}})}}}))}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),hc=kc(_c.prototype,"elements",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ai(this.TRANSACTION_CACHE,this.root_store.core.client.loginid,[])}}),gc=kc(_c.prototype,"active_transaction_id",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),kc(_c.prototype,"transactions",[qo.computed],Object.getOwnPropertyDescriptor(_c.prototype,"transactions"),_c.prototype),kc(_c.prototype,"onBotContractEvent",[sc],Object.getOwnPropertyDescriptor(_c.prototype,"onBotContractEvent"),_c.prototype),kc(_c.prototype,"pushTransaction",[uc],Object.getOwnPropertyDescriptor(_c.prototype,"pushTransaction"),_c.prototype),kc(_c.prototype,"setActiveTransactionId",[pc],Object.getOwnPropertyDescriptor(_c.prototype,"setActiveTransactionId"),_c.prototype),kc(_c.prototype,"onClickOutsideTransaction",[dc],Object.getOwnPropertyDescriptor(_c.prototype,"onClickOutsideTransaction"),_c.prototype),kc(_c.prototype,"onMount",[yc],Object.getOwnPropertyDescriptor(_c.prototype,"onMount"),_c.prototype),kc(_c.prototype,"onUnmount",[mc],Object.getOwnPropertyDescriptor(_c.prototype,"onUnmount"),_c.prototype),kc(_c.prototype,"clear",[fc],Object.getOwnPropertyDescriptor(_c.prototype,"clear"),_c.prototype),_c);function ts(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function os(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){ts(i,n,r,a,l,"next",e)}function l(e){ts(i,n,r,a,l,"throw",e)}a(void 0)}))}}function ns(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function rs(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function is(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var as,ls,cs,ss,us,ps,ds,ys=(Ec=qo.action.bound,Tc=qo.action.bound,Bc=qo.action.bound,Sc=qo.action.bound,Oc=qo.action.bound,wc=qo.action.bound,Cc=qo.action.bound,Ac=qo.action.bound,Ic=qo.action.bound,Rc=qo.action.bound,Dc=qo.action.bound,xc=qo.action.bound,Pc=qo.action.bound,Nc=qo.action.bound,zc=qo.action.bound,Lc=qo.action.bound,Mc=qo.action.bound,Fc=qo.action.bound,Uc=function(){function e(t){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),rs(this,"selected_symbol",jc,this),rs(this,"selected_trade_type",Vc,this),rs(this,"selected_duration_unit",Hc,this),rs(this,"input_duration_value",Jc,this),rs(this,"input_stake",Gc,this),rs(this,"input_size",Wc,this),rs(this,"input_loss",Yc,this),rs(this,"input_profit",qc,this),rs(this,"is_strategy_modal_open",Kc,this),rs(this,"active_index",Xc,this),rs(this,"symbol_dropdown",Zc,this),rs(this,"trade_type_dropdown",Qc,this),rs(this,"duration_unit_dropdown",$c,this),this.onScrollStopDropdownList=function(e){fn.pushDataLayer({event:"dbot_quick_strategy_scroll_".concat(e)})},this.getSizeDesc=function(e){switch(e){case 0:return(0,B.localize)("The multiplier amount used to increase your stake if you’re losing a trade.");case 1:return(0,B.localize)("The amount that you may add to your stake if you’re losing a trade.");case 2:return(0,B.localize)("The amount that you may add to your stake after each successful trade.");default:return""}},this.getSizeText=function(e){switch(e){case 0:return(0,B.localize)("Size");case 1:case 2:return(0,B.localize)("Units");default:return""}},this.getFieldMap=function(e){return{symbol:{field_name:"quick-strategy__symbol",dropdown:o.symbol_dropdown,selected:o.selected_symbol,setSelected:o.setSelectedSymbol},"trade-type":{field_name:"quick-strategy__trade-type",dropdown:o.trade_type_dropdown,selected:o.selected_trade_type,setSelected:o.setSelectedTradeType},"duration-unit":{field_name:"quick-strategy__duration-unit",dropdown:o.duration_unit_dropdown,selected:o.selected_duration_unit,setSelected:o.setSelectedDurationUnit}}[e]},this.getFieldValue=function(e,t){var o,n,r=(Array.isArray(e)?e:(o=[]).concat.apply(o,(n=Object.values(e),function(e){if(Array.isArray(e))return ns(e)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return ns(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?ns(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))).find((function(e){var o;return"string"!=typeof e.value?e.value===t:(null===(o=e.value)||void 0===o?void 0:o.toLowerCase())===(null==t?void 0:t.toLowerCase())}));return(null==r?void 0:r.text)||""},this.root_store=t,this.qs_cache=Ti("quick_strategy")||{}}var t,n,r,i,a,l,c,u;return t=e,n=[{key:"initial_values",get:function(){var e={"quick-strategy__symbol":this.getFieldValue(this.symbol_dropdown,this.selected_symbol.value)||"","quick-strategy__trade-type":this.getFieldValue(this.trade_type_dropdown,this.selected_trade_type.value)||"","quick-strategy__duration-unit":this.getFieldValue(this.duration_unit_dropdown,this.selected_duration_unit.value)||"","quick-strategy__duration-value":this.input_duration_value||"","quick-strategy__stake":this.input_stake,"quick-strategy__size":this.input_size,"quick-strategy__loss":this.input_loss,"quick-strategy__profit":this.input_profit};return Bi("quick_strategy",this.qs_cache),e}},{key:"initial_errors",get:function(){return this.validateQuickStrategy(this.initial_values,!0)}},{key:"setActiveTabIndex",value:function(e){this.active_index=e}},{key:"setDurationUnitDropdown",value:function(e){this.duration_unit_dropdown=e}},{key:"setSymbolDropdown",value:function(e){this.symbol_dropdown=e}},{key:"setTradeTypeDropdown",value:function(e){this.trade_type_dropdown=e}},{key:"setSelectedDurationUnit",value:function(e){this.qs_cache.selected_duration_unit=e,this.selected_duration_unit=e}},{key:"setSelectedSymbol",value:function(e){this.qs_cache.selected_symbol=e,this.selected_symbol=e,delete this.qs_cache.selected_duration_unit,delete this.qs_cache.duration_value,delete this.qs_cache.selected_trade_type}},{key:"setSelectedTradeType",value:function(e){this.qs_cache.selected_trade_type=e,this.selected_trade_type=e,delete this.qs_cache.selected_duration_unit,delete this.qs_cache.duration_value}},{key:"setDurationInputValue",value:function(e){this.qs_cache.input_duration_value=e,this.input_duration_value=e}},{key:"onChangeDropdownItem",value:function(e,t,o){if(t){var n=this.getFieldMap(e);if("symbol"===e){this.updateTradeTypeDropdown(t,o);var r=this.symbol_dropdown.find((function(e){return e.value===t}));this.setSelectedSymbol(r),r&&o(n.field_name,r.text)}else if("trade-type"===e){this.updateDurationDropdown(this.selected_symbol.value,t,o);var i=this.trade_type_dropdown.find((function(e){return e.value===t}));this.setSelectedTradeType(i),i&&o(n.field_name,i.text)}else if("duration-unit"===e){this.updateDurationValue(t,o);var a=this.duration_unit_dropdown.find((function(e){return e.value===t}));this.setSelectedDurationUnit(a),a&&o("quick-strategy__duration-unit",a.text)}}}},{key:"onChangeInputValue",value:function(e,t){this.qs_cache[e]=t.currentTarget.value,this[e]=t.currentTarget.value,Bi("quick_strategy",this.qs_cache)}},{key:"onHideDropdownList",value:function(e,t,o){var n=this.getFieldMap(e),r=n.dropdown.find((function(e){return e.text.toLowerCase()===t.toLowerCase()}))||n.selected;r?(r.text!==t&&o(n.field_name,r.text),r!==n.selected&&n.setSelected(r)):o(n.field_name,"")}},{key:"toggleStrategyModal",value:(u=os(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.root_store.flyout.setVisibility(!1),this.is_strategy_modal_open=!this.is_strategy_modal_open,!this.is_strategy_modal_open){e.next=5;break}return e.next=5,this.updateSymbolDropdown();case 5:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"createStrategy",value:(c=os(regeneratorRuntime.mark((function e(t){var n,r,i,a,l,c,u,p,d,y,m,f,_,h,g,b,v,k,E,T,S,O,w,C,A=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.button,i=this.selected_symbol.value,a=this.selected_trade_type.value,l=this.selected_duration_unit.value,c=this.input_duration_value,u=this.input_stake,p=this.input_size,d=this.input_loss,y=this.input_profit,m=s.ApiHelpers.instance.contracts_for,e.next=12,m.getMarketBySymbol(i);case 12:return f=e.sent,e.next=15,m.getSubmarketBySymbol(i);case 15:return _=e.sent,e.next=18,m.getTradeTypeCategoryByTradeType(a);case 18:return h=e.sent,g=s.config.strategies,b=Object.keys(g).find((function(e){return g[e].index===A.active_index})),e.next=23,o(7328)("./".concat(b,".xml"));case 23:v=e.sent,k=Blockly.Xml.textToDom(v.default),E=function(e,t){k.querySelectorAll('value[strategy_value="'.concat(e,'"]')).forEach((function(e){e.innerHTML='<shadow type="math_number"><field name="NUM">'.concat(t,"</field></shadow>")}))},T=function(e,t){k.querySelectorAll('field[name="'.concat("".concat(e.toUpperCase(),"_LIST"),'"]')).forEach((function(e){e.innerHTML=t}))},S={market:f,submarket:_,symbol:i,tradetype:a,tradetypecat:h,durationtype:l,duration:c,stake:u,size:p,loss:d,profit:y},Object.keys(S).forEach((function(e){var t=S[e];isNaN(t)?"string"==typeof t&&T(e,t):E(e,t)})),O=(null==g||null===(n=g[b])||void 0===n?void 0:n.label)||(0,B.localize)("Unknown"),w=Blockly,C=w.derivWorkspace,(0,s.load)({block_string:Blockly.Xml.domToText(k),file_name:O,workspace:C,from:je.R.UNSAVED}),"run"===r&&C.waitForBlockEvent({block_type:"trade_definition",event_type:Blockly.Events.BLOCK_CREATE,timeout:5e3}).then((function(){A.root_store.run_panel.onRunButtonClick()})),this.is_strategy_modal_open&&this.toggleStrategyModal();case 34:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"updateSymbolDropdown",value:(l=os(regeneratorRuntime.mark((function e(){var t,o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.ApiHelpers.instance.active_symbols,o=t.getAllSymbols(!0),n=o.map((function(e){return{group:e.submarket_display,text:e.symbol_display,value:e.symbol}})),this.setSymbolDropdown(n),!this.selected_symbol&&n.length&&(this.selected_symbol=n[0]),e.next=7,this.updateTradeTypeDropdown(this.selected_symbol.value);case 7:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"updateTradeTypeDropdown",value:(a=os(regeneratorRuntime.mark((function e(t,o){var n,r,i,a,l,c,u,p,d,y,m,f,_,h,g,b,v,k=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.ApiHelpers.instance.contracts_for,r=[],i=n.getMarketBySymbol(t),a=n.getSubmarketBySymbol(t),e.next=6,n.getTradeTypeCategories(i,a,t);case 6:l=e.sent,c=[],u=0;case 9:if(!(u<l.length)){e.next=20;break}return p=l[u],e.next=13,n.getTradeTypeByTradeCategory(i,a,t,p[1]);case 13:for(d=e.sent,y=0,m=0;m<d.length;m++)f=d[m],_=s.config.BARRIER_TRADE_TYPES.includes(f.value),h=s.config.PREDICTION_TRADE_TYPES.includes(f.value),(_||h)&&y++;y<d.length&&c.push(p);case 17:u++,e.next=9;break;case 20:g=regeneratorRuntime.mark((function e(o){var l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=c[o],e.next=3,n.getTradeTypeByTradeCategory(i,a,t,l[1]);case 3:e.sent.forEach((function(e){var t=s.config.BARRIER_TRADE_TYPES.includes(e.value),o=s.config.PREDICTION_TRADE_TYPES.includes(e.value),n=["multiplier"].includes(e.value);t||o||n||r.push({text:e.name,value:e.value,group:l[0],icon:e.icon})}));case 5:case"end":return e.stop()}}),e)})),b=0;case 22:if(!(b<c.length)){e.next=27;break}return e.delegateYield(g(b),"t0",24);case 24:b++,e.next=22;break;case 27:if(this.setTradeTypeDropdown(r),v=r[0],this.selected_trade_type&&r.some((function(e){return e.value===k.selected_trade_type.value}))?(v=this.selected_trade_type,(0,qo.runInAction)((function(){v.text=k.getFieldValue(k.trade_type_dropdown,k.selected_trade_type.value)}))):delete this.qs_cache.selected_trade_type,!v){e.next=35;break}return this.setSelectedTradeType(v),e.next=34,this.updateDurationDropdown(this.selected_symbol.value,this.selected_trade_type.value,o);case 34:o&&o("quick-strategy__trade-type",v.text);case 35:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"updateDurationDropdown",value:(i=os(regeneratorRuntime.mark((function e(t,o,n){var r,i,a,l,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.ApiHelpers.instance.contracts_for,e.next=3,r.getDurations(t,o);case 3:i=e.sent,a=i.map((function(e){return{text:e.display,value:e.unit,min:e.min,max:e.max}})),this.setDurationUnitDropdown(a),l=a[0],this.selected_duration_unit&&a.some((function(e){return e.value===c.selected_duration_unit.value}))?(l=this.selected_duration_unit,(0,qo.runInAction)((function(){l.text=c.getFieldValue(a,c.selected_duration_unit.value)}))):delete this.qs_cache.selected_duration_unit,l&&(this.setSelectedDurationUnit(l),this.updateDurationValue(this.selected_duration_unit.value,n),n&&n("quick-strategy__duration-unit",l.text));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,o){return i.apply(this,arguments)})},{key:"updateDurationValue",value:(r=os(regeneratorRuntime.mark((function e(t,o){var n,r,i,a,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.ApiHelpers.instance.contracts_for,e.next=3,n.getDurations(this.selected_symbol.value,this.selected_trade_type.value);case 3:r=e.sent,(i=r.find((function(e){return e.unit===t})))&&(a=i.min,(l=this.qs_cache.input_duration_value)&&l<i.max&&l>i.min?a=l:delete this.qs_cache.input_duration_value,this.setDurationInputValue(a),o&&o("quick-strategy__duration-value",a));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"validateQuickStrategy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o={},n=["quick-strategy__duration-value","quick-strategy__stake","quick-strategy__size","quick-strategy__profit","quick-strategy__loss"];Object.keys(e).forEach((function(r){var i=e[r];t&&!i||(n.includes(r)&&(isNaN(i)?o[r]=(0,B.localize)("Must be a number"):i<=0?o[r]=(0,B.localize)("Must be a number higher than 0"):/^0+(?=\d)/.test(i)&&(o[r]=(0,B.localize)("Invalid number format"))),""===i&&(o[r]=(0,B.localize)("Field cannot be empty")))}));var r=this.duration_unit_dropdown.find((function(t){return t.text===e["quick-strategy__duration-unit"]}));if(r){var i=r.min,a=r.max;e["quick-strategy__duration-value"]<i?o["quick-strategy__duration-value"]=(0,B.localize)("Minimum duration: {{ min }}",{min:i}):e["quick-strategy__duration-value"]>a&&(o["quick-strategy__duration-value"]=(0,B.localize)("Maximum duration: {{ max }}",{max:a}))}return o}}],n&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),jc=is(Uc.prototype,"selected_symbol",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.selected_symbol||""}}),Vc=is(Uc.prototype,"selected_trade_type",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.selected_trade_type||""}}),Hc=is(Uc.prototype,"selected_duration_unit",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.selected_duration_unit||""}}),Jc=is(Uc.prototype,"input_duration_value",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.input_duration_value||""}}),Gc=is(Uc.prototype,"input_stake",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.input_stake||""}}),Wc=is(Uc.prototype,"input_size",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.input_size||""}}),Yc=is(Uc.prototype,"input_loss",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.input_loss||""}}),qc=is(Uc.prototype,"input_profit",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.input_profit||""}}),Kc=is(Uc.prototype,"is_strategy_modal_open",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Xc=is(Uc.prototype,"active_index",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Zc=is(Uc.prototype,"symbol_dropdown",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Qc=is(Uc.prototype,"trade_type_dropdown",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$c=is(Uc.prototype,"duration_unit_dropdown",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),is(Uc.prototype,"initial_values",[qo.computed],Object.getOwnPropertyDescriptor(Uc.prototype,"initial_values"),Uc.prototype),is(Uc.prototype,"initial_errors",[qo.computed],Object.getOwnPropertyDescriptor(Uc.prototype,"initial_errors"),Uc.prototype),is(Uc.prototype,"setActiveTabIndex",[Ec],Object.getOwnPropertyDescriptor(Uc.prototype,"setActiveTabIndex"),Uc.prototype),is(Uc.prototype,"setDurationUnitDropdown",[Tc],Object.getOwnPropertyDescriptor(Uc.prototype,"setDurationUnitDropdown"),Uc.prototype),is(Uc.prototype,"setSymbolDropdown",[Bc],Object.getOwnPropertyDescriptor(Uc.prototype,"setSymbolDropdown"),Uc.prototype),is(Uc.prototype,"setTradeTypeDropdown",[Sc],Object.getOwnPropertyDescriptor(Uc.prototype,"setTradeTypeDropdown"),Uc.prototype),is(Uc.prototype,"setSelectedDurationUnit",[Oc],Object.getOwnPropertyDescriptor(Uc.prototype,"setSelectedDurationUnit"),Uc.prototype),is(Uc.prototype,"setSelectedSymbol",[wc],Object.getOwnPropertyDescriptor(Uc.prototype,"setSelectedSymbol"),Uc.prototype),is(Uc.prototype,"setSelectedTradeType",[Cc],Object.getOwnPropertyDescriptor(Uc.prototype,"setSelectedTradeType"),Uc.prototype),is(Uc.prototype,"setDurationInputValue",[Ac],Object.getOwnPropertyDescriptor(Uc.prototype,"setDurationInputValue"),Uc.prototype),is(Uc.prototype,"onChangeDropdownItem",[Ic],Object.getOwnPropertyDescriptor(Uc.prototype,"onChangeDropdownItem"),Uc.prototype),is(Uc.prototype,"onChangeInputValue",[Rc],Object.getOwnPropertyDescriptor(Uc.prototype,"onChangeInputValue"),Uc.prototype),is(Uc.prototype,"onHideDropdownList",[Dc],Object.getOwnPropertyDescriptor(Uc.prototype,"onHideDropdownList"),Uc.prototype),is(Uc.prototype,"toggleStrategyModal",[xc],Object.getOwnPropertyDescriptor(Uc.prototype,"toggleStrategyModal"),Uc.prototype),is(Uc.prototype,"createStrategy",[Pc],Object.getOwnPropertyDescriptor(Uc.prototype,"createStrategy"),Uc.prototype),is(Uc.prototype,"updateSymbolDropdown",[Nc],Object.getOwnPropertyDescriptor(Uc.prototype,"updateSymbolDropdown"),Uc.prototype),is(Uc.prototype,"updateTradeTypeDropdown",[zc],Object.getOwnPropertyDescriptor(Uc.prototype,"updateTradeTypeDropdown"),Uc.prototype),is(Uc.prototype,"updateDurationDropdown",[Lc],Object.getOwnPropertyDescriptor(Uc.prototype,"updateDurationDropdown"),Uc.prototype),is(Uc.prototype,"updateDurationValue",[Mc],Object.getOwnPropertyDescriptor(Uc.prototype,"updateDurationValue"),Uc.prototype),is(Uc.prototype,"validateQuickStrategy",[Fc],Object.getOwnPropertyDescriptor(Uc.prototype,"validateQuickStrategy"),Uc.prototype),Uc);function ms(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var fs,_s,hs,gs,bs,vs,ks,Es,Ts=(as=qo.action.bound,ls=qo.action.bound,cs=qo.action.bound,ss=qo.action.bound,us=qo.action.bound,ps=function(){function e(t){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(o=ds)&&Object.defineProperty(this,"active_tab",{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(this):void 0}),this.root_store=t}var t,o;return t=e,(o=[{key:"setActiveTab",value:function(e){this.active_tab=e,Bi("active_tab",this.active_tab)}},{key:"setContainerSize",value:function(){this.active_tab===S.WORKSPACE&&(0,s.onWorkspaceResize)()}},{key:"onMount",value:function(){window.addEventListener("resize",this.setContainerSize)}},{key:"getCachedActiveTab",value:function(){Ti("active_tab")&&(this.active_tab=Ti("active_tab"))}},{key:"onUnmount",value:function(){window.removeEventListener("resize",this.setContainerSize)}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ds=ms(ps.prototype,"active_tab",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return S.WORKSPACE}}),ms(ps.prototype,"setActiveTab",[as],Object.getOwnPropertyDescriptor(ps.prototype,"setActiveTab"),ps.prototype),ms(ps.prototype,"setContainerSize",[ls],Object.getOwnPropertyDescriptor(ps.prototype,"setContainerSize"),ps.prototype),ms(ps.prototype,"onMount",[cs],Object.getOwnPropertyDescriptor(ps.prototype,"onMount"),ps.prototype),ms(ps.prototype,"getCachedActiveTab",[ss],Object.getOwnPropertyDescriptor(ps.prototype,"getCachedActiveTab"),ps.prototype),ms(ps.prototype,"onUnmount",[us],Object.getOwnPropertyDescriptor(ps.prototype,"onUnmount"),ps.prototype),ps);function Bs(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function Ss(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Os=(fs=qo.action.bound,_s=qo.action.bound,hs=qo.action.bound,gs=qo.action.bound,bs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Bs(this,"should_show",vs,this),Bs(this,"is_confirmed",ks,this),Bs(this,"last_location",Es,this),this.root_store=t}var t,o;return t=e,(o=[{key:"shouldNavigateAfterPrompt",value:function(e){return!!this.is_confirmed||(this.last_location=e,this.should_show=!0,!1)}},{key:"onConfirm",value:function(){this.should_show=!1,this.is_confirmed=!0}},{key:"onCancel",value:function(){this.should_show=!1}},{key:"continueRoute",value:function(){this.is_confirmed&&this.last_location&&this.root_store.common.routeTo(this.last_location.pathname)}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),vs=Ss(bs.prototype,"should_show",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ks=Ss(bs.prototype,"is_confirmed",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Es=Ss(bs.prototype,"last_location",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ss(bs.prototype,"shouldNavigateAfterPrompt",[fs],Object.getOwnPropertyDescriptor(bs.prototype,"shouldNavigateAfterPrompt"),bs.prototype),Ss(bs.prototype,"onConfirm",[_s],Object.getOwnPropertyDescriptor(bs.prototype,"onConfirm"),bs.prototype),Ss(bs.prototype,"onCancel",[hs],Object.getOwnPropertyDescriptor(bs.prototype,"onCancel"),bs.prototype),Ss(bs.prototype,"continueRoute",[gs],Object.getOwnPropertyDescriptor(bs.prototype,"continueRoute"),bs.prototype),bs),ws=o(7108),Cs=o.n(ws);function As(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function Is(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?As(Object(o),!0).forEach((function(t){Rs(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):As(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Rs(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function Ds(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function xs(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){Ds(i,n,r,a,l,"next",e)}function l(e){Ds(i,n,r,a,l,"throw",e)}a(void 0)}))}}var Ps,Ns,zs,Ls,Ms=function(){function e(t){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.IS_PENDING=!1,this.IS_PROCESSED=!0,this.endpoint="https://dbot-conf-dot-business-intelligence-240201.df.r.appspot.com/dbotconf",this.run_id="",this.run_start=0,this.should_post_xml=!0,this.strategy_content="",this.transaction_ids={},this.cleanXmlDom=function(e){var t=["x","y","id"],o=(0,_e.cloneObject)(e);return function e(o){t.forEach((function(e){return o.removeAttribute(e)})),Array.from(o.children).forEach((function(t){return e(t)}))}(o),o},this.getHash=function(e){return btoa(Cs().str(e))},((0,_e.isProduction)()||/(.*?)\.binary.sx$/.test(window.location.hostname))&&(this.root_store=t,(0,qo.reaction)((function(){return o.root_store.run_panel.is_running}),(function(){return o.root_store.run_panel.is_running?o.trackRun():void 0})),(0,qo.reaction)((function(){return o.root_store.transactions.transactions}),(function(e){o.run_id&&o.trackTransaction(e)})))}var t,n,r,i;return t=e,n=[{key:"trackRun",value:(i=xs(regeneratorRuntime.mark((function e(){var t,o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.cleanXmlDom(Blockly.Xml.workspaceToDom(s.DBot.workspace,!0)),o=Blockly.Xml.domToText(t),n=this.getHash(o),this.getHash(this.strategy_content)!==n&&(this.should_post_xml=!0,this.setStrategyContent(o)),this.setRunId(this.getHash(n+this.root_store.core.client.loginid+Math.random())),this.setRunStart(this.root_store.common.server_time.unix());case 6:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"trackTransaction",value:(r=xs(regeneratorRuntime.mark((function e(t){var n,r,i,a,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.e(297).then(o.t.bind(o,2845,23));case 2:if(n=e.sent,r=t[0]){e.next=6;break}return e.abrupt("return");case 6:i=r.data.transaction_ids.buy,Object.keys(this.transaction_ids).includes(i.toString())||(this.transaction_ids[i]=this.IS_PENDING,a=function(){return{body:n.gzip(l.strategy_content),headers:{"Content-Encoding":"gzip","Content-Type":"application/xml",Referer:window.location.hostname}}},fetch("".concat(this.endpoint,"/").concat(this.run_id,"/").concat(i,"/").concat(this.run_start,"/").concat(this.getHash(this.strategy_content)),Is(Is({},this.should_post_xml?a():{}),{},{method:"POST",mode:"cors"})).then((function(){l.should_post_xml=!1,l.transaction_ids[i]=l.IS_PROCESSED})).catch((function(){delete l.transaction_ids[i]})));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setRunId",value:function(e){this.run_id=e}},{key:"setRunStart",value:function(e){this.run_start=e}},{key:"setStrategyContent",value:function(e){this.strategy_content=e}}],n&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Fs(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Us,js,Vs,Hs,Js,Gs,Ws,Ys,qs,Ks=(Ps=qo.action.bound,Ns=qo.action.bound,zs=function(){function e(t){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Ls)&&Object.defineProperty(this,"is_loading",{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(this):void 0}),this.root_store=t}var t,o;return t=e,(o=[{key:"startLoading",value:function(){this.is_loading=!0}},{key:"endLoading",value:function(){this.is_loading=!1}}])&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ls=Fs(zs.prototype,"is_loading",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Fs(zs.prototype,"startLoading",[Ps],Object.getOwnPropertyDescriptor(zs.prototype,"startLoading"),zs.prototype),Fs(zs.prototype,"endLoading",[Ns],Object.getOwnPropertyDescriptor(zs.prototype,"endLoading"),zs.prototype),zs);function Xs(e,t,o,n,r,i,a){try{var l=e[i](a),c=l.value}catch(e){return void o(e)}l.done?t(c):Promise.resolve(c).then(n,r)}function Zs(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function Qs(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var $s,eu,tu,ou,nu,ru,iu,au,lu,cu,su,uu,pu,du,yu,mu,fu,_u,hu,gu,bu,vu,ku=(Us=qo.action.bound,js=qo.action.bound,Vs=qo.action.bound,Hs=qo.action.bound,Js=qo.action.bound,Gs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Zs(this,"api_max_losses",Ws,this),Zs(this,"run_limit",Ys,this),Zs(this,"is_restricted",qs,this),this.root_store=t}var t,o,n,r;return t=e,o=[{key:"initial_values",get:function(){return{form_max_losses:this.api_max_losses||"",run_limit:-1!==this.run_limit?this.run_limit:""}}},{key:"should_bot_run",get:function(){var e=this.root_store.core.client;return!(e.is_eu&&!e.is_virtual&&(0===this.api_max_losses||-1===this.run_limit))}},{key:"setIsRestricted",value:function(e){this.is_restricted=e}},{key:"setApiMaxLosses",value:function(e){this.api_max_losses=e}},{key:"setRunLimit",value:function(e){this.run_limit=e}},{key:"resetSelfExclusion",value:function(){this.is_restricted=!1,this.api_max_losses=0,this.form_max_losses=0,this.run_limit=-1}},{key:"checkRestriction",value:(n=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.root_store.core.client,e.next=3,t.getSelfExclusion();case 3:t.self_exclusion.max_losses&&this.setApiMaxLosses(t.self_exclusion.max_losses);case 4:case"end":return e.stop()}}),e,this)})),r=function(){var e=this,t=arguments;return new Promise((function(o,r){var i=n.apply(e,t);function a(e){Xs(i,o,r,a,l,"next",e)}function l(e){Xs(i,o,r,a,l,"throw",e)}a(void 0)}))},function(){return r.apply(this,arguments)})}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ws=Qs(Gs.prototype,"api_max_losses",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ys=Qs(Gs.prototype,"run_limit",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),qs=Qs(Gs.prototype,"is_restricted",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Qs(Gs.prototype,"initial_values",[qo.computed],Object.getOwnPropertyDescriptor(Gs.prototype,"initial_values"),Gs.prototype),Qs(Gs.prototype,"should_bot_run",[qo.computed],Object.getOwnPropertyDescriptor(Gs.prototype,"should_bot_run"),Gs.prototype),Qs(Gs.prototype,"setIsRestricted",[Us],Object.getOwnPropertyDescriptor(Gs.prototype,"setIsRestricted"),Gs.prototype),Qs(Gs.prototype,"setApiMaxLosses",[js],Object.getOwnPropertyDescriptor(Gs.prototype,"setApiMaxLosses"),Gs.prototype),Qs(Gs.prototype,"setRunLimit",[Vs],Object.getOwnPropertyDescriptor(Gs.prototype,"setRunLimit"),Gs.prototype),Qs(Gs.prototype,"resetSelfExclusion",[Hs],Object.getOwnPropertyDescriptor(Gs.prototype,"resetSelfExclusion"),Gs.prototype),Qs(Gs.prototype,"checkRestriction",[Js],Object.getOwnPropertyDescriptor(Gs.prototype,"checkRestriction"),Gs.prototype),Gs);function Eu(e){return function(e){if(Array.isArray(e))return Tu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Tu(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Tu(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tu(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function Bu(e,t,o,n){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(n):void 0})}function Su(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Ou,wu,Cu,Au=($s=qo.action.bound,eu=qo.action.bound,tu=qo.action.bound,ou=qo.action.bound,nu=qo.action.bound,ru=qo.action.bound,iu=qo.action.bound,au=qo.action.bound,lu=qo.action.bound,cu=qo.action.bound,su=qo.action.bound,uu=qo.action.bound,pu=qo.action.bound,du=qo.action.bound,yu=qo.action.bound,mu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Bu(this,"is_toolbox_open",fu,this),Bu(this,"is_search_loading",_u,this),Bu(this,"is_search_focus",hu,this),Bu(this,"sub_category_index",gu,this),Bu(this,"toolbox_dom",bu,this),Bu(this,"toolbox_examples",vu,this),this.root_store=t}var t,o;return t=e,o=[{key:"onMount",value:function(e){var t=this,o=this.root_store.core;this.adjustWorkspace(),(0,_e.isMobile)()||(this.toolbox_dom=Blockly.Xml.textToDom(null==e?void 0:e.current),this.toolbox_examples=Eu(this.toolbox_dom.childNodes).find((function(e){return"examples"===e.tagName})),this.setWorkspaceOptions(),this.disposeToolboxToggleReaction=(0,qo.reaction)((function(){return t.is_toolbox_open}),(function(e){e&&(t.adjustWorkspace(),o.gtm.pushDataLayer({event:"dbot_toolbox_visible",value:!0}))})))}},{key:"onUnmount",value:function(){"function"==typeof this.disposeToolboxToggleReaction&&this.disposeToolboxToggleReaction()}},{key:"setWorkspaceOptions",value:function(){var e,t,o,n,r,i=Blockly.derivWorkspace;i.options.readOnly?(e=null,t=!1,o=!1,n=!1,r=!1):(e=this.toolbox_dom,o=t=Boolean(e&&e.getElementsByTagName("category").length),n=t,r=t),i.options.collapse=o,i.options.comments=n,i.options.disable=r,i.options.hasCategories=t,i.options.languageTree=e}},{key:"adjustWorkspace",value:function(){var e,t,o=Blockly.derivWorkspace,n=(null===(e=document.getElementById("gtm-toolbox"))||void 0===e?void 0:e.getBoundingClientRect().width)||0,r=null===(t=o.svgBlockCanvas_)||void 0===t?void 0:t.getBoundingClientRect();if(Math.round(null==r?void 0:r.left)<=n){var i=(0,_e.isMobile)()?n-r.left+20:n-r.left+36;(0,s.scrollWorkspace)(o,i,!0,!1)}}},{key:"toggleDrawer",value:function(){this.is_toolbox_open=!this.is_toolbox_open}},{key:"onToolboxItemClick",value:function(e){var t,o=this.root_store.flyout,n=e.getAttribute("id"),r=this.getCategoryContents(e);o.setIsSearchFlyout(!1),(null===(t=o.selected_category)||void 0===t?void 0:t.getAttribute("id"))===n?o.setVisibility(!1):(o.setSelectedCategory(e),o.setContents(r))}},{key:"onToolboxItemExpand",value:function(e){if(this.sub_category_index.includes(e)){var t=this.sub_category_index.filter((function(t){return t!==e}));this.sub_category_index=t}else this.sub_category_index=[].concat(Eu(this.sub_category_index),[e])}},{key:"getCategoryContents",value:function(e){var t=Blockly.derivWorkspace,o=e.getAttribute("dynamic"),n=Array.from(e.childNodes);return"string"==typeof o&&(n=t.getToolboxCategoryCallback(o)(t)),n}},{key:"getAllCategories",value:function(){var e=this,t=[];return Array.from(this.toolbox_dom.childNodes).forEach((function(o){t.push(o),e.hasSubCategory(o.children)&&Array.from(o.children).forEach((function(e){t.push(e)}))})),t}},{key:"hasSubCategory",value:function(e){return!!Object.keys(e).filter((function(t){if("CATEGORY"===e[t].tagName.toUpperCase())return e[t]})).length}},{key:"onSearch",value:function(e){var t=e.search;this.is_search_focus=!0,this.showSearch(t)}},{key:"onSearchBlur",value:function(){this.is_search_focus=!1}},{key:"onSearchClear",value:function(e){e("search",""),this.showSearch("")}},{key:"onSearchKeyUp",value:function(e){var t=this;this.is_search_loading=!0,clearTimeout(this.typing_timer),this.typing_timer=setTimeout((0,qo.action)((function(){e(),t.is_search_loading=!1})),1e3)}},{key:"showSearch",value:function(e){var t=this,o=Blockly.derivWorkspace,n=[],r=e.replace(/\s+/g," ").trim().toUpperCase(),i=r.split(" "),a=o.getVariablesOfType(""),l=Blockly.Procedures.allProcedures(o),c=this.root_store.flyout;c.setVisibility(!1);var s=[(0,B.localize)("THE"),(0,B.localize)("OF"),(0,B.localize)("YOU"),(0,B.localize)("IS"),(0,B.localize)("THIS"),(0,B.localize)("THEN"),(0,B.localize)("A"),(0,B.localize)("AN")];if(0!==r.length){if(r.length<=1||i.every((function(e){return s.includes(e)})))return c.setIsSearchFlyout(!0),void c.setContents(n,e);var u=this.getAllCategories().filter((function(e){return!t.hasSubCategory(e.children)})).map((function(e){var o=t.getCategoryContents(e);return Array.from(o).filter((function(e){return"BLOCK"===e.tagName.toUpperCase()}))})).flat(),p=function(e,t){e.some((function(e){return e===t}))||e.push(t)};["exact_block_name","match_words","block_term","block_definitions","block_meta"].forEach((function(e){return function(e){u.forEach((function(t){var o=t.getAttribute("type"),a=Blockly.Blocks[o],l=a.meta instanceof Function&&a.meta(),c=a.definition instanceof Function&&a.definition(),s=l.display_name,u=o.toUpperCase().split("_"),d=s.toUpperCase().split(" "),y=/^((message)|(tooltip)|(category))/;switch(e){case"exact_block_name":r!==s.toUpperCase()&&r!==o.toUpperCase()||p(n,t);break;case"match_words":(i.every((function(e){return d.some((function(t){return t.includes(e)}))}))||i.every((function(e){return u.some((function(t){return t.includes(e)}))})))&&p(n,t);break;case"block_term":(u.some((function(e){return i.some((function(t){return e.includes(t)}))}))||d.some((function(e){return i.some((function(t){return e.includes(t)}))})))&&p(n,t);break;case"block_definitions":Object.keys(c).forEach((function(e){var o=c[e];y.test(e)&&i.some((function(e){return o.includes(e)}))&&p(n,t),o instanceof Array&&o.forEach((function(e){var o=JSON.stringify(e).toUpperCase();"field_dropdown"===e.type&&r.length>2&&i.some((function(e){return o.includes(e)}))&&p(n,t)}))}));break;case"block_meta":var m=Object.keys(l).filter((function(e){return"display_name"!==e})).find((function(e){var t=l[e].toUpperCase().replace(/[^\w\s]/gi,"").split(" ");return i.some((function(e){return t.some((function(t){return t.includes(e)}))}))}));m&&m.length&&p(n,t)}}))}(e)}));var d=a.filter((function(e){return e.name.toUpperCase().includes(r)})),y=Blockly.DataCategory.search(d).filter((function(e){return-1===n.indexOf(e)}));y&&y.length&&n.unshift.apply(n,Eu(y));var m={0:[],1:[]},f=l[0],_=l[1];Object.keys(f).forEach((function(e){var t=f[e];t[0].toUpperCase().includes(r)&&m[0].unshift(t)})),Object.keys(_).forEach((function(e){var t=_[e];t[0].toUpperCase().includes(r)&&m[1].unshift(t)}));var h=Blockly.Procedures.populateDynamicProcedures(m).filter((function(e){return-1===n.indexOf(e)}));h.length&&n.unshift.apply(n,Eu(h)),c.setIsSearchFlyout(!0),c.setContents(n,e)}}}],o&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),fu=Su(mu.prototype,"is_toolbox_open",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),_u=Su(mu.prototype,"is_search_loading",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),hu=Su(mu.prototype,"is_search_focus",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),gu=Su(mu.prototype,"sub_category_index",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),bu=Su(mu.prototype,"toolbox_dom",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vu=Su(mu.prototype,"toolbox_examples",[qo.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Su(mu.prototype,"onMount",[$s],Object.getOwnPropertyDescriptor(mu.prototype,"onMount"),mu.prototype),Su(mu.prototype,"onUnmount",[eu],Object.getOwnPropertyDescriptor(mu.prototype,"onUnmount"),mu.prototype),Su(mu.prototype,"setWorkspaceOptions",[tu],Object.getOwnPropertyDescriptor(mu.prototype,"setWorkspaceOptions"),mu.prototype),Su(mu.prototype,"adjustWorkspace",[ou],Object.getOwnPropertyDescriptor(mu.prototype,"adjustWorkspace"),mu.prototype),Su(mu.prototype,"toggleDrawer",[nu],Object.getOwnPropertyDescriptor(mu.prototype,"toggleDrawer"),mu.prototype),Su(mu.prototype,"onToolboxItemClick",[ru],Object.getOwnPropertyDescriptor(mu.prototype,"onToolboxItemClick"),mu.prototype),Su(mu.prototype,"onToolboxItemExpand",[iu],Object.getOwnPropertyDescriptor(mu.prototype,"onToolboxItemExpand"),mu.prototype),Su(mu.prototype,"getCategoryContents",[au],Object.getOwnPropertyDescriptor(mu.prototype,"getCategoryContents"),mu.prototype),Su(mu.prototype,"getAllCategories",[lu],Object.getOwnPropertyDescriptor(mu.prototype,"getAllCategories"),mu.prototype),Su(mu.prototype,"hasSubCategory",[cu],Object.getOwnPropertyDescriptor(mu.prototype,"hasSubCategory"),mu.prototype),Su(mu.prototype,"onSearch",[su],Object.getOwnPropertyDescriptor(mu.prototype,"onSearch"),mu.prototype),Su(mu.prototype,"onSearchBlur",[uu],Object.getOwnPropertyDescriptor(mu.prototype,"onSearchBlur"),mu.prototype),Su(mu.prototype,"onSearchClear",[pu],Object.getOwnPropertyDescriptor(mu.prototype,"onSearchClear"),mu.prototype),Su(mu.prototype,"onSearchKeyUp",[du],Object.getOwnPropertyDescriptor(mu.prototype,"onSearchKeyUp"),mu.prototype),Su(mu.prototype,"showSearch",[yu],Object.getOwnPropertyDescriptor(mu.prototype,"showSearch"),mu.prototype),mu);function Iu(e,t,o,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=o.slice().reverse().reduce((function(o,n){return n(e,t,o)||o}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Ru=(Ou=qo.action.bound,wu=qo.action.bound,Cu=function(){function e(t){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onBeforeUnload=function(e){o.root_store.run_panel.is_stop_button_visible&&(e.returnValue=!0)},this.onClickOutsideBlockly=function(e){var t;document.querySelector(".injectionDiv")&&((e.path||e.composedPath&&e.composedPath()).some((function(e){return e.classList&&e.classList.contains("injectionDiv")}))||null===(t=Blockly)||void 0===t||t.hideChaff(!1))},this.showDigitalOptionsMaltainvestError=function(e,t){!e.is_logged_in&&e.is_eu_country||e.has_maltainvest_account||(0,_e.isEuResidenceWithOnlyVRTC)(e.active_accounts)||e.is_options_blocked?(0,_e.showDigitalOptionsUnavailableError)(t.showError,{text:(0,B.localize)("We’re working to have this available for you soon. If you have another account, switch to that account to continue trading. You may add a DMT5 Financial."),title:(0,B.localize)("DBot is not available for this account"),link:(0,B.localize)("Go to DMT5 dashboard")}):t.has_error&&t.setError(!1,null)},this.root_store=t,this.dbot_store=null,this.api_helpers_store=null}var t,n;return t=e,n=[{key:"onMount",value:function(){var e=this.root_store,t=e.blockly_store,n=e.core,r=e.main_content,i=n.client,a=n.common,l=n.ui;this.showDigitalOptionsMaltainvestError(i,a),t.startLoading(),s.DBot.initWorkspace(o.p,this.dbot_store,this.api_helpers_store,l.is_mobile).then((function(){r.setContainerSize(),t.endLoading()})),this.registerReloadOnLanguageChange(this),this.registerCurrencyReaction.call(this),this.registerOnAccountSwitch.call(this),this.registerLandingCompanyChangeReaction.call(this),this.registerResidenceChangeReaction.call(this),window.addEventListener("click",this.onClickOutsideBlockly),window.addEventListener("beforeunload",this.onBeforeUnload),r.getCachedActiveTab()}},{key:"onUnmount",value:function(){s.DBot.terminateBot(),Blockly.derivWorkspace&&(clearInterval(Blockly.derivWorkspace.save_workspace_interval),Blockly.derivWorkspace.dispose()),"function"==typeof this.disposeReloadOnLanguageChangeReaction&&this.disposeReloadOnLanguageChangeReaction(),"function"==typeof this.disposeCurrencyReaction&&this.disposeCurrencyReaction(),"function"==typeof this.disposeSwitchAccountListener&&this.disposeSwitchAccountListener(),"function"==typeof this.disposeLandingCompanyChangeReaction&&this.disposeLandingCompanyChangeReaction(),"function"==typeof this.disposeResidenceChangeReaction&&this.disposeResidenceChangeReaction(),window.removeEventListener("click",this.onClickOutsideBlockly),window.removeEventListener("beforeunload",this.onBeforeUnload);var e=this.root_store.core.ui;e.setAccountSwitcherDisabledMessage(!1),e.setPromptHandler(!1)}},{key:"registerReloadOnLanguageChange",value:function(){var e=this;this.disposeReloadOnLanguageChangeReaction=(0,qo.reaction)((function(){return e.root_store.common.current_language}),(function(){var e=window.location.pathname;(/^\/bot/.test(e)||/^\/(br_)/.test(e)&&"bot"===e.split("/")[2])&&window.location.reload()}))}},{key:"registerCurrencyReaction",value:function(){var e=this;this.disposeCurrencyReaction=(0,qo.reaction)((function(){return e.root_store.core.client.currency}),(function(e){Blockly.derivWorkspace&&Blockly.derivWorkspace.getAllBlocks().filter((function(e){return"trade_definition_tradeoptions"===e.type||"trade_definition_multiplier"===e.type||e.isDescendantOf("trade_definition_multiplier")&&"trade_parameters"===e.category_})).forEach((function(t){return t.setCurrency(e)}))}))}},{key:"registerOnAccountSwitch",value:function(){var e=this,t=this.root_store.core,o=t.client,n=t.common;this.disposeSwitchAccountListener=(0,qo.reaction)((function(){return o.switch_broadcast}),(function(t){if(t){e.showDigitalOptionsMaltainvestError(o,n);var r=s.ApiHelpers.instance,i=r.active_symbols,a=r.contracts_for;Blockly.derivWorkspace&&i.retrieveActiveSymbols(!0).then((function(){a.disposeCache(),Blockly.derivWorkspace.getAllBlocks().filter((function(e){return"trade_definition_market"===e.type})).forEach((function(e){(0,s.runIrreversibleEvents)((function(){var t=new Blockly.Events.Create(e);Blockly.Events.fire(t)}))}))}))}}))}},{key:"registerLandingCompanyChangeReaction",value:function(){var e=this.root_store.core,t=e.client,o=e.common;this.disposeLandingCompanyChangeReaction=(0,qo.reaction)((function(){return t.landing_company_shortcode}),(function(){(!t.is_logged_in&&t.is_eu_country||t.has_maltainvest_account||(0,_e.isEuResidenceWithOnlyVRTC)(t.active_accounts)||t.is_options_blocked)&&(0,_e.showDigitalOptionsUnavailableError)(o.showError,{text:(0,B.localize)("We’re working to have this available for you soon. If you have another account, switch to that account to continue trading. You may add a DMT5 Financial."),title:(0,B.localize)("DBot is not available for this account"),link:(0,B.localize)("Go to DMT5 dashboard")})}))}},{key:"registerResidenceChangeReaction",value:function(){var e=this.root_store.core,t=e.client,o=e.common;this.disposeResidenceChangeReaction=(0,qo.reaction)((function(){return t.account_settings.country_code}),(function(){(!t.is_logged_in&&t.is_eu_country||t.has_maltainvest_account||(0,_e.isEuResidenceWithOnlyVRTC)(t.active_accounts)||t.is_options_blocked)&&(0,_e.showDigitalOptionsUnavailableError)(o.showError,{text:(0,B.localize)("We’re working to have this available for you soon. If you have another account, switch to that account to continue trading. You may add a DMT5 Financial."),title:(0,B.localize)("DBot is not available for this account"),link:(0,B.localize)("Go to DMT5 dashboard")})}))}},{key:"setDBotEngineStores",value:function(){var e=this.root_store,t=e.core.client,o=e.flyout,n=e.toolbar,r=e.save_modal,i=e.quick_strategy,a=e.load_modal,l=e.blockly_store,c=e.summary_card,s=a.handleFileChange,u=i.toggleStrategyModal,p=l.startLoading,d=l.endLoading,y=c.populateConfig,m=c.setContractUpdateConfig;this.dbot_store={is_mobile:!1,client:t,flyout:o,populateConfig:y,toolbar:n,save_modal:r,startLoading:p,setContractUpdateConfig:m,endLoading:d,toggleStrategyModal:u,handleFileChange:s},this.api_helpers_store={server_time:this.root_store.server_time,ws:this.root_store.ws}}}],n&&function(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Iu(Cu.prototype,"onMount",[Ou],Object.getOwnPropertyDescriptor(Cu.prototype,"onMount"),Cu.prototype),Iu(Cu.prototype,"onUnmount",[wu],Object.getOwnPropertyDescriptor(Cu.prototype,"onUnmount"),Cu.prototype),Cu);function Du(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var xu=function(e,t,o){return t&&Du(e.prototype,t),o&&Du(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t,o,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.core=t,this.ui=t.ui,this.common=t.common,this.notifications=t.notifications,this.ws=o,this.dbot=n,this.server_time=t.common.server_time,this.app=new Ru(this),this.summary_card=new ac(this),this.blockly_store=new Ks(this),this.download=new yn(this),this.flyout=new Un(this),this.flyout_help=new oi(this),this.google_drive=new vi(this),this.journal=new ra(this),this.load_modal=new Xa(this),this.run_panel=new dl(this),this.save_modal=new hl(this),this.summary=new bl(this),this.transactions=new es(this),this.toolbar=new bc(this),this.toolbox=new Au(this),this.quick_strategy=new ys(this),this.route_prompt_dialog=new Os(this),this.self_exclusion=new ku(this),this.chart_store=new rn(this),this.main_content=new Ts(this),this.data_collection_store=new Ms(this)}));function Pu(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}const Nu=function(e){var t,o=e.passthrough,n=o.root_store,r=o.WS,i=(2,function(e){if(Array.isArray(e))return e}(t=l.useState(!0))||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),2!==i.length);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(t)||function(e,t){if(e){if("string"==typeof e)return Pu(e,2);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Pu(e,2):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],p=i[1],d=l.useRef(new xu(n,r,s.DBot)),y=d.current,m=y.app,f=y.common,_=y.core,h=m.onMount,b=m.onUnmount,v=m.showDigitalOptionsMaltainvestError;return l.useEffect((function(){v(_.client,f)}),[_.client.is_options_blocked,_.client.account_settings.country_code]),l.useEffect((function(){fn.init(d.current),s.ServerTime.init(f),m.setDBotEngineStores(d.current),s.ApiHelpers.setInstance(m.api_helpers_store);var e=s.ApiHelpers.instance.active_symbols;return p(!0),e.retrieveActiveSymbols(!0).then((function(){p(!1),h()})),function(){b()}}),[h,b]),a?l.createElement(c.Loading,null):l.createElement(g,{store:d.current},l.createElement("div",{className:"bot"},l.createElement(I,null),l.createElement(No,null),l.createElement(ft,null),l.createElement(ko,null),l.createElement(Ot,null),l.createElement(C,null),l.createElement(u,null),l.createElement(wt,null),l.createElement(k,null)))}}}]);